{
  "name": "Angharad",
  "tagline": "House automation system with a REST/Json interface",
  "body": "# Angharad\r\n\r\nHouse automation system API server\r\n\r\n![example snapshot](https://github.com/babelouest/sagremor/raw/master/snapshots/dashboard-filled.png)\r\nCentral program and orchestrator of the following submodules:\r\n\r\n- [Benoic](https://github.com/babelouest/benoic): Command house automation devices as lights, heaters, sensors, switches. Currently [ZWave](http://www.z-wave.com/) and [Taulas](https://github.com/babelouest/taulas) devices are supported\r\n- [Carleon](https://github.com/babelouest/carleon): Command house automation side services (music, camera, etc)\r\n- [Gareth](https://github.com/babelouest/gareth): Logs and messenger service\r\n\r\nAngharad integrates all those submodules functionnalities and manages scripts, events, user profiles, and a small static file server.\r\n\r\nBenoic and Carleon implement a dynamic lbrary loading interface to add/remove/update modules without having to recompile all the system every time an update or an improvement is made.\r\n\r\nEach module are compiled independently and have its own dependencies.\r\n\r\n# Prerequisites\r\n\r\nAll Angharad system, its submodules and its custom libraries are written in C language, for better preformance and lightweight resources consumption. GCC and Makefile were used for the development.\r\n\r\n## External dependencies\r\n\r\n### TL;DR\r\n\r\nOn Debian-based systems (Debian, Raspbian, Ubuntu), use the following comand to install dependencies:\r\n\r\n```shell\r\nsudo apt-get install libmicrohttpd-dev libjansson-dev libcurl4-gnutls-dev uuid-dev libldap2-dev libmysqlclient-dev libsqlite3-dev libconfig-dev\r\n\r\ngit clone https://github.com/babelouest/orcania.git\r\ncd orcania\r\nmake\r\nsudo make install\r\n\r\ngit clone https://github.com/babelouest/yder.git\r\ncd yder/src\r\nmake\r\nsudo make install\r\n\r\ngit clone https://github.com/babelouest/ulfius.git\r\ncd ulfius/src\r\nmake\r\nsudo make install\r\n\r\ngit clone https://github.com/babelouest/hoel.git\r\ncd hoel/src\r\nmake\r\nsudo make install\r\n```\r\n\r\nThe following external libraries are required to build Angharad:\r\n- [libuuid](https://sourceforge.net/projects/libuuid/), UUID generator\r\n- [libldap](http://www.openldap.org/devel//cvsweb.cgi/libraries/libldap?hideattic=0&sortbydate=0), ldap API\r\n- [libconfig](http://www.hyperrealm.com/libconfig/), Configuration File Library\r\n- [jansson](http://www.digip.org/jansson/), json manipulation library\r\n\r\nThe following other external libraries are required to build angharad dependencies:\r\n- [libmicrohttpd](https://www.gnu.org/software/libmicrohttpd/), HTTP server library\r\n- [libcurl](https://curl.haxx.se/libcurl/), HTTP client library\r\n- [MySQL client API](https://dev.mysql.com/doc/refman/5.7/en/c-api.html), MySQL/MariaDB API\r\n- [SQLite3](https://www.sqlite.org/), SQLite API\r\n\r\nAnd finally, Angharad depends on the following libraries:\r\n- [Orcania](https://github.com/babelouest/orcania), Potluck with different functions for different purposes that can be shared among angharad programs\r\n- [Yder](https://github.com/babelouest/yder), Logging library\r\n- [Ulfius](https://github.com/babelouest/ulfius), Web Framework for REST Applications\r\n- [Hoel](https://github.com/babelouest/hoel), Database abstraction library\r\n\r\n## Benoic modules prerequisites\r\n\r\nBenoic implements a ZWave module to control ZWave nodes and a [Taulas](https://github.com/babelouest/taulas) module.\r\n\r\nThe Benoic module is based on the [OpenZwave library](http://www.openzwave.net/). You must download and install this library before installing benoic zwave device module, version 1.2 or above, preferably a stable version.\r\n\r\n## Carleon modules prerequisites\r\n\r\nCarleon modules available are the following:\r\n- Motion control, to view pictures and real-time streams of a motion application\r\n- MPD Control, for basic control of a MPD instance: volume, play/pause/stop and playlist loading, depends on [libmpdclient](https://www.musicpd.org/libs/libmpdclient/) (`apt-get install libmpdclient-dev`)\r\n- Liquidsoap Control, for basic control of a [liquidsoap](http://liquidsoap.fm/) based webradio: play/stop/next and view the 10 last played songs\r\n\r\n# Installation\r\n\r\n## Main system compilation\r\n\r\nWhen all prerequisites are installed, clone angharad from github, and git install submodules:\r\n\r\n```shell\r\ngit clone https://github.com/babelouest/angharad.git\r\ncd angharad\r\ngit submodule update --init\r\nmake\r\n```\r\n\r\nThis will compile angharad program, and all device-modules for Benoic and services for Carleon.\r\n\r\n## Full system installation\r\n\r\nGo back to angharad source folder, then as root, run `make install`:\r\n\r\n```shell\r\ncd angharad\r\nsudo make install\r\n```\r\n\r\n## Benoic modules\r\n\r\nBenoic modules are located in the folder `benoic/device-modules`. If you want to adapt or change the modules for your needs, you can manually compile them.\r\n\r\nThe module named `device-mock.c` is a mock device that is used to test the behaviour of a module with benoic and angharad systems. A mock device doesn't control any real hardware, but simulates the behaviour of a device. You can use it to help you write your own device module.\r\n\r\n```shell\r\ncd benoic/device-modules\r\nmake libdevzwave.so # For ZWave device\r\nmake libdevtaulas.so # For Taulas device\r\nmake libdevmock.so # For mock device\r\nsudo make install # to install compiled devices in $PREFIX/lib/angharad/benoic directory\r\n```\r\n\r\n## Carleon modules\r\n\r\nCarleon service are located in the folder `carleon/service-modules/`.\r\n\r\nThe service named `service-mock.c` is a mock service that is used to test the behaviour of a service with carleon and angharad systems. A mock service doesn't control any real service, but simulates one. You can use it to help you write your own service.\r\n\r\n```shell\r\ncd carleon/service-modules/\r\nmake libservicemotion.so # For Motion service\r\nmake libservicempd.so # For MPD service\r\nmake libserviceliquidsoap.so # For MPD service\r\nmake libservicemock.so # For mock service\r\nsudo make install # to install compiled devices in $PREFIX/lib/angharad/carleon directory\r\n```\r\n\r\n## Database installation\r\n\r\nDepending on your needs, you can use a sqlite3 database (single file, fast and reliable) or a MySQL Database (fast and reliable as well but also more secure).\r\n\r\n### MySQL Installation\r\n\r\nRun the SQL script angharad.mariadb.sql file under an already existing database.\r\n\r\n```shell\r\nmysql < angharad.mariadb.sql\r\n```\r\n\r\n### SQLite3 installation\r\n\r\nRun the SQL script angharad.sqlite3.sql file in an existing or a new SQLite3 database file:\r\n```shell\r\nsqlite3 angharad.db < angharad.sqlite3.sql\r\n```\r\n\r\n# Configuration\r\n\r\nThe file angharad.conf.sample contains a sample file with all the configuration parameters needed, just fill the parameters with your own environment. Paths can be relatives or absolute.\r\n\r\nCopy `angharad.conf.sample` into your configuration folder as `angharad.conf`\r\n\r\n```shell\r\ncp angharad.conf.sample /usr/local/etc/angharad.conf\r\n```\r\n\r\n## Static file server\r\n\r\n`static_files_path` and `static_files_prefix` are used for the static files server, in this case, [Sagremor](https://github.com/babelouest/sagremor) is the dedicated web application and can be hosted there.\r\n\r\nBeware that the static web server is not secured with SSL connection, so don't use it outside a trusted network. i.e., don't forward ports directly outside your network.\r\n\r\nIf you want to access angharad in a secure connection, you can use apache `mod_proxy` and an https instance for example, and embed angharad access in it.\r\n\r\n## Database\r\n\r\nSpecify the database parameters in the `database {}` block, depending on your database configuration (SQLite3 or MySQL).\r\n\r\n## Authentication\r\n\r\nCurrently, 2 types of authentication are supported, database users or LDAP authentication. If you use database authentication, you can manage users with the dedicated API.\r\n\r\nPlease note that users and profile are not linked, any authenticated user can use any profile.\r\n\r\n# Run Angharad\r\n\r\nTo run angharad, simply execute the command:\r\n\r\n```shell\r\n/usr/local/bin/angharad --config-file=/usr/local/etc/angharad.conf\r\n```\r\n\r\nCheck the log messages in the log file, syslog or the console, depending on your configuration, then the server will be up and running when you'll se the following log message:\r\n\r\n```log\r\nyyyy-mm-dd hh:mm:ss - Angharad INFO: Start angharad on port 2473\r\n```\r\n\r\nNow you can access Angharad API via a third party application like [Sagremor](https://github.com/babelouest/sagremor).\r\n\r\n# Angharad API Documentation\r\n\r\nAngharad has several endpoints with their own format. Here is the full documentaition of the REST API.\r\n\r\nAll the return data are in JSON format.\r\n\r\nExcept fo static file API, all URL have the prefix called `ANGHARAD_PREFIX`, default is `/angharad`. All the URLs given in this dcumentation (Except for static files) are relative to `ANGHARAD_PREFIX`.\r\n\r\n## Authentication\r\n\r\nExcept when mentionned otherwise, all endpoints require a valid authentication token located in the header or in the cookies. The header or cookies key must be called `\"ANGHARAD_SESSION_ID\"` and the value must be a valid token value returned b a previous successfull login.\r\n\r\n## Submodules management\r\n\r\n### Get all submodules available\r\n\r\n#### URL\r\n\r\n`/submodule/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[\r\n\t{\r\n\t\t\"name\": string, max 64 characters\r\n\t\t\"description\": string, max 128 characters\r\n\t\t\"enabled\": boolean\r\n\t}\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get submodule specified\r\n\r\n#### URL\r\n\r\n`/submodule/@submodule_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@submodule_name`: Submodule name to look for\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"name\": string, max 64 characters\r\n\t\"description\": string, max 128 characters\r\n\t\"enabled\": boolean\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nSubmodule `@submodule_name`not found\r\n\r\n### Enable or disable submodule\r\n\r\n#### URL\r\n\r\n`/submodule/@submodule_name/enable/@enabled`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@submodule_name`: Submodule name to look for\r\n\r\n`@enabled`: 0 (disable) or 1 (enable)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nSubmodule `@submodule_name`not found\r\n\r\n## Scripts management\r\n\r\n### Get all scripts available\r\n\r\n#### URL\r\n\r\n`/script`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[\r\n\t{\r\n\r\n\t\t\"name\":string, maximum 64 characters, required\r\n\t\t\"description\":string, maximum 128 characters, optional\r\n\t\t\"options\":{ optional\r\n\t\t\t\"tags\":[\r\n\t\t\t\tstring, maximum 64 characters\r\n\t\t\t] Maximum 128 tags\r\n\t\t},\r\n\t\t\"actions\":[\r\n\t\t\t{\r\n\t\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\t\"element\": string, element name, required\r\n\t\t\t\t\"parameters\":{\r\n\t\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t},\r\n\t\t\t\t\"command\": string|number, command to send to the element, required\r\n\t\t\t}\r\n\t\t]\r\n\r\n\t}\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get script by its name\r\n\r\n#### URL\r\n\r\n`/script/@script_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n`@script_name`: script name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\r\n\t\"name\":string, maximum 64 characters, required\r\n\t\"description\":string, maximum 128 characters, optional\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n\t\"actions\":[\r\n\t\t{\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t},\r\n\t\t\t\"command\": string|number, command to send to the element, required\r\n\t\t}\r\n\t]\r\n\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScript not found\r\n\r\n### Add new script\r\n\r\n#### URL\r\n\r\n`/script/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\r\n\t\"name\":string, maximum 64 characters, must be a new name, required\r\n\t\"description\":string, maximum 128 characters, optional\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n\t\"actions\":[\r\n\t\t{\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t},\r\n\t\t\t\"command\": string|number, command to send to the element, required\r\n\t\t}\r\n\t]\r\n\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify a script\r\n\r\n#### URL\r\n\r\n`/script/@script_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@script_name`: Script name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\r\n\t\"description\":string, maximum 128 characters, optional\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n\t\"actions\":[\r\n\t\t{\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"command\": string|number, command to send to the element, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Remove a script\r\n\r\n#### URL\r\n\r\n`/script/@script_name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@script_name`: Script name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScript not found\r\n\r\n### Add tag to script\r\n\r\n#### URL\r\n\r\n`/script/@script_name/@tag`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@tag`: tag value, maximum 64 characters, maximum 128 tags per element\r\n\r\n`@script_name`: Script name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nscript not found\r\n\r\n### Delete tag from script\r\n\r\n#### URL\r\n\r\n`/script/@script_name/@tag`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@tag`: tag value, maximum 64 characters, maximum 128 tags per element\r\n\r\n`@script_name`: Script name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nscript or tag not found\r\n\r\n### Run script\r\n\r\n#### URL\r\n\r\n`/script/@script_name/run`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@script_name`: Script name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\nScript not found\r\n\r\n## Schedulers management\r\n\r\n### Get all schedulers\r\n\r\n#### URL\r\n\r\n`/scheduler/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of scripts\r\n\r\n    {\r\n        \"name\":string, 64 characters max\r\n        \"description\":string, 128 characters max\r\n        \"enabled\":boolean\r\n        \"repeat\":integer, values possible are -1: None, 0: minute, 1: hours, 2: days, 3: day of week, 4: month, 5: year\r\n        \"repeat_value\":positive integer\r\n        \"next_time\":integer, next launch in UNIX EPOCH format\r\n        \"remove_after\":boolean, if true, this scheduler will be autmatically removed when done\r\n        \"conditions\":[ Array of conditions objects\r\n\t\t\t{\r\n\t\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains'\r\n\t\t\t\t\"value\":string|integer|boolean\r\n\t\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\t\"element\": string, element name, required\r\n\t\t\t\t\"parameters\":{\r\n\t\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t},\r\n\t\t\t}\r\n        ],\r\n        \"scripts\":[ Array of scripts to run\r\n            {\r\n                \"name\":script name\r\n                \"enabled\":boolean\r\n            }\r\n        ],\r\n\t\t\"options\":{ optional\r\n\t\t\t\"tags\":[\r\n\t\t\t\tstring, maximum 64 characters\r\n\t\t\t] Maximum 128 tags\r\n\t\t},\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get scheduler by its name\r\n\r\n#### URL\r\n\r\n`/scheduler/@scheduler_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n#### Success response\r\n\r\nCode 200\r\nContent\r\n```javascript\r\n{\r\n\t\"name\":string, 64 characters max\r\n\t\"description\":string, 128 characters max\r\n\t\"enabled\":boolean\r\n\t\"repeat\":integer, values possible are -1: None, 0: minute, 1: hours, 2: days, 3: day of week, 4: month, 5: year\r\n\t\"repeat_value\":positive integer\r\n\t\"next_time\":integer, next launch in UNIX EPOCH format\r\n\t\"remove_after\":boolean, if true, this scheduler will be autmatically removed when done\r\n\t\"conditions\":[ Array of conditions objects\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains'\r\n\t\t\t\"value\":string|integer|boolean\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run\r\n\t\t{\r\n\t\t\t\"name\":script name\r\n\t\t\t\"enabled\":boolean\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler not found\r\n\r\n### Enable or disable a scheduler\r\n\r\n#### URL\r\n`/scheduler/@scheduler_name/enable/@enabled`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n`@enabled`: 1 (true) or 0 (false)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler not found\r\n\r\n### Add a new scheduler\r\n\r\n#### URL\r\n\r\n`/scheduler/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\":string, 64 characters max, required\r\n\t\"description\":string, 128 characters max\r\n\t\"enabled\":boolean, required\r\n\t\"repeat\":integer, values possible are -1: None, 0: minute, 1: hours, 2: days, 3: day of week, 4: month, 5: year, required\r\n\t\"repeat_value\":positive integer, required\r\n\t\"remove_after\":boolean, if true, this scheduler will be autmatically removed when done\r\n\t\"conditions\":[ Array of conditions objects, conditions are optional\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains', required\r\n\t\t\t\"value\":string|integer|boolean, required\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run, at least one scrit is required\r\n\t\t{\r\n\t\t\t\"name\":script name, required\r\n\t\t\t\"enabled\":boolean, required\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing scheduler\r\n\r\n#### URL\r\n\r\n`/scheduler/@scheduler_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"description\":string, 128 characters max\r\n\t\"enabled\":boolean, required\r\n\t\"repeat\":integer, values possible are -1: None, 0: minute, 1: hours, 2: days, 3: day of week, 4: month, 5: year, required\r\n\t\"repeat_value\":positive integer, required\r\n\t\"remove_after\":boolean, if true, this scheduler will be autmatically removed when done\r\n\t\"conditions\":[ Array of conditions objects, conditions are optional\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains', required\r\n\t\t\t\"value\":string|integer|boolean, required\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run, at least one scrit is required\r\n\t\t{\r\n\t\t\t\"name\":script name, required\r\n\t\t\t\"enabled\":boolean, required\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler not found\r\n\r\n### Remove a scheduler\r\n\r\n#### URL\r\n\r\n`/scheduler/@scheduler_name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler not found\r\n\r\n### Add a new tag to a scheduler\r\n\r\n#### URL\r\n\r\n`/scheduler/@scheduler_name/@tag`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n`@tag`: Tag value, maximum 64 characters, maximum 128 tags per scheduler\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler not found\r\n\r\n### Remove a tag from a scheduler\r\n\r\n#### URL\r\n\r\n`/scheduler/@scheduler_name/@tag`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@scheduler_name`: Scheduler name\r\n\r\n`@tag`: Tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nScheduler or tag not found\r\n\r\n## Triggers management\r\n\r\n### Send an external message\r\n\r\nThis endpoint does not require a valid authentication token in the headers or in the cookies.\r\n\r\nIt's used to send an external message in Angharad. If a trigger matches this message, its scripts will be run.\r\n\r\n#### URL\r\n\r\n`/alert/@submodule_name/@source/@element/@message/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@submodule_name`: string, submodule name of the sender (benoic or carleon)\r\n\r\n`@source`: string, source of the sender\r\n\r\n`@element`: string, sender element\r\n\r\n`@message`: string, message sent\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get all triggers\r\n\r\n#### URL\r\n\r\n`/trigger/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of trigger objects\r\n\r\n    {\r\n        \"name\":string, max 64 characters\r\n        \"description\":string, max 128 characters\r\n        \"enabled\":boolean\r\n        \"submodule\":string, submodule name available (ex, benoic or carleon)\r\n        \"source\":string, source of the trigger (ex device for a benoic element), max 64 characters\r\n        \"element\":string, element of the trigger (ex element name for a benoic element), max 64 characters\r\n        \"message\":string, message value to match\r\n        \"message_match\":integer, message match type, values are 0 none, 1 equal, 2 different, 3 contains, 4 not contains, 5 empty, 6 not empty\r\n\t\t\"conditions\":[ Array of conditions objects\r\n\t\t\t{\r\n\t\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains'\r\n\t\t\t\t\"value\":string|integer|boolean\r\n\t\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\t\"element\": string, element name, required\r\n\t\t\t\t\"parameters\":{\r\n\t\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t],\r\n        \"scripts\":[ Array of scripts to run\r\n            {\r\n                \"name\":string, script name\r\n                \"enabled\":boolean\r\n            }\r\n        ],\r\n\t\t\"options\":{ optional\r\n\t\t\t\"tags\":[\r\n\t\t\t\tstring, maximum 64 characters\r\n\t\t\t] Maximum 128 tags\r\n\t\t},\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a trigger by its name\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: trigger name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"name\":string, max 64 characters\r\n\t\"description\":string, max 128 characters\r\n\t\"enabled\":boolean\r\n\t\"submodule\":string, submodule name available (ex, benoic or carleon)\r\n\t\"source\":string, source of the trigger (ex device for a benoic element), max 64 characters\r\n\t\"element\":string, element of the trigger (ex element name for a benoic element), max 64 characters\r\n\t\"message\":string, message value to match\r\n\t\"message_match\":integer, message match type, values are 0 none, 1 equal, 2 different, 3 contains, 4 not contains, 5 empty, 6 not empty\r\n\t\"conditions\":[ Array of conditions objects\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains'\r\n\t\t\t\"value\":string|integer|boolean\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run\r\n\t\t{\r\n\t\t\t\"name\":string, script name\r\n\t\t\t\"enabled\":boolean\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nCode 404\r\n\r\ntrigger not found\r\n\r\n### Enable or disable a trigger\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name/enable/@enabled`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: trigger name\r\n\r\n`@enabled`: 0 (disabled) or 1 (enabled)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nOR\r\n\r\nCode 404\r\n\r\ntrigger not found\r\n\r\n### Add a new trigger\r\n\r\n#### URL\r\n\r\n`/trigger/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\":string, max 64 characters, required\r\n\t\"description\":string, max 128 characters\r\n\t\"enabled\":boolean, required\r\n\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\"source\":string, source of the trigger (ex device for a benoic element), max 64 characters, required\r\n\t\"element\":string, element of the trigger (ex element name for a benoic element), max 64 characters, required\r\n\t\"message\":string, message value to match, required (can be empty)\r\n\t\"message_match\":integer, message match type, values are 0 none, 1 equal, 2 different, 3 contains, 4 not contains, 5 empty, 6 not empty, required\r\n\t\"conditions\":[ Array of conditions objects, conditions are optional\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains', required\r\n\t\t\t\"value\":string|integer|boolean, required\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run, at least one script is required\r\n\t\t{\r\n\t\t\t\"name\":string, script name, required\r\n\t\t\t\"enabled\":boolean, required\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing trigger\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: trigger name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"description\":string, max 128 characters\r\n\t\"enabled\":boolean, required\r\n\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\"source\":string, source of the trigger (ex device for a benoic element), max 64 characters, required\r\n\t\"element\":string, element of the trigger (ex element name for a benoic element), max 64 characters, required\r\n\t\"message\":string, message value to match, required (can be empty)\r\n\t\"message_match\":integer, message match type, values are 0 none, 1 equal, 2 different, 3 contains, 4 not contains, 5 empty, 6 not empty, required\r\n\t\"conditions\":[ Array of conditions objects, conditions are optional\r\n\t\t{\r\n\t\t\t\"condition\":string, values can be '==', '!=', '<', '<=', '>', '>=', 'contains' and 'not contains', required\r\n\t\t\t\"value\":string|integer|boolean, required\r\n\t\t\t\"submodule\":string, submodule name available (ex, benoic or carleon), required\r\n\t\t\t\"element\": string, element name, required\r\n\t\t\t\"parameters\":{\r\n\t\t\t\t\"device\":string, device name, required if submodule is benoic\r\n\t\t\t\t\"element_type\":string, element type, required if submodule is benoic\r\n\t\t\t},\r\n\t\t}\r\n\t],\r\n\t\"scripts\":[ Array of scripts to run, at least one script is required\r\n\t\t{\r\n\t\t\t\"name\":string, script name, required\r\n\t\t\t\"enabled\":boolean, required\r\n\t\t}\r\n\t],\r\n\t\"options\":{ optional\r\n\t\t\"tags\":[\r\n\t\t\tstring, maximum 64 characters\r\n\t\t] Maximum 128 tags\r\n\t},\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\ntrigger not found\r\n\r\n### Remove an existing trigger\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: trigger name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nTrigger not found\r\n\r\n### Add a new tag to a trigger\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name/@tag`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: Trigger name\r\n\r\n`@tag`: Tag value, maximum 64 characters, maximum 128 tags per scheduler\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nTrigger not found\r\n\r\n### Remove a tag from a trigger\r\n\r\n#### URL\r\n\r\n`/trigger/@trigger_name/@tag`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@trigger_name`: Trigger name\r\n\r\n`@tag`: Tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nTrigger or tag not found\r\n\r\n### Profiles management\r\n\r\n### Get all profiles data\r\n\r\n#### URL\r\n\r\n`/profile`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[\r\n\tany json value as profile data\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a profile by its name\r\n\r\n#### URL\r\n\r\n`/profile/@profile_id`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@profile_id`: id (name) of the profile\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\nany json value as profile data\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nprofile not found\r\n\r\n### Update all values of a profile\r\n\r\n#### URL\r\n\r\n`/profile/@profile_id`\r\n\r\n#### Method\r\n\r\n`method`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@profile_id`: id (name) of the profile\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\nany json value as profile data\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nprofile not found\r\n\r\n### Delete a profile by its name\r\n\r\n#### URL\r\n\r\n`/profile/@profile_id`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@profile_id`: id (name) of the profile\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nprofile not found\r\n\r\n## Authentication management\r\n\r\n### Check authentication token\r\n\r\n#### URL\r\n\r\n`/auth`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"token\":string, the token value\r\n\t\"validity\":integer, date of end of validity for the current token in UNIX EPOCH format\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\n### Check user credentials to receive a valid authentication token\r\n\r\nThis endpoint does not require a valid authentication token in the headers or the cookies\r\n\r\nIf the validity sent does not match one in the list below, it will be rounded to the previous value in the list.\r\n\r\n#### URL\r\n\r\n`/auth`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"user\": string, required\r\n\t\"password\": string, required\r\n\t\"validity\": integer, end of validity in seconds for the sent token, possible values are 0: none (end of session), 3600: 1 hour, 43200: 12 hours, 86400: 1 day, 604800: 1 week, above 1 week: 10 years\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"token\":string, the token value\r\n\t\"validity\":integer, date of end of validity for the current token in UNIX EPOCH format\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\n### Revoke current token\r\n\r\n#### URL\r\n\r\n`/auth`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nOR\r\n\r\nCode 404\r\n\r\n## Users management\r\n\r\nThese endpoints manage database users only, and only if database users authentication is enabled, otherwise all those endpoints will return an error 404.\r\n\r\n### Get all users\r\n\r\n#### URL\r\n\r\n`/user/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ array of users object\r\n\t{\r\n\t\t\"login\": string\r\n\t\t\"enabled\", boolean\r\n\t}\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a database user by it login\r\n\r\n#### URL\r\n\r\n`/user/@user_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@user_name`: string, login of the user to look for\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"login\": string\r\n\t\"enabled\", boolean\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nUser not found\r\n\r\n### Add a new database user\r\n\r\n#### URL\r\n`/user/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"login\": string, must be a new login, max 128 characters, required\r\n\t\"password\": string, password to use, max 128 characters, required\r\n\t\"enabled\", boolean, required\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing database user\r\n\r\n#### URL\r\n\r\n`/user/@user_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@user_name`: string, login of the user\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"password\": string, password to use, max 128 characters, optional\r\n\t\"enabled\", boolean, required\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\ndatabase user not found\r\n\r\n### Delete an existing database user\r\n\r\n#### URL\r\n\r\n`/user/@user_name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@user_name`: string, login of the user\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\ndatabase user not found\r\n\r\n## Tokens management\r\n\r\n### Get a list of tokens\r\n\r\n#### URL\r\n\r\n`/token/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Optional**\r\n\r\n`login`: string, tokens assigned to the specified login\r\n\r\n`enabled`: string (\"true\"|\"false\"), look for enabled or revoked tokens\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[\r\n\t{\r\n\r\n\t\t\"token\":string, token value\r\n\t\t\"login\":string, login value assigned to the token\r\n\t\t\"enabled\":boolean, token valid or revoked\r\n\t\t\"last_seen\":string, date of last seen token in ISO 8601 format\r\n\t\t\"validity\":string, date of end of validity of the token in ISO 8601 format\r\n\r\n\t}\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\n### Revoke a token\r\n\r\n#### URL\r\n\r\n`/token/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\r\n    \"token\":string, token value\r\n\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nToken not found\r\n\r\n## Static files\r\n\r\nStatic files are used to host a static website within Angharad\r\n\r\n### Get a static file\r\n\r\n#### URL\r\n\r\n`/static_file_prefix/@static_file_path`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@static_file_path`: string, static file path\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\nraw file content and its content-type in the headers.\r\n\r\nCurrently, the supported content-types are:\r\n\r\n```\r\n\".html\": \"text/html\"\r\n\".css\": \"text/css\"\r\n\".js\": \"application/javascript\"\r\n\".png\": \"image/png\"\r\n\".jpeg\": \"image/jpeg\"\r\n\".jpg\": \"image/jpeg\"\r\n\".ttf\": \"font/ttf\"\r\n\".woff\": \"font/woff\"\r\n\".woff2\": \"font/woff2\"\r\n\".json\": \"application/json\"\r\n\".map\": \"application/octet-stream\"\r\n\"*\": \"application/octet-stream\"\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nfile not found\r\n\r\n## Options\r\n\r\nThis endpoint is used to send OPTIONS parameters for all endpoints\r\n\r\n### Send OPTIONS parameters\r\n\r\n#### URL\r\n`*`\r\n\r\n#### Method\r\n\r\n`OPTIONS`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\nHeaders contain all options\r\n# Benoic API Documentation\r\n\r\nBenoic has several endpoints with their own format. Here is the full documentaition of the REST API.\r\n\r\nAll the return data are in JSON format.\r\n\r\nAll URL have the prefix called `BENOIC_PREFIX`, default is `/benoic`. All the URLs given in this dcumentation are relative to `BENOIC_PREFIX`.\r\n\r\n## Authentication\r\n\r\nIf used within Angharad application, and except when mentionned otherwise, all endpoints require a valid authentication token located in the header or in the cookies. The header or cookies key must be called `\"ANGHARAD_SESSION_ID\"` and the value must be a valid token value returned b a previous successfull login.\r\n\r\n## Devices management\r\n\r\n### Get all device types\r\n\r\nGet all the different device types available\r\n\r\n#### URL\r\n\r\n`/deviceTypes/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of device types\r\n    {\r\n\r\n        \"uid\": string, uid of the type, max 64 chars\r\n        \"name\":string, name of the type, max 64 chars\r\n        \"description\":string, descrition of the type, max 512 chars\r\n        \"enabled\":boolean\r\n        \"options\":[ // Array of options avaiable to ad a new device of this type\r\n            {\r\n                \"name\":string, name of the option\r\n                \"type\":string, values can be \"string\", \"integer\", \"float\" or \"boolean\"\r\n                \"description\":string, description of the option\r\n                \"optional\":boolean\r\n            }\r\n        ],\r\n\r\n    }\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get all devices\r\n\r\n#### URL\r\n\r\n`/device/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ array of device objects\r\n\r\n    {\r\n        \"name\":string, name of the device, max 64 chars\r\n        \"type_uid\":string, uid of the device type\r\n        \"description\":string, description for the device, max 512 chars\r\n        \"enabled\":boolean\r\n        \"connected\":boolean\r\n        \"last_seen\":string, date of last seen device connected, in ISO 8601 format\r\n        \"options\":{ object containing options for the current device\r\n        },\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a specific device by its name\r\n\r\n#### URL\r\n\r\n`/device/@device_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n    \"name\":string, name of the device, max 64 chars\r\n    \"type_uid\":string, uid of the device type\r\n    \"description\":string, description for the device, max 512 chars\r\n    \"enabled\":boolean\r\n    \"connected\":boolean\r\n    \"last_seen\":string, date of last seen device connected, in ISO 8601 format\r\n    \"options\":{ object containing options for the current device\r\n    },\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n### Add a new device\r\n\r\n#### URL\r\n\r\n`/device/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n    \"name\":string, name of the device, max 64 chars, name must not already exist\r\n    \"type_uid\":string, uid of the device type\r\n    \"description\":string, description for the device, max 512 chars\r\n    \"enabled\":boolean\r\n    \"connected\":boolean\r\n    \"options\":{ object containing options for the current device\r\n    },\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing device\r\n\r\n#### URL\r\n\r\n`/device/@device_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n    \"description\":string, description for the device, max 512 chars\r\n    \"enabled\":boolean\r\n    \"connected\":boolean\r\n    \"options\":{ object containing options for the current device\r\n    },\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n### Delete a device\r\n\r\n#### URL\r\n\r\n`/device/@device_name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n### Connect a device\r\n\r\n#### URL\r\n\r\n`/device/@device_name/connect`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n### Disconnect a device\r\n\r\n#### URL\r\n\r\n`/device/@device_name/disconnect`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n### Ping a device\r\n\r\n#### URL\r\n\r\n`/device/@device_name/ping`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 503\r\n\r\nDevice not responding to ping command\r\n\r\nOR\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nDevice disconnected or disabled\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n## Device elements overview\r\n\r\n### Overview Device\r\n\r\n#### URL\r\n\r\n`/device/@device_name/overview`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\r\n    \"sensors\":{ Object containing all sensors\r\n        \"sensor_name_1\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":boolean|string|number, sensor value\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n                \"unit\":string\r\n            },\r\n            \"enabled\":bolean\r\n        },\r\n        \"sensor_name_2\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":boolean\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n                \"unit\":string\r\n            },\r\n            \"enabled\":bolean\r\n        }\r\n    },\r\n    \"switches\":{ Object containing all switches\r\n        \"switch_name_1\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":integer, 0 (off) or 1 (on)\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n            },\r\n            \"enabled\":bolean\r\n        },\r\n        \"switch_name_2\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":integer, 0 (off) or 1 (on)\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n            },\r\n            \"enabled\":bolean\r\n        }\r\n    },\r\n    \"dimmers\":{ Object containing all dimmers\r\n        \"dimmer_name_1\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":integer, between 0 (off) and 100 (max)\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n            },\r\n            \"enabled\":bolean\r\n        },\r\n        \"dimmer_name_2\":{ string, internal name\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"value\":integer, between 0 (off) and 100 (max)\r\n            \"monitored\":boolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"options\":{ options object\r\n            },\r\n            \"enabled\":bolean\r\n        }\r\n    },\r\n    \"heaters\":{ Object containing all heaters\r\n        \"heater_name_1\":{\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"options\":{ options object\r\n                \"unit\":string\r\n            },\r\n            \"enabled\":bolean\r\n            \"monitored\":bolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"value\":{ value object for a heater\r\n                \"mode\":string, current mode\r\n                \"command\":number, temperature command\r\n                \"on\":boolean, indicates if the heat is on or off\r\n                \"availableModes\":[ array of strings to get all modes available\r\n                ]\r\n            }\r\n        },\r\n        \"heater_name_2\":{\r\n            \"display\":string, element display name, max 128 chars\r\n            \"description\":string, element description, max 128 chars\r\n            \"options\":{ options object\r\n                \"unit\":string\r\n            },\r\n            \"enabled\":bolean\r\n            \"monitored\":bolean\r\n            \"monitored_every\":integer, monitor frequency in seconds\r\n            \"value\":{ value object for a heater\r\n                \"mode\":string, current mode\r\n                \"command\":number, temperature command\r\n                \"on\":boolean, indicates if the heat is on or off\r\n                \"availableModes\":[ array of strings to get all modes available\r\n                ]\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice not found\r\n\r\n## Elements management\r\n\r\n\"GET\", url_prefix, \"/device/@device_name/@element_type/@element_name\"\r\n\r\n### Get a specific element data\r\n\r\n#### URL\r\n\r\n`/device/@device_name/@element_type/@element_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nDepending on your element type, the content will vary\r\n\r\nContent\r\n```javascript\r\nsensor value:\r\n{\r\n    \"display\":string, element display name, max 128 chars\r\n    \"description\":string, element description, max 128 chars\r\n    \"value\":boolean|string|number, sensor value\r\n    \"monitored\":boolean\r\n    \"monitored_every\":integer, monitor frequency in seconds\r\n    \"options\":{ options object\r\n        \"unit\":string\r\n    },\r\n    \"enabled\":bolean\r\n}\r\n\r\nswitch value:\r\n{\r\n    \"display\":string, element display name, max 128 chars\r\n    \"description\":string, element description, max 128 chars\r\n    \"value\":integer, 0 (off) or 1 (on)\r\n    \"monitored\":boolean\r\n    \"monitored_every\":integer, monitor frequency in seconds\r\n    \"options\":{ options object\r\n    },\r\n    \"enabled\":bolean\r\n}\r\n\r\ndimmer value:\r\n{\r\n    \"display\":string, element display name, max 128 chars\r\n    \"description\":string, element description, max 128 chars\r\n    \"value\":integer, between 0 (off) and 100 (max)\r\n    \"monitored\":boolean\r\n    \"monitored_every\":integer, monitor frequency in seconds\r\n    \"options\":{ options object\r\n    },\r\n    \"enabled\":bolean\r\n}\r\n\r\nheater value:\r\n{\r\n    \"display\":string, element display name, max 128 chars\r\n    \"description\":string, element description, max 128 chars\r\n    \"options\":{ options object\r\n        \"unit\":string\r\n    },\r\n    \"enabled\":bolean\r\n    \"monitored\":bolean\r\n    \"monitored_every\":integer, monitor frequency in seconds\r\n    \"value\":{ value object for a heater\r\n        \"mode\":string, current mode\r\n        \"command\":number, temperature command\r\n        \"on\":boolean, indicates if the heat is on or off\r\n        \"availableModes\":[ array of strings to get all modes available\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nElement type incorrect\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n\r\n### Send a command to an element\r\n\r\n#### URL\r\n\r\n`/device/@device_name/@element_type/@element_name/@command`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n`@command`: number, command value\r\n\r\n**Optional**\r\n\r\n`@mode`: string, heater mode (heater only)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n\r\n### Update an element data\r\n\r\n#### URL\r\n\r\n`/device/@device_name/@element_type/@element_name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n    \"display\": string, max 128 chars\r\n    \"description\": string, max 128 chars\r\n    \"enabled\": boolean\r\n    \"options\": object containing options values, example unit value for sensors\r\n    \"monitored\":bolean\r\n    \"monitored_every\":integer, monitor frequency in seconds\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n\r\n### Add a tag to an element\r\n\r\n#### URL\r\n\r\n`/device/@device_name/@element_type/@element_name/@tag`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n`@tag`: string, tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n\r\n### Delete a tag from an element\r\n\r\n#### URL\r\n\r\n`/device/@device_name/@element_type/@element_name/@tag`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n`@tag`: string, tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n\r\n### Get an element's monitored values\r\n\r\n#### URL\r\n\r\n`/monitor/@device_name/@element_type/@element_name/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@device_name`: device name\r\n\r\n`@element_type`: string, element type, values are \"switch\", \"dimmer\", \"sensor\" or \"heater\"\r\n\r\n`@element_name`: element name\r\n\r\n**Optional**\r\n\r\n`from`: Start date for the monitoring, in UNX EPOCH format\r\n\r\n`to`: End date for the monitoring, in UNX EPOCH format\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of monitor objects\r\n\r\n    {\r\n        \"timestamp\":integer, date for the monitoring, in UNX EPOCH format\r\n        \"value\":string, value for the monitoring\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nDevice or element not found\r\n# Carleon API Documentation\r\n\r\nCarleon has several endpoints with their own format. Here is the full documentaition of the REST API.\r\n\r\nAll the return data are in JSON format.\r\n\r\nAll URL have the prefix called `CARLEON_PREFIX`, default is `/carleon`. All the URLs given in this dcumentation are relative to `CARLEON_PREFIX`.\r\n\r\nThis is only carleon API, each carleon services can add their own endpoints, their documentation can be found in [carleon service modules](service-modules/README.md)\r\n\r\n## Authentication\r\n\r\nIf used within Angharad application, and except when mentionned otherwise, all endpoints require a valid authentication token located in the header or in the cookies. The header or cookies key must be called `\"ANGHARAD_SESSION_ID\"` and the value must be a valid token value returned b a previous successfull login.\r\n\r\n### Get all services available, their description, their elements and their commands\r\n\r\n#### URL\r\n\r\n`/service/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[\r\n\r\n    {\r\n        \"name\":string, name of the service, max 64 chars\r\n        \"description\":string, description of the service, max 64 chars\r\n        \"enabled\":boolean\r\n        \"commands\":{ object containing all commands\r\n            \"exec1\":{ command name\r\n                \"parameters\":{ input parameters\r\n                    \"param1\":{ parameter name\r\n                        \"type\":string, values can be \"string\", \"integer\", \"real\" or \"boolean\"\r\n                        \"required\":boolean\r\n                    },\r\n                    \"param2\":{ another parameter name\r\n                        \"type\":string, values can be \"string\", \"integer\", \"real\" or \"boolean\"\r\n                        \"required\":boolean\r\n                    },\r\n                    \"param3\":{\r\n                        \"type\":\"real\"\r\n                    }\r\n                },\r\n                \"result\":{ Result object, this command has 2 values in its result\r\n                    \"value1\":{ result name\r\n                        \"type\":string, values can be \"string\", \"integer\", \"real\" or \"boolean\"\r\n                    },\r\n                    \"value2\":{ another result name\r\n                        \"type\":string, values can be \"string\", \"integer\", \"real\" or \"boolean\"\r\n                    }\r\n                }\r\n            },\r\n            \"exec2\":{ another command name\r\n                \"result\":{ result object, this command has 1 value in its result\r\n                    \"type\":string, values can be \"string\", \"integer\", \"real\" or \"boolean\"\r\n                }\r\n            },\r\n        },\r\n        \"element\":[ Elements list of all the service elements\r\n            {\r\n                \"name\":string, element name, max 64 chars\r\n                \"description\":string, element description, max 64 chars\r\n                \"tags\":[ Array of tags, each tag is astring, max 64 chars, max 128 tags per element\r\n                ]\r\n            }\r\n        ]\r\n    },\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Enable or disable a service\r\n\r\n#### URL\r\n\r\n`/service/@service_name/enable/@enable_value`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@service_name`: service name\r\n\r\n`@enable_value`: 0 (disable) or 1 (enable)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService not found\r\n\r\n### Add a tag to a service element\r\n\r\n#### URL\r\n\r\n`/service/@service_name/@element_id/@tag`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@service_name`: service name\r\n\r\n`@element_id`: element name\r\n\r\n`@tag`: string, tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService or element not found\r\n\r\n### Remove a tag from a service element\r\n\r\n#### URL\r\n\r\n`/service/@service_name/@element_id/@tag`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@service_name`: service name\r\n\r\n`@element_id`: element name\r\n\r\n`@tag`: string, tag value\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService or element or tag not found\r\n\r\n### Clean all data of a service element\r\n\r\n#### URL\r\n\r\n`/service/@service_name/@element_id/cleanup`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@service_name`: service name\r\n\r\n`@element_id`: element name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService or element not found\r\n# Mock service API\r\n\r\nThis service does nothing for real, but behaves as a real carleon service. It's designed to help create a client program and create other services.\r\n\r\nThis service use carleon prefix as prefix. All endpoints described here assume to have carleon prefix before the url.\r\n\r\n### Get all mock service elements\r\n\r\n#### URL\r\n\r\n`/mock-service/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ array of moc-service elements\r\n\r\n    {\r\n        \"name\": string, name of the element\r\n        \"description\": string, description of the element\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a moc-service element by its name\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@element_id`: element name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element\r\n\t\"description\": string, description of the element\r\n}\r\n\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Add a new mock-service element\r\n\r\n#### URL\r\n\r\n`/mock-service/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars\r\n\t\"description\": string, description of the element, max 128 chars\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing mock-service element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@element_id`: element name\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"description\": string, description of the element, max 128 chars\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Delete an existing mock-service element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@element_id`: element name\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Execute a mock-service command exec1 on an element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id/command/exec1/@param1/@param2/@param3`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@element_id`: element name\r\n\r\n`@param1`: string\r\n\r\n`@param2`: integer\r\n\r\n`@param3`: real\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"value1\": string\r\n\t\"value2\": integer\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Execute a mock-service command exec2 on an element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id/command/exec2/@param1`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@element_id`: element name\r\n\r\n`@param1`: string\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"value\": string\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Execute a mock-service command exec3 on an element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id/command/exec3`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"value\": string\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Execute a mock-service command exec4 on an element\r\n\r\n#### URL\r\n\r\n`/mock-service/@element_id/command/exec4`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"value1\": integer\r\n\t\"value2\": boolean\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n# MPD service API\r\n\r\nMPD service is used to get status and send commands to a MPD instance\r\n\r\nThis service use carleon prefix as prefix. All endpoints described here assume to have carleon prefix before the url.\r\n\r\n## Service MPD elements management\r\n\r\n### Get all service-mpd elements\r\n\r\n#### URL\r\n\r\n`/service-mpd/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of service-mpd elements\r\n\r\n    {\r\n        \"name\": string, name of the element, max 64 chars\r\n        \"description\": string, description of the element, max 128 chars\r\n        \"host\": string, host where the mpd instance is hosted, max 128 chars\r\n        \"port\": integer, port where mpd instance is hosted, if 0 then default\r\n    }\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a service-mpd element by its name\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars\r\n\t\"description\": string, description of the element, max 128 chars\r\n\t\"host\": string, host where the mpd instance is hosted, max 128 chars\r\n\t\"port\": integer, port where mpd instance is hosted, if 0 then default\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nservice-mpd not found\r\n\r\n### Add a new service-mpd element\r\n\r\n#### URL\r\n\r\n`/service-mpd/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars, required\r\n\t\"description\": string, description of the element, max 128 chars, optional\r\n\t\"host\": string, host where the mpd instance is hosted, max 128 chars, required\r\n\t\"port\": integer, port where mpd instance is hosted, if 0 then default mpd port, optional\r\n\t\"password\": string, password to connect to the mpd instance, max 128 chars, optional\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing service-mpd element\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars, required\r\n\t\"description\": string, description of the element, max 128 chars, optional\r\n\t\"host\": string, host where the mpd instance is hosted, max 128 chars, required\r\n\t\"port\": integer, port where mpd instance is hosted, if 0 then default mpd port, optional\r\n\t\"password\": string, password to connect to the mpd instance, max 128 chars, optional\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Delete an existing service-mpd element\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Get status and current song details of a service-mpd element\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name/status`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`, name of the element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\r\n    \"state\":string, state of the player, values can be \"stop\", \"play\", \"pause\", \"unknown\"\r\n    \"volume\":integer, volume of the player, between 0 and 100\r\n    \"elapsed_time\":integer, elapsed time of the current song in seconds\r\n    \"total_time\":integer, total time of the current song in seconds\r\n    \"name\":string, Name of the playlist, optional\r\n    \"title\":string, title of current song\r\n    \"artist\":string, artist of current song, optional\r\n    \"album\":string, album of current song, optional\r\n    \"date\":string, year of current song, optional\r\n    \"track\":string, track of current song, optional\r\n\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Send a playback command\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name/action/@action_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n`@action_name`, string, name of the action to launch, values can be \"stop\", \"play\", \"pause\"\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Get playlists available\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name/playlists`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of strings\r\n\r\n    \"playlist_1\",\r\n    \"playlist_2\",\r\n    \"playlist_3\",\r\n    ...\r\n\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Load and play a playlist\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name/playlists/@playlist_name/load`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n`@playlist_name`: string, name of the playlist\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement or playlist not found\r\n\r\n### Change the volume\r\n\r\n#### URL\r\n\r\n`/service-mpd/@name/volume/@value`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: string, name of the element\r\n\r\n`@value`: integer, volume to set, value must be between 0 (off) and 100 (max)\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n# Motion service API\r\n\r\nMotion service is used to display motion pictures taken or real-time streams.\r\n\r\nThis service use carleon prefix as prefix. All endpoints described here assume to have carleon prefix before the url.\r\n\r\n## Motion-service elements management\r\n\r\n### Get all motion-service elements\r\n\r\n#### URL\r\n\r\n`/service-motion/`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n[ Array of service-motion elements\r\n    {\r\n        \"name\": string, name of the element, max 64 chars\r\n        \"description\": string, description of the element, max 128 chars\r\n        \"config_uri\": string, uri of the motion instance configuration to check if it's still responding, max 512 chars\r\n        \"stream_list\": [ Array of streams\r\n            {\r\n                \"uri\": string, uri to access the stream directly from the client, max 512 chars\r\n                \"name\": string, name of the stream, max 64 chars\r\n                \"snapshot_uri\": string, uri to run a snapshot command on the stream, max 512 chars\r\n            }\r\n        ],\r\n        \"file_list\": [ Array of files lists of the pricures taken by this motion instance\r\n\t\t\t{\r\n\t\t\t\t\"name\": string, name of the file list, max 64 chars\r\n\t\t\t\t\"path\": string, full path of the pictures, max 512 chars\r\n\t\t\t\t\"thumbnail_path\": string, full path of the pictures thumbnails, max 512 chars, optional\r\n\t\t\t}\r\n\t\t]\r\n    }\r\n]\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\n### Get a service-motion element by its name\r\n\r\n#### URL\r\n\r\n`/service-motion/@name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the service-motion element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars\r\n\t\"description\": string, description of the element, max 128 chars\r\n\t\"config_uri\": string, uri of the motion instance configuration to check if it's still responding, max 512 chars\r\n\t\"stream_list\": [ Array of streams\r\n\t\t{\r\n\t\t\t\"uri\": string, uri to access the stream directly from the client, max 512 chars\r\n\t\t\t\"name\": string, name of the stream, max 64 chars\r\n\t\t\t\"snapshot_uri\": string, uri to run a snapshot command on the stream, max 512 chars\r\n\t\t}\r\n\t],\r\n\t\"file_list\": [ Array of files lists of the pricures taken by this motion instance\r\n\t\t{\r\n\t\t\t\"name\": string, name of the file list, max 64 chars\r\n\t\t\t\"path\": string, full path of the pictures, max 512 chars\r\n\t\t\t\"thumbnail_path\": string, full path of the pictures thumbnails, max 512 chars, optional\r\n\t\t}\r\n\t]\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nservice-motion element not found\r\n\r\n### Add a new service-motion element\r\n\r\n#### URL\r\n\r\n`/service-motion/`\r\n\r\n#### Method\r\n\r\n`POST`\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"name\": string, name of the element, max 64 chars, required\r\n\t\"description\": string, description of the element, max 128 chars, optional\r\n\t\"config_uri\": string, uri of the motion instance configuration to check if it's still responding, max 512 chars, required\r\n\t\"stream_list\": [ Array of streams, optional\r\n\t\t{\r\n\t\t\t\"uri\": string, uri to access the stream directly from the client, max 512 chars, required\r\n\t\t\t\"name\": string, name of the stream, max 64 chars, required\r\n\t\t\t\"snapshot_uri\": string, uri to run a snapshot command on the stream, max 512 chars, required\r\n\t\t}\r\n\t],\r\n\t\"file_list\": [ Array of files lists of the pricures taken by this motion instance, optional\r\n\t\t{\r\n\t\t\t\"name\": string, name of the file list, max 64 chars, required\r\n\t\t\t\"path\": string, full path of the pictures, max 512 chars, required\r\n\t\t\t\"thumbnail_path\": string, full path of the pictures thumbnails, max 512 chars, optional\r\n\t\t}\r\n\t]\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\n### Modify an existing service-motion element\r\n\r\n#### URL\r\n\r\n`/service-motion/@name`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the element\r\n\r\n#### Data Parameters\r\n\r\n```javascript\r\n{\r\n\t\"description\": string, description of the element, max 128 chars, optional\r\n\t\"config_uri\": string, uri of the motion instance configuration to check if it's still responding, max 512 chars, required\r\n\t\"stream_list\": [ Array of streams, optional\r\n\t\t{\r\n\t\t\t\"uri\": string, uri to access the stream directly from the client, max 512 chars, required\r\n\t\t\t\"name\": string, name of the stream, max 64 chars, required\r\n\t\t\t\"snapshot_uri\": string, uri to run a snapshot command on the stream, max 512 chars, required\r\n\t\t}\r\n\t],\r\n\t\"file_list\": [ Array of files lists of the pricures taken by this motion instance, optional\r\n\t\t{\r\n\t\t\t\"name\": string, name of the file list, max 64 chars, required\r\n\t\t\t\"path\": string, full path of the pictures, max 512 chars, required\r\n\t\t\t\"thumbnail_path\": string, full path of the pictures thumbnails, max 512 chars, optional\r\n\t\t}\r\n\t]\r\n}\r\n```\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService-motion element not found\r\n\r\n### Delete an existing service-motion element\r\n\r\n#### URL\r\n\r\n`/service-motion/@name`\r\n\r\n#### Method\r\n\r\n`DELETE`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the element\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nService-motion element not found\r\n\r\n## Service-motion element commads\r\n\r\n### Get current status of a service-motion element\r\n\r\n#### URL\r\n\r\n`/service-motion/@name/status`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the element\r\n\r\n**Optional**\r\n\r\n`offset`: offset to start file-list\r\n\r\n`limit`: limit of a file-list result number of files\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n```javascript\r\n{\r\n\r\n    \"online\":boolean, is the motion instance responding?\r\n    \"file_list\":{ Object containing lists of files\r\n        \"file_list_name_1\":[ Array of string, each element is a picture file available\r\n        ],\r\n        \"file_list_name_2\":[ Array of string, each element is a picture file available\r\n        ],\r\n    },\r\n    \"stream_list\":[ Array of stream objects\r\n        {\r\n            \"name\":string, name of the stream object\r\n            \"snapshot_uri\":string, uri to run a snapshot command on the stream, max 512 chars, required\r\n            \"uri\":uri to access the stream directly from the client, max 512 chars, required\r\n        }\r\n    ]\r\n\r\n}\r\n```\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 400\r\n\r\nError input parameters\r\n\r\nContent: json array containing all errors\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement not found\r\n\r\n### Get a file from a file list\r\n\r\n#### URL\r\n\r\n`/service-motion/@name/image/@file_list/@file_name`\r\n\r\n#### Method\r\n\r\n`GET`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the element\r\n\r\n`@file_list`: name of the file list\r\n\r\n`@file_name`: name of the file\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\nContent\r\n\r\nRaw content of the file\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement or file list or file not found\r\n\r\n### Send a snapshot command to a motion instance\r\n\r\n#### URL\r\n\r\n`/service-motion/@name/stream/@stream_name/snapshot`\r\n\r\n#### Method\r\n\r\n`PUT`\r\n\r\n#### URL Parameters\r\n\r\n**Required**\r\n\r\n`@name`: name of the element\r\n\r\n`@stream_name`: name of the stream\r\n\r\n#### Success response\r\n\r\nCode 200\r\n\r\n#### Error Response\r\n\r\nCode 500\r\n\r\nInternal Error\r\n\r\nOR\r\n\r\nCode 404\r\n\r\nElement or steam not found\r\n\r\n# Gareth API Documentation\r\n\r\nIn the documentation, we assume you use the prefix `/gareth`.\r\n\r\nFor all endpoints, return status can be 200 for success, 400 for invalid parameters, 404 for resource or page not found, or 500 for internal server error. On an error 400, the json body result explains the error.\r\n\r\n## Message management APIs\r\n\r\n### POST /gareth/message\r\n\r\nPost a new message.\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\nNone\r\n\r\n##### Body\r\n\r\n```javascrit\r\n{\r\n  \"priority\": string, values available: NONE, LOW, MEDIUM, HIGH, CRITICAL\r\n  \"source\": string, maximum 64 characters\r\n  \"text\": string, maximum 256 characters\r\n  \"tags\": array of strings, maximum 16 tags, and maximum 32 characters per tag\r\n}\r\n```\r\n\r\n##### Result body\r\n\r\nNone\r\n\r\n### GET /gareth/message/@filter_name\r\n\r\nGet a list of messages, filter result using a filter name, or message attributes criteria\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\n- @filter_name: string, name of an existing filter. If not set, all messages are displayed\r\n- date: integer, filter messages younger than date in seconds\r\n- source: string filter messages from source parameter\r\n- priority: string, filter messages that have the corresponding priority\r\n- text: string, filter messages that contain the filter value\r\n- tags: string, filter messages that contain the specified tag\r\n- limit: integer, specify the maximal number of message to display, limit can't be hogher than 100. If no specified, limit is set to 20 messages\r\n- offset: integer, specify the offset message to start the search\r\n\r\n##### Body\r\n\r\nNone\r\n\r\n##### Result Body\r\n\r\nAn array of messages. A message has the following format:\r\n\r\n```javascrit\r\n{\r\n  \"date\": string\r\n  \"priority\": string, values available: NONE, LOW, MEDIUM, HIGH, CRITICAL\r\n  \"source\": string\r\n  \"text\": string\r\n  \"tags\": array of strings\r\n}\r\n```\r\n\r\n### Message trigger\r\n\r\nIf a message correspond to a filter that has alerts (see below), this will trigger a message to be send.\r\n\r\nFor example, let's say you have this following smtp alert:\r\n\r\n```javascrit\r\n{\r\n  \"name\": \"smtp1\",\r\n  \"host\": \"localhost\",\r\n  \"port\": null,\r\n  \"tls\": null,\r\n  \"check_ca\": null,\r\n  \"user\": null,\r\n  \"password\": null,\r\n  \"from\": \"gareth@mail.tld\",\r\n  \"to\": \"user@mail.tld\",\r\n  \"cc\": \"archive@mail.tld\",\r\n  \"bcc\": null,\r\n  \"subject\": \"Alert message from {source}\",\r\n  \"body\": \"On {date}, {source} has sent the following alert: {message}\\n\\nPriority: {priority}\\nAdditional tags: {tags}\"\r\n}\r\n```\r\n\r\nThen, Gareth has received the following message:\r\n\r\n```javascrit\r\n{\r\n  \"priority\": \"HIGH\",\r\n  \"source\": \"Door Sensor\",\r\n  \"text\": \"The front door has been opened\",\r\n  \"tags\": [\"front\", \"door\"]\r\n}\r\n```\r\n\r\nThe triggered message will have the following form:\r\n\r\n```\r\nFrom: gareth@mail.tld\r\nTo: user@mail.tld\r\nCc: archive@mail.tld\r\nSubject: Alert message from Door Sensor\r\n\r\nOn 2016/01/14 18:21:12, Door Sensor has sent the following alert: The front door has been opened\r\n\r\nPriority: High\r\nAdditional tags: front, door\r\n```\r\n\r\n## Alerts management APIs\r\n\r\nAn alert is used joined with one or several filters, when a message is posted and matches a filter (e.g. a message with priority `CRITICAL` from the source `door sensor`), a message alert is triggered.\r\n\r\nAn alert can be either a smtp message (email) or http request (to call an sms api from your provider for example).\r\n\r\nAn smtp alert has the following format:\r\n\r\n```javascrit\r\n{\r\n  \"name\": name of the smtp alert, must be unique, string, max 64 characters, mandatory\r\n  \"host\": smtp hostname, string, max 128 characters, mandatory\r\n  \"port\": smtp port number, integer, between 0 and 65535, optional, if set to 0 or not set, default port number will be used (25 or 587, depending on tls set to true or not)\r\n  \"tls\": use TLS to connect, boolean, optional, default false\r\n  \"check_ca\": check the certificate authority of the smtp host if tls is activated, boolean, optional, default false\r\n  \"user\": username to connect to the smtp host, string, max 128 characters, optional\r\n  \"password\": password to connect to the smtp host, string, max 128 characters, optional\r\n  \"from\": email address of the sender, string, max 128 characters, mandatory\r\n  \"to\": email address of the recipient, string, max 128 characters, mandatory\r\n  \"cc\": email address of the recipient in cc, string, max 128 characters, optional\r\n  \"bcc\": email address of the recipient in bcc, string, max 128 characters, optional\r\n  \"subject\": subject of the email, string, max 128 characters, mandatory\r\n  \"body\": body of the email, string, max 512 characters, optional\r\n}\r\n```\r\n\r\n`subject` and `body` can contain some specific patterns:\r\n- {priority}: will be replaced by the priority of the message\r\n- {source}: will be replaced by the source of the message\r\n- {message}: will be replaced by the text of the message\r\n- {tags}: will be replaced by the list of tags of the message, separated by a comma\r\n- {date}: will be replaced by the date of the message, using the format format `YYYY/MM/DD hh:mm:ss`\r\n\r\nAn http alert has the following format:\r\n\r\n```javascrit\r\n{\r\n  \"name\": name of the http alert, must be unique, string, max 64 characters, mandatory\r\n  \"method\": http method (GET, POST, PUT, etc.), string, max 16 characters, optional (default GET)\r\n  \"url\": url to call, string, max 128 characters, mandatory\r\n  \"body\": body of the http call, max 512 characters, optional\r\n  \"http_headers\": [ Array of http headers to add to the alert, optional\r\n    {\r\n      \"key\": key of the http header, max 64 characters, mandatory\r\n      \"value\": value of the http header, max 128 characters, mandatory\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nThe attributes `url`, `body`, `key` or `value` can contain patterns as described above:\r\n- {priority}: will be replaced by the priority of the message\r\n- {source}: will be replaced by the source of the message\r\n- {message}: will be replaced by the text of the message\r\n- {tags}: will be replaced by the list of tags of the message, separated by a coma\r\n- {date}: will be replaced by the date of the message, using the format format `YYYY/MM/DD hh:mm:ss`\r\n\r\nIf specified in the url and the body, these patterns will be url encoded according to the [RFC 3986](https://tools.ietf.org/html/rfc3986).\r\n\r\n### GET /gareth/alert\r\n\r\nGet all alerts for all types (http and smtp)\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\nNone\r\n\r\n##### Body\r\n\r\nNone\r\n\r\n##### Result Body\r\n\r\nAn object with 2 attributes: an array of smtp alerts and an array of http alerts:\r\n\r\n```javascrit\r\n{\r\n  \"smtp\": [\r\n    {\r\n      \"name\": name of the smtp alert, string, max 64 characters\r\n      \"host\": smtp hostname, string, max 128 characters\r\n      \"port\": smtp port number, integer, between 0 and 65535, if set to 0, default port number will be used (25 or 587, depending on tls set to true or not)\r\n      \"tls\": use TLS to connect, boolean\r\n      \"check_ca\": check the certificate authority of the smtp host if tls is activated, boolean\r\n      \"user\": username to connect to the smtp host, string, max 128 characters or null\r\n      \"password\": password to connect to the smtp host, string, max 128 characters or null\r\n      \"from\": email address of the sender, string, max 128 characters\r\n      \"to\": email address of the recipient, string, max 128 characters\r\n      \"cc\": email address of the recipient in cc, string, max 128 characters\r\n      \"bcc\": email address of the recipient in bcc, string, max 128 characters\r\n      \"subject\": subject of the email, string, max 128 characters\r\n      \"body\": body of the email, string, max 512 characters\r\n    }\r\n  ],\r\n  \"http\": [\r\n    {\r\n      \"name\": name of the http alert, string, max 64 characters\r\n      \"method\": http method (GET, POST, PUT, etc.), string, max 16 characters\r\n      \"url\": url to call, string, max 128 characters\r\n      \"body\": body of the http call, max 512 characters\r\n      \"http_headers\": [\r\n        {\r\n          \"key\": key of the http header, max 64 characters\r\n          \"value\": value of the http header, max 128 characters\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### GET /gareth/alert/@type/@alert_name\r\n\r\nGet a apecific alert of the specified type and name\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\n- @type: smtp or http\r\n- @alert_name: name of the alert\r\n\r\n##### Body\r\n\r\nNone\r\n\r\n##### Result Body\r\n\r\nsmtp alert:\r\n\r\n```javascrit\r\n{\r\n  \"name\": name of the smtp alert, string, max 64 characters\r\n  \"host\": smtp hostname, string, max 128 characters\r\n  \"port\": smtp port number, integer, between 0 and 65535, if set to 0, default port number will be used (25 or 587, depending on tls set to true or not)\r\n  \"tls\": use TLS to connect, boolean\r\n  \"check_ca\": check the certificate authority of the smtp host if tls is activated, boolean\r\n  \"user\": username to connect to the smtp host, string, max 128 characters or null\r\n  \"password\": password to connect to the smtp host, string, max 128 characters or null\r\n  \"from\": email address of the sender, string, max 128 characters\r\n  \"to\": email address of the recipient, string, max 128 characters\r\n  \"cc\": email address of the recipient in cc, string, max 128 characters\r\n  \"bcc\": email address of the recipient in bcc, string, max 128 characters\r\n  \"subject\": subject of the email, string, max 128 characters\r\n  \"body\": body of the email, string, max 512 characters\r\n}\r\n```\r\n\r\nhttp alert:\r\n\r\n```javascrit\r\n{\r\n  \"name\": name of the http alert, string, max 64 characters\r\n  \"method\": http method (GET, POST, PUT, etc.), string, max 16 characters\r\n  \"url\": url to call, string, max 128 characters\r\n  \"body\": body of the http call, max 512 characters\r\n  \"http_headers\": [\r\n    {\r\n      \"key\": key of the http header, max 64 characters\r\n      \"value\": value of the http header, max 128 characters\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### POST /gareth/alert/@type/\r\n\r\nAdd a new alert of the specified type\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\n- @type: smtp or http\r\n\r\n##### Body\r\n\r\nsmtp alert:\r\n```javascrit\r\n{\r\n  \"name\": name of the smtp alert, must be unique, string, max 64 characters, mandatory\r\n  \"host\": smtp hostname, string, max 128 characters, mandatory\r\n  \"port\": smtp port number, integer, between 0 and 65535, optional, if set to 0 or not set, default port number will be used (25 or 587, depending on tls set to true or not)\r\n  \"tls\": use TLS to connect, boolean, optional, default false\r\n  \"check_ca\": check the certificate authority of the smtp host if tls is activated, boolean, optional, default false\r\n  \"user\": username to connect to the smtp host, string, max 128 characters, optional\r\n  \"password\": password to connect to the smtp host, string, max 128 characters, optional\r\n  \"from\": email address of the sender, string, max 128 characters, mandatory\r\n  \"to\": email address of the recipient, string, max 128 characters, mandatory\r\n  \"cc\": email address of the recipient in cc, string, max 128 characters, optional\r\n  \"bcc\": email address of the recipient in bcc, string, max 128 characters, optional\r\n  \"subject\": subject of the email, string, max 128 characters, mandatory\r\n  \"body\": body of the email, string, max 512 characters, optional\r\n}\r\n```\r\n\r\nhttp alert:\r\n```javascrit\r\n{\r\n  \"name\": name of the http alert, must be unique, string, max 64 characters, mandatory\r\n  \"method\": http method (GET, POST, PUT, etc.), string, max 16 characters, optional (default GET)\r\n  \"url\": url to call, string, max 128 characters, mandatory\r\n  \"body\": body of the http call, max 512 characters, optional\r\n  \"http_headers\": [ Array of http headers to add to the alert, optional\r\n    {\r\n      \"key\": key of the http header, max 64 characters, mandatory\r\n      \"value\": value of the http header, max 128 characters, mandatory\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n##### Result Body\r\n\r\nNone\r\n\r\n### PUT /gareth/alert/@type/@alert_name\r\n\r\nModify an existing alert of the specified type\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\n- @type: smtp or http\r\n- @alert_name: name of the alert\r\n\r\n##### Body\r\n\r\nsmtp alert:\r\n```javascrit\r\n{\r\n  \"host\": smtp hostname, string, max 128 characters, mandatory\r\n  \"port\": smtp port number, integer, between 0 and 65535, optional, if set to 0 or not set, default port number will be used (25 or 587, depending on tls set to true or not)\r\n  \"tls\": use TLS to connect, boolean, optional, default false\r\n  \"check_ca\": check the certificate authority of the smtp host if tls is activated, boolean, optional, default false\r\n  \"user\": username to connect to the smtp host, string, max 128 characters, optional\r\n  \"password\": password to connect to the smtp host, string, max 128 characters, optional\r\n  \"from\": email address of the sender, string, max 128 characters, mandatory\r\n  \"to\": email address of the recipient, string, max 128 characters, mandatory\r\n  \"cc\": email address of the recipient in cc, string, max 128 characters, optional\r\n  \"bcc\": email address of the recipient in bcc, string, max 128 characters, optional\r\n  \"subject\": subject of the email, string, max 128 characters, mandatory\r\n  \"body\": body of the email, string, max 512 characters, optional\r\n}\r\n```\r\n\r\nhttp alert:\r\n```javascrit\r\n{\r\n  \"method\": http method (GET, POST, PUT, etc.), string, max 16 characters, optional (default GET)\r\n  \"url\": url to call, string, max 128 characters, mandatory\r\n  \"body\": body of the http call, max 512 characters, optional\r\n  \"http_headers\": [ Array of http headers to add to the alert, optional\r\n    {\r\n      \"key\": key of the http header, max 64 characters, mandatory\r\n      \"value\": value of the http header, max 128 characters, mandatory\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n##### Result Body\r\n\r\nNone\r\n\r\n### DELETE /gareth/alert/@type/@alert_name\r\n\r\nDelete an existing alert of the specified type\r\n\r\n#### Parameters\r\n\r\n##### URL\r\n\r\n- @type: smtp or http\r\n- @alert_name: name of the alert\r\n\r\n##### Body\r\n\r\nNone\r\n\r\n##### Result Body\r\n\r\nNone\r\n\r\n## Filters management APIs\r\n\r\nFilters can be used for both filter a message list or trigger an smtp or http message when a message matches the filter.\r\n\r\nA filter has the following format:\r\n\r\n```javascrit\r\n  \"name\": name of the filter, string, max \r\n  \"description\": \"valid test\",\r\n  \"filter_clauses\": [\r\n    {\"element\": \"priority\", \"operator\": \">=\", \"value\": 2}\r\n  ],\r\n  \"filter_alerts\": {\"smtp\": [\"smtp1\"], \"http\": [\"http1\"]}\r\n```\r\n# Benoic modules\r\n\r\nBenoic implements an interface to control multiple types of house automation devices. To add a new device type, you have to create a library with the proper functions, then place the library in the folder specified by `modules_path` in your configuration file, then restart the program.\r\n\r\nThe mock module in the file `device-mock.c` can be used to create your own module.\r\n\r\n## Device module interace\r\n\r\nA device module is a library loaded with `dlopen/dlsync`. All mandatory functions will return a json object of type `json_t *`, except for `b_device_has_element` which returns a int.\r\n\r\nThe returned json object must have the following format:\r\n\r\n```json\r\n{\r\n  result: number,\r\n  other values\r\n}\r\n```\r\n\r\nThe `result` value is used to return a status code. The different status codes available are:\r\n\r\n```C\r\n#define WEBSERVICE_RESULT_ERROR     0\r\n#define WEBSERVICE_RESULT_OK        1\r\n#define WEBSERVICE_RESULT_NOT_FOUND 2\r\n#define WEBSERVICE_RESULT_TIMEOUT   3\r\n#define WEBSERVICE_RESULT_PARAM     4\r\n```\r\n\r\nThese functions are mandatory for a device module:\r\n\r\n```C\r\n/**\r\n *\r\n * Device type initialization\r\n * \r\n * Initialize the device type and return a json object of the following format:\r\n * {\r\n *   result: number, result value\r\n *   uid: string, a unique identifier for your device type\r\n *   name: string, the name of your device type\r\n *   description: string\r\n *   options: json array, contains the name and type of parameters used to instanciate a device\r\n * }\r\n *\r\n * The options array has the following format:\r\n * {\r\n *   name: string, // Name of the option\r\n *   type: \"string\"|\"numeric\"|\"boolean\", // Type of th option, must be one of those values\r\n *   description: string, // Description for the option\r\n *   optional: boolean // is the option optional or not?\r\n * }\r\n * \r\n */\r\njson_t * b_device_type_init ();\r\n\r\n/**\r\n * \r\n * Connects the device\r\n * \r\n * Connects a device and initialize its parameters and context\r\n * device parameter is a json object containing the following values:\r\n * {\r\n *   name: string\r\n *   options: array // options values according to the options format returned in the b_device_type_init function\r\n * }\r\n * device_ptr is a pointer you can use to store any other parameter, structure or value you want without having to rebuild it every time the device is called\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_connect (json_t * device, void ** device_ptr);\r\n\r\n/**\r\n * \r\n * Disconnects the device\r\n * \r\n * Disconnect the device and clean device_ptr\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_disconnect (json_t * device, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Pings the device\r\n * \r\n * Check if the device is still availble\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_ping (json_t * device, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Get all the elements and their values for the device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   sensors: {\r\n *     sensor_name_1: {\r\n *       unit: string,\r\n *       value: string|number\r\n *     },\r\n *     sensor_name_2: {\r\n *       unit: string,\r\n *       value: string|number\r\n *     }, etc\r\n *   }\r\n *   switches: {\r\n *     switch_name_1: number (0 or 1),\r\n *     switch_name_2: number (0 or 1),\r\n *     etc.\r\n *   }\r\n *   dimmers: {\r\n *     dimmer_name_1: number (between 0 and 100),\r\n *     dimmer_name_2: number (between 0 and 100),\r\n *     etc.\r\n *   }\r\n *   heaters: {\r\n *     heater_name_1: {\r\n *       mode: string,\r\n *       command: float,\r\n *       on: boolean,\r\n *       availableModes: Array of strings listing all the different modes available\r\n *     },\r\n *     heater_name_2: {\r\n *       mode: string,\r\n *       command: float,\r\n *       on: boolean,\r\n *       availableModes: Array of strings listing all the different modes available\r\n *     }\r\n *     etc.\r\n *   }\r\n * }\r\n * \r\n */\r\njson_t * b_device_overview (json_t * device, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Get the value of the specified sensor on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   value: string|number\r\n * }\r\n * \r\n */\r\njson_t * b_device_get_sensor (json_t * device, const char * sensor_name, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Get the value of the specified switch on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   value: number (0 or 1),\r\n * }\r\n * \r\n */\r\njson_t * b_device_get_switch (json_t * device, const char * switch_name, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Send the command on the specified switch on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_set_switch (json_t * device, const char * switch_name, const int command, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Get the value of the specified dimmer on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   value: number (between 0 and 100),\r\n * }\r\n * \r\n */\r\njson_t * b_device_get_dimmer (json_t * device, const char * dimmer_name, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Send the command on the specified dimmer on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_set_dimmer (json_t * device, const char * dimmer_name, const int command, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Get the value of the specified heater on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   mode: string,\r\n *   command: float,\r\n *   on: boolean,\r\n *   availableModes: Array of strings listing all the different modes available\r\n * }\r\n * \r\n */\r\njson_t * b_device_get_heater (json_t * device, const char * heater_name, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Send the command on the specified heater on the specified device\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * b_device_set_heater (json_t * device, const char * heater_name, const char * mode, const float command, void * device_ptr);\r\n\r\n/**\r\n * \r\n * Return true if the specified element exist on the specified device, false otherwise\r\n * \r\n * element_type can have the following values:\r\n * \r\n * ELEMENT_TYPE_SENSOR 1\r\n * ELEMENT_TYPE_SWITCH 2\r\n * ELEMENT_TYPE_DIMMER 3\r\n * ELEMENT_TYPE_HEATER 4\r\n * \r\n */\r\nint b_device_has_element (json_t * device, int element_type, const char * element_name, void * device_ptr);\r\n```\r\n# Carleon services\r\n\r\nCarleon implements an interface to control multiple types of house automation services. To add a new service, you have to create a library with the proper functions, then place the library in the folder specified by `services_path` in your configuration file, then restart the program.\r\n\r\nIn the service module, you have access to carleon configuration and the ulfius instance, which means you can access the database without instanciating your own database connector:\r\n\r\n```C\r\n/**\r\n *\r\n * Carleon configuration structure\r\n *\r\n */\r\nstruct _carleon_config {\r\n  char                    * services_path;\r\n  struct _h_connection    * conn;\r\n  struct _carleon_service * service_list;\r\n  char                    * alert_url;\r\n};\r\n```\r\n\r\nThe intended behaviour is to create your own webservices that will be available within Carleon. Within your service, the user can create elements and execute commands to those elements. Commands can be automatized via Angharad scripts and events.\r\n\r\nThe mock service in the file `service-mock.c` can be used to create your own module.\r\n\r\n## Service module interace\r\n\r\nA service module is a library loaded with `dlopen/dlsync`. All mandatory functions will return a json object of type `json_t *`.\r\n\r\nThe returned json object must have the following format:\r\n\r\n```json\r\n{\r\n  result: number,\r\n  other values\r\n}\r\n```\r\n\r\nThe `result` value is used to return a status code. The different status codes available are:\r\n\r\n```C\r\n#define WEBSERVICE_RESULT_ERROR     0\r\n#define WEBSERVICE_RESULT_OK        1\r\n#define WEBSERVICE_RESULT_NOT_FOUND 2\r\n#define WEBSERVICE_RESULT_TIMEOUT   3\r\n#define WEBSERVICE_RESULT_PARAM     4\r\n```\r\n\r\nThese functions are mandatory for a device module:\r\n\r\n```C\r\n/**\r\n * \r\n * Initializes the service\r\n * You can add here your own ulfius endpoints\r\n * \r\n * Return value\r\n * \r\n * {\r\n *   result: number, result value\r\n *   name: string, name of the service\r\n *   description: string, description for the service\r\n * }\r\n * \r\n */\r\njson_t * c_service_init(struct _u_instance * instance, const char * url_prefix, struct _carleon_config * config);\r\n\r\n/**\r\n * Closes the service\r\n * You can remove your endpoints here\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n * }\r\n * \r\n */\r\njson_t * c_service_close(struct _u_instance * instance, const char * url_prefix);\r\n\r\n\r\n/**\r\n * Get the available commands executable within angharad scripts or events\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   commands: object containing different commands\r\n * }\r\n * \r\n * A command must have the following format:\r\n * command_name: {\r\n *   parameters: {\r\n *     param_name_1: {\r\n *       type: \"string\"|\"integer\"|\"boolean\",\r\n *       required: boolean (default is false)\r\n *     },\r\n *     param_name_2: {\r\n *       type: \"string\"|\"integer\"|\"boolean\",\r\n *       required: boolean (default is false)\r\n *     },\r\n *     etc\r\n *   },\r\n *   result: {\r\n *     type: \"string\"|\"integer\"|\"boolean\"\r\n *     OR\r\n *     {\r\n *       result_value_1: { type: \"string\"|\"integer\"|\"boolean\" },\r\n *       result_value_2: { type: \"string\"|\"integer\"|\"boolean\" },\r\n *       etc\r\n *     }\r\n *   }\r\n * }\r\n */\r\njson_t * c_service_command_get_list(struct _carleon_config * config);\r\n\r\n/**\r\n * Get the available elements of the service\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   element: array of elements\r\n * }\r\n * \r\n * An element returned must have at least the following format:\r\n * {\r\n *   name: string, name of the element\r\n * }\r\n * \r\n */\r\njson_t * c_service_element_get_list(struct _carleon_config * config);\r\n\r\n/**\r\n * Execute the specified command to the specified element with the specified parameters\r\n * Return the value of the command if needed\r\n * \r\n * Return value\r\n * {\r\n *   result: number, result value\r\n *   value: \"string\"|\"integer\"|\"boolean\" OR object containing the result values names and their values\r\n * }\r\n * \r\n */\r\njson_t * c_service_exec(struct _carleon_config * config, const char * command, const char * element, json_t * parameters);\r\n```\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}