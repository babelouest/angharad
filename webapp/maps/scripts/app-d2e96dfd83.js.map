{"version":3,"sources":["scripts/app-d2e96dfd83.js"],"names":["carleonMotionController","$scope","$http","$translatePartialLoader","$translate","angharadConfig","angharadFactory","carleonFactory","carleonMotionFactory","sagremorService","sagremorParams","toaster","ctrl","this","urlBaseImages","baseUrl","prefixCarleon","element","name","urlBaseStream","images","fileListName","fileList","selectedFileList","offset","streamList","selectedStream","streamUri","online","profileParams","init","refresh","getFromProfile","currentProfile","_","has","carleon","serviceMotion","openPopupImage","imgArray","index","imagePopup","status","then","response","file_list","forEach","push","changeSelectedFileList","length","stream_list","stream","image","title","uri","snapshotUri","snapshot_uri","canPrevious","canNext","previousList","nextList","file","thumb","img","saveCurrentProfile","pop","instant","openStream","$on","carleonMpdController","$q","$window","$interval","carleonMpdFactory","benoicFactory","sharedData","mpdElement","find","get","mpd","promises","getMpdStatus","getMpdPlaylists","all","responses","playlists","state","startRefreshStatusInterval","_interval","hasFocus","refreshStatus","selectedPlaylist","cancel","displayVolume","volume","setVolume","delta","newVolume","setMpdVolume","displayVolumeCommand","setAction","action","actionUrl","repeat","random","device","setElement","setMpdAction","loadPlaylist","loadMpdPlaylist","onblur","onfocus","sagContainerController","$rootScope","tag","type","scripts","filter","script","options","tags","oneTag","runScript","loaderToast","body","timeout","showCloseButton","error","$broadcast","clear","menuSelect","menuItem","sagDimmerController","valueChecked","value","adminMode","newDisplay","display","setDimmer","result","addDimmer","Dimmervalue","sagSchedulerController","enableScheduler","enabled","add","sagTriggerController","enableTrigger","sagHeaterController","availableModes","setHeater","command","mode","displayCommandValue","Math","round","unit","displayCommand","modeDisplay","toLowerCase","carleonMockController","carleonMockFactory","param","param1","param2","param3","commandList","messages","commandMock","sagScriptController","self","sagSensorController","elementDisplayValue","isNaN","parseFloat","isFinite","sagMonitorController","sagremorConstant","updateDevices","displayMonitor","devices","deviceName","switches","monitored","elt","elementList","dimmers","heaters","sensors","elementListDisplayed","colorList","newElement","newElementColor","durationList","duration","data","labels","series","datasetOverride","fill","chart","interpolate","x","d","timestamp","y","showValues","valueFormat","d3","format","transitionDuration","xScale","time","scale","xAxis","axisLabel","yAxis","axisLabelDistance","tr","addElement","color","elements","from","Date","setTime","getTime","setMonth","getMonth","angular","copy","httpMonitor","getMonitor","results","key","remove","curElement","myData","values","monitor","curDate","newElementValid","removeSerie","serie","indexOf","splice","sagSwitchController","toggleSwitcher","topRightMenuCtrl","$location","$cookies","selectedLang","use","langList","profiles","currentProfileName","oauth2","search","responseType","changeLang","changeProfile","profile","now","exp","getFullYear","getDate","put","expires","reconnect","topLeftMenuCtrl","sagGenericInjectorManager","loadMenu","serviceList","components","inject","service","carleonService","leftMenu","menu","icon","target","selectTab","tabName","$","removeClass","addClass","carleonLiquidsoapController","$sce","carleonLiquidsoapFactory","getLiquidsoapService","radio","onAir","artist","albumartist","year","album","list","listSelected","onAirAccordionOpen","listAccordionOpen","commandRadio","$watch","isOpen","refreshOnAir","refreshList","$inject","module","constant","window","scriptActionElements","label","submodule","conditionList","monitoredEveryEnum","schedulerRepeatEveryEnum","style","config","$translateProvider","$translatePartialLoaderProvider","useLoader","urlTemplate","addPart","registerAvailableLanguageKeys","en_US","en_UK","en_CA","fr_FR","fr_CA","fr_BE","*","fallbackLanguage","determinePreferredLanguage","useCookieStorage","useSanitizeValueStrategy","factory","share","removeAll","params","$uibModal","open","message","modalInstance","animation","templateUrl","controller","controllerAs","size","resolve","placeholder","component","$locationProvider","html5Mode","hashPrefix","$stateProvider","$urlRouterProvider","url","otherwise","$timeout","sagremorEdit","getDashboardElements","dashboardWidgetsDisplay","profileName","addTo","D","getDashboardElementsCurrentProfile","dashboardWidgets","benoicEnabled","addBenoicElementToDashboard","addScriptToDashboard","addEventToDashboard","addDashboardSeparator","addMonitorToDashboard","carleonEnabled","addCarleonElementToDashboard","isInit","tagParams","split","curHeight","found","widget","bElt","getBenoicElement","dashboardElement","width","height","monitorList","injector","cElt","widgetHeight","curWidth","widgetWidth","newDashboardSeparator","setProfile","updateTag","newTag","e","_timeout","connected","cellHeight","verticalHargin","disableResize","removeFromDashboard","addTitleLine","w","onChange","event","items","changed","item","el","attr","chain","sortBy","splitted","token","fn","errorMessage","schedulerList","triggerList","menuScheduler","edit","editEvent","removeScheduler","add_to_dashboard","next_time","addToDashboard","menuTrigger","removeTrigger","updateSchedulers","updateTriggers","events","refreshEvents","schedulers","scheduler","triggers","trigger","newEvent","$uibModalInstance","DTOptionsBuilder","garethFactory","filterList","AlertSmtpList","AlertHttpList","editFilter","addFilter","newClause","newAlertSmtp","newAlertHttp","newAlertHttpHeader","displayAlert","customFilter","description","filter_clauses","filter_alerts","smtp","http","addAlertSmtp","addAlertHttp","customClause","operator","customHttpAlert","method","http_headers","customHttpAlertHeader","existingHttpAlert","customHttpAlertMethodSelect","customSmtpAlert","host","port","tls","check_ca","user","password","to","cc","bcc","subject","existingSmtpAlert","AlertList","newFilter","addClause","isClauseValid","addNewClause","parseInt","removeClause","cancelAddClause","getClauseElement","getClauseOperator","getClauseValue","clause","isSmtpAlertValid","alert","cancelAddSmtpAlert","postNewSmtpAlert","addAlert","addAlertHttpHeader","cancelAddAlertHttpHeader","addNewAlertHttpHeader","isHttpAlertValid","postNewHttpAlert","cancelAddHttpAlert","removeAlert","isFilterValid","cancelNewFilter","postNewFilter","promise","setFilter","removeCustomFilter","removeFilter","editCustomFilter","showAlerts","showFilters","removeSmtpAlert","removeHttpAlert","close","messageList","searchOptions","limit","getFilters","newOptions","withLanguageSource","withOption","getPriority","priority","getFilteredMessages","getAllMessages","filterManagement","scriptList","menuScript","editScript","removeScript","bindToElement","updateScripts","refreshScripts","newScript","sagremorConfirm","submodules","deviceList","deviceTypes","deviceTypesEnabled","deviceAdded","deviceUpdated","newDeviceName","newDeviceDescription","newDeviceType","newDeviceConnect","deviceOptionList","deviceOptionListDisplay","profileList","profileAdded","loggedIn","path","initDeviceTypes","addDevice","isDeviceValid","option","optional","postNewDevice","curOptions","type_uid","connectDevice","cancelNewDevice","setDeviceOptions","uid","getDeviceOverview","disconnectDevice","curDevice","editDevice","newDescription","update","saveDevice","setDevice","cancelEditDevice","removeDevice","translate","reloadBenoicDeviceTypes","reloadDeviceTypes","deviceType","reloadCarleonServices","reloadServiceList","submoduleEnable","enableSubmodule","benoic","gareth","garethEnabled","addProfile","newProfileName","newProfileDescription","newProfileDefault","cancelNewProfile","isProfileValid","saveNewProfile","newProfile","default","removeProfile","curProfile","cleanProfile","editProfile","newName","cancelEditProfile","isUpdateProfileValid","saveProfile","savedName","savedDescription","setDefaultProfile","useProfile","enableCarleonService","enableService","input","types","sensorList","menuSensor","editSensor","updateSensors","se","refreshElements","sensor","eltName","heaterList","editHeater","updateHeaters","heater","switchList","dimmerList","menuSwitcher","editSwitcher","menuDimmer","editDimmer","updateSwitchers","updateDimmers","sw","switcher","di","dimmer","addMonitor","exist","removeMonitor","updateMonitors","newMonitor","$stateParams","loadServices","currentInjectors","currentInjector","cService","serviceGroup","groupTitle","editService","removeService","serviceElt","addService","userList","tokenList","newUser","login","usersEnabled","getUserList","getTokenList","addUser","cancelNewUser","isNewUserValid","createNewUser","displayChangePassword","changePassword","cancelChangePassword","setUser","enableUser","removeUser","displayToken","substring","revokeToken","directive","$compile","template","templateNotFound","templateDisabled","scope","link","content","replace","append","bindings","angharadBackendService","urlBase","getMotionServiceList","httpRequest","getMotionService","addMotionService","motionService","setMotionService","removeMotionService","file_name","thumbnail","urlParam","stream_name","snapshot","motion","run","commands","parameters","currentImage","dismiss","displayTitle","changeImage","showIndex","addFileList","addStream","newFileList","newStream","addNewFileList","removeFileList","saveNewFileList","cancelNewFileList","isFileListValid","thumbnail_path","addNewStream","removeStream","saveNewStream","cancelNewStream","isStreamValid","isCameraValid","config_uri","save","getMpdServiceList","getMpdService","addMpdService","mpdService","setMpdService","removeMpdService","playlist","load_playlist","set_volume","switchAttached","switch","isMpdValid","changeSwitch","transclude","dashboard","sagParams","monitorEveryEnum","monitorEvery","trLabel","id","saveDimmer","monitorChecked","updateElement","AccessToken","angharadBackendFactory","deferred","defer","expires_at","valueOf","forceRefresh","defaults","headers","common","Authorization","access_token","reject","prefixAngharad","dataFactory","getSumboduleList","getSubmodule","getScriptList","getScript","addScript","setScript","getSchedulerList","getScheduler","addScheduler","setScheduler","getTriggerList","getTrigger","addTrigger","setTrigger","getProfileList","getProfile","profile_id","prefixBenoic","getDeviceTypes","getDeviceList","getDevice","pingDevice","elementType","elementName","elementValue","additionalOptions","addTag","removeTag","getServiceList","service_name","enable","elementCleanup","prefixGareth","getFilterList","getFilter","getAlertList","getAlert","setAlert","closeLoader","popLoader","initParameters","getApiData","refreshTimeout","startRefreshTimeout","refreshData","devicePromises","promiseList","sc","sh","initAngharadSubmodules","initAngharad","initBenoic","initCarleon","initGareth","initComplete","shouldRefresh","benoicInitError","shoudRefresh","deviceTypesResult","deviceResult","qList","filters","alerts","defaultProfile","profile_name","closeSagremor","isLogged","sagremorFactory","src","undefined","eventType","getCarleonElement","curMonitor","repeatSwitch","repeatEveryDayOfWeek","sunday","monday","tuesday","wednesday","thursday","friday","saturday","repeat_value","myDate","source","conditions","globalTriggerElementList","benoicElements","serviceName","commandName","newAction","globalElementList","carleonConditionElementsList","carleonConditionCommandsParameters","serviceParameter","serviceParameterName","commandParameter","required","carleonConditionResultParameters","serviceResult","serviceResultName","commandResult","resultName","newCondition","curResult","curResultName","field","nameInvalid","globalScriptList","remove_after","tmpElement","tmpResult","condition","newTrigger","newTriggerTag","datePickerOptions","buttonBar","show","text","today","date","openCalendar","preventDefault","stopPropagation","trackBenoicElement","trackCarleonElement","trackTriggerElement","isConditionValid","newConditionType","commandMode","commandHeat","res","parameter","heaterModeDisplay","setConditionBenoicElement","element_type","addCondition","nameSplitted","removeCondition","displayCondition","curSwitch","curDimmer","curHeater","curSensor","curCondition","cond","fieldName","isEventValid","gridstack","removeItem","removeWidget","addItem","makeWidget","restrict","onDragStart","onDragStop","onResizeStart","onResizeStop","attrs","ngModel","on","$apply","ui","require","gridstackItem","onItemAdded","onItemRemoved","gsItemX","gsItemY","gsItemWidth","gsItemHeight","gsItemAutopos","val","bind","saveHeater","mockFactory","getMockList","getMock","addMock","mock","setMock","removeMock","exec1","value1","value2","exec2","exec3","exec4","mocks","actions","newActionType","setActionBenoicElement","setActionCarleonElement","addAction","changeActionType","newActionTypeSplitted","removeAction","$index","getBenoicElementDisplay","getCarleonElementDisplay","getCarleonElementParameters","toReturn","getBenoicElementValue","cancelAddAction","saveNewAction","isScriptValid","isActionValid","ret","parameterName","carleonCommand","curCommand","carleonParameter","curParameter","saveSensor","saveSwitcher","ok","reason","selected","typeTitle","tmpCheck","selectRow","startsWith","selectedElements","newVal","oldVal","trustAsResourceUrl","getLiquidsoapServiceList","addLiquidsoapService","liquidsoapService","setLiquidsoapService","removeLiquidsoapService","radio_url","radio_type","control_enabled","control_host","control_port","control_request_name","isLiquidsoapValid","$templateCache"],"mappings":"AAw0FA,QAASA,yBAAyBC,EAAQC,EAAOC,EAAyBC,EAAYC,EAAgBC,EAAiBC,EAAgBC,EAAsBC,EAAiBC,EAAgBC,GAC1L,GAAIC,GAAOC,IAEXA,MAAKC,cAAgBT,EAAeU,QAAUV,EAAeW,cAAgB,kBAAoBJ,EAAKK,QAAQC,KAAO,UACrHL,KAAKM,cAAgBd,EAAeU,QAAUV,EAAeW,cAAgB,kBAAoBJ,EAAKK,QAAQC,KAAO,WACrHL,KAAKK,KAAON,EAAKK,QAAQC,KAEzBL,KAAKO,UACLP,KAAKQ,gBACLR,KAAKS,YACLT,KAAKU,iBAAmB,GACxBV,KAAKW,OAAS,EAEdX,KAAKY,cACLZ,KAAKa,gBAAiB,EACtBb,KAAKc,UAAY,GAEjBd,KAAKe,QAAS,EAEdf,KAAKgB,iBAELhB,KAAKiB,KAAO,WACdlB,EAAKmB,UACLnB,EAAKoB,kBAGHnB,KAAKmB,eAAiB,WACpBtB,EAAeuB,gBAAkBC,EAAEC,IAAIzB,EAAeuB,eAAgB,yBAAyBrB,EAAKK,QAAQC,MAC/GN,EAAKiB,cAAgBnB,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,MAC1ER,EAAeuB,iBACtBvB,EAAeuB,eAAeG,UAClC1B,EAAeuB,eAAeG,YAE1B1B,EAAeuB,eAAeG,QAAQC,gBAC1C3B,EAAeuB,eAAeG,QAAQC,kBAElC3B,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,QACrER,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,OAChEK,iBAAkB,GAClBG,eAAgB,OAMjBb,KAAKyB,eAAiB,SAAUC,EAAUC,GAC5ChC,EAAqBiC,WAAWF,EAAUC,IAGxC3B,KAAKkB,QAAU,WACjBnB,EAAKS,gBACLT,EAAKa,cACLjB,EAAqBkC,OAAO9B,EAAKK,QAAQC,KAAMN,EAAKY,QAAQmB,KAAK,SAAUC,GAC1EhC,EAAKgB,OAASgB,EAAShB,OACvBhB,EAAKU,SAAWsB,EAASC,UACzBX,EAAEY,QAAQF,EAASC,UAAW,SAAUvB,EAAUJ,GACjDN,EAAKS,aAAa0B,KAAK7B,KAElBR,EAAeuB,gBAAoBvB,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,MAAMK,kBAC/GX,EAAKW,iBAAmBb,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,MAAMK,iBAC/FX,EAAKoC,0BACkC,IAA7BpC,EAAKS,aAAa4B,SAC5BrC,EAAKW,iBAAmBX,EAAKS,aAAa,GAC1CT,EAAKoC,0BAGNd,EAAEY,QAAQF,EAASM,YAAa,SAAUC,GACzC,GAAIC,IACHlC,KAAMN,EAAKK,QAAQC,KACnBmC,MAAOF,EAAOjC,KACdiC,OAAQA,EAAOG,IACfC,YAAaJ,EAAOK,aAErB5C,GAAKa,WAAWsB,KAAKK,QAKxBvC,KAAK4C,YAAc,WAClB,MAAO7C,GAAKY,OAAS,GAGtBX,KAAK6C,QAAU,WACd,MAAsD,KAA/C9C,EAAKU,SAASV,EAAKW,kBAAkB0B,QAG7CpC,KAAK8C,aAAe,WACnB/C,EAAKY,QAAU,GACfZ,EAAKmB,WAGNlB,KAAK+C,SAAW,WACfhD,EAAKY,QAAU,GACfZ,EAAKmB,WAGHlB,KAAKmC,uBAAyB,WAChCpC,EAAKQ,UACLc,EAAEY,QAAQlC,EAAKU,SAASV,EAAKW,kBAAmB,SAAUsC,GACzD,GAAIT,IACHU,MAAOlD,EAAKE,cAAgBF,EAAKW,iBAAmB,IAAMsC,EAAO,kBACjEE,IAAKnD,EAAKE,cAAgBF,EAAKW,iBAAmB,IAAMsC,EACxDR,MAAOQ,EAERjD,GAAKQ,OAAO2B,KAAKK,KAElB1C,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,MAAMQ,eAAiB,GACxFhB,EAAeuB,eAAeG,QAAQC,cAAczB,EAAKK,QAAQC,MAAMK,iBAAmBX,EAAKW,iBAC/FjB,EAAgB0D,qBAAqBrB,KAAK,aAEvC,WACFhC,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAI9ErD,KAAKsD,WAAa,WACjB3D,EAAqBiC,WAAW7B,EAAKa,WAAY,IAGlDxB,EAAOmE,IAAI,yBAA0B,WACpCxD,EAAKmB,YAGN9B,EAAOmE,IAAI,yBAA0B,WACpCxD,EAAKkB,SAGN7B,EAAOmE,IAAI,yBAA0B,WACpCxD,EAAKoB,mBAGHnB,KAAKiB,OA8UT,QAASuC,sBAAqBpE,EAAQqE,EAAIC,EAASpE,EAAyBC,EAAYoE,EAAWnE,EAAgBE,EAAgBkE,EAAmBC,EAAehE,EAAgBiE,EAAYhE,GAUhM,QAASmB,KACRlB,EAAKgE,WAAa1C,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,eAAe7D,QAAS,SAAU8D,GAC5F,MAAOA,GAAI7D,OAASN,EAAKK,QAAQC,MAGlC,IAAI8D,IACHP,EAAkBQ,aAAarE,EAAKK,QAAQC,MAC5CuD,EAAkBS,gBAAgBtE,EAAKK,QAAQC,MAGhDoD,GAAGa,IAAIH,GAAUrC,KAAK,SAASyC,GAC9BxE,EAAKmE,IAAMK,EAAU,GACrBxE,EAAKyE,UAAYD,EAAU,GACJ,SAAnBxE,EAAKmE,IAAIO,OAAuC,UAAnB1E,EAAKmE,IAAIO,OACzCC,KAEC,WACF5E,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,0BAC1EhD,KAAMN,EAAKK,QAAQC,UAKtB,QAASqE,KACR3E,EAAK4E,UAAYhB,EAAU,WACtB5D,EAAK6E,UACR7E,EAAK8E,iBAEJ,KArCJ,GAAI9E,GAAOC,IAEXA,MAAKkE,OACLlE,KAAK+D,cACL/D,KAAKwE,aACLxE,KAAK8E,kBAAmB,EACxB9E,KAAK2E,UAAY,KACjB3E,KAAK4E,UAAW,EAiChB5E,KAAK6E,cAAgB,WACpBjB,EAAkBQ,aAAarE,EAAKK,QAAQC,MAAMyB,KAAK,SAASC,GAC/DhC,EAAKmE,IAAMnC,EACa,SAAnBhC,EAAKmE,IAAIO,OAAuC,UAAnB1E,EAAKmE,IAAIO,OAAwC,MAAlB1E,EAAK4E,UAEzC,MAAlB5E,EAAK4E,WAAwC,SAAnB5E,EAAKmE,IAAIO,OAAuC,UAAnB1E,EAAKmE,IAAIO,QAC1Ed,EAAUoB,OAAOhF,EAAK4E,WACtB5E,EAAK4E,UAAY,MAHjBD,KAKC,WACF5E,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,0BAC1EhD,KAAMN,EAAKK,QAAQC,WAKtBL,KAAKgF,cAAgB,WACpB,MAAOjF,GAAKmE,IAAIe,OAAS,KAG1BjF,KAAKkF,UAAY,SAASC,GACzB,GAAIC,GAAYrF,EAAKmE,IAAIe,OAASE,CAC9BC,IAAa,GAAKA,GAAa,KAClCxB,EAAkByB,aAAatF,EAAKK,QAAQC,KAAM+E,GAAWtD,KAAK,WACjE/B,EAAKmE,IAAIe,OAASG,GAChB,WACFtF,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,gCAK9ErD,KAAKsF,qBAAuB,SAASH,GACpC,OAAQA,EAAQ,EAAI,IAAM,IAAMA,EAAQ,MAGzCnF,KAAKuF,UAAY,SAASC,GACzB,GAAIC,GAAYD,CACD,YAAXA,IACHC,GAAc,KAAO1F,EAAKmE,IAAIwB,OAAO,IAAI,KACzC3F,EAAKmE,IAAIwB,QAAU3F,EAAKmE,IAAIwB,QAEd,WAAXF,IACHC,GAAc,KAAO1F,EAAKmE,IAAIyB,OAAO,IAAI,KACzC5F,EAAKmE,IAAIyB,QAAU5F,EAAKmE,IAAIyB,QAEd,SAAXH,GAAqBzF,EAAKgE,WAAW6B,QAAU7F,EAAKgE,WAALhE,WAClD8D,EAAcgC,WAAW9F,EAAKgE,WAAW6B,OAAQ,SAAU7F,EAAKgE,WAALhE,UAAwB,KAErE,SAAXyF,GAAqBzF,EAAKgE,WAAW6B,QAAU7F,EAAKgE,WAALhE,WAClD8D,EAAcgC,WAAW9F,EAAKgE,WAAW6B,OAAQ,SAAU7F,EAAKgE,WAALhE,UAAwB,KAEpF6D,EAAkBkC,aAAa/F,EAAKK,QAAQC,KAAMoF,GAAW3D,KAAK,WACjE/B,EAAK8E,iBACH,WACF/E,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,gCAI7ErD,KAAK+F,aAAe,WACbhG,EAAK+E,mBACN/E,EAAKgE,WAAW6B,QAAU7F,EAAKgE,WAALhE,WAC7B8D,EAAcgC,WAAW9F,EAAKgE,WAAW6B,OAAQ,SAAU7F,EAAKgE,WAALhE,UAAwB,KAEpF6D,EAAkBoC,gBAAgBjG,EAAKK,QAAQC,KAAMN,EAAK+E,kBAAkBhD,KAAK,WAChF/B,EAAK8E,iBACH,WACF/E,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wCAK9EjE,EAAOmE,IAAI,yBAA0B,WACpCxD,EAAK8E,kBAGNzF,EAAOmE,IAAI,yBAA0B,WACpCtC,MAGD7B,EAAOmE,IAAI,WAAY,WACtBI,EAAUoB,OAAOhF,EAAK4E,WACtB5E,EAAK4E,UAAY,OAGlBjB,EAAQuC,OAAS,WAChBlG,EAAK6E,UAAW,GAGjBlB,EAAQwC,QAAU,WACjBnG,EAAK6E,UAAW,GAGjB3D,IA8PD,QAASkF,wBAAwBC,EAAY7G,EAAYO,EAASgE,EAAYrE,GAK1E,QAASwB,KACX,GAAIoF,GAAM,WACV,QAAQtG,EAAKuG,MACZ,IAAK,SACJD,GAAO,KAAOtG,EAAKK,QAAQwF,OAAS,WAAa7F,EAAKK,QAAQC,IAC9D,MACD,KAAK,SACJgG,GAAO,KAAOtG,EAAKK,QAAQwF,OAAS,WAAa7F,EAAKK,QAAQC,IAC9D,MACD,KAAK,SACJgG,GAAO,KAAOtG,EAAKK,QAAQwF,OAAS,WAAa7F,EAAKK,QAAQC,IAC9D,MACD,KAAK,SACJgG,GAAO,KAAOtG,EAAKK,QAAQwF,OAAS,WAAa7F,EAAKK,QAAQC,IAC9D,MACD,KAAK,YACJgG,GAAO,eAAiBtG,EAAKK,QAAQC,IACrC,MACD,SAECgG,GAAO,KAAOtG,EAAKuG,KAAO,IAAMvG,EAAKK,QAAQC,KAG/CN,EAAKwG,QAAUlF,EAAEmF,OAAO1C,EAAWQ,IAAI,mBAAoB,SAAUmC,GACpE,QAASpF,EAAE2C,KAAKyC,EAAOC,QAAQC,KAAM,SAAUC,GAC9C,MAAOA,KAAWP,MA7BlB,GAAItG,GAAOC,IAEXA,MAAKuG,WAgCLvG,KAAK6G,UAAY,SAAUJ,GAC7B,GAAIK,GAAchH,EAAQsD,KAAKkD,KAAM,OAAQ9D,MAAOjD,EAAW8D,QAAQ,iCAAkC0D,KAAMxH,EAAW8D,QAAQ,mCAAoC2D,QAAS,EAAGC,iBAAiB,GACnMxH,GAAgBoH,UAAUJ,EAAOpG,MAAMyB,KAAK,WAC3ChC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAehD,KAAMoG,EAAOpG,OAAQd,EAAW8D,QAAQ,wBAC/F,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAehD,KAAMoG,EAAOpG,OAAQd,EAAW8D,QAAQ,uBAC7F,WAAW,WACb+C,EAAWe,WAAW,WACtBrH,EAAQsH,MAAMN,MAIb/G,EAAKsH,WAAa,SAASC,EAAUlH,GACjCkH,EAAS9B,OAAOpF,IAGpBa,IAmBJ,QAASsG,qBAAqB1D,EAAehE,EAAgBN,GAOzD,QAAS0B,KACLlB,EAAKK,QAAQkG,KAAO,SAPxB,GAAIvG,GAAOC,IAEXD,GAAKK,QAAQoH,aAAuC,IAAvBzH,EAAKK,QAAQqH,MAC1C1H,EAAK2H,UAAY7H,EAAe6H,UAChC3H,EAAKK,QAAQuH,WAAa5H,EAAKK,QAAQwH,QAMvC7H,EAAK8H,UAAY,SAAUJ,GACT,IAAVA,GAAsC,IAAvB1H,EAAKK,QAAQqH,MACrC5D,EAAcgC,WAAW9F,EAAKK,QAAQwF,OAAQ,SAAU7F,EAAKK,QAAQC,KAAM,KAAKyB,KAAK,SAAUgG,GAC9F/H,EAAKK,QAAQqH,MAAQK,EAAOL,QAEnBA,GAAS,GAAKA,GAAS,KACjC5D,EAAcgC,WAAW9F,EAAKK,QAAQwF,OAAQ,SAAU7F,EAAKK,QAAQC,KAAMoH,GAAO3F,KAAK,WACtF/B,EAAKK,QAAQqH,MAAQA,KAKrB1H,EAAKgI,UAAY,SAAUN,GACzB1H,EAAKK,QAAQqH,MAAQA,GAAS,GAAK1H,EAAKK,QAAQqH,MAAQA,GAAS,KACpE5D,EAAcgC,WAAW9F,EAAKK,QAAQwF,OAAQ,SAAU7F,EAAKK,QAAQC,KAAMN,EAAKK,QAAQqH,MAAQA,GAAO3F,KAAK,WAC3G/B,EAAKK,QAAQqH,OAASA,KAKtB1H,EAAKiI,YAAc,WACrB,MAAOjI,GAAKK,QAAQqH,MAAQ,KAG1BxG,IAstDJ,QAASgH,wBAAwB1I,EAAYO,EAASL,EAAiBI,EAAgBiE,GAGnF,QAAS7C,MAFT,GAAIlB,GAAOC,IAKXA,MAAKkI,gBAAkB,WACzBzI,EAAgByI,gBAAgBnI,EAAKK,QAAQC,KAAMN,EAAKK,QAAQ+H,SAASrG,KAAK,SAAUgG,GACvFhE,EAAWsE,IAAI,qBAAsBN,EAAOzH,KAAMyH,GAClD/H,EAAKK,QAAU0H,EACfhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,8BAChF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,8BAI/EpC,IAmBJ,QAASoH,sBAAsB9I,EAAYO,EAASL,EAAiBI,EAAgBiE,GAGjF,QAAS7C,MAFT,GAAIlB,GAAOC,IAKXA,MAAKsI,cAAgB,WACvB7I,EAAgB6I,cAAcvI,EAAKK,QAAQC,KAAMN,EAAKK,QAAQ+H,SAASrG,KAAK,SAAUgG,GACrFhE,EAAWsE,IAAI,kBAAmBN,EAAOzH,KAAMyH,GAC/C/H,EAAKK,QAAU0H,EACfhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,4BAC9E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,4BAI7EpC,IA+IJ,QAASsH,qBAAqB1E,EAAehE,EAAgBN,GAQzD,QAAS0B,KACLlB,EAAKK,QAAQkG,KAAO,SACdvG,EAAKK,UAChBL,EAAKK,QAAQuH,WAAa5H,EAAKK,QAAQwH,QACvC7H,EAAKyI,eAAiBzI,EAAKK,QAAQqH,MAAMe,gBAXxC,GAAIzI,GAAOC,IAEXD,GAAKK,QAAQoH,aAAuC,IAAvBzH,EAAKK,QAAQqH,MAC1C1H,EAAK2H,UAAY7H,EAAe6H,UAChC3H,EAAKK,QAAQuH,WAAa,GAC1B5H,EAAKyI,kBAULzI,EAAK0I,UAAY,SAAUhB,GAE5BA,EADY,MAATA,EACK1H,EAAKK,QAAQqH,MAAMiB,QAEnB3I,EAAKK,QAAQqH,MAAMiB,QAAUjB,EAEhC5D,EAAcgC,WAAW9F,EAAKK,QAAQwF,OAAQ,SAAU7F,EAAKK,QAAQC,KAAMoH,GAAQkB,KAAM5I,EAAKK,QAAQqH,MAAMkB,OAAO7G,KAAK,WACpH/B,EAAKK,QAAQqH,MAAMiB,QAAUjB,KAIrC1H,EAAK6I,oBAAsB,WAC7B,GAAIF,GAAY3I,EAAKK,QAASyI,KAAKC,MAAmC,IAA7B/I,EAAKK,QAAQqH,MAAMiB,SAAiB,IAAK,CAIlF,OAHY3I,GAAKK,SAAaL,EAAKK,QAAQsG,QAAQqC,OAClDL,GAAW,IAAM3I,EAAKK,QAAQsG,QAAQqC,MAEhCL,GAGR3I,EAAKiJ,eAAiB,SAAUN,GAC/B,GAAIjB,GAAQ,EASZ,OAPCA,GADGiB,EAAU,EACLA,EAEA,IAAMA,EAEH3I,EAAKK,SAAaL,EAAKK,QAAQsG,QAAQqC,OAClDtB,GAAS,IAAM1H,EAAKK,QAAQsG,QAAQqC,MAE9BtB,GAGR1H,EAAKkJ,YAAc,SAAUxB,GAC5B,MAAOlI,GAAW8D,QAAQ,eAAiBoE,EAAMyB,gBAG/CjI,IA+DJ,QAASkI,uBAAuB7J,EAAyBC,EAAY6J,EAAoBvJ,EAAgBC,GAQrG,QAASmB,MAPT,GAAIlB,GAAOC,IAEXD,GAAK2H,UAAY7H,EAAe6H,UAChC3H,EAAKsJ,OAASX,QAAS,QAASY,OAAQ,OAAQC,OAAQ,GAAIC,OAAQ,KACpEzJ,EAAK0J,aAAe,QAAS,QAAS,QAAS,SAC/C1J,EAAK2J,YAKL3J,EAAK2I,QAAU,WACjBU,EAAmBO,YAAY5J,EAAKK,QAAQC,KAAMN,EAAKsJ,MAAMX,QAAS3I,EAAKsJ,MAAMC,OAAQvJ,EAAKsJ,MAAME,OAAQxJ,EAAKsJ,MAAMG,QAAQ1H,KAAK,SAAUgG,GAC7IhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,wBAAyB9D,EAAW8D,QAAQ,kCACpF,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,wBAAyB9D,EAAW8D,QAAQ,kCAInFpC,IA8NJ,QAAS2I,qBAAqBxD,EAAY7G,EAAYO,EAASL,EAAiBI,GAK5E,QAASoB,MAJT,GAAIlB,GAAOC,IAEXA,MAAK8G,YAAc,KAKnB9G,KAAK6G,UAAY,WAClB/G,EAAQsH,MAAMyC,KAAK/C,aACnB+C,KAAK/C,YAAchH,EAAQsD,KAAKkD,KAAM,OAAQ9D,MAAOjD,EAAW8D,QAAQ,iCAAkC0D,KAAMxH,EAAW8D,QAAQ,mCAAoC2D,QAAS,EAAGC,iBAAiB,IACpMxH,EAAgBoH,UAAU9G,EAAKK,QAAQC,MAAMyB,KAAK,WACjDhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAehD,KAAMN,EAAKK,QAAQC,OAAQd,EAAW8D,QAAQ,wBACrG,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAehD,KAAMN,EAAKK,QAAQC,OAAQd,EAAW8D,QAAQ,uBACnG,WAAW,WACbvD,EAAQsH,MAAMyC,KAAK/C,aACnBV,EAAWe,WAAW,cAItBlG,IAmWJ,QAAS6I,qBAAqBjG,EAAehE,EAAgBN,GAOzD,QAAS0B,KACLlB,EAAKK,QAAQkG,KAAO,SAPxB,GAAIvG,GAAOC,IAEXD,GAAK2H,UAAY7H,EAAe6H,UAChC3H,EAAKK,QAAQuH,WAAa5H,EAAKK,QAAQwH,QACvC7H,EAAK2J,YAML3J,EAAKgK,oBAAsB,WAC7B,GAAItC,GAAQ1H,EAAKK,QAAQqH,KAOzB,QANKuC,MAAMC,WAAWxC,KAAWyC,SAASzC,KACzCA,EAASoB,KAAKC,MAAc,IAARrB,GAAe,KAExB1H,EAAKK,SAAaL,EAAKK,QAAQsG,QAAQqC,OAClDtB,GAAS,IAAM1H,EAAKK,QAAQsG,QAAQqC,MAE9BtB,GAGLxG,IA+DJ,QAASkJ,sBAAsB/K,EAAQqE,EAAIlE,EAAYO,EAASL,EAAiBoE,EAAenE,EAAgBG,EAAgBuK,EAAkBtG,GA0C9I,QAAS7C,KACXoJ,IACAtK,EAAKuK,iBAWN,QAASD,KACR,GAAIE,GAAUzG,EAAWQ,IAAI,gBAE7BjD,GAAEY,QAAQsI,EAAS,SAAU3E,EAAQ4E,GAC9B5E,EAAOxF,SACZiB,EAAEY,QAAQ2D,EAAOxF,QAAQqK,SAAU,SAAUrK,EAASC,GACrD,GAAID,EAAQsK,WAAatK,EAAQ+H,QAAS,CACzC,GAAIwC,IACHtK,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBhC,OAAQ4E,EACRlE,KAAM,SAEPvG,GAAK6K,YAAY1I,KAAKyI,QAM1BtJ,EAAEY,QAAQsI,EAAS,SAAU3E,EAAQ4E,GAC9B5E,EAAOxF,SACZiB,EAAEY,QAAQ2D,EAAOxF,QAAQyK,QAAS,SAAUzK,EAASC,GACpD,GAAID,EAAQsK,WAAatK,EAAQ+H,QAAS,CACzC,GAAIwC,IACHtK,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBhC,OAAQ4E,EACRlE,KAAM,SAEPvG,GAAK6K,YAAY1I,KAAKyI,QAM1BtJ,EAAEY,QAAQsI,EAAS,SAAU3E,EAAQ4E,GAC9B5E,EAAOxF,SACZiB,EAAEY,QAAQ2D,EAAOxF,QAAQ0K,QAAS,SAAU1K,EAASC,GACpD,GAAID,EAAQsK,WAAatK,EAAQ+H,QAAS,CACzC,GAAIwC,IACHtK,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBhC,OAAQ4E,EACRlE,KAAM,SAEPvG,GAAK6K,YAAY1I,KAAKyI,QAM1BtJ,EAAEY,QAAQsI,EAAS,SAAU3E,EAAQ4E,GAC9B5E,EAAOxF,SACZiB,EAAEY,QAAQ2D,EAAOxF,QAAQ2K,QAAS,SAAU3K,EAASC,GACpD,GAAID,EAAQsK,WAAatK,EAAQ+H,QAAS,CACzC,GAAIwC,IACHtK,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBhC,OAAQ4E,EACRlE,KAAM,SAEPvG,GAAK6K,YAAY1I,KAAKyI,QAnHxB,GAAI5K,GAAOC,IAEXA,MAAK4K,eACL5K,KAAKgL,wBACLhL,KAAKiL,aACLjL,KAAKkL,YAAa,EAClBlL,KAAKmL,iBAAkB,EACvBnL,KAAKoL,aAAehB,EAAiBgB,aACrCpL,KAAKqL,UAAY5D,MAAO,GAExBzH,KAAKsL,QACLtL,KAAKuL,UACLvL,KAAKwL,UAELxL,KAAKyL,kBACPC,MAAM,IAIP1L,KAAK0G,SACJiF,OACCrF,KAAM,YACNsF,YAAY,QACZC,EAAG,SAASC,GAAK,MAAOA,GAAEC,WAC1BC,EAAG,SAASF,GAAK,MAAOA,GAAErE,OAC1BwE,YAAY,EACZC,YAAa,SAASJ,GACrB,MAAOK,IAAGC,OAAO,QAAQN,IAE1BO,mBAAoB,IACpBC,OAASH,GAAGI,KAAKC,QACjBC,OACCC,UAAWnN,EAAW8D,QAAQ,sBAE/BsJ,OACCD,UAAW,GACXE,kBAAmB,MAUnB5M,KAAK6M,GAAK,SAAUpF,GACtB,MAAOlI,GAAW8D,QAAQoE,IAGxBrI,EAAOmE,IAAI,iBAAiBxD,EAAKK,QAAQC,KAAM,WACjDN,EAAKuK,mBAuEHtK,KAAK8M,WAAa,WACpB/M,EAAKmL,WAAW6B,MAAQhN,EAAKoL,gBAC7BpL,EAAKK,QAAQ4M,SAAS9K,KAAKnC,EAAKmL,YAChCzL,EAAgB0D,qBAAqBrB,KAAK,WACzC/B,EAAKuK,kBACH,WACFxK,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC1E,WAAW,eAIfrD,KAAKsK,eAAiB,WACrB,GAAI2C,GAAO,GAAIC,KAEf,QAAQnN,EAAKsL,SAAS5D,OACrB,IAAK,GACJwF,EAAKE,QAAQF,EAAKG,UAAY,KAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,KAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKI,SAASJ,EAAKK,WAAa,GAGlCvN,EAAKkL,UAAYsC,QAAQC,KAAKpD,EAAiBa,WAC/ClL,EAAKiL,qBAAuBuC,QAAQC,KAAKzN,EAAK6K,YAC9C,IAAI6C,KAEJpM,GAAEY,QAAQlC,EAAKK,QAAQ4M,SAAU,SAAU5M,GAC1CqN,EAAYvL,KAAK2B,EAAc6J,WAAWtN,EAAQwF,OAAQxF,EAAQkG,KAAMlG,EAAQC,KAAMwI,KAAKC,MAAMmE,EAAKG,UAAY,SAGnHrN,EAAKuL,QACL7H,EAAGa,IAAImJ,GAAa3L,KAAK,SAAU6L,GAClC,IAAKC,MAAOD,GAAS,CACpBtM,EAAEwM,OAAO9N,EAAKiL,qBAAsB,SAAU8C,GAC7C,MAAOA,GAAWlI,SAAW7F,EAAKK,QAAQ4M,SAASY,KAAKhI,QACtDkI,EAAWxH,OAASvG,EAAKK,QAAQ4M,SAASY,KAAKtH,MAC/CwH,EAAWzN,OAASN,EAAKK,QAAQ4M,SAASY,KAAKvN,OAElDN,EAAKyL,OAAOtJ,KAAKnC,EAAKK,QAAQ4M,SAASY,KAAKhG,QAChC,IAAImG,IACfH,IAAK7N,EAAKK,QAAQ4M,SAASY,KAAKhG,QAChCoG,UAEiBL,GAAQC,MAAQD,EAAQC,KAAKxL,OAAS,IACvDf,EAAEY,QAAQ0L,EAAQC,KAAM,SAAUK,GACjC,GAAIC,GAAU,GAAIhB,MAAyB,IAApBe,EAAQlC,WAC3BtE,GAASsE,UAAWmC,EAASzG,MAAOwC,WAAWgE,EAAQxG,OAC3DsG,GAAOC,OAAO9L,KAAKuF,KAEpB1H,EAAKuL,KAAKpJ,KAAK6L,MAGf,SAAU7G,OAIdlH,KAAKmO,gBAAkB,WACtB,QAASpO,EAAKmL,YAGflL,KAAKoO,YAAc,SAAUC,GACxBtO,EAAKK,QAAQ4M,SAASsB,QAAQD,IAAU,IAC3CtO,EAAKK,QAAQ4M,SAASuB,OAAOxO,EAAKK,QAAQ4M,SAASsB,QAAQD,GAAQ,GACnE5O,EAAgB0D,qBAAqBrB,KAAK,WACzC/B,EAAKuK,kBACH,WACFxK,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC1E,WAAW,WACbtD,EAAKoL,iBAAkB,EACvBpL,EAAKmL,YAAa,MAKlBjK,IAkBJ,QAASuN,qBAAqB3K,EAAehE,EAAgBN,GAQzD,QAAS0B,KACLlB,EAAKK,QAAQkG,KAAO,SARxB,GAAIvG,GAAOC,IAEXD,GAAKK,QAAQoH,aAAuC,IAAvBzH,EAAKK,QAAQqH,MAC1C1H,EAAK2H,UAAY7H,EAAe6H,UAChC3H,EAAKK,QAAQuH,WAAa5H,EAAKK,QAAQwH,QACvC7H,EAAK2J,YAML3J,EAAK0O,eAAiB,WAClB1O,EAAKK,QAAQqH,MAAQ1H,EAAKK,QAAQoH,aAAa,EAAE,EACjD3D,EAAcgC,WAAW9F,EAAKK,QAAQwF,OAAQ,SAAU7F,EAAKK,QAAQC,KAAMN,EAAKK,QAAQqH,QAG5FxG,IA+DJ,QAASyN,kBAAiBtP,EAAQgH,EAAYuI,EAAWtP,EAAOE,EAAYqP,EAAUnP,EAAiB2K,EAAkBvK,EAAgBL,GACxI,GAAIqK,GAAO7J,IAEX6J,GAAKhK,eAAiBA,EAEtBgK,EAAKgF,aAAetP,EAAWuP,MAE/BjF,EAAKkF,SAAW3E,EAAiB2E,SAEjClF,EAAKmF,SAAWnP,EAAemP,SAC/BnF,EAAKoF,mBAAuBpP,EAAeuB,eAAiBvB,EAAeuB,eAAef,KAAO,GAEjGwJ,EAAKqF,OAAS1P,EAAe0P,OAEzBP,EAAUQ,SAAS7I,OACtBuD,EAAKqF,OAAOE,aAAeT,EAAUQ,SAAS7I,MAG/CuD,EAAKwF,WAAa,WACjB9P,EAAWuP,IAAIjF,EAAKgF,cAAc/M,KAAK,WACtCsE,EAAWe,WAAW,iBAIxB0C,EAAKyF,cAAgB,WACpBjO,EAAEY,QAAQpC,EAAemP,SAAU,SAASO,GAC3C,GAAIA,EAAQlP,OAASwJ,EAAKoF,mBAAoB,CAC7CpP,EAAeuB,eAAiBmO,CAChC,IAAIC,GAAM,GAAItC,MACVuC,EAAM,GAAIvC,MAAKsC,EAAIE,cAAgB,GAAIF,EAAIlC,WAAYkC,EAAIG,UAC/Df,GAASgB,IAAI,mBAAoB/F,EAAKoF,oBACrCY,QAASJ,IAEVrJ,EAAWe,WAAW,0BACtBf,EAAWe,WAAW,wBAKzB0C,EAAK3I,QAAU,WACdkF,EAAWe,WAAW,YAGvB0C,EAAKiG,UAAY,WAChB1J,EAAWe,WAAW,cAGvB/H,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKmF,SAAWnP,EAAemP,SAC/BnF,EAAKoF,mBAAuBpP,EAAeuB,eAAiBvB,EAAeuB,eAAef,KAAO,KAGlGjB,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKmF,SAAWnP,EAAemP,SAC/BnF,EAAKoF,mBAAuBpP,EAAeuB,eAAiBvB,EAAeuB,eAAef,KAAO,KAUnG,QAAS0P,iBAAiB3Q,EAAQG,EAAYM,EAAgBmQ,EAA2BlM,GAMrF,QAAS7C,KACX4I,EAAKoG,WANH,GAAIpG,GAAO7J,IAEXA,MAAKkQ,eACLlQ,KAAKH,eAAiBA,EAMzBG,KAAKiQ,SAAW,WACfpG,EAAKqG,eACL7O,EAAEY,QAAQ+N,EAA0BG,WAAY,SAAUC,GACzD,GAAIC,GAAUvM,EAAWG,IAAI,kBAAmBmM,EAAO9J,KACvD,IAAI8J,EAAOE,gBAAkBF,EAAOG,UAAcF,GAAWA,EAAQlI,QAAS,CAC7E,GAAIqI,GAAOJ,EAAOG,QAClBC,GAAKC,KAAOL,EAAOK,KACdpP,EAAE2C,KAAK6F,EAAKqG,aAAcQ,OAAQF,EAAKE,UAC3C7G,EAAKqG,YAAYhO,KAAKsO,OASvBxQ,KAAK2Q,UAAY,SAAUC,GACvBC,EAAE,aAAaC,YAAY,UAC3BD,EAAED,GAASG,SAAS,WAG3B3R,EAAOmE,IAAI,oBAAqB,WAC/BsG,EAAKhK,eAAiBA,IAGvBT,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKoG,aAGHhP,IA8VJ,QAAS+P,6BAA6B5R,EAAQ6R,EAAMxN,EAAIC,EAASpE,EAAyBC,EAAYoE,EAAWnE,EAAgBE,EAAgBwR,EAA0BtR,EAAiBC,EAAgBC,GAwBxM,QAASmB,KACXiQ,EAAyBC,qBAAqBpR,EAAKK,QAAQC,MAAMyB,KAAK,SAAUgG,GAC/E/H,EAAKqR,MAAQtJ,GACX,WACFhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,oCA3BtF,GAAItD,GAAOC,IAEXA,MAAKoR,SACRpR,KAAK6B,OAAS,GACX7B,KAAKqR,OACP7O,MAAO,GACP8O,OAAQ,GACRC,YAAa,GACbC,KAAM,GACNC,MAAO,IAERzR,KAAK0R,QACL1R,KAAK2R,cACJnP,MAAO,GACP8O,OAAQ,GACRC,YAAa,GACbC,KAAM,GACNC,MAAO,IAGLzR,KAAK4R,oBAAqB,EAC1B5R,KAAK6R,mBAAoB,EAUzB7R,KAAK8R,aAAe,SAAUpJ,GAChCwI,EAAyBxI,QAAQ3I,EAAKK,QAAQC,KAAMqI,GAAS5G,KAAK,SAAUgG,GAC3EhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,8BAA+B9D,EAAW8D,QAAQ,uCAC5FtD,EAAK8E,iBACH,WACF/E,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,8BAA+B9D,EAAW8D,QAAQ,wCAI5FjE,EAAO2S,OAAO,6BAA8B,SAASC,GAChDA,GACHjS,EAAK8E,kBAIPzF,EAAO2S,OAAO,2BAA4B,SAASC,GAC9CA,GACHjS,EAAKkS,iBAIP7S,EAAO2S,OAAO,0BAA2B,SAASC,GAC7CA,GACHjS,EAAKmS,gBAIPlS,KAAK6E,cAAgB,WACpBqM,EAAyBxI,QAAQ3I,EAAKK,QAAQC,KAAM,UAAUyB,KAAK,SAAUgG,GAC5E/H,EAAK8B,OAASiG,EAAOL,OACnB,WACF3H,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,6BAA8B9D,EAAW8D,QAAQ,uCAI3FrD,KAAKiS,aAAe,WACnBf,EAAyBG,MAAMtR,EAAKK,QAAQC,MAAMyB,KAAK,SAAUgG,GAChE/H,EAAKsR,MAAQvJ,GACX,WACFhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,6BAA8B9D,EAAW8D,QAAQ,uCAI3FrD,KAAKkS,YAAc,WAClBhB,EAAyBQ,KAAK3R,EAAKK,QAAQC,MAAMyB,KAAK,SAAUgG,GAC/D/H,EAAK2R,KAAO5J,GACV,WACFhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,qCAItFpC,IAlyOJ9B,wBAAwBgT,SAAW,SAAU,QAAS,0BAA2B,aAAc,iBAAkB,kBAAmB,iBAAkB,uBAAwB,kBAAmB,iBAAkB,WACnN3O,qBAAqB2O,SAAW,SAAU,KAAM,UAAW,0BAA2B,aAAc,YAAa,iBAAkB,iBAAkB,oBAAqB,gBAAiB,iBAAkB,aAAc,WAC3NhM,uBAAuBgM,SAAW,aAAc,aAAc,UAAW,aAAc,mBACvF5K,oBAAoB4K,SAAW,gBAAiB,iBAAkB,cAClElK,uBAAuBkK,SAAW,aAAc,UAAW,kBAAmB,iBAAkB,cAChG9J,qBAAqB8J,SAAW,aAAc,UAAW,kBAAmB,iBAAkB,cAC9F5J,oBAAoB4J,SAAW,gBAAiB,iBAAkB,cAClEhJ,sBAAsBgJ,SAAW,0BAA2B,aAAc,qBAAsB,iBAAkB,WAClHvI,oBAAoBuI,SAAW,aAAc,aAAc,UAAW,kBAAmB,kBACzFrI,oBAAoBqI,SAAW,gBAAiB,iBAAkB,cAClEhI,qBAAqBgI,SAAW,SAAU,KAAM,aAAc,UAAW,kBAAmB,gBAAiB,iBAAkB,iBAAkB,mBAAoB,cACrK3D,oBAAoB2D,SAAW,gBAAiB,iBAAkB,cAClEzD,iBAAiByD,SAAW,SAAU,aAAc,YAAa,QAAS,aAAc,WAAY,kBAAmB,mBAAoB,iBAAkB,kBAC7JpC,gBAAgBoC,SAAW,SAAU,aAAc,iBAAkB,4BAA6B,cAClGnB,4BAA4BmB,SAAW,SAAU,OAAQ,KAAM,UAAW,0BAA2B,aAAc,YAAa,iBAAkB,iBAAkB,2BAA4B,kBAAmB,iBAAkB,WAfrO5E,QAAQ6E,OAAO,eACf,eACA,YACA,YACA,gBACA,+BACA,UACA,2BACA,yBACA,aACA,8BACA,aACA,cACA,OACA,UAECC,SAAS,IAAKC,OAAOjR,GACrBgR,SAAS,oBACNE,uBACKlS,KAAM,SAAUmS,MAAO,8BAA+BC,UAAW,WACjEpS,KAAM,SAAUmS,MAAO,8BAA+BC,UAAW,WACjEpS,KAAM,SAAUmS,MAAO,8BAA+BC,UAAW,WAEtEC,gBACKrS,KAAM,SAAUmS,MAAO,gCAAiCC,UAAW,WACnEpS,KAAM,SAAUmS,MAAO,gCAAiCC,UAAW,WACnEpS,KAAM,SAAUmS,MAAO,gCAAiCC,UAAW,WACnEpS,KAAM,SAAUmS,MAAO,gCAAiCC,UAAW,WAExEE,qBACKlL,MAAO,GAAI+K,MAAO,qBAClB/K,MAAO,IAAK+K,MAAO,sBACnB/K,MAAO,IAAK+K,MAAO,sBACnB/K,MAAO,IAAK+K,MAAO,uBACnB/K,MAAO,IAAK+K,MAAO,uBACnB/K,MAAO,KAAM+K,MAAO,uBACpB/K,MAAO,KAAM+K,MAAO,uBACpB/K,MAAO,KAAM+K,MAAO,mBACpB/K,MAAO,KAAM+K,MAAO,oBACpB/K,MAAO,MAAO+K,MAAO,oBACrB/K,MAAO,MAAO+K,MAAO,oBACrB/K,MAAO,KAAO+K,MAAO,oBACrB/K,MAAO,MAAO+K,MAAO,oBACrB/K,MAAO,MAAO+K,MAAO,qBACrB/K,MAAO,MAAO+K,MAAO,kBAE1BI,2BACKnL,MAAO,EAAG+K,MAAO,yCACjB/K,MAAO,EAAG+K,MAAO,uCACjB/K,MAAO,EAAG+K,MAAO,sCACjB/K,MAAO,EAAG+K,MAAO,8CACjB/K,MAAO,EAAG+K,MAAO,wCACjB/K,MAAO,EAAG+K,MAAO,sCAEtBzD,WACK1O,KAAM,KAAMuH,QAAS,OACrBvH,KAAM,KAAMuH,QAAS,OAE1BwD,eACK3D,MAAO,EAAG+K,MAAO,uBACjB/K,MAAO,EAAG+K,MAAO,0BACjB/K,MAAO,EAAG+K,MAAO,0BACjB/K,MAAO,EAAG+K,MAAO,2BACjB/K,MAAO,EAAG+K,MAAO,sBACjB/K,MAAO,EAAG+K,MAAO,yBACjB/K,MAAO,EAAG+K,MAAO,yBACjB/K,MAAO,EAAG+K,MAAO,yBACjB/K,MAAO,EAAG+K,MAAO,wBAEtBvH,YACA4H,MAAM,kBAAmBpL,MAAM,UAAW+K,MAAM,SAChDK,MAAM,mBAAoBpL,MAAM,UAAW+K,MAAM,UACjDK,MAAM,kBAAmBpL,MAAM,UAAW+K,MAAM,SAChDK,MAAM,wBAAyBpL,MAAM,UAAW+K,MAAM,eACtDK,MAAM,uBAAwBpL,MAAM,UAAW+K,MAAM,eACrDK,MAAM,wBAAyBpL,MAAM,UAAW+K,MAAM,gBACtDK,MAAM,qBAAsBpL,MAAM,UAAW+K,MAAM,aACnDK,MAAM,2BAA4BpL,MAAM,UAAW+K,MAAM,mBACzDK,MAAM,wBAAyBpL,MAAM,UAAW+K,MAAM,gBACtDK,MAAM,mBAAoBpL,MAAM,UAAW+K,MAAM,UACjDK,MAAM,uBAAwBpL,MAAM,UAAW+K,MAAM,eACrDK,MAAM,wBAAyBpL,MAAM,UAAW+K,MAAM,gBACtDK,MAAM,2BAA4BpL,MAAM,UAAW+K,MAAM,oBACzDK,MAAM,4BAA6BpL,MAAM,UAAW+K,MAAM,qBAC1DK,MAAM,kBAAmBpL,MAAM,UAAW+K,MAAM,SAChDK,MAAM,qBAAsBpL,MAAM,UAAW+K,MAAM,YACnDK,MAAM,wBAAyBpL,MAAM,UAAW+K,MAAM,gBACtDK,MAAM,+BAAgCpL,MAAM,UAAW+K,MAAM,wBAC7DK,MAAM,kBAAmBpL,MAAM,UAAW+K,MAAM,SAChDK,MAAM,oBAAqBpL,MAAM,UAAW+K,MAAM,WAClDK,MAAM,oBAAqBpL,MAAM,UAAW+K,MAAM,WAClDK,MAAM,iBAAkBpL,MAAM,UAAW+K,MAAM,QAC/CK,MAAM,kBAAmBpL,MAAM,UAAW+K,MAAM,SAChDK,MAAM,uBAAwBpL,MAAM,UAAW+K,MAAM,cACrDK,MAAM,oBAAqBpL,MAAM,UAAW+K,MAAM,WAClDK,MAAM,oBAAqBpL,MAAM,UAAW+K,MAAM,WAClDK,MAAM,yBAA0BpL,MAAM,UAAW+K,MAAM,mBAI1DM,QAAA,qBAAA,kCAAO,SAAUC,EAAoBC,GACrCD,EAAmBE,UAAU,2BAC5BC,YAAa,uCAEdF,EAAgCG,QAAQ,QACxCJ,EAECK,+BAA+B,KAAM,OACpCC,MAAS,KACTC,MAAS,KACTC,MAAS,KACTC,MAAS,KACTC,MAAS,KACTC,MAAS,KACTC,IAAK,OAENC,iBAAiB,MACjBC,6BAGDd,EAAmBe,mBACnBf,EAAmBgB,yBAAyB,aAE5CC,QAAQ,aAAc,WACnB,GAAIlQ,MAEAsE,EAAM,SAAS6L,EAAO5T,EAAMiL,GACvBxH,EAAWmQ,KACZnQ,EAAWmQ,OAEfnQ,EAAWmQ,GAAO5T,GAAQiL,GAG1BrH,EAAM,SAASgQ,EAAO5T,GACtB,MAAMyD,GAAWmQ,IAAYnQ,EAAWmQ,GAAO5T,GACpCyD,EAAWmQ,GAAO5T,GAEzB,QAIJwN,EAAS,SAASoG,EAAO5T,GACzB,aAAcyD,GAAWmQ,GAAO5T,IAGhC6T,EAAY,SAAUD,GAC5BnQ,EAAWmQ,OAGL3P,EAAM,SAAS2P,GACf,MAAOnQ,GAAWmQ,GAGtB,QACI3P,IAAKA,EACLL,IAAKA,EACLmE,IAAKA,EACLyF,OAAQA,EACRqG,UAAWA,KAGlBF,QAAQ,iBAAkB,WACvB,GAAIG,KAEJ,OAAOA,KAEVH,QAAQ,mBAAA,YAAmB,SAAUI,GAElC,GAAIC,GAAO,SAAU7R,EAAO8R,GACxB,MAAOC,eAAgBH,EAAUC,MAC7BG,WAAW,EACXC,YAAa,uCACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,KACNC,SACIrS,MAAO,WACH,MAAOA,IAEX8R,QAAS,WACL,MAAOA,OAGhBxM,OAGP,QAAQuM,KAAMA,MAEjBL,QAAQ,gBAAA,YAAgB,SAAUI,GAE/B,GAAIC,GAAO,SAAU7R,EAAO8R,EAASQ,GACjC,MAAOP,eAAgBH,EAAUC,MAC7BG,WAAW,EACXC,YAAa,oCACbC,WAAY,gBACZC,aAAc,gBACdC,KAAM,KACNC,SACIrS,MAAO,WACH,MAAOA,IAEX8R,QAAS,WACL,MAAOA,IAEXQ,YAAa,WACT,MAAOA,OAGhBhN,OAGP,QAAQuM,KAAMA,MAEjBhE,QAAQ,4BAA6B,WAClC,GAAIxG,GAAO7J,IACX6J,GAAKsG,cAELnQ,KAAKoI,IAAM,SAAU0K,GAClBjJ,EAAK5F,IAAI6O,EAAOxM,OACpBuD,EAAKsG,WAAWjO,KAAK4Q,IAIpB9S,KAAKiE,IAAM,SAAUqC,GACvB,MAAOjF,GAAE2C,KAAK6F,EAAKsG,WAAY,SAAU4E,GACxC,MAAOA,GAAUzO,OAASA,OAK7BiH,QAAQ6E,OAAO,eACVU,QAAA,oBAAO,SAASkC,GACbA,EAAkBC,WAAU,GAAMC,WAAW,QAEhDpC,QAAA,iBAAA,qBAAO,SAAUqC,EAAgBC,GAE9BD,EACK1Q,MAAM,aACH4Q,IAAK,IACLZ,YAAa,+BACbC,WAAY,gBACZC,aAAc,kBAEjBlQ,MAAM,SACH4Q,IAAK,SACLZ,YAAa,uBACbC,WAAY,YACZC,aAAc,cAEjBlQ,MAAM,YACH4Q,IAAK,YACLZ,YAAa,6BACbC,WAAY,eACZC,aAAc,iBAEjBlQ,MAAM,WACH4Q,IAAK,WACLZ,YAAa,2BACbC,WAAY,cACZC,aAAc,gBAEjBlQ,MAAM,WACH4Q,IAAK,WACLZ,YAAa,2BACbC,WAAY,cACZC,aAAc,gBAEjBlQ,MAAM,WACH4Q,IAAK,oBACLZ,YAAa,2BACbC,WAAY,cACZC,aAAc,gBAEjBlQ,MAAM,WACH4Q,IAAK,WACLZ,YAAa,2BACbC,WAAY,cACZC,aAAc,gBAEjBlQ,MAAM,UACH4Q,IAAK,UACLZ,YAAa,yBACbC,WAAY,aACZC,aAAc,eAEjBlQ,MAAM,YACH4Q,IAAK,YACLZ,YAAa,6BACbC,WAAY,eACZC,aAAc,iBAEjBlQ,MAAM,QACH4Q,IAAK,QACLZ,YAAa,qBACbC,WAAY,WACZC,aAAc,aAEjBlQ,MAAM,cACH4Q,IAAK,cACLZ,YAAa,iCACbC,WAAY,iBACZC,aAAc,mBAGtBS,EAAmBE,UAAU,QAGrC/H,QAAQ6E,OAAO,eACVsC,WAAW,iBAgBP,SAAU,YAAa,aAAc,WAAY,UAAW,aAAc,iBAAkB,kBAAmB,eAAgB,kBAAmB,gBAAiB,iBAAkB,4BAftL,SAAStV,EAAQuP,EAAWpP,EAAYgW,EAAUzV,EAASgE,EAAYjE,EAAgBD,EAAiB4V,EAAc/V,EAAiBoE,EAAenE,EAAgBsQ,GAwClK,QAASyF,KACL5L,EAAK6L,0BACL,IAAInG,GAAU1P,EAAeuB,cACvBmO,IACF1F,EAAK8L,YAAcpG,EAAQlP,KACrBkP,EAAQqG,OAAWrG,EAAQqG,MAAMC,GAAKtG,EAAQqG,MAAMC,EAAEzT,OAAS,GACjE0T,KAGJjM,EAAK8L,YAAc,EAEvB,KAAK/H,MAAO/D,GAAKkM,iBACPlM,EAAKkM,iBAAiBnI,MACxB/D,EAAK6L,wBAAwBxT,KAAK2H,EAAKkM,iBAAiBnI,MAKpE,QAASkI,KACL,GAAIvG,GAAU1P,EAAeuB,cACvBmO,IAAaA,EAAQqG,OAAWrG,EAAQqG,MAAMC,GAChDxU,EAAEY,QAAQsN,EAAQqG,MAAMC,EAAG,SAASzV,GAC1BA,EAAQwF,OACN/F,EAAemW,eACfC,EAA4B7V,EAASA,EAAQiG,KAEzB,WAAjBjG,EAAQkG,KACf4P,EAAqB9V,EAASA,EAAQiG,KACd,cAAjBjG,EAAQkG,MAAyC,YAAjBlG,EAAQkG,KAC/C6P,EAAoB/V,EAASA,EAAQiG,KACb,cAAjBjG,EAAQkG,KACf8P,EAAsBhW,EAAQC,KAAMD,EAAQiG,KACpB,YAAjBjG,EAAQkG,KACf+P,EAAsBjW,EAASA,EAAQiG,KAChCxG,EAAeyW,gBACtBC,EAA6BnW,EAASA,EAAQiG,OAI1DwD,EAAK2M,QAAS,EAGlB,QAASP,GAA4B7V,EAASiG,GAC1C,GAAIoQ,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAIyJ,GAAI4K,EAAU,GACdzK,EAAIyK,EAAU,GACdE,EAAY,CACK,YAAjBvW,EAAQkG,MAAsC,WAAjBlG,EAAQkG,OACrCqQ,EAAY,EAEhB,IAAIC,GAAQvV,EAAE2C,KAAK6F,EAAKkM,iBAAkB,SAASc,GAC/C,MAAOA,IAAUA,EAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOjR,SAAWxF,EAAQwF,QAAUiR,EAAOxW,OAASD,EAAQC,OAE7GyW,EAAOlX,EAAgBmX,iBAAiB3W,EAAQwF,OAAQxF,EAAQkG,KAAMlG,EAAQC,KAClF,IAAMyW,EACF,GAAKF,EAiCDvV,EAAEY,QAAQ4H,EAAKkM,iBAAkB,SAASc,GAClCA,GAAUA,EAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOjR,SAAWxF,EAAQwF,QAAUiR,EAAOxW,OAASD,EAAQC,OACtGyW,EAAKlR,OAASxF,EAAQwF,OACtBkR,EAAKzW,KAAOD,EAAQC,KACpBwW,EAAOzW,QAAU0W,SArCjB,CACR,GAAIrG,GAAO,EACX,QAAQrQ,EAAQkG,MACZ,IAAK,SACDmK,EAAO,WACP,MACJ,KAAK,SACDA,EAAO,aACP,MACJ,KAAK,SACDA,EAAO,MACP,MACJ,KAAK,SACDA,EAAO,aAGfqG,EAAKlR,OAASxF,EAAQwF,OACtBkR,EAAKzW,KAAOD,EAAQC,IACpB,IACI2W,IACA1Q,KAAMlG,EAAQkG,KACdV,OAAQxF,EAAQwF,OAChBvF,KAAMD,EAAQC,KACdD,QAAS0W,EACTjL,EAAGA,EACHG,EAAGA,EACHiL,MAAO,EACPC,OAAQP,EACRtQ,IAAKA,EACLoK,KAAMA,EAEV5G,GAAKkM,iBAAiB7T,KAAK8U,KAc3C,QAASd,GAAqB9V,EAASiG,GACnC,GAAIsE,GAAM7G,EAAWG,IAAI,kBAAmB7D,EAAQC,MAChDuW,EAAQvV,EAAE2C,KAAK6F,EAAKkM,iBAAkB,SAASc,GAC/C,MAAOA,IAAUA,EAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOxW,OAASD,EAAQC,MAE7E,IAAMsK,IAAQiM,EAAO,CACjB,GAAIH,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAIyJ,GAAI4K,EAAU,GACdzK,EAAIyK,EAAU,GACdE,EAAY,EACZlG,EAAO,QAEPuG,GACA1Q,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdD,QAASuK,EACTkB,EAAGA,EACHG,EAAGA,EACHiL,MAAO,EACPC,OAAQP,EACRtQ,IAAKA,EACLoK,KAAMA,EAEV5G,GAAKkM,iBAAiB7T,KAAK8U,KAKvC,QAASb,GAAoB/V,EAASiG,GAClC,GAAIsE,IAAM,EACN8F,EAAO,GACPmG,EAAQvV,EAAE2C,KAAK6F,EAAKkM,iBAAkB,SAASc,GAC/C,MAAOA,GAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOxW,OAASD,EAAQC,MASnE,IAPqB,cAAjBD,EAAQkG,MACRqE,EAAM7G,EAAWG,IAAI,qBAAsB7D,EAAQC,MACnDoQ,EAAO,aAEP9F,EAAM7G,EAAWG,IAAI,mBAAoB7D,EAAQC,MACjDoQ,EAAO,QAEL9F,IAAQiM,EAAO,CACjB,GAAIH,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAIyJ,GAAI4K,EAAU,GACdzK,EAAIyK,EAAU,GACdE,EAA6B,cAAjBvW,EAAQkG,KAAuB,EAAI,EAE/C0Q,GACA1Q,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdD,QAASuK,EACTkB,EAAGA,EACHG,EAAGA,EACHiL,MAAO,EACPC,OAAQP,EACRtQ,IAAKA,EACLoK,KAAMA,EAEV5G,GAAKkM,iBAAiB7T,KAAK8U,KAKvC,QAASX,GAAsBjW,EAASiG,GACpC,GAAIsE,GAAMtJ,EAAE2C,KAAKnE,EAAeuB,eAAe+V,YAAa,SAASlJ,GACjE,MAAOA,GAAQ5N,OAASD,EAAQC,OAEhCuW,EAAQvV,EAAE2C,KAAK6F,EAAKkM,iBAAkB,SAASc,GAC/C,MAAOA,IAAUA,EAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOxW,OAASD,EAAQC,MAE7E,IAAMsK,IAAQiM,EAAO,CACjB,GAAIH,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAIyJ,GAAI4K,EAAU,GACdzK,EAAIyK,EAAU,GACdE,EAAY,EACZlG,EAAO,YAEPuG,GACA1Q,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdD,QAASuK,EACTkB,EAAGA,EACHG,EAAGA,EACHiL,MAAO,EACPC,OAAQP,EACRtQ,IAAKA,EACLoK,KAAMA,EAEV5G,GAAKkM,iBAAiB7T,KAAK8U,KAKvC,QAAST,GAA6BnW,EAASiG,GAC3C,GAAI+Q,GAAW/V,EAAE2C,KAAKgM,EAA0BG,WAAY,SAASC,GACjE,MAAOA,GAAO9J,OAASlG,EAAQkG,OAE/B+J,EAAUvM,EAAWG,IAAI,kBAAmB7D,EAAQkG,MACpDqE,IAAQ0F,KAAaA,EAAQjQ,SAAWiB,EAAE2C,KAAKqM,EAAQjQ,QAAS,SAASiX,GACzE,MAAOA,GAAKhX,OAASD,EAAQC,OAE7BuW,EAAQvV,EAAE2C,KAAK6F,EAAKkM,iBAAkB,SAASc,GAC/C,MAAOA,IAAUA,EAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOxW,OAASD,EAAQC,MAE7E,IAAMsK,IAAQiM,EAAO,CACjB,GAAIH,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAIyJ,GAAI4K,EAAU,GACdzK,EAAIyK,EAAU,GACdE,EAAYS,EAASE,aACrBC,EAAWH,EAASI,YACpB/G,EAAO2G,EAAS3G,KAEhBuG,GACA1Q,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdD,QAASA,EACTyL,EAAGA,EACHG,EAAGA,EACHiL,MAAOM,EACPL,OAAQP,EACRtQ,IAAKA,EACLoK,KAAMA,EAEV5G,GAAKkM,iBAAiB7T,KAAK8U,KAKvC,QAASZ,GAAsB3O,EAAOpB,GAClC,GAAIoQ,GAAYpQ,EAAIqQ,MAAM,IAC1B,IAAID,EAAUrU,QAAU,EAAG,CACvB,GAAI4J,GAAIyK,EAAU,GAEdO,GACA1Q,KAAM,YACNjG,KAAMoH,EACNoE,EAAG,EACHG,EAAGA,EACHiL,MAAO,GACPC,OAAQ,EACR7Q,IAAKA,EAETwD,GAAKkM,iBAAiB7T,KAAK8U,IAInC,QAASS,GAAsBhQ,GAC3B,GAAIuP,IACA1Q,KAAM,YACNjG,KAAMoH,EACNoE,EAAG,EACHG,EAAG,EACHiL,MAAO,GACPC,OAAQ,GAER3H,EAAU1P,EAAeuB,cACxBmO,GAAQqG,QACTrG,EAAQqG,OACJC,OAGHtG,EAAQqG,MAAMC,IACftG,EAAQqG,MAAMC,MAElBhM,EAAK6L,wBAAwBxT,KAAK8U,EAClC,IAAI9L,IACA5E,KAAM,YACNjG,KAAMoH,EACNpB,IAAK,aAETkJ,GAAQqG,MAAMC,EAAE3T,KAAKgJ,GACrBzL,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,WACnDhC,EAAQsD,KACJkD,KAAM,UACN9D,MAAOjD,EAAW8D,QAAQ,6BAC1B0D,KAAMxH,EAAW8D,QAAQ,wCAE9B,WACCvD,EAAQsD,KACJkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,6BAC1B0D,KAAMxH,EAAW8D,QAAQ,uCAqErC,QAASsU,GAAUvX,EAASwX,GACxB,GAAIA,IAAWxX,EAAQiG,IAAK,CACxB,GAAIkJ,GAAU1P,EAAeuB,cAC7B,IAAMmO,EAAS,CACNA,EAAQqG,QACTrG,EAAQqG,OACJC,OAGHtG,EAAQqG,MAAMC,IACftG,EAAQqG,MAAMC,KAElB,IAAIlL,GAAMtJ,EAAE2C,KAAKuL,EAAQqG,MAAMC,EAAG,SAASgC,GACvC,MAAOzX,GAAQiG,KAAOwR,EAAExR,KAQ5B,OANMsE,GACFA,EAAItE,IAAMuR,GAEVxX,EAAQiG,IAAMuR,EACdrI,EAAQqG,MAAMC,EAAE3T,KAAK9B,KAElB,GAGf,OAAO,EAjaX,GAAIyJ,GAAO7J,IAEXA,MAAK8X,SAAW,KAChB9X,KAAKH,eAAiBA,EACtBG,KAAK+V,oBACL/V,KAAK0V,2BACL1V,KAAK2V,YAAc,GACnB3V,KAAKwW,QAAS,EACdxW,KAAK+X,WAAY,EAEjB/X,KAAK0G,SACDsR,WAAY,IACZC,eAAgB,GAChBC,eAAe,GAGnBlY,KAAKiB,KAAO,WACR4I,EAAK2M,QAAS,EACdf,IACA5L,EAAK2G,OACDnQ,KAAM,wBACNuH,QAASrI,EAAW8D,QAAQ,yBAC5BmC,OAAQ,SAAS6D,GACbQ,EAAKsO,oBAAoB9O,OAKrCrJ,KAAKqH,WAAa,SAASC,EAAUlH,GACjCkH,EAAS9B,OAAOpF,IAGpBJ,KAAKoY,aAAe,WAChB,MAAO5C,GAAanB,KAAK9U,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,4BAA6B9D,EAAW8D,QAAQ,mCAAmCvB,KAAK,SAASgG,GACnL2P,EAAsB3P,EAAOL,UAuSrCzH,KAAKmY,oBAAsB,SAASE,GAChC,GAAI9I,GAAU1P,EAAeuB,cACvBmO,IAAaA,EAAQqG,OAAWrG,EAAQqG,MAAMC,GAChDxU,EAAEY,QAAQsN,EAAQqG,MAAMC,EAAG,SAASzV,EAASwN,GACrCxN,GAAWA,EAAQkG,OAAS+R,EAAE/R,MAAQlG,EAAQC,OAASgY,EAAEhY,MAAQgY,EAAEhS,MAAQjG,EAAQiG,KACnFkJ,EAAQqG,MAAMC,EAAEtH,OAAOX,EAAK,IAIxC,IAAIjM,GAAQkI,EAAK6L,wBAAwBpH,QAAQ+J,EACjDxO,GAAK6L,wBAAwBnH,OAAO5M,EAAO,GAC3C9B,EAAeuB,eAAiBmO,EAChC9P,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,WACnDhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAC/E,WACCvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,2BAIpFrD,KAAKsY,SAAW,SAASC,EAAOC,GACxB3O,EAAKiO,UAELvC,EAASxQ,OAAO8E,EAAKiO,UAEzBjO,EAAKiO,SAAWvC,EAAS,WACrB,IAAK1L,EAAK2M,QACF3W,EAAeyW,eAAgB,CAC/B,GAAImC,IAAU,CAed,IAdApX,EAAEY,QAAQuW,EAAO,SAASE,GACtB,GAAItY,GAAUiB,EAAE2C,KAAK6F,EAAK6L,wBAAyB,SAASmB,GACxD,MAAOA,GAAOvQ,OAASuK,EAAE6H,EAAKC,IAAIC,KAAK,kBACnC/B,EAAOxW,OAASwQ,EAAE6H,EAAKC,IAAIC,KAAK,oBAC9B/B,EAAOjR,QAAUiR,EAAOjR,SAAWiL,EAAE6H,EAAKC,IAAIC,KAAK;EAE7D,IAAMxY,EAAS,CACX,GAAIwX,GAAS,UAAYc,EAAK7M,EAAI,IAAM6M,EAAK1M,CACzC2L,GAAUvX,EAASwX,KACnBa,GAAU,EACVrY,EAAQiG,IAAMuR,MAItBa,EAAS,CACT,GAAI/C,GAA0BrU,EAAExB,EAAeuB,eAAewU,MAAMC,GAAGgD,QAAQC,OAAO,SAASjC,GAC3F,GAAIkC,GAAWlC,EAAOxQ,IAAIqQ,MAAM,IAChC,OAAOqC,GAAS,KACjBD,OAAO,SAASjC,GACf,GAAIkC,GAAWlC,EAAOxQ,IAAIqQ,MAAM,IAChC,OAAOqC,GAAS,KACjBtR,OACH5H,GAAeuB,eAAewU,MAAMC,EAAIH,EAExCjW,EAAgBiY,WAAW7X,EAAeuB,eAAef,KAAMR,EAAeuB,gBAAgBU,KAAK,WAC/FhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAC/E,WACCvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,2BAK5FwG,EAAKiO,SAAW,MACjB,MAyCP1Y,EAAOmE,IAAI,yBAA0B,WACjCsG,EAAK2M,QAAS,EACd3M,EAAKkM,oBACLN,MAGJrW,EAAOmE,IAAI,mBAAoB,WAC3BsG,EAAK2M,QAAS,EACdf,MAGJrW,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAK2M,QAAS,EACdf,MAGJrW,EAAOmE,IAAI,yBAA0B,WACjCsG,EAAK2M,QAAS,EACdf,MAGJrW,EAAOmE,IAAI,cAAe,SAASgV,EAAOS,GACxCnP,EAAKkO,WAAY,IAGnB3Y,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOS,GAC1CnP,EAAKkO,WAAY,IAGnB3Y,EAAOmE,IAAI,eAAgB,SAASgV,EAAOS,GACzCnP,EAAKkO,WAAY,IAGnB3Y,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOS,GAC1CnP,EAAKkO,WAAY,IAGnB3Y,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOS,GAC1CnP,EAAKkO,WAAY,IAGnB/X,KAAKiB,UAOjB4P,EAAEoI,GAAGrE,KAAO,WACR,MAAO5U,MAAKoC,QAGhBmL,QAAQ6E,OAAO,eACbsC,WAAW,aAgBX,SAAU,iBAfX,SAAStV,EAAQS,GAEhB,GAAIgK,GAAO7J,IAEXA,MAAKkZ,aAAe,GAEpBlZ,KAAKiB,KAAO,WACLpB,EAAeqZ,eACpBrP,EAAKqP,aAAerZ,EAAeqZ,eAIrC9Z,EAAOmE,IAAI,eAAgB,WAC1BsG,EAAK5I,SAGN4I,EAAK5I,UAIPsM,QAAQ6E,OAAO,eACVsC,WAAW,cAgBX,SAAU,aAAc,kBAAmB,kBAAmB,aAAc,iBAf7E,SAAStV,EAAQG,EAAYK,EAAiBH,EAAiBqE,EAAYjE,GAEvE,GAAIgK,GAAO7J,IAEXA,MAAKmZ,iBACLnZ,KAAKoZ,eACLpZ,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WAEjB1B,GAAY,OAAQ,SAAU,qBAAqBuC,KAAK,SAAU6L,GACjE9D,EAAKwP,gBAEHhZ,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgB2Z,UAAUlQ,EAAO,gBAIlChJ,KAAM,SACNuH,QAAS+F,EAAQE,OACjBrI,OAAQ,SAAU6D,GACjBzJ,EAAgB4Z,gBAAgBnQ,GAAOvH,KAAK,WAC3C1C,EAAO+H,WAAW,kCAKpB9G,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBA,EAAM/C,KAAS+C,EAAMqQ,UAAU,YAAY,UAC3C9Z,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAKtB0C,EAAK+P,cAEHvZ,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgB2Z,UAAUlQ,EAAO,cAIlChJ,KAAM,SACNuH,QAAS+F,EAAQE,OACjBrI,OAAQ,SAAU6D,GACjBzJ,EAAgBia,cAAcxQ,GAAOvH,KAAK,WACzC1C,EAAO+H,WAAW,gCAKpB9G,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBA,EAAM/C,KAAS+C,EAAMqQ,UAAU,YAAY,UAC3C9Z,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAMtB0C,EAAKiQ,mBACLjQ,EAAKkQ,oBAID/Z,KAAK8Z,iBAAmB,WACpB,GAAIE,GAASlW,EAAWQ,IAAI,qBAC5BuF,GAAKsP,gBACL,KAAKvL,MAAOoM,GACpBnQ,EAAKsP,cAAcjX,KAAK8X,EAAOpM,OAI3B5N,KAAK+Z,eAAiB,WAClB,GAAIC,GAASlW,EAAWQ,IAAI,mBAC5BuF,GAAKuP,cACL,KAAKxL,MAAOoM,GACpBnQ,EAAKuP,YAAYlX,KAAK8X,EAAOpM,OAIzB5N,KAAKia,cAAgB,WAC1B,GAAIC,GAAapW,EAAWQ,IAAI,qBACvB,KAAKsJ,MAAOsM,GAAY,CAChC,GAAItD,GAAQvV,EAAE2C,KAAK6F,EAAKsP,cAAe,SAAUgB,GAChD,MAAOA,GAAU9Z,OAASuN,KAGtBgJ,IACJ/M,EAAKsP,cAAcjX,KAAKgY,EAAWtM,MAI5B,IAAK,GAAIjM,GAAQkI,EAAKsP,cAAc/W,OAAS,EAAGT,GAAS,EAAGA,IAC/DmC,EAAWG,IAAI,qBAAsB4F,EAAKsP,cAAcxX,GAAOtB,OACnEwJ,EAAKsP,cAAc5K,OAAO5M,EAAO,EAInC,IAAIyY,GAAWtW,EAAWQ,IAAI,mBACrB,KAAKsJ,MAAOwM,GAAU,CAC9B,GAAIxD,GAAQvV,EAAE2C,KAAK6F,EAAKuP,YAAa,SAAUiB,GAC9C,MAAOA,GAAQha,OAASuN,KAGpBgJ,IACJ/M,EAAKuP,YAAYlX,KAAKkY,EAASxM,MAIxB,IAAK,GAAIjM,GAAQkI,EAAKuP,YAAYhX,OAAS,EAAGT,GAAS,EAAGA,IAC7DmC,EAAWG,IAAI,mBAAoB4F,EAAKuP,YAAYzX,GAAOtB,OAC/DwJ,EAAKuP,YAAY7K,OAAO5M,EAAO,IAK5B3B,KAAKsa,SAAW,WACrB1a,EAAgB2Z,UAAU,OAGrBna,EAAOmE,IAAI,4BAA6B,WACpCsG,EAAKiQ,qBAGT1a,EAAOmE,IAAI,0BAA2B,WAClCsG,EAAKkQ,mBAGT3a,EAAOmE,IAAI,wBAAyB,WAChCsG,EAAKoQ,kBAGTja,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,SAAU,KAAM,oBAAqB,aAAc,UAAW,mBAAoB,gBAAiB,aAfpG,SAAStV,EAAQqE,EAAI8W,EAAmBhb,EAAYO,EAAS0a,EAAkBC,EAAe3W,GAmF1F,QAAS7C,MAlFT,GAAI4I,GAAO7J,IAEXA,MAAK0a,WAAa5W,EAAWQ,IAAI,iBACjCtE,KAAK2a,cAAgB7W,EAAWQ,IAAI,oBACpCtE,KAAK4a,cAAgB9W,EAAWQ,IAAI,oBACpCtE,KAAK6a,YAAa,EAClB7a,KAAK8a,WAAY,EACjB9a,KAAK+a,WAAY,EACjB/a,KAAKgb,cAAe,EACpBhb,KAAKib,cAAe,EACpBjb,KAAKkb,oBAAqB,EAC1Blb,KAAKmb,cAAe,EACpBnb,KAAKob,cACV/a,KAAM,GACNgb,YAAa,GACbC,kBAEAC,eACCC,QACAC,UAIF5R,EAAK2G,OAEHnQ,KAAM,OACNuH,QAASrI,EAAW8D,QAAQ,kBAC5BmC,OAAQ,WACPqE,EAAK6R,kBAINrb,KAAM,OACNuH,QAASrI,EAAW8D,QAAQ,kBAC5BmC,OAAQ,WACPqE,EAAK8R,kBAKR9R,EAAKxC,WAAa,SAASC,EAAUlH,GACpCkH,EAAS9B,OAAOpF,IAGjBJ,KAAK4b,cACJxb,QAAS,GACTyb,SAAU,GACVpU,MAAO,IAGRzH,KAAK8b,iBACJzb,KAAM,GACN0b,OAAQ,GACR1G,IAAK,GACLtO,KAAM,GACNiV,iBAGDhc,KAAKic,uBACJrO,IAAK,GACLnG,MAAO,IAERzH,KAAKkc,kBAAoB,GACzBlc,KAAKmc,4BAA8B,MAEnCnc,KAAKoc,iBACJ/b,KAAM,GACNgc,KAAM,GACNC,KAAM,EACNC,KAAK,EACLC,UAAU,EACVC,KAAM,GACNC,SAAU,GACVzP,KAAM,GACN0P,GAAI,GACJC,GAAI,GACJC,IAAK,GACLC,QAAS,GACT/V,KAAM,IAEP/G,KAAK+c,kBAAoB,GAKzB3d,EAAOmE,IAAI,eAAgB,WAC1BsG,EAAK6Q,WAAa5W,EAAWQ,IAAI,iBACjCuF,EAAKmT,UAAYlZ,EAAWQ,IAAI,kBAG3BtE,KAAKid,UAAY,WACtBpT,EAAKgR,YAAa,EAClBhR,EAAKiR,WAAY,EACjBjR,EAAKuR,cACJ/a,KAAM,GACNgb,YAAa,GACbC,kBAEAC,eACCC,QACAC,WAKHzb,KAAKkd,UAAY,WAChBrT,EAAKkR,WAAY,GAGlB/a,KAAKmd,cAAgB,WACpB,QAAStT,EAAK+R,aAAaxb,WAAayJ,EAAK+R,aAAaC,YAAchS,EAAK+R,aAAanU,OAG3FzH,KAAKod,aAAe,WACe,aAA9BvT,EAAK+R,aAAaxb,UACrByJ,EAAK+R,aAAanU,MAAQ4V,SAASxT,EAAK+R,aAAanU,QAEtDoC,EAAKuR,aAAaE,eAAepZ,KAAK2H,EAAK+R,cAC3C/R,EAAK+R,cACJxb,QAAS,GACTyb,SAAU,GACVpU,MAAO,IAERoC,EAAKkR,WAAY,GAGlB/a,KAAKsd,aAAe,SAAU3b,GAC7BkI,EAAKuR,aAAaE,eAAe/M,OAAO5M,EAAO,IAGhD3B,KAAKud,gBAAkB,WACtB1T,EAAKkR,WAAY,GAGlB/a,KAAKwd,iBAAmB,SAAUpd,GACjC,MAAOb,GAAW8D,QAAQ,iBAAmBjD,IAG9CJ,KAAKyd,kBAAoB,SAAU5B,GAClC,OAAQA,GACP,IAAK,IACJ,MAAOtc,GAAW8D,QAAQ,wBAE3B,KAAK,KACJ,MAAO9D,GAAW8D,QAAQ,4BAE3B,KAAK,IACJ,MAAO9D,GAAW8D,QAAQ,wBAE3B,KAAK,KACJ,MAAO9D,GAAW8D,QAAQ,8BAE3B,KAAK,IACJ,MAAO9D,GAAW8D,QAAQ,yBAE3B,KAAK,KACJ,MAAO9D,GAAW8D,QAAQ,+BAE3B,KAAK,WACJ,MAAO9D,GAAW8D,QAAQ,2BAE3B,KAAK,cACJ,MAAO9D,GAAW8D,QAAQ,iCAK7BrD,KAAK0d,eAAiB,SAAUC,GAC/B,GAAuB,aAAnBA,EAAOvd,QAmBV,MAAOud,GAAOlW,KAlBd,QAAQkW,EAAOlW,OACd,IAAK,GACJ,MAAOlI,GAAW8D,QAAQ,qBAE3B,KAAK,GACJ,MAAO9D,GAAW8D,QAAQ,oBAE3B,KAAK,GACJ,MAAO9D,GAAW8D,QAAQ,uBAE3B,KAAK,GACJ,MAAO9D,GAAW8D,QAAQ,qBAE3B,KAAK,GACJ,MAAO9D,GAAW8D,QAAQ,4BAQ9BrD,KAAK0b,aAAe,WACnB7R,EAAKmR,cAAe,GAGrBhb,KAAK2b,aAAe,WACnB9R,EAAKoR,cAAe,GAGrBjb,KAAK4d,iBAAmB,WACvB,GAAM/T,EAAKkT,kBACV,OAAO,CAER,IAAInG,GAAQvV,EAAE2C,KAAK6F,EAAK8Q,cAAe,SAAUkD,GAChD,MAAOA,GAAMxd,OAASwJ,EAAKuS,gBAAgB/b,MAE5C,QAAIuW,MAGK/M,EAAKuS,gBAAgB/b,MAC1BwJ,EAAKuS,gBAAgBC,MACrBxS,EAAKuS,gBAAgBnP,MACrBpD,EAAKuS,gBAAgBO,IACrB9S,EAAKuS,gBAAgBU,SACrBjT,EAAKuS,gBAAgBrV,OAG1B/G,KAAK8d,mBAAqB,WACzBjU,EAAKmR,cAAe,GAGrBhb,KAAK+d,iBAAmB,WACjBlU,EAAKkT,mBACVlT,EAAKuR,aAAaG,cAAcC,KAAKtZ,KAAK2H,EAAKkT,kBAAkB1c,MACjEwJ,EAAKkT,kBAAoB,GACzBlT,EAAKmR,cAAe,GAEpBP,EAAcuD,SAAS,OAAQnU,EAAKuS,iBAAiBta,KAAK,WACzD+H,EAAKuR,aAAaG,cAAcC,KAAKtZ,KAAK2H,EAAKuS,gBAAgB/b,MAC/DyD,EAAWsE,IAAI,mBAAoByB,EAAKuS,gBAAgB/b,KAAMwJ,EAAKuS,iBACnEtc,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,4BAC5EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,4BACxE,WAAW,WACbwG,EAAKuS,iBACJ/b,KAAM,GACNgc,KAAM,GACNC,KAAM,EACNC,KAAK,EACLC,UAAU,EACVC,KAAM,GACNC,SAAU,GACVzP,KAAM,GACN0P,GAAI,GACJG,QAAS,GACT/V,KAAM,IAEP8C,EAAKmR,cAAe,KAKvBhb,KAAKie,mBAAqB,WACzBpU,EAAKqR,oBAAqB,GAG3Blb,KAAKke,yBAA2B,WAC/BrU,EAAKqR,oBAAqB,GAG3Blb,KAAKme,sBAAwB,WAC5BtU,EAAKiS,gBAAgBE,aAAa9Z,KAAK2H,EAAKoS,uBAC5CpS,EAAKoS,uBACJrO,IAAK,GACLnG,MAAO,IAERoC,EAAKqR,oBAAqB,GAG3Blb,KAAKoe,iBAAmB,WACvB,GAAMvU,EAAKqS,kBACV,OAAO,CAER,IAAItF,GAAQvV,EAAE2C,KAAK6F,EAAK+Q,cAAe,SAAUiD,GAChD,MAAOA,GAAMxd,OAASwJ,EAAKiS,gBAAgBzb,MAE5C,QAAIuW,MAGK/M,EAAKiS,gBAAgBzb,OACzBwJ,EAAKiS,gBAAgBC,SAAYlS,EAAKsS,8BACvCtS,EAAKiS,gBAAgBzG,MAG1BrV,KAAKqe,iBAAmB,WACjBxU,EAAKqS,mBACVrS,EAAKuR,aAAaG,cAAcE,KAAKvZ,KAAK2H,EAAKqS,kBAAkB7b,MACjEwJ,EAAKqS,kBAAoB,GACzBrS,EAAKoR,cAAe,IAEqB,WAArCpR,EAAKsS,8BACRtS,EAAKiS,gBAAgBC,OAASlS,EAAKsS,6BAEpC1B,EAAcuD,SAAS,OAAQnU,EAAKiS,iBAAiBha,KAAK,WACzD+H,EAAKuR,aAAaG,cAAcE,KAAKvZ,KAAK2H,EAAKiS,gBAAgBzb,MAC/DyD,EAAWsE,IAAI,mBAAoByB,EAAKiS,gBAAgBzb,KAAMwJ,EAAKiS,iBACnEhc,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,4BAC5EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,4BACxE,WAAW,WACbwG,EAAKoS,uBACJrO,IAAK,GACLnG,MAAO,IAERoC,EAAKiS,iBACJzb,KAAM,GACN0b,OAAQ,GACR1G,IAAK,GACLtO,KAAM,GACNiV,iBAGDnS,EAAKoR,cAAe,EACpBpR,EAAKqR,oBAAqB,MAK7Blb,KAAKse,mBAAqB,WACzBzU,EAAKoR,cAAe,GAGrBjb,KAAKue,YAAc,SAAUjY,EAAM3E,GAClCkI,EAAKuR,aAAaG,cAAcjV,GAAMiI,OAAO5M,EAAO,IAGrD3B,KAAKwe,cAAgB,WACpB,QAAS3U,EAAKuR,aAAa/a,MAAQwJ,EAAKuR,aAAaE,eAAelZ,OAAS,GAG9EpC,KAAKye,gBAAkB,WACtB5U,EAAKgR,YAAa,EAClBhR,EAAKiR,WAAY,GAGlB9a,KAAK0e,cAAgB,WACpB,GAAIC,GAAU,IAEbA,GADG9U,EAAKiR,UACEL,EAAcK,UAAUjR,EAAKuR,cAE7BX,EAAcmE,UAAU/U,EAAKuR,aAAa/a,KAAMwJ,EAAKuR,cAEhEuD,EAAQ7c,KAAK,WACZgC,EAAWsE,IAAI,gBAAiByB,EAAKuR,aAAa/a,KAAMwJ,EAAKuR,cAC7Dtb,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,6BAC7EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,6BACzE,WAAW,WACbwG,EAAKgR,YAAa,EAClBhR,EAAKiR,WAAY,KAInB9a,KAAK6e,mBAAqB,SAAUrY,GACnCiU,EAAcqE,aAAatY,EAAOnG,MAAMyB,KAAK,WAC5CgC,EAAW+J,OAAO,gBAAiBrH,EAAOnG,MAC1CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,+BAC7EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,gCAI7ErD,KAAK+e,iBAAmB,SAAUvY,GACjCqD,EAAKuR,aAAe5U,EACpBqD,EAAKgR,YAAa,EAClBhR,EAAKiR,WAAY,GAGlB9a,KAAKgf,WAAa,WACjBnV,EAAKsR,cAAe,GAGrBnb,KAAKif,YAAc,WAClBpV,EAAKsR,cAAe,GAGrBnb,KAAKkf,gBAAkB,SAAUrB,GAChCpD,EAAc8D,YAAY,OAAQV,EAAMxd,MAAMyB,KAAK,WAClDgC,EAAW+J,OAAO,mBAAoBgQ,EAAMxd,MAC5CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,8BAC5EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAI5ErD,KAAKmf,gBAAkB,SAAUtB,GAChCpD,EAAc8D,YAAY,OAAQV,EAAMxd,MAAMyB,KAAK,WAClDgC,EAAW+J,OAAO,mBAAoBgQ,EAAMxd,MAC5CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,8BAC5EjE,EAAO+H,WAAW,iBAChB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAI5ErD,KAAKof,MAAQ,WACZ7E,EAAkB6E,MAAM,OAGnBne,OAIRsM,QAAQ6E,OAAO,eACVsC,WAAW,YAgBX,SAAU,aAAc,YAAa,UAAW,mBAAoB,gBAAiB,aAftF,SAAStV,EAAQG,EAAY6U,EAAWtU,EAAS0a,EAAkBC,EAAe3W,GAE9E,GAAI+F,GAAO7J,IAEXA,MAAKqf,eACLrf,KAAK0a,cACL1a,KAAK0G,WAEL1G,KAAKsf,eACVC,MAAO,GACP5e,OAAQ,GAGTvB,EAAOmE,IAAI,eAAgB,WAC1BsG,EAAK2V,aACL3V,EAAKsF,WAGAnP,KAAKiB,KAAO,WACb1B,EAAWuP,QACdjF,EAAKnD,QAAU8T,EAAiBiF,aAC3BC,mBAAmB,mCAAmCngB,EAAWuP,MAAM,SACvE6Q,WAAW,SAAU,EAAG,SAC7B9V,EAAK2V,aACL3V,EAAKsF,WAKPnP,KAAK4f,YAAc,SAAUtL,GAC5B,OAAQA,EAAQuL,UACf,IAAK,OACJ,MAAOtgB,GAAW8D,QAAQ,qBAE3B,KAAK,MACJ,MAAO9D,GAAW8D,QAAQ,oBAE3B,KAAK,SACJ,MAAO9D,GAAW8D,QAAQ,uBAE3B,KAAK,OACJ,MAAO9D,GAAW8D,QAAQ,qBAE3B,KAAK,WACJ,MAAO9D,GAAW8D,QAAQ,yBAE3B,SACC,MAAO9D,GAAW8D,QAAQ,6BAK7BrD,KAAKmP,OAAS,WACTtF,EAAKyV,cAAcC,MAAQ,GAAK1V,EAAKyV,cAAc3e,QAAU,EAC1DkJ,EAAKyV,cAAc9Y,OACxBiU,EAAcqF,oBAAoBjW,EAAKyV,cAAc9Y,OAAOnG,KAAMwJ,EAAKyV,cAAcC,MAAO1V,EAAKyV,cAAc3e,QAAQmB,KAAK,SAAUgG,GACrI+B,EAAKwV,YAAcvX,IAGpB2S,EAAcsF,eAAelW,EAAKyV,cAAcC,MAAO1V,EAAKyV,cAAc3e,QAAQmB,KAAK,SAAUgG,GAChG+B,EAAKwV,YAAcvX,IAIrBhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,uBAI7ErD,KAAKwf,WAAa,WACjB3V,EAAK6Q,WAAa5W,EAAWQ,IAAI,kBAGlCtE,KAAKggB,iBAAmB,WACH5L,EAAUC,MAC7BG,WAAW,EACXC,YAAa,8BACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,QAIRxV,EAAOmE,IAAI,aAAc,WACxBsG,EAAKnD,QAAU8T,EAAiBiF,aAC3BC,mBAAmB,mCAAmCngB,EAAWuP,MAAM,WAGvE9O,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,eAgBX,SAAU,aAAc,kBAAmB,kBAAmB,aAAc,iBAf7E,SAAStV,EAAQG,EAAYK,EAAiBH,EAAiBqE,EAAYjE,GAEvE,GAAIgK,GAAO7J,IAEXA,MAAKigB,cACLjgB,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WACf1B,GAAY,OAAQ,UAAW,kBAAmB,qBAAqBuC,KAAK,SAAU6L,GACrF9D,EAAKqW,aAEH7f,KAAM,OACNuH,QAASrI,EAAW8D,QAAQ,QAC5BmC,OAAQ,SAAU6D,GACjBzJ,EAAgBugB,WAAW9W,MAI5BhJ,KAAM,SACNuH,QAASrI,EAAW8D,QAAQ,UAC5BmC,OAAQ,SAAU6D,GACjBzJ,EAAgBwgB,aAAa/W,GAAOvH,KAAK,WACxC1C,EAAO+H,WAAW,+BAKpB9G,KAAM,kBACNuH,QAASrI,EAAW8D,QAAQ,mBAC5BmC,OAAQ,SAAU6D,GACjBzJ,EAAgBygB,cAAchX,MAI/BhJ,KAAM,mBACNuH,QAASrI,EAAW8D,QAAQ,oBAC5BmC,OAAQ,SAAU6D,GACjBA,EAAM/C,KAAO,SACb1G,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAKtB0C,EAAKyW,mBAIHlhB,EAAOmE,IAAI,yBAA0B,WACjCsG,EAAKyW,kBAGTtgB,KAAKsgB,cAAgB,WACjB,GAAI/Z,GAAUzC,EAAWQ,IAAI,kBAC7BuF,GAAKoW,aACL,KAAKrS,MAAOrH,GACpBsD,EAAKoW,WAAW/d,KAAKqE,EAAQqH,OAIzBxO,EAAOmE,IAAI,yBAA0B,WACjCsG,EAAK0W,mBAGTvgB,KAAKugB,eAAiB,WACzB,GAAIha,GAAUzC,EAAWQ,IAAI,kBAC1B,KAAKsJ,MAAOrH,GAAS,CACvB,GAAIqQ,GAAQvV,EAAE2C,KAAK6F,EAAKoW,WAAY,SAAUxZ,GAC7C,MAAOA,GAAOpG,OAASuN,KAGnBgJ,IACJ/M,EAAKoW,WAAW/d,KAAKqE,EAAQqH,MAI5B,IAAK,GAAIjM,GAAQkI,EAAKoW,WAAW7d,OAAS,EAAGT,GAAS,EAAGA,IACtDmC,EAAWG,IAAI,kBAAmB4F,EAAKoW,WAAWte,GAAOtB,OAC7DwJ,EAAKoW,WAAW1R,OAAO5M,EAAO,IAK7B3B,KAAKwgB,UAAY,WACpB5gB,EAAgBugB,WAAW,OAGxBngB,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,kBAgBX,SAAU,aAAc,KAAM,YAAa,aAAc,WAAY,UAAW,UAAW,kBAAmB,gBAAiB,iBAAkB,aAAc,kBAAmB,iBAfnL,SAAStV,EAAQgH,EAAY3C,EAAIkL,EAAWpP,EAAYqP,EAAUlL,EAAS5D,EAASL,EAAiBoE,EAAenE,EAAgBoE,EAAY2c,EAAiB5gB,GAEnK,GAAIgK,GAAO7J,IAEXA,MAAK0gB,WAEL1gB,KAAK2gB,cACL3gB,KAAK4gB,eACL5gB,KAAK6gB,sBACL7gB,KAAK8gB,aAAc,EACnB9gB,KAAK+gB,eAAgB,EAErB/gB,KAAKghB,cAAgB,GACrBhhB,KAAKihB,qBAAuB,GAC5BjhB,KAAKkhB,cAAgB,GACrBlhB,KAAKmhB,kBAAmB,EAExBnhB,KAAKohB,oBACLphB,KAAKqhB,yBAA0B,EAE/BrhB,KAAKshB,eACLthB,KAAKoB,gBAAiB,EACtBpB,KAAKuhB,cAAe,EAEpBvhB,KAAKkQ,eAELlQ,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WACNpB,EAAe2hB,UACnB7S,EAAU8S,KAAK,UAGhB5X,EAAK6W,WAAa5c,EAAWQ,IAAI,cACjCuF,EAAK8W,WAAa7c,EAAWQ,IAAI,iBACjCuF,EAAK6X,kBACL7X,EAAKqG,YAAcpM,EAAWQ,IAAI,mBAClCuF,EAAKgF,aAAetP,EAAWuP,MAC/BjF,EAAKyX,YAAczhB,EAAemP,SAClCnF,EAAKzI,eAAiBvB,EAAeuB,gBAGtChC,EAAOmE,IAAI,oBAAqB,WAC/BsG,EAAK6W,WAAa5c,EAAWQ,IAAI,gBAGlClF,EAAOmE,IAAI,uBAAwB,WAClCsG,EAAK8W,WAAa7c,EAAWQ,IAAI,mBAGlClF,EAAOmE,IAAI,2BAA4B,WACtCsG,EAAK6X,oBAGNtiB,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKqG,YAAcpM,EAAWQ,IAAI,qBAGnCtE,KAAK2hB,UAAY,WAChB9X,EAAKiX,aAAc,GAGpB9gB,KAAK4hB,cAAgB,WACpB,IAAK/X,EAAKmX,eAAiBnX,EAAKmX,cAAc5e,OAAS,GACtD,OAAO,CAGR,KAAK,GAAI/B,KAAQwJ,GAAK8W,WACrB,GAAI9W,EAAKmX,gBAAkB3gB,EAC1B,OAAO,CAIT,KAAKwJ,EAAKoX,sBAAwBpX,EAAKoX,qBAAuB,IAC7D,OAAO,CAGR,KAAKpX,EAAKqX,cACT,OAAO,CAGR,KAAK,GAAItT,KAAO/D,GAAKuX,iBAAkB,CACtC,GAAIS,GAAShY,EAAKuX,iBAAiBxT,EAEnC,KAAKiU,EAAOC,WAAaD,EAAOpa,MAC/B,OAAO,EAIT,OAAO,GAGRzH,KAAK+hB,cAAgB,WAEpB,GAAIC,KACJ3gB,GAAEY,QAAQ4H,EAAKuX,iBAAkB,SAAUS,GACtB,YAAhBA,EAAOvb,KACV0b,EAAWH,EAAOxhB,QAAUwhB,EAAOpa,MACT,YAAhBoa,EAAOvb,KACjB0b,EAAWH,EAAOxhB,MAAQ4J,WAAW4X,EAAOpa,OAE5Cua,EAAWH,EAAOxhB,MAAQwhB,EAAOpa,OAGnC,IAAI+C,GAAaX,EAAKmX,aACtBnd,GAAc8d,WAAWthB,KAAMmK,EAAY5C,QAASiC,EAAKmX,cAAe3F,YAAaxR,EAAKoX,qBAAsB9Y,SAAS,EAAM8Z,SAAUpY,EAAKqX,cAAexa,QAASsb,IAAalgB,KAAK,SAAUC,GAC7L8H,EAAKsX,iBACRtX,EAAKqY,eAAe7hB,KAAMmK,EAAYuN,WAAW,IAAOjW,KAAK,SAASgG,GACrEhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,yBAG7EvD,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,wBAE3E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,uBACxE,WAAW,WACbwG,EAAKiX,aAAc,EACnBjX,EAAK8W,WAAa7c,EAAWQ,IAAI,iBACjCuF,EAAKmX,cAAgB,GACrBnX,EAAKoX,qBAAuB,GAC5BpX,EAAKqX,cAAgB,GACrBrX,EAAKsX,kBAAmB,EACxBtX,EAAKuX,oBACLhb,EAAWe,WAAW,mBAIxBnH,KAAKmiB,gBAAkB,WACtBtY,EAAKiX,aAAc,EACnBjX,EAAKmX,cAAgB,GACrBnX,EAAKoX,qBAAuB,GAC5BpX,EAAKqX,cAAgB,GACrBrX,EAAKuX,qBAGNphB,KAAKoiB,iBAAmB,WACjBvY,EAAKqX,eACVrX,EAAKuX,iBAAmB/f,EAAE2C,KAAK6F,EAAK+W,YAAa,SAASta,GAAQ,MAAOA,GAAK+b,MAAQxY,EAAKqX,gBAAkBxa,QAC7GmD,EAAKwX,yBAA0B,GAE/BxX,EAAKwX,yBAA0B,GAIjCrhB,KAAKkiB,cAAgB,SAAUtc,GAC9B,MAAIA,GAAOmS,UACHlU,EAAcqe,cAActc,EAAOvF,MAAMyB,KAAK,SAAUC,GAC9D8B,EAAcye,kBAAkB1c,EAAOvF,MAAMyB,KAAK,SAAUgG,GAC3DhE,EAAWG,IAAI,gBAAiB2B,EAAOvF,MAAMD,QAAU0H,EACvDhI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,4BAC9E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,4BAE7E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,yBAC9EuC,EAAOmS,WAAY,IAGblU,EAAc0e,iBAAiB3c,EAAOvF,MAAMyB,KAAK,SAAUC,GACjEjC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,6BACnF,IAAImf,GAAY1e,EAAWG,IAAI,gBAAiB2B,EAAOvF,KACjDmiB,KACLA,EAAUpiB,aAET,SAAU8G,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,4BACjFuC,EAAOmS,WAAY,KAKtB/X,KAAKyiB,WAAa,SAAU7c,GAC3BA,EAAO8c,eAAiB9c,EAAOyV,YAC/BzV,EAAO+c,QAAS,EAChB9Y,EAAKkX,eAAgB,EACrBlX,EAAKwX,yBAA0B,EAC/BxX,EAAKuX,iBAAmB/f,EAAE2C,KAAK6F,EAAK+W,aAAcyB,IAAKzc,EAAOqc,WAAWvb,QACzEmD,EAAKqX,cAAgBtb,EAAOqc,SAC5B5gB,EAAEY,QAAQ4H,EAAKuX,iBAAkB,SAAUS,GAC1CA,EAAOpa,MAAQ7B,EAAOc,QAAQmb,EAAOxhB,SAIvCL,KAAK4iB,WAAa,SAAUhd,GAC3BA,EAAOyV,YAAczV,EAAO8c,eAC5BrhB,EAAEY,QAAQ4H,EAAKuX,iBAAkB,SAAUS,GAC1Cjc,EAAOc,QAAQmb,EAAOxhB,MAAQwhB,EAAOpa,QAGtC5D,EAAcgf,UAAUjd,GAAQ9D,KAAK,SAAUC,GAC9CjC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC3E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBACzE,WAAW,WACbwG,EAAKkX,eAAgB,EACrBlX,EAAKwX,yBAA0B,EAC/BxX,EAAKuX,oBACLxb,EAAO+c,QAAS,KAIlB3iB,KAAK8iB,iBAAmB,SAAUld,GACjCA,EAAO8c,eAAiB9c,EAAOyV,YAC/BxR,EAAKkX,eAAgB,EACrBlX,EAAKwX,yBAA0B,EAC/BxX,EAAKuX,oBACLxb,EAAO+c,QAAS,GAGjB3iB,KAAK+iB,aAAe,SAAUnd,GAC7B6a,EAAgBpM,KAAK9U,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,0BAA0BvB,KAAM,SAASgG,GACrHjE,EAAckf,aAAand,EAAOvF,MAAMyB,KAAK,SAAUC,GACtD+B,EAAW+J,OAAO,gBAAiBjI,EAAOvF,MAC1CwJ,EAAK8W,WAAa7c,EAAWQ,IAAI,iBACjCxE,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,2BAC7E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,6BAKhFrD,KAAK0hB,gBAAkB,WACtB7X,EAAK+W,YAAc9c,EAAWQ,IAAI,qBAClCuF,EAAKgX,mBAAqBxf,EAAEmF,OAAO1C,EAAWQ,IAAI,sBAAuB6D,SAAS,IAClF9G,EAAEY,QAAQ4H,EAAK+W,YAAa,SAAUta,GACrC/G,EAAW+G,EAAK+b,IAAM,gBAAgBvgB,KAAK,SAASkhB,GACnD1c,EAAK0c,UAAYA,GACf,SAAU9b,GACZZ,EAAK0c,UAAY1c,EAAKjG,UAKzBL,KAAKijB,wBAA0B,WAC9Bpf,EAAcqf,oBAAoBphB,KAAK,SAAUgG,GAChDhE,EAAWoQ,UAAU,qBACrB7S,EAAEY,QAAQ6F,EAAQ,SAAUqb,GAC3Brf,EAAWsE,IAAI,oBAAqB+a,EAAWd,IAAKc,KAErDtZ,EAAK6X,kBACLtb,EAAWe,WAAW,cAIxBnH,KAAKojB,sBAAwB,WAC5B1jB,EAAe2jB,oBAAoBvhB,KAAK,SAAUgG,GACjDhE,EAAWoQ,UAAU,kBACrB,KAAKtG,MAAO9F,GACXzG,EAAEY,QAAQ6F,EAAO8F,KAAKxN,QAAS,SAAUA,GACxCA,EAAQkG,KAAOwB,EAAO8F,KAAKvN,OAE5ByD,EAAWsE,IAAI,kBAAmBN,EAAO8F,KAAKvN,KAAMyH,EAAO8F,KAE5DxH,GAAWe,WAAW,cAIxBnH,KAAKsjB,gBAAkB,SAAS7Q,GAC/B,MAAOgO,GAAgBpM,KAAK9U,EAAW8D,QAAQ,0BAA2B9D,EAAW8D,QAAQ,mCAAmCvB,KAAK,WAClH,WAAd2Q,EACHhT,EAAgB8jB,gBAAgB9Q,EAAW5I,EAAK6W,WAAW8C,OAAOrb,SAASrG,KAAK,SAAUC,GACzFlC,EAAemW,cAAgBnM,EAAK6W,WAAW8C,OAAOrb,QACtD/B,EAAWe,WAAW,qBACtBf,EAAWe,WAAW,oBAClB0C,EAAK6W,WAAW8C,OAAOrb,QAC1B/B,EAAWe,WAAW,gBAEtBf,EAAWe,WAAW,eAEvBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAC1E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,8BAEnD,YAAdoP,EACVhT,EAAgB8jB,gBAAgB9Q,EAAW5I,EAAK6W,WAAWnf,QAAQ4G,SAASrG,KAAK,SAAUC,GAC1FlC,EAAeyW,eAAiBzM,EAAK6W,WAAWnf,QAAQ4G,QACxD/B,EAAWe,WAAW,qBACtBf,EAAWe,WAAW,oBAClB0C,EAAK6W,WAAWnf,QAAQ4G,QAC3B/B,EAAWe,WAAW,iBAEtBf,EAAWe,WAAW,gBAEvBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAC1E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,8BAEnD,WAAdoP,GACVhT,EAAgB8jB,gBAAgB9Q,EAAW5I,EAAK6W,WAAW+C,OAAOtb,SAASrG,KAAK,SAAUC,GACzFlC,EAAe6jB,cAAgB7Z,EAAK6W,WAAW+C,OAAOtb,QACtD/B,EAAWe,WAAW,qBACtBf,EAAWe,WAAW,oBAClB0C,EAAK6W,WAAW+C,OAAOtb,QAC1B/B,EAAWe,WAAW,gBAEtBf,EAAWe,WAAW,eAEvBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAC1E,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,cAAe9D,EAAW8D,QAAQ,+BAG1E,WACFwG,EAAK6W,WAAWjO,GAAWtK,SAAW0B,EAAK6W,WAAWjO,GAAWtK,WAInEnI,KAAK2jB,WAAa,WACjB9Z,EAAK+Z,eAAiB,GACtB/Z,EAAKga,sBAAwB,GAC7Bha,EAAKia,mBAAoB,EACzBja,EAAK0X,cAAe,GAGrBvhB,KAAK+jB,iBAAmB,WACvBla,EAAK0X,cAAe,GAGrBvhB,KAAKgkB,eAAiB,WACrB,GAAIlc,GAAS+B,EAAK+Z,eAAexhB,OAAS,CAM1C,OALAf,GAAEY,QAAQ4H,EAAKyX,YAAa,SAAU/R,GACjCA,EAAQlP,OAASwJ,EAAK+Z,iBACzB9b,GAAS,KAGJA,GAGR9H,KAAKikB,eAAiB,WACrB,GAAIC,IAAc7jB,KAAMwJ,EAAK+Z,eAAgBvI,YAAaxR,EAAKga,sBAAuBM,UAASta,EAAKia,kBACpGrkB,GAAgBiY,WAAW7N,EAAK+Z,eAAgBM,GAAYpiB,KAAK,WAChEhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,yBAC1EjE,EAAO+H,WAAW,0BAClB0C,EAAKyX,YAAYpf,KAAKgiB,IACpB,SAAUhd,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,yBACtE,WAAW,WACbwG,EAAK0X,cAAe,KAItBvhB,KAAKokB,cAAgB,SAAU7U,GAC9BkR,EAAgBpM,KAAK9U,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAA2BvB,KAAM,SAASgG,GACvHrI,EAAgB2kB,cAAc7U,EAAQlP,MAAMyB,KAAK,WAChDhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,4BAC1EjE,EAAO+H,WAAW,0BAClB9F,EAAEwM,OAAOhE,EAAKyX,YAAa,SAAU+C,GACpC,MAAO9U,GAAQlP,OAASgkB,EAAWhkB,QAElC,SAAU6G,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,+BAK3ErD,KAAKskB,aAAe,SAAU/U,GAC7BkR,EAAgBpM,KAAK9U,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,0BAA0BvB,KAAM,SAASgG,GACrH,GAAIwc,IAAgBjkB,KAAMkP,EAAQlP,KAAMgb,YAAa9L,EAAQ8L,YAAa8I,UAAS5U,EAAAA,WACnF9P,GAAgBiY,WAAWnI,EAAQlP,KAAMikB,GAAcxiB,KAAK,SAAUgG,GACrE,IAAK8F,MAAO/N,GAAemP,SACtBnP,EAAemP,SAASpB,KAAKvN,OAASikB,EAAajkB,OACtDR,EAAemP,SAASpB,KAAO0W,EAG7BzkB,GAAeuB,eAAef,OAASikB,EAAajkB,OACvDR,EAAeuB,eAAiBkjB,GAEjCllB,EAAO+H,WAAW,0BAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,0BAC1EkM,EAAU+U,GACR,SAAUpd,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,6BAK3ErD,KAAKukB,YAAc,SAAUhV,GAC5BA,EAAQoT,QAAS,EACjBpT,EAAQiV,QAAUjV,EAAQlP,KAC1BkP,EAAQmT,eAAiBnT,EAAQ8L,aAGlCrb,KAAKykB,kBAAoB,SAAUlV,GAClCA,EAAQoT,QAAS,EACjBpT,EAAQlP,KAAOkP,EAAQiV,QACvBjV,EAAQ8L,YAAc9L,EAAQmT,gBAG/B1iB,KAAK0kB,qBAAuB,SAAUnV,GACrC,GAAIzH,GAASyH,EAAQiV,QAAQpiB,OAAS,CAOtC,OANAf,GAAEY,QAAQ4H,EAAKyX,YAAa,SAAU+C,GACjC9U,EAAQlP,OAASgkB,EAAWhkB,MAAQkP,EAAQiV,UAAYH,EAAWhkB,OAEtEyH,GAAS,KAGJA,GAGR9H,KAAK2kB,YAAc,SAAUpV,GAC5B,GAAIA,EAAQlP,OAASkP,EAAQqV,UAAW,CAEvC,GAAIA,GAAYrV,EAAQiV,OACxBjV,GAAQlP,KAAOkP,EAAQiV,QACvBjV,EAAQ8L,YAAc9L,EAAQmT,qBACvBnT,GAAQiV,cACRjV,GAAQmT,qBACRnT,GAAQoT,MACf,IAAIxe,IACH0J,OAAQpO,EAAgB2kB,cAAcQ,GACtCxc,IAAK3I,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAG/C9L,GAAGa,IAAIH,GAAUrC,KAAK,SAAU6L,GAC/BvO,EAAO+H,WAAW,0BAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,2BACxE,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,qCAIlEkM,GAAQqV,gBACRrV,GAAQsV,uBACRtV,GAAQoT,OACfljB,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,SAAUgG,GAChE1I,EAAO+H,WAAW,0BAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,2BACxE,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,2BAK3ErD,KAAK8kB,kBAAoB,SAAUvV,GAC7BA,EAAAA,kBAaGA,GAAQoT,OACfljB,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,SAAUgG,GAChEzG,EAAEY,QAAQ4H,EAAKyX,YAAa,SAAU+C,GACjCA,EAAAA,YAAsBA,EAAWhkB,OAASkP,EAAQlP,OACrDgkB,EAAAA,YAAqB,EACrB5kB,EAAgBiY,WAAW2M,EAAWhkB,KAAMgkB,GAAYviB,KAAK,SAAUgG,KACpE,SAAUZ,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,6BAI3EjE,EAAO+H,WAAW,0BAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,2BACxE,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,kCAzBlEkM,GAAQqV,gBACRrV,GAAQsV,uBACRtV,GAAQoT,OACfljB,EAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,SAAUgG,GAChE1I,EAAO+H,WAAW,0BAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,2BACxE,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,YAAa9D,EAAW8D,QAAQ,4BAuB3ErD,KAAK+kB,WAAa,SAAUxV,GAC3B1P,EAAeuB,eAAiBmO,CAChC,IAAIE,GAAM,GAAI/L,GAAQwJ,IACtBuC,GAAM,GAAI/L,GAAQwJ,KAAKuC,EAAIC,cAAgB,GAAID,EAAInC,WAAYmC,EAAIE,WACnEf,EAASgB,IAAI,mBAAoBL,EAAQlP,MAAOwP,QAASJ,IACzDrJ,EAAWe,WAAW,2BAGvBnH,KAAKglB,qBAAuB,SAAU3U,GACrC3Q,EAAeulB,cAAc5U,EAAQhQ,KAAMgQ,EAAQlI,SAASrG,KAAK,WAChEhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,qCAClF+C,EAAWe,WAAW,2BACpB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,sCAIlFjE,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKyX,YAAczhB,EAAemP,WAGnC5P,EAAOmE,IAAI,yBAA0B,WACpCsG,EAAKzI,eAAiBvB,EAAeuB,iBAGtCpB,KAAKiB,UAELuF,OAAO,kBACL,aACA,SAAS1C,GACL,MAAO,UAASohB,GACd,GAAIC,GAAQrhB,EAAWQ,IAAI,oBAC3B,KAAKsJ,MAAOuX,GACV,GAAIA,EAAMvX,KAAKyU,MAAQ6C,EACrB,MAAOC,GAAMvX,KAAKvN,IAGtB,QAAO,MAIjBkN,QAAQ6E,OAAO,eACVsC,WAAW,eAgBX,SAAU,YAAa,aAAc,kBAAmB,gBAAiB,aAAc,iBAfxF,SAAStV,EAAQuP,EAAWpP,EAAYK,EAAiBiE,EAAeC,EAAYjE,GAEhF,GAAIgK,GAAO7J,IAEXA,MAAKolB,cACLplB,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WACZpB,EAAe2hB,UACnB7S,EAAU8S,KAAK,UAEhBliB,GAAY,OAAQ,UAAW,qBAAqBuC,KAAK,SAAU6L,GAClE9D,EAAKwb,aAEHhlB,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgB0lB,WAAWjc,MAI5BhJ,KAAM,UACNuH,QAAS+F,EAAQM,QACjBzI,OAAQ,SAAU6D,GACjBzJ,EAAgBqO,QAAQ5E,MAIzBhJ,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBzJ,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAMtB0C,EAAK0b,mBAIDnmB,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAK0b,kBAGTnmB,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAK0b,kBAGTvlB,KAAKulB,cAAgB,WACjB,GAAIhb,GAAUzG,EAAWQ,IAAI,gBACtCuF,GAAKub,aACI,KAAKxX,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQ2K,QAAS,CACrC,GAAIA,GAAUR,EAAQqD,KAAKxN,QAAQ2K,QAAQya,GAC3Cza,GAAQnF,OAAS4E,EACjBO,EAAQ1K,KAAOmlB,GACf3b,EAAKub,WAAWljB,KAAK6I,MAMrC3L,EAAOmE,IAAI,iBAAkB,WACzBsG,EAAK4b,oBAGTzlB,KAAKylB,gBAAkB,WAE5B,GAAIlb,GAAUzG,EAAWQ,IAAI,gBACpB,KAAKsJ,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQ2K,QAAS,CACvD,GAAIpJ,GAAQ,EACRiV,EAAQvV,EAAE2C,KAAK6F,EAAKub,WAAY,SAAUhlB,GAC7C,MAAOA,GAAQC,OAASmlB,IAAMplB,EAAQwF,SAAW4E,GAElD,IAAKoM,EAKE,CACN,GAAI8O,GAASnb,EAAQqD,KAAKxN,QAAQ2K,QAAQya,GAC1CE,GAAO9f,OAAS4E,EAChBkb,EAAOrlB,KAAOmlB,EACd,IAAI7jB,GAAQN,EAAEiN,QAAQzE,EAAKub,WAAY/jB,EAAE2C,KAAK6F,EAAKub,YAAaxf,OAAQ4E,EAAYnK,KAAMmlB,KAC1F3b,GAAKub,WAAW7W,OAAO5M,EAAO,EAAG+jB,OAVtB,CACX,GAAIA,GAASnb,EAAQqD,KAAKxN,QAAQ2K,QAAQya,GAC1CE,GAAO9f,OAAS4E,EAChBkb,EAAOrlB,KAAOmlB,GACd3b,EAAKub,WAAWljB,KAAKwjB,KAahBrkB,EAAEwM,OAAOhE,EAAKub,WAAY,SAAUM,GAC5C,GAAI9O,GAAQvV,EAAE2C,KAAKF,EAAWQ,IAAI,iBAAkB,SAAUsB,EAAQ4E,GACrE,OAAQ5E,EAAOxF,SAAWiB,EAAE2C,KAAK4B,EAAOxF,QAAQ2K,QAAS,SAAU3K,EAASulB,GAC3E,MAAOA,KAAYD,EAAOrlB,MAAQmK,IAAekb,EAAO9f,UAI1D,KAAKgR,EACJ,OAAO,KAKJ5W,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,eAgBX,SAAU,YAAa,aAAc,kBAAmB,gBAAiB,aAAc,iBAfxF,SAAStV,EAAQuP,EAAWpP,EAAYK,EAAiBiE,EAAeC,EAAYjE,GAEhF,GAAIgK,GAAO7J,IAEXA,MAAK4lB,cACL5lB,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WACZpB,EAAe2hB,UACnB7S,EAAU8S,KAAK,UAEhBliB,GAAY,OAAQ,UAAW,qBAAqBuC,KAAK,SAAU6L,GAClE9D,EAAKwb,aAEHhlB,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgBimB,WAAWxc,MAI5BhJ,KAAM,UACNuH,QAAS+F,EAAQM,QACjBzI,OAAQ,SAAU6D,GACjBzJ,EAAgBqO,QAAQ5E,MAIzBhJ,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBzJ,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAMtB0C,EAAKic,mBAID1mB,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAKic,kBAGT1mB,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAKic,kBAGT9lB,KAAK8lB,cAAgB,WACjB,GAAIvb,GAAUzG,EAAWQ,IAAI,gBACtCuF,GAAK+b,aACI,KAAKhY,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQ0K,QAAS,CACrC,GAAIA,GAAUP,EAAQqD,KAAKxN,QAAQ0K,QAAQ0a,GAC3C1a,GAAQlF,OAAS4E,EACjBM,EAAQzK,KAAOmlB,GACf3b,EAAK+b,WAAW1jB,KAAK4I,MAMrC1L,EAAOmE,IAAI,iBAAkB,WACzBsG,EAAK4b,oBAGTzlB,KAAKylB,gBAAkB,WAE5B,GAAIlb,GAAUzG,EAAWQ,IAAI,gBACpB,KAAKsJ,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQ0K,QAAS,CACvD,GAAInJ,GAAQ,EACRiV,EAAQvV,EAAE2C,KAAK6F,EAAK+b,WAAY,SAAUxlB,GAC7C,MAAOA,GAAQC,OAASmlB,IAAMplB,EAAQwF,SAAW4E,GAElD,IAAKoM,EAKE,CACN,GAAImP,GAASxb,EAAQqD,KAAKxN,QAAQ0K,QAAQ0a,GAC1CO,GAAOngB,OAAS4E,EAChBub,EAAO1lB,KAAOmlB,EACd,IAAI7jB,GAAQN,EAAEiN,QAAQzE,EAAK+b,WAAYvkB,EAAE2C,KAAK6F,EAAK+b,YAAahgB,OAAQ4E,EAAYnK,KAAMmlB,KAC1F3b,GAAK+b,WAAWrX,OAAO5M,EAAO,EAAGokB,OAVtB,CACX,GAAIA,GAASxb,EAAQqD,KAAKxN,QAAQ0K,QAAQ0a,GAC1CO,GAAOngB,OAAS4E,EAChBub,EAAO1lB,KAAOmlB,GACd3b,EAAK+b,WAAW1jB,KAAK6jB,KAahB1kB,EAAEwM,OAAOhE,EAAK+b,WAAY,SAAUG,GAC5C,GAAInP,GAAQvV,EAAE2C,KAAKF,EAAWQ,IAAI,iBAAkB,SAAUsB,EAAQ4E,GACrE,OAAQ5E,EAAOxF,SAAWiB,EAAE2C,KAAK4B,EAAOxF,QAAQ0K,QAAS,SAAU1K,EAASulB,GAC3E,MAAOA,KAAYI,EAAO1lB,MAAQmK,IAAeub,EAAOngB,UAI1D,KAAKgR,EACJ,OAAO,KAKJ5W,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,gBAgBX,SAAU,YAAa,aAAc,kBAAmB,gBAAiB,aAAc,iBAfxF,SAAStV,EAAQuP,EAAWpP,EAAYK,EAAiBiE,EAAeC,EAAYjE,GAEhF,GAAIgK,GAAO7J,IAEXA,MAAKgmB,cACLhmB,KAAKimB,cACLjmB,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WACZpB,EAAe2hB,UACnB7S,EAAU8S,KAAK,UAEhBliB,GAAY,OAAQ,UAAW,qBAAqBuC,KAAK,SAAU6L,GAClE9D,EAAKqc,eAEH7lB,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgBumB,aAAa9c,MAI9BhJ,KAAM,UACNuH,QAAS+F,EAAQM,QACjBzI,OAAQ,SAAU6D,GACjBzJ,EAAgBqO,QAAQ5E,MAIzBhJ,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBzJ,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAKtB0C,EAAKuc,aAEH/lB,KAAM,OACNuH,QAAS+F,EAAQ2L,KACjB9T,OAAQ,SAAU6D,GACjBzJ,EAAgBymB,WAAWhd,MAI5BhJ,KAAM,UACNuH,QAAS+F,EAAQM,QACjBzI,OAAQ,SAAU6D,GACjBzJ,EAAgBqO,QAAQ5E,MAIzBhJ,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBzJ,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAMtB0C,EAAKyc,kBACLzc,EAAK0c,mBAIDnnB,EAAOmE,IAAI,uBAAwB,WAC/BsG,EAAKyc,kBACLzc,EAAK0c,kBAGTnnB,EAAOmE,IAAI,wBAAyB,WAChCsG,EAAKyc,kBACLzc,EAAK0c,kBAGTvmB,KAAKsmB,gBAAkB,WACnB,GAAI/b,GAAUzG,EAAWQ,IAAI,gBACtCuF,GAAKmc,aACI,KAAKpY,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqe,KAAMjc,GAAQqD,KAAKxN,QAAQqK,SAAU,CACtC,GAAIgc,GAAWlc,EAAQqD,KAAKxN,QAAQqK,SAAS+b,GAC7CC,GAAS7gB,OAAS4E,EAClBic,EAASpmB,KAAOmmB,GAChB3c,EAAKmc,WAAW9jB,KAAKukB,MAMrCzmB,KAAKumB,cAAgB,WACjB,GAAIhc,GAAUzG,EAAWQ,IAAI,gBACtCuF,GAAKoc,aACI,KAAKrY,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKue,KAAMnc,GAAQqD,KAAKxN,QAAQyK,QAAS,CACrC,GAAI8b,GAASpc,EAAQqD,KAAKxN,QAAQyK,QAAQ6b,GAC1CC,GAAO/gB,OAAS4E,EAChBmc,EAAOtmB,KAAOqmB,GACd7c,EAAKoc,WAAW/jB,KAAKykB,MAMrCvnB,EAAOmE,IAAI,iBAAkB,WACzBsG,EAAK4b,oBAGTzlB,KAAKylB,gBAAkB,WAE5B,GAAIlb,GAAUzG,EAAWQ,IAAI,gBACpB,KAAKsJ,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQyK,QAAS,CACvD,GAAIlJ,GAAQ,EACRiV,EAAQvV,EAAE2C,KAAK6F,EAAKoc,WAAY,SAAU7lB,GAC7C,MAAOA,GAAQC,OAASmlB,IAAMplB,EAAQwF,SAAW4E,GAElD,IAAKoM,EAKE,CACN,GAAI+P,GAASpc,EAAQqD,KAAKxN,QAAQyK,QAAQ2a,GAC1CmB,GAAO/gB,OAAS4E,EAChBmc,EAAOtmB,KAAOmlB,EACd,IAAI7jB,GAAQN,EAAEiN,QAAQzE,EAAKoc,WAAY5kB,EAAE2C,KAAK6F,EAAKoc,YAAargB,OAAQ4E,EAAYnK,KAAMmlB,KAC1F3b,GAAKoc,WAAW1X,OAAO5M,EAAO,EAAGglB,OAVtB,CACX,GAAIA,GAASpc,EAAQqD,KAAKxN,QAAQyK,QAAQ2a,GAC1CmB,GAAO/gB,OAAS4E,EAChBmc,EAAOtmB,KAAOmlB,GACd3b,EAAKoc,WAAW/jB,KAAKykB,KAahBtlB,EAAEwM,OAAOhE,EAAKoc,WAAY,SAAUU,GAC5C,GAAI/P,GAAQvV,EAAE2C,KAAKF,EAAWQ,IAAI,iBAAkB,SAAUsB,EAAQ4E,GACrE,MAAOnJ,GAAE2C,KAAK4B,EAAOxF,QAAQyK,QAAS,SAAUzK,EAASulB,GACxD,MAAOA,KAAYgB,EAAOtmB,MAAQmK,IAAemc,EAAO/gB,UAI1D,KAAKgR,EACJ,OAAO,GAKT,IAAIrM,GAAUzG,EAAWQ,IAAI,gBACpB,KAAKsJ,MAAOrD,GAAS,CACjB,GAAIC,GAAaD,EAAQqD,KAAKvN,IAC9B,IAAIkK,EAAQqD,KAAKmK,WAAaxN,EAAQqD,KAAKzF,QACvC,IAAKqd,KAAMjb,GAAQqD,KAAKxN,QAAQqK,SAAU,CACxD,GAAI9I,GAAQ,EACRiV,EAAQvV,EAAE2C,KAAK6F,EAAKmc,WAAY,SAAU5lB,GAC7C,MAAOA,GAAQC,OAASmlB,IAAMplB,EAAQwF,SAAW4E,GAElD,IAAKoM,EAKE,CACN,GAAI6P,GAAWlc,EAAQqD,KAAKxN,QAAQqK,SAAS+a,GAC7CiB,GAAS7gB,OAAS4E,EAClBic,EAASpmB,KAAOmlB,EAChB,IAAI7jB,GAAQN,EAAEiN,QAAQzE,EAAKmc,WAAY3kB,EAAE2C,KAAK6F,EAAKmc,YAAapgB,OAAQ4E,EAAYnK,KAAMmlB,KAC1F3b,GAAKmc,WAAWzX,OAAO5M,EAAO,EAAG8kB,OAVtB,CACX,GAAIA,GAAWlc,EAAQqD,KAAKxN,QAAQyK,QAAQ2a,GAC5CiB,GAAS7gB,OAAS4E,EAClBic,EAASpmB,KAAOmlB,GAChB3b,EAAKmc,WAAW9jB,KAAKukB,KAahBplB,EAAEwM,OAAOhE,EAAKmc,WAAY,SAAUS;AAC5C,GAAI7P,GAAQvV,EAAE2C,KAAKF,EAAWQ,IAAI,iBAAkB,SAAUsB,EAAQ4E,GACrE,OAAQ5E,EAAOxF,SAAWiB,EAAE2C,KAAK4B,EAAOxF,QAAQyK,QAAS,SAAUzK,EAASulB,GAC3E,MAAOA,KAAYgB,EAAOtmB,MAAQmK,IAAemc,EAAO/gB,UAI1D,KAAKgR,EACJ,OAAO,KAKJ5W,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,gBAgBX,SAAU,aAAc,UAAW,kBAAmB,kBAAmB,iBAAkB,iBAAkB,eAf9G,SAAStV,EAAQG,EAAYO,EAASF,EAAiBH,EAAiBC,EAAgBG,EAAgB2V,GAoD1G,QAASoR,GAAWvmB,GACnB,GAAIR,EAAeuB,eAAgB,CAClC,GAAIylB,GAAQxlB,EAAE2C,KAAKnE,EAAeuB,eAAe+V,YAAa,SAAUlJ,GACvE,MAAOA,GAAQ5N,OAASA,GAKzB,IAHKR,EAAeuB,eAAe+V,cAClCtX,EAAeuB,eAAe+V,iBAE1B0P,GAAWxmB,EAAM,CACrB,GAAI4N,IAAW5N,KAAMA,EAAM2M,YAC3BnN,GAAeuB,eAAe+V,YAAYjV,KAAK+L,GAC/CxO,EAAgB0D,qBAAqBrB,KAAK,WACzChC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAC5E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC1E,WAAW,WACbjE,EAAO+H,WAAW,8BAlEhB,GAAI0C,GAAO7J,IAEXA,MAAKmX,eACLnX,KAAKH,eAAiBA,EAEtBG,KAAKiB,KAAO,WAEjB1B,GAAY,OAAQ,SAAU,qBAAqBuC,KAAK,SAAU6L,GACjE9D,EAAK2G,OAEHnQ,KAAM,SACNuH,QAAS+F,EAAQE,OACjBrI,OAAQ,SAAU6D,GACjBzJ,EAAgBknB,cAAczd,GAAOvH,KAAK,WACzC1C,EAAO+H,WAAW,+BAKpB9G,KAAM,mBACNuH,QAAS+F,EAAQ8L,iBACjBjU,OAAQ,SAAU6D,GACjBA,EAAM/C,KAAO,UACb1G,EAAgB+Z,eAAetQ,GAAOvH,KAAK,WAC1C1C,EAAO+H,WAAW,yBAKtB0C,EAAKkd,oBAID3nB,EAAOmE,IAAI,yBAA0B,WACjCsG,EAAKkd,mBAGT/mB,KAAK+mB,eAAiB,WAC3B,GAAIxX,GAAU1P,EAAeuB,cACvBmO,IAAaA,EAAQ4H,cAC1BtN,EAAKsN,YAAc5H,EAAQ4H,cAIvBnX,KAAKgnB,WAAa,WACvB,MAAOxR,GAAanB,KAAK9U,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,4BAA4BvB,KAAK,SAAUgG,GACxK8e,EAAW9e,EAAOL,UA0BdzH,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,eAgBX,SAAU,eAAgB,YAAa,aAAc,YAAa,UAAW,4BAA6B,kBAAmB,iBAAkB,aAAc,iBAf9J,SAAStV,EAAQ6nB,EAActY,EAAWpP,EAAY6U,EAAWtU,EAASkQ,EAA2BpQ,EAAiBF,EAAgBoE,EAAYjE,GAoBpJ,QAASqnB,KACR7lB,EAAEY,QAAQ4H,EAAKsd,iBAAkB,SAAUC,GAC1C,GAAIC,GAAWvjB,EAAWG,IAAI,kBAAmBmjB,EAAgB9gB,KACjE,IAAM+gB,GAAYA,EAASlf,UAAY9G,EAAE2C,KAAK6F,EAAKqG,aAAc5J,KAAM8gB,EAAgB9gB,OAAQ,CAC9F,GAAI+J,IAAW/J,KAAM8gB,EAAgB9gB,KACrCuD,GAAKrH,MAAQ4kB,EAAgB7W,SAAS/N,MACtC6N,EAAQuE,KAAOwS,EAAgBxS,MAAQ,EACvCvE,EAAQiX,cAAgB9kB,MAAO4kB,EAAgBG,WAAY7V,QAAUrB,QAAS+W,EAAgB/W,SAC9FA,EAAQG,OAENnQ,KAAM,OACNuH,QAASrI,EAAW8D,QAAQ,QAC5BmC,OAAQ,SAAU6D,GACjBA,EAAMgH,QAAQmX,YAAYne,MAI3BhJ,KAAM,SACNuH,QAASrI,EAAW8D,QAAQ,UAC5BmC,OAAQ,SAAU6D,GACjBA,EAAMgH,QAAQoX,cAAcpe,GAAOvH,KAAK,WACvC1C,EAAO+H,WAAW,+BAKpB9G,KAAM,mBACNuH,QAASrI,EAAW8D,QAAQ,oBAC5BmC,OAAQ,SAAU6D,GACbzJ,EAAgB+Z,eAAetQ,IAClCjK,EAAO+H,WAAW,uBAKtB0C,EAAKqG,YAAYhO,KAAKmO,MAGxBhP,EAAEY,QAAQ4H,EAAKsd,iBAAkB,SAAUC,GAC1C,GAAIC,GAAWvjB,EAAWG,IAAI,kBAAmBmjB,EAAgB9gB,KACjE,IAAM+gB,GAAYA,EAASlf,SAAakf,EAASjnB,QAAS,CACzD,GAAIknB,GAAejmB,EAAE2C,KAAK6F,EAAKqG,aAAc5J,KAAM8gB,EAAgB9gB,MAC7DghB,KAAiBA,EAAa5V,OACnC4V,EAAa5V,UAEb4V,GAAgBjmB,EAAEY,QAAQolB,EAASjnB,QAAS,SAAUA,GACtD,GAAIymB,GAAQxlB,EAAE2C,KAAKsjB,EAAa5V,KAAM,SAAU/G,GAC/C,MAAOA,GAAItK,OAASD,EAAQC,MAE7B,KAAKwmB,EAAO,CACX,GAAIlc,IAAOtK,KAAMD,EAAQC,KAAMiG,KAAMlG,EAAQkG,KAAM+U,YAAajb,EAAQib,YAAahL,QAAS+W,EAAgB/W,QAC9GiX,GAAa5V,KAAKxP,KAAKyI,OAIxB2c,GAAgBjmB,EAAEY,QAAQqlB,EAAa5V,KAAM,SAAU/G,EAAKhJ,GAC5D,GAAIklB,GAAQxlB,EAAE2C,KAAKqjB,EAASjnB,QAAS,SAAUsnB,GAC9C,MAAOA,GAAWrnB,OAASsK,EAAItK,MAE3BwmB,IACJS,EAAa5V,KAAKnD,OAAO5M,EAAO,QA9E/B,GAAIkI,GAAO7J,IAEXA,MAAKkQ,eACLlQ,KAAKwC,MAAQ,GAEbxC,KAAKH,eAAiBA,EACtBG,KAAKmnB,iBAAmB9lB,EAAEmF,OAAOwJ,EAA0BG,WAAY,SAAU4E,GACtF,MAAOA,GAAUxE,UAAYwE,EAAUxE,SAASG,SAAWuW,EAAa5W,UAEzErQ,KAAK4U,KAAO,EAEN5U,KAAKiB,KAAO,WACZpB,EAAe2hB,UACnB7S,EAAU8S,KAAK,UAEhByF,KAsEDlnB,KAAK2nB,WAAa,SAAUtX,GAC3BA,EAAQsX,cAGTvoB,EAAOmE,IAAI,yBAA0B,WACpC2jB,MAGD9nB,EAAOmE,IAAI,yBAA0B,WACpC2jB,MAGKlnB,KAAKiB,UAKbsM,QAAQ6E,OAAO,eACVsC,WAAW,aAgBX,SAAU,aAAc,UAAW,mBAAoB,kBAAmB,kBAf3E,SAAStV,EAAQG,EAAYO,EAAS0a,EAAkB/a,EAAiBghB,GAErE,GAAI5W,GAAO7J,IAEXA,MAAK4nB,YACL5nB,KAAK6nB,aAEL7nB,KAAK0G,WAEL1G,KAAK8nB,SAAU,EACf9nB,KAAKyc,MACVsL,MAAO,GACPrL,SAAU,GACVvU,SAAS,GAEVnI,KAAKgoB,cAAe,EAEpBhoB,KAAKsf,eACJyI,MAAO,GACP5f,QAAS,IAGJnI,KAAKiB,KAAO,WACb1B,EAAWuP,QACdjF,EAAKnD,QAAU8T,EAAiBiF,aAC3BC,mBAAmB,mCAAmCngB,EAAWuP,MAAM,UAE7EjF,EAAKoe,cACLpe,EAAKqe,gBAGNloB,KAAKioB,YAAc,WAClBxoB,EAAgBwoB,cAAcnmB,KAAK,SAAUgG,GAC5C+B,EAAK+d,SAAW9f,GACd,SAAUZ,GACS,MAAjBA,EAAMrF,OACTgI,EAAKme,cAAe,EAEpBloB,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,iCAKtFrD,KAAKmoB,QAAU,WACdte,EAAKie,SAAU,GAGhB9nB,KAAKooB,cAAgB,WACpBve,EAAKie,SAAU,EACfje,EAAK4S,MACJsL,MAAO,GACPrL,SAAU,GACVvU,SAAS,IAIXnI,KAAKqoB,eAAiB,WACrB,GAAIzR,GAAQvV,EAAE2C,KAAK6F,EAAK+d,UAAWG,MAAOle,EAAK4S,KAAKsL,OAEpD,QAAInR,MAIK/M,EAAK4S,KAAKsL,OAASle,EAAK4S,KAAKsL,MAAM3lB,OAAS,KAAOyH,EAAK4S,KAAKC,UAAY7S,EAAK4S,KAAKC,SAASta,OAAS,IAG/GpC,KAAKsoB,cAAgB,WACpB7oB,EAAgB0oB,QAAQte,EAAK4S,MAAM3a,KAAK,WACvC+H,EAAK+d,SAAS1lB,KAAK2H,EAAK4S,MACxB5S,EAAKie,SAAU,EACfje,EAAK4S,MACJsL,MAAO,GACPrL,SAAU,GACVvU,SAAS,GAEVrI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAC/E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAIjFrD,KAAKuoB,sBAAwB,SAAU9L,GACtCA,EAAK+L,gBAAiB,GAGvBxoB,KAAKyoB,qBAAuB,SAAUhM,GACrCA,EAAK+L,gBAAiB,EACtB/L,EAAKC,SAAW,IAGjB1c,KAAKwoB,eAAiB,SAAU/L,GAC/Bhd,EAAgBipB,QAAQjM,EAAKsL,MAAOtL,GAAM3a,KAAK,WAC9C2a,EAAKC,SAAW,GAChBD,EAAK+L,gBAAiB,EACtB1oB,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAC/E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAIjFrD,KAAK2oB,WAAa,SAAUlM,GAC3Bhd,EAAgBipB,QAAQjM,EAAKsL,OAAQ5f,QAASsU,EAAKtU,UAAUrG,KAAK,WACjEhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAC/E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,mBAAoB9D,EAAW8D,QAAQ,6BAIjFrD,KAAK4oB,WAAa,SAAUnM,GAC3B,MAAOgE,GAAgBpM,KAAK9U,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,6BAA8B0kB,MAAOtL,EAAKsL,SAASjmB,KAAK,WAC/I,MAAOrC,GAAgBmpB,WAAWnM,EAAKsL,OAAOjmB,KAAK,WAClDT,EAAEwM,OAAOhE,EAAK+d,UAAWG,MAAOtL,EAAKsL,QACrCjoB,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,+BACjF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,iCAKpFrD,KAAKkoB,aAAe,WACnB,GAAIxhB,IACHqhB,MAAOle,EAAKyV,cAAcyI,MAEQ,UAA/Ble,EAAKyV,cAAcnX,QACtBzB,EAAQyB,SAAU,EACuB,UAA/B0B,EAAKyV,cAAcnX,UAC7BzB,EAAQyB,SAAU,GAGnB1I,EAAgByoB,aAAaxhB,GAAS5E,KAAK,SAAUgG,GACpD+B,EAAKge,UAAY/f,GACf,WACFhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,wBAAyB9D,EAAW8D,QAAQ,kCAItFrD,KAAK6oB,aAAe,SAAU7P,GAC7B,MAAOA,GAAM8P,UAAU,EAAG,GAAK,+BAAiC9P,EAAM8P,UAAU,KAGjF9oB,KAAK+oB,YAAc,SAAU/P,GAC5B,MAAOyH,GAAgBpM,KAAK9U,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,+BAA+BvB,KAAK,WAC5H,MAAOrC,GAAgBspB,YAAY/P,EAAMA,OAAOlX,KAAK,WACpDkX,EAAM7Q,SAAU,EAChBrI,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,gCAClF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,kCAK/ErD,KAAKiB,OAEX7B,EAAOmE,IAAI,aAAc,WACxBsG,EAAKnD,QAAU8T,EAAiBiF,aAC3BC,mBAAmB,mCAAmCngB,EAAWuP,MAAM,cAK/EvB,QAAQ6E,OAAO,eAAe4W,UAAU,sBAAA,WAAA,4BAAA,aAAsB,SAAUC,EAAUjZ,EAA2BlM,GAEzG,GAAIolB,GAAW,wCAEXC,EAAmB,8EAEnBC,EAAmB,4EAEvB,QACIC,OACI/iB,KAAM,IACNqE,IAAK,KAET2e,KAAM,SAASD,EAAOjpB,GAClB,GAAI0S,GAASzR,EAAE2C,KAAKgM,EAA0BG,YAAa7J,KAAM+iB,EAAM/iB,OAC5E+J,EAAUvM,EAAWG,IAAI,kBAAmBolB,EAAM/iB,KAClDwM,GAAOxC,gBAAkBD,GAAWA,EAAQlI,QAC/CohB,QAAUN,EAASC,EAASM,QAAQ,aAAc1W,EAAOkW,YAAYK,GAC3DvW,EAAOxC,gBAAkBD,IAAYA,EAAQlI,QACvDohB,QAAUN,EAASG,GAAkBC,GAC1BvW,EAAOxC,eAGlBiZ,QAAUN,EAASE,GAAkBE,GAFrCE,QAAUN,EAASC,EAASM,QAAQ,aAAc1W,EAAOkW,YAAYK,GAI7DjpB,EAAQqpB,OAAOF,cA0I3Bhc,QAAQ6E,OAAO,eAAe2C,UAAU,iBACpCN,YAAa,uDACbC,WAAYvV,wBACZuqB,UACItpB,QAAS,OAGhB4T,QAAQ,wBAAA,QAAA,YAAA,aAAA,UAAA,iBAAA,yBAAA,kBAAA,aAAwB,SAAS3U,EAAO+U,EAAW7U,EAAYO,EAASN,EAAgBmqB,EAAwBlJ,EAAiB3c,GACtI,GAAI8lB,GAAUpqB,EAAeU,QAAUV,EAAeW,cAClDR,IA0GJ,OAvGAA,GAAqBkqB,qBAAuB,WACxC,MAAOF,GAAuBG,YAAY,MAAOF,EAAU,oBAG/DjqB,EAAqBoqB,iBAAmB,SAAU1pB,GAC9C,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,IAGnFV,EAAqBqqB,iBAAmB,SAAUC,GAC9C,MAAON,GAAuBG,YAAY,OAAQF,EAAU,kBAAmBK,IAGnFtqB,EAAqBuqB,iBAAmB,SAAU7pB,EAAM4pB,GACpD,MAAON,GAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,EAAM4pB,IAGzFtqB,EAAqBwqB,oBAAsB,SAAU9pB,GACjD,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,kBAAoBvpB,IAGtFV,EAAqBkC,OAAS,SAAUxB,EAAMM,GAC1C,MAAOgpB,GAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,EAAO,UAAW,MAAOM,OAAQA,KAGpHhB,EAAqB4C,MAAQ,SAAUlC,EAAM2B,EAAWooB,EAAWC,GACrE,GAAIC,KAIE,OAHFD,KACHC,EAASD,UAAY,IAETV,EAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,EAAO,UAAY2B,EAAY,IAAMooB,EAAW,KAAME,IAGzI3qB,EAAqB2C,OAAS,SAAUjC,EAAMkqB,GAC1C,MAAOZ,GAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,EAAO,WAAakqB,IAGvG5qB,EAAqB6qB,SAAW,SAAUnqB,EAAMkqB,GAC5C,MAAOZ,GAAuBG,YAAY,MAAOF,EAAU,kBAAoBvpB,EAAO,WAAakqB,EAAc,cAGxH5qB,EAAqBgoB,WAAa,WACbvT,EAAUC,MAC7BG,WAAW,EACXC,YAAa,oDACbC,WAAY,yBACZC,aAAc,yBACdC,KAAM,KACNC,SACC4V,OAAQ,WACP,MAAO,WAMX9qB,EAAqB6nB,YAAc,SAAUnX,GACxB+D,EAAUC,MAC7BG,WAAW,EACXC,YAAa,oDACbC,WAAY,yBACZC,aAAc,yBACdC,KAAM,KACNC,SACC4V,OAAQ,WACP,MAAOpa,QAMX1Q,EAAqB8nB,cAAgB,SAAUpX,GAC9C,MAAOoQ,GAAgBpM,KAAK9U,EAAW8D,QAAQ,yBAA0B9D,EAAW8D,QAAQ,2BAA2BvB,KAAK,WAC3H,MAAOnC,GAAqBwqB,oBAAoB9Z,EAAQhQ,MAAMyB,KAAK,WAClE,GAAIsV,GAAWtT,EAAWG,IAAI,kBAAmB,iBACjD5C,GAAEwM,OAAOuJ,EAAShX,QAAS,SAAUA,GACpC,MAAOA,GAAQC,OAASgQ,EAAQhQ,OAEjCyD,EAAWsE,IAAI,kBAAmB,iBAAkBgP,GACpDtX,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,yBAA0B9D,EAAW8D,QAAQ,mCACrF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,yBAA0B9D,EAAW8D,QAAQ,qCAKxF1D,EAAqBiC,WAAa,SAAUF,EAAUC,GACjCyS,EAAUC,MAC7BG,WAAW,EACXC,YAAa,0DACbC,WAAY,8BACZC,aAAc,8BACdC,KAAM,KACNC,SACCnT,SAAU,WACT,MAAOA,IAERC,MAAO,WACN,MAAOA,QAMDhC,KAGVmT,QAAA,kCAAO,SAAaE,GACpBA,EAAgCG,QAAQ,oBAExCuX,KAAA,4BAAA,uBAAI,SAAS1a,EAA2BrQ,GACrCqQ,EAA0B5H,KACtB9B,KAAM,iBACN0iB,UAAW,iBACXzB,WAAY,uBACZlX,QAAS1Q,EACT2Q,gBAAgB,EAChBsE,KAAM,EACNrE,UACL/N,MAAO,uBACPkO,OAAQ,iBAET4G,aAAc,EACdE,YAAa,EACb/G,KAAM,SACNka,UACC5pB,QACCyB,MAAO,sCACPooB,cACA9iB,QACCxB,KAAM,UACN9D,MAAO,+CAGTgoB,UACChoB,MAAO,wCACPooB,YACCtoB,OAAQ,0DAETwF,QACCxB,KAAM,UACN9D,MAAO,uDAOZ+K,QAAQ6E,OAAO,eACVsC,WAAW,+BAgBX,SAAU,oBAAqB,aAAc,UAAW,uBAAwB,WAAY,QAf7F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAASH,EAAsB+B,EAAUC,GAarF,QAASV,KACd4I,EAAKghB,aAAehhB,EAAKnI,SAASmI,EAAKlI,OACvCvC,EAAO+H,WAAW,2BAA4B0C,EAAKghB,cAd9C,GAAIhhB,GAAO7J,IAEXA,MAAK0B,SAAWA,EAChB1B,KAAK2B,MAAQA,EACb3B,KAAK6qB,cACVxqB,KAAM,GACNmC,MAAO,GACPU,IAAK,GACLZ,OAAQ,GACRI,YAAa,IAQR1C,KAAKof,MAAQ,WACT7E,EAAkBuQ,QAAQ,UAG9B9qB,KAAK+qB,aAAe,WACzB,MAAOxrB,GAAW8D,QAAQ,eAAiBwG,EAAKghB,aAAaroB,OAG9DxC,KAAKgrB,YAAc,SAAU7lB,GAC5B0E,EAAKlI,OAASwD,EACd0E,EAAKghB,aAAehhB,EAAKnI,SAASmI,EAAKlI,OACvCvC,EAAO+H,WAAW,2BAA4B0C,EAAKghB,eAGpD7qB,KAAK4C,YAAc,WAClB,MAAOiH,GAAKlI,MAAQ,GAGrB3B,KAAK6C,QAAU,WACd,MAAOgH,GAAKlI,MAAQkI,EAAKnI,SAASU,OAAS,GAG5CpC,KAAKwqB,SAAW,WACf7qB,EAAqB6qB,SAAS3gB,EAAKghB,aAAaxqB,KAAMwJ,EAAKghB,aAAaroB,OAAOV,KAAK,WACnFhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,qCACvF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,qCAIzFrD,KAAKirB,UAAY,WAChB,MAAQphB,GAAKlI,MAAQ,EAAK,MAAQkI,EAAKnI,SAASU,QAG3CnB,OAIRsM,QAAQ6E,OAAO,eACVsC,WAAW,0BAgBX,aAAc,oBAAqB,aAAc,aAAc,UAAW,uBAAwB,SAfnG,SAAStO,EAAYmU,EAAmBhb,EAAYuE,EAAYhE,EAASH,EAAsB8qB,GAU3F,QAASxpB,KACRwpB,GACL5gB,EAAK4gB,OAASppB,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,kBAAkB7D,QAAS,SAAUuK,GAC3F,MAAOA,GAAItK,OAASoqB,EAAOpqB,OAE5BwJ,EAAKzB,KAAM,GAEXyB,EAAK4gB,QACJzoB,aACAK,gBAlBG,GAAIwH,GAAO7J,IAEXA,MAAK0J,YACL1J,KAAKoI,KAAM,EACXpI,KAAKkrB,aAAc,EACnBlrB,KAAKmrB,WAAY,EACjBnrB,KAAKorB,eACLprB,KAAKqrB,aAgBLrrB,KAAKsrB,eAAiB,WAC3BzhB,EAAKqhB,aAAc,GAGpBlrB,KAAKurB,eAAiB,SAAU5pB,GAC/BkI,EAAK4gB,OAAOzoB,UAAUuM,OAAO5M,EAAO,IAGrC3B,KAAKwrB,gBAAkB,WACtB3hB,EAAK4gB,OAAOzoB,UAAUE,KAAK2H,EAAKuhB,aAChCvhB,EAAKuhB,eACLvhB,EAAKqhB,aAAc,GAGpBlrB,KAAKyrB,kBAAoB,WACxB5hB,EAAKuhB,eACLvhB,EAAKqhB,aAAc,GAGpBlrB,KAAK0rB,gBAAkB,WACtB,QAAS7hB,EAAKuhB,YAAY/qB,QAAUwJ,EAAKuhB,YAAY3J,QAAU5X,EAAKuhB,YAAYO,gBAGjF3rB,KAAK4rB,aAAe,WACnB/hB,EAAKshB,WAAY,GAGlBnrB,KAAK6rB,aAAe,SAAUlqB,GAC7BkI,EAAK4gB,OAAOpoB,YAAYkM,OAAO5M,EAAO,IAGvC3B,KAAK8rB,cAAgB,WACpBjiB,EAAK4gB,OAAOpoB,YAAYH,KAAK2H,EAAKwhB,WAClCxhB,EAAKwhB,aACLxhB,EAAKshB,WAAY,GAGlBnrB,KAAK+rB,gBAAkB,WACtBliB,EAAKwhB,aACLxhB,EAAKshB,WAAY,GAGlBnrB,KAAKgsB,cAAgB,WACpB,QAASniB,EAAKwhB,UAAUhrB,QAAUwJ,EAAKwhB,UAAU5oB,KAGlDzC,KAAKisB,cAAgB,WACpB,GAAIrV,GAAQvV,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,kBAAkB7D,QAAS,SAAUA,GACzF,MAAOA,GAAQC,OAASwJ,EAAK4gB,OAAOpqB,MAErC,SAASuW,GAAU/M,EAAKzB,MAAUyB,EAAK4gB,OAAOpqB,OAAUwJ,EAAK4gB,OAAOyB,aAG/DlsB,KAAK+E,OAAS,WACnBwV,EAAkBuQ,QAAQ,UAGrB9qB,KAAKmsB,KAAO,WACbtiB,EAAKzB,IACRzI,EAAqBqqB,iBAAiBngB,EAAK4gB,QAAQ3oB,KAAK,WACvD+H,EAAK4gB,OAAOnkB,KAAO,iBACnBuD,EAAK4gB,OAAOpa,QAAU1Q,EACtBmE,EAAWG,IAAI,kBAAmB,kBAAkB7D,QAAQ8B,KAAK2H,EAAK4gB,QACtErkB,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,iCACnF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,gCACjF,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3BnrB,EAAqBuqB,iBAAiBrgB,EAAK4gB,OAAOpqB,KAAMwJ,EAAK4gB,QAAQ3oB,KAAK,WACzE+H,EAAK4gB,OAAOnkB,KAAO,iBACnBuD,EAAK4gB,OAAOpa,QAAU1Q,EACtByG,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,iCACnF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,gCACjF,WAAW,WACbkX,EAAkBuQ,QAAQ,YAKvB7pB,OA4IRsM,QAAQ6E,OAAO,eAAe2C,UAAU,cACtCN,YAAa,iDACbC,WAAYlR,qBACZkmB,UACCtpB,QAAS,OAGV4T,QAAQ,qBAAA,QAAA,YAAA,aAAA,UAAA,iBAAA,yBAAA,kBAAA,aAAqB,SAAS3U,EAAO+U,EAAW7U,EAAYO,EAASN,EAAgBmqB,EAAwBlJ,EAAiB3c,GACtI,GAAI8lB,GAAUpqB,EAAeU,QAAUV,EAAeW,cAClDyD,IAwFJ,OArFAA,GAAkBwoB,kBAAoB,WACrC,MAAOzC,GAAuBG,YAAY,MAAOF,EAAU,iBAG5DhmB,EAAkByoB,cAAgB,SAAShsB,GAC1C,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,IAG7EuD,EAAkB0oB,cAAgB,SAASC,GAC1C,MAAO5C,GAAuBG,YAAY,OAAQF,EAAU,eAAgB2C,IAG7E3oB,EAAkB4oB,cAAgB,SAASnsB,EAAMksB,GAChD,MAAO5C,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAMksB,IAGnF3oB,EAAkB6oB,iBAAmB,SAASpsB,GAC7C,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,eAAiBvpB,IAGhFuD,EAAkBQ,aAAe,SAAS/D,GACzC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAO,YAGpFuD,EAAkBS,gBAAkB,SAAShE,GAC5C,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAO,eAGpFuD,EAAkBkC,aAAe,SAASzF,EAAMmF,GAC/C,MAAOmkB,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAO,WAAamF,IAGjG5B,EAAkBoC,gBAAkB,SAAS3F,EAAMqsB,GAClD,MAAO/C,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAO,aAAeqsB,IAGnG9oB,EAAkByB,aAAe,SAAShF,EAAM4E,GAC/C,MAAO0kB,GAAuBG,YAAY,MAAOF,EAAU,eAAiBvpB,EAAO,WAAa4E,IAGjGrB,EAAkB+jB,WAAa,WACVvT,EAAUC,MAC7BG,WAAW,EACXC,YAAa,8CACbC,WAAY,sBACZC,aAAc,sBACdC,KAAM,KACNC,SACC3Q,IAAK,WACJ,MAAO,WAMXN,EAAkB4jB,YAAc,SAASnX,GACpB+D,EAAUC,MAC7BG,WAAW,EACXC,YAAa,8CACbC,WAAY,sBACZC,aAAc,sBACdC,KAAM,KACNC,SACC3Q,IAAK,WACJ,MAAOmM,QAMXzM,EAAkB6jB,cAAgB,SAASpX,GAC1C,MAAOoQ,GAAgBpM,KAAK9U,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,wBAAwBvB,KAAK,WACrH,MAAO8B,GAAkB6oB,iBAAiBpc,EAAQhQ,MAAMyB,KAAK,WAC5D,GAAIsV,GAAWtT,EAAWG,IAAI,kBAAmB,cACjD5C,GAAEwM,OAAOuJ,EAAShX,QAAS,SAASA,GACnC,MAAOA,GAAQC,OAASgQ,EAAQhQ,OAEjCyD,EAAWsE,IAAI,kBAAmB,cAAegP,GACjDtX,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,gCAClF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,sBAAuB9D,EAAW8D,QAAQ,kCAK9EO,KAGPkP,QAAA,kCAAO,SAAaE,GACpBA,EAAgCG,QAAQ,iBAExCuX,KAAA,4BAAA,oBAAI,SAAS1a,EAA2BpM,GACxCoM,EAA0B5H,KACzB9B,KAAM,cACN0iB,UAAW,cACXzB,WAAY,oBACZlX,QAASzM,EACT0M,gBAAgB,EAChBsE,KAAM,EACNrE,UACC/N,MAAO,sBACPkO,OAAQ,SAET4G,aAAc,EACdE,YAAa,EACb/G,KAAM,QACNka,UACCnlB,QACChD,MAAO,mCACPooB,YACCplB,OAAQ,qDAETsC,QACCxB,KAAM,UACN9D,MAAO,4CAGTmqB,eACCnqB,MAAO,qCACPooB,YACC8B,SAAU,yDAEX5kB,QACCxB,KAAM,UACN9D,MAAO,8CAGToqB,YACCpqB,MAAO,mCACPooB,YACC3lB,OAAQ,qDAET6C,QACCxB,KAAM,UACN9D,MAAO,kDAOb+K,QAAQ6E,OAAO,eACZsC,WAAW,uBAgBX,aAAc,oBAAqB,aAAc,aAAc,UAAW,oBAAqB,MAfhG,SAAStO,EAAYmU,EAAmBhb,EAAYuE,EAAYhE,EAAS8D,EAAmBM,GAiB5F,QAASjD,KACFiD,GACL2F,EAAK3F,IAAM7C,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,eAAe7D,QAAS,SAAUuK,GACrF,MAAOA,GAAItK,OAAS6D,EAAI7D,OAEzBwJ,EAAKzB,KAAM,GAEXyB,EAAK3F,KACJlC,aACAK,gBAGFhB,EAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAAUsB,GAChDA,EAAOuC,SAAWvC,EAAOmS,WAC5B1W,EAAEY,QAAQ2D,EAAOxF,QAAQqK,SAAU,SAASrK,EAASC,GACpD,GAAIsK,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QAEd+C,GAAItK,OAASwJ,EAAK3F,IAAL2F,WAAmBc,EAAI/E,SAAWiE,EAAK3F,IAAI0B,SAC3DiE,EAAKgjB,eAAiBliB,GAEvBd,EAAKY,SAASvI,KAAKyI,OAxCtB,GAAId,GAAO7J,IAEXA,MAAK0J,YACL1J,KAAKoI,KAAM,EACXpI,KAAKkE,KACJ7D,KAAM,GACNgb,YAAa,GACbgB,KAAM,GACNC,KAAM,EACNI,SAAU,GACV9W,OAAQ,GACRknB,SAAQ,IAET9sB,KAAKyK,YACLzK,KAAK6sB,kBAgCN7sB,KAAK+sB,WAAa,WACjB,GAAInW,GAAQvV,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,eAAe7D,QAAS,SAAUA,GACtF,MAAOA,GAAQC,OAASwJ,EAAK3F,IAAI7D,MAElC,SAASuW,GAAU/M,EAAKzB,MAAUyB,EAAK3F,IAAI7D,OAAUwJ,EAAK3F,IAAImY,OAG/Drc,KAAKmsB,KAAO,WACPtiB,EAAKzB,IACRxE,EAAkB0oB,cAAcziB,EAAK3F,KAAKpC,KAAK,WAC9C+H,EAAK3F,IAAIoC,KAAO,cAChBuD,EAAK3F,IAAImM,QAAUzM,EACnBE,EAAWG,IAAI,kBAAmB,eAAe7D,QAAQ8B,KAAK2H,EAAK3F,KACnEkC,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,8BAChF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,6BAC9E,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3BlnB,EAAkB4oB,cAAc3iB,EAAK3F,IAAI7D,KAAMwJ,EAAK3F,KAAKpC,KAAK,WAC7D+H,EAAK3F,IAAIoC,KAAO,cAChBuD,EAAK3F,IAAImM,QAAUzM,EACnBwC,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,8BAChF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,6BAC9E,WAAW,WACbkX,EAAkBuQ,QAAQ,YAK7B9qB,KAAK+E,OAAS,WACbwV,EAAkBuQ,QAAQ,UAG3B9qB,KAAKgtB,aAAe,WACfnjB,EAAKgjB,iBACRhjB,EAAK3F,IAAI0B,OAASiE,EAAKgjB,eAAejnB,OACtCiE,EAAK3F,IAAL2F,UAAkBA,EAAKgjB,eAAexsB,OAIxCY,OA0DFsM,QAAQ6E,OAAO,eAAe2C,UAAU,gBACpCN,YAAa,+CACbC,WAAYvO,uBACZ8mB,YAAY,EACZvD,UACIpjB,KAAM,IACNkK,KAAM,IACNhO,MAAO,IACPoS,KAAM,IACNxU,QAAS,IACT8sB,UAAW,IACXC,UAAW,IACX1c,KAAM,OA0CdlD,QAAQ6E,OAAO,eAAe2C,UAAU,aACpCN,YAAa,yCACbC,WAAYnN,oBACZmiB,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,SACN0iB,UAAW,aACX1Y,gBAAgB,OAIxB/C,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,SAAU,oBAAqB,aAAc,UAAW,mBAAoB,gBAAiB,SAf9F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAASsK,EAAkBvG,EAAe8iB,GAQtF,QAAS1lB,KACd4I,EAAK8c,OAAOnW,MAAO,EAEVnP,EAAEY,QAAQ4H,EAAKujB,iBAAkB,SAASC,GACtC9tB,EAAW8tB,EAAa7a,OAAO1Q,KAAK,SAAUwrB,GAC1CD,EAAaC,QAAUA,MAZnC,GAAIzjB,GAAO7J,IAEXA,MAAK2mB,OAASA,EACd3mB,KAAK2mB,OAAOhf,WAAa3H,KAAK2mB,OAAO/e,QAErC5H,KAAKotB,iBAAmBhjB,EAAiBuI,mBAYzC3S,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAK6M,GAAK,SAAU0gB,GACzB,MAAOhuB,GAAW8D,QAAQkqB,IAGrBvtB,KAAKwtB,WAAa,WACd3jB,EAAK8c,OAAO/e,QAAUiC,EAAK8c,OAAOhf,WAClCkC,EAAK8c,OAAO1Y,QAAUpE,EAAK8c,OAAO8G,eAAe,EAAE,EACnD5pB,EAAc6pB,cAAc7jB,EAAK8c,OAAO/gB,OAAQ,SAAUiE,EAAK8c,OAAOtmB,KAAMwJ,EAAK8c,QAAQ7kB,KAAK,SAAUC,GACpG3C,EAAO+H,WAAW,wBAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC9E,SAAU6D,GACTpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC5E,WAAW,WACVkX,EAAkBuQ,QAAQ,YAIlC7pB,OAIRsM,QAAQ6E,OAAO,eACZ4B,QAAQ,0BAgBR,QAAS,KAAM,aAAc,cAAe,iBAAkB,aAf/D,SAAS3U,EAAOoE,EAAI2C,EAAYunB,EAAa9tB,EAAgBiE,GAC3D,GAAI8pB,KA8BJ,OA5BAA,GAAuB9D,YAAc,SAAU/N,EAAQ1G,EAAK/J,EAAM6I,GAChE,GAAI0Z,GAAWpqB,EAAGqqB,QAEd9U,EAAQlV,EAAWG,IAAI,aAAc,SACrCuL,EAAM,GAAItC,KAqBd,OApBI8L,GAAM+U,WAAWC,UAAYxe,EAAIwe,UAEnCL,EAAYM,eAAensB,KAAK,SAAUkX,GACxC3Z,EAAM6uB,SAASC,QAAQC,OAAOC,cAAgB,UAAYrV,EAAMsV,aAChEjvB,GAAO0c,OAAQA,EAAQ1G,IAAKA,EAAK/J,KAAMA,EAAM6I,OAAQA,IAASrS,KAAK,SAAUC,GAC3E8rB,EAAShZ,QAAQ9S,EAASuJ,OACzB,SAAUpE,GACX2mB,EAASU,OAAOrnB,MAEjB,SAAUA,GACX2mB,EAASU,OAAOrnB,KAGlB7H,GAAO0c,OAAQA,EAAQ1G,IAAKA,EAAK/J,KAAMA,EAAM6I,OAAQA,IAASrS,KAAK,SAAUC,GAC3E8rB,EAAShZ,QAAQ9S,EAASuJ,OACzB,SAAUpE,GACX2mB,EAASU,OAAOrnB,KAIb2mB,EAASlP,SAGXiP,KAER5Z,QAAQ,mBAgBR,QAAS,KAAM,iBAAkB,yBAA0B,iBAf5D,SAAS3U,EAAOoE,EAAIjE,EAAgBmqB,EAAwB9pB,GAE1D,GAAI+pB,GAAUpqB,EAAeU,QAAUV,EAAegvB,eAClDC,IA6IJ,OA3IAA,GAAYC,iBAAmB,WAC7B,MAAO/E,GAAuBG,YAAY,MAAOF,EAAU,eAG7D6E,EAAYE,aAAe,SAAUtuB,GACnC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,aAAevpB,IAG5EouB,EAAYlL,gBAAkB,SAAUljB,EAAM8H,GAC5C,MAAOwhB,GAAuBG,YAAY,MAAOF,EAAU,aAAevpB,EAAO,YAAc8H,EAAQ,IAAI,OAG7GsmB,EAAYG,cAAgB,WAC1B,MAAOjF,GAAuBG,YAAY,MAAOF,EAAU,YAG7D6E,EAAYI,UAAY,SAAUxuB,GAChC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,IAGzEouB,EAAYK,UAAY,SAAUroB,GAChC,MAAOkjB,GAAuBG,YAAY,OAAQF,EAAU,UAAWnjB,IAGzEgoB,EAAYM,UAAY,SAAU1uB,EAAMoG,GACtC,MAAOkjB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAMoG,IAG/EgoB,EAAYrO,aAAe,SAAU/f,GACnC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,UAAYvpB,IAG5EouB,EAAY5nB,UAAY,SAAUxG,GAChC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAO,SAGhFouB,EAAYO,iBAAmB,WAC7B,MAAOrF,GAAuBG,YAAY,MAAOF,EAAU,eAG7D6E,EAAYQ,aAAe,SAAU5uB,GACnC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,aAAevpB,IAG5EouB,EAAYvmB,gBAAkB,SAAU7H,EAAM8H,GAC5C,MAAOwhB,GAAuBG,YAAY,MAAOF,EAAU,aAAevpB,EAAO,YAAc8H,EAAQ,IAAI,OAG7GsmB,EAAYS,aAAe,SAAU/U,GACnC,MAAOwP,GAAuBG,YAAY,OAAQF,EAAU,aAAczP,IAG5EsU,EAAYU,aAAe,SAAU9uB,EAAM8Z,GACzC,MAAOwP,GAAuBG,YAAY,MAAOF,EAAU,aAAevpB,EAAM8Z,IAGlFsU,EAAYjV,gBAAkB,SAAUnZ,GACtC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,aAAevpB,IAG/EouB,EAAYW,eAAiB,WAC3B,MAAOzF,GAAuBG,YAAY,MAAOF,EAAU,aAG7D6E,EAAYY,WAAa,SAAUhvB,GACjC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,WAAavpB,IAG1EouB,EAAYnmB,cAAgB,SAAUjI,EAAM8H,GAC1C,MAAOwhB,GAAuBG,YAAY,MAAOF,EAAU,WAAavpB,EAAO,YAAc8H,EAAQ,IAAI,OAG3GsmB,EAAYa,WAAa,SAAUjV,GACjC,MAAOsP,GAAuBG,YAAY,OAAQF,EAAU,WAAYvP,IAG1EoU,EAAYc,WAAa,SAAUlvB,EAAMga,GACvC,MAAOsP,GAAuBG,YAAY,MAAOF,EAAU,WAAavpB,EAAMga,IAGhFoU,EAAY5U,cAAgB,SAAUxZ,GACpC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,WAAavpB,IAI7EouB,EAAYe,eAAiB,WAC3B,MAAO7F,GAAuBG,YAAY,MAAOF,EAAU,YAG7D6E,EAAYgB,WAAa,SAAUC,GACjC,MAAO/F,GAAuBG,YAAY,MAAOF,EAAU,WAAa8F,IAG1EjB,EAAY/W,WAAa,SAAUgY,EAAYngB,GAC7C,MAAOoa,GAAuBG,YAAY,MAAOF,EAAU,WAAa8F,EAAYngB,IAGtFkf,EAAYrK,cAAgB,SAAUsL,GACpC,MAAO/F,GAAuBG,YAAY,SAAUF,EAAU,WAAa8F,IAI7EjB,EAAYxG,YAAc,WACxB,MAAO0B,GAAuBG,YAAY,MAAOF,EAAU,UAG7D6E,EAAYtG,QAAU,SAAU1L,GAC9B,MAAOkN,GAAuBG,YAAY,OAAQF,EAAU,QAASnN,IAGvEgS,EAAY/F,QAAU,SAAUroB,EAAMoc,GACpC,MAAOkN,GAAuBG,YAAY,MAAOF,EAAU,QAAUvpB,EAAMoc,IAG7EgS,EAAY7F,WAAa,SAAUvoB,GACjC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,QAAUvpB,IAI1EouB,EAAYvG,aAAe,SAAUxhB,GACnC,MAAOijB,GAAuBG,YAAY,MAAOF,EAAU,SAAU,KAAMljB,IAG7E+nB,EAAY1F,YAAc,SAAU/P,GAClC,MAAO2Q,GAAuBG,YAAY,OAAQF,EAAU,UAAW5Q,MAAOA,KAIhFyV,EAAYtrB,mBAAqB,WAC/B,GAAIoM,GAAU1P,EAAeuB,eACzBysB,EAAWpqB,EAAGqqB,OAClB,OAAMve,GACGkf,EAAY/W,WAAWnI,EAAQlP,KAAMkP,IAE5Cse,EAASU,OAAOrnB,OACT2mB,EAASlP,UAIb8P,KAIXlhB,QAAQ6E,OAAO,eACV4B,QAAQ,iBAgBR,QAAS,iBAAkB,yBAf5B,SAAS3U,EAAOG,EAAgBmqB,GAEhC,GAAIC,GAAUpqB,EAAeU,QAAUV,EAAemwB,aAClDlB,IAkEJ,OAhEAA,GAAYmB,eAAiB,WACzB,MAAOjG,GAAuBG,YAAY,MAAOF,EAAU,iBAG/D6E,EAAYvL,kBAAoB,WAC5B,MAAOyG,GAAuBG,YAAY,MAAOF,EAAU,uBAG/D6E,EAAYoB,cAAgB,WACxB,MAAOlG,GAAuBG,YAAY,MAAOF,EAAU,YAG/D6E,EAAYqB,UAAY,SAAUzvB,GAC9B,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,IAG3EouB,EAAY9M,UAAY,SAAU/b,GAC9B,MAAO+jB,GAAuBG,YAAY,OAAQF,EAAU,UAAWhkB,IAG3E6oB,EAAY5L,UAAY,SAAUjd,GAC9B,MAAO+jB,GAAuBG,YAAY,MAAOF,EAAU,UAAYhkB,EAAOvF,KAAMuF,IAGxF6oB,EAAY1L,aAAe,SAAU1iB,GACjC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,UAAYvpB,IAG9EouB,EAAYvM,cAAgB,SAAU7hB,GAClC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAO,aAGlFouB,EAAYlM,iBAAmB,SAAUliB,GACrC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAO,gBAGlFouB,EAAYsB,WAAa,SAAU1vB,GAC/B,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAO,UAGlFouB,EAAYnM,kBAAoB,SAAUjiB,GACtC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAO,cAGlFouB,EAAY5oB,WAAa,SAAU2E,EAAYwlB,EAAaC,EAAaC,EAAcC,GACnF,MAAOxG,GAAuBG,YAAY,MAAOF,EAAU,UAAYpf,EAAa,IAAMwlB,EAAc,IAAMC,EAAc,IAAMC,EAAc,KAAMC,IAG1J1B,EAAYf,cAAgB,SAAUljB,EAAYwlB,EAAaC,EAAa7vB,GACxE,MAAOupB,GAAuBG,YAAY,MAAOF,EAAU,UAAYpf,EAAa,IAAMwlB,EAAc,IAAMC,EAAa7vB,IAG/HquB,EAAY/gB,WAAa,SAAUlD,EAAYwlB,EAAaC,EAAahjB,GACrE,MAAO0c,GAAuBG,YAAY,MAAOF,EAAU,WAAapf,EAAa,IAAMwlB,EAAc,IAAMC,EAAa,KAAQhjB,GAAMA,KAAMA,GAAM,OAG1JwhB,EAAY2B,OAAS,SAAU5lB,EAAYwlB,EAAaC,EAAa5pB,GACjE,MAAOsjB,GAAuBG,YAAY,MAAOF,EAAU,UAAYpf,EAAa,IAAMwlB,EAAc,IAAMC,EAAc,IAAM5pB,IAGtIooB,EAAY4B,UAAY,SAAU7lB,EAAYwlB,EAAaC,EAAa5pB,GACpE,MAAOsjB,GAAuBG,YAAY,SAAUF,EAAU,UAAYpf,EAAa,IAAMwlB,EAAc,IAAMC,EAAc,IAAM5pB,IAGlIooB,KAGXlhB,QAAQ6E,OAAO,eACV4B,QAAQ,kBAgBR,QAAS,KAAM,iBAAkB,yBAA0B,iBAf5D,SAAS3U,EAAOoE,EAAIjE,EAAgBmqB,EAAwB9pB,GAE5D,GAAI+pB,GAAUpqB,EAAeU,QAAUV,EAAeW,cAClDsuB,IA2BJ,OAxBAA,GAAY6B,eAAiB,WACzB,MAAO3G,GAAuBG,YAAY,MAAOF,EAAU,YAG/D6E,EAAYpL,kBAAoB,WAC5B,MAAOsG,GAAuBG,YAAY,MAAOF,EAAU,mBAG/D6E,EAAYxJ,cAAgB,SAAUsL,EAAcC,GAChD,MAAO7G,GAAuBG,YAAY,MAAOF,EAAU,WAAa2G,EAAe,YAAcC,EAAO,IAAI,OAGpH/B,EAAYgC,eAAiB,SAAUF,EAAcnwB,GACjD,MAAOupB,GAAuBG,YAAY,MAAOF,EAAU,WAAa2G,EAAe,IAAMnwB,EAAU,aAG3GquB,EAAY2B,OAAS,SAAUG,EAAcnwB,EAASiG,GAClD,MAAOsjB,GAAuBG,YAAY,MAAOF,EAAU,WAAa2G,EAAe,IAAMnwB,EAAU,IAAMiG,IAGjHooB,EAAY4B,UAAY,SAAUE,EAAcnwB,EAASiG,GACrD,MAAOsjB,GAAuBG,YAAY,SAAUF,EAAU,WAAa2G,EAAe,IAAMnwB,EAAU,IAAMiG,IAG7GooB,KAGXlhB,QAAQ6E,OAAO,eACb4B,QAAQ,iBAgBR,iBAAkB,yBAA0B,iBAf7C,SAASxU,EAAgBmqB,EAAwB9pB,GAEjD,GAAI+pB,GAAUpqB,EAAeU,QAAUV,EAAekxB,aAClDjC,IAqDJ,OAlDAA,GAAY1O,eAAiB,SAAUR,EAAO5e,GAC7C,MAAOgpB,GAAuBG,YAAY,MAAOF,EAAU,UAAW,MAAOrK,MAAOA,EAAO5e,OAAQA,KAGpG8tB,EAAY3O,oBAAsB,SAAUtZ,EAAQ+Y,EAAO5e,GAC1D,MAAOgpB,GAAuBG,YAAY,MAAOF,EAAU,WAAapjB,EAAQ,MAAO+Y,MAAOA,EAAO5e,OAAQA,KAI9G8tB,EAAYkC,cAAgB,WAC3B,MAAOhH,GAAuBG,YAAY,MAAOF,EAAU,WAG5D6E,EAAYmC,UAAY,SAAUvwB,GACjC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,IAGxEouB,EAAY3T,UAAY,SAAUtU,GACjC,MAAOmjB,GAAuBG,YAAY,OAAQF,EAAU,UAAWpjB,IAGxEioB,EAAY7P,UAAY,SAAUve,EAAMmG,GACvC,MAAOmjB,GAAuBG,YAAY,MAAOF,EAAU,UAAYvpB,EAAMmG,IAG9EioB,EAAY3P,aAAe,SAAUze,GACpC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,UAAYvpB,IAI3EouB,EAAYoC,aAAe,WAC1B,MAAOlH,GAAuBG,YAAY,MAAOF,EAAU,UAG5D6E,EAAYqC,SAAW,SAAUxqB,EAAMjG,GACtC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,SAAWtjB,EAAO,IAAMjG,IAGpFouB,EAAYzQ,SAAW,SAAU1X,EAAMuX,GACtC,MAAO8L,GAAuBG,YAAY,OAAQF,EAAU,SAAWtjB,EAAMuX,IAG9E4Q,EAAYsC,SAAW,SAAUzqB,EAAMjG,EAAMwd,GAC5C,MAAO8L,GAAuBG,YAAY,MAAOF,EAAU,SAAWtjB,EAAO,IAAMjG,EAAMwd,IAG1F4Q,EAAYlQ,YAAc,SAAUjY,EAAMjG,GACzC,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,SAAWtjB,EAAO,IAAMjG,IAGhFouB,KAGRlhB,QAAQ6E,OAAO,eACbsC,WAAW,gBAgBV,SAAU,aAAc,YAAa,UAAW,QAAS,KAAM,YAAa,WAAY,aAAc,UAAW,kBAAmB,gBAAiB,iBAAkB,gBAAiB,aAAc,iBAAkB,iBAfzN,SAAStV,EAAQgH,EAAYzC,EAAWD,EAASrE,EAAOoE,EAAIkL,EAAWC,EAAUrP,EAAYO,EAASL,EAAiBoE,EAAenE,EAAgB+a,EAAe3W,EAAYjE,EAAgBL,GAWhM,QAASyB,KACR1B,EAAW,0BAA0BuC,KAAK,SAASU,MAKpD,QAASwuB,GAAYlpB,GACpBhI,EAAQsH,MAAMyC,EAAK/C,aACfgB,EACHhI,EAAQsD,KACPkD,KAAM,UACN9D,MAAOjD,EAAW8D,QAAQ,0BAC1B0D,KAAMxH,EAAW8D,QAAQ,mCAG1BvD,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,0BAC1B0D,KAAMxH,EAAW8D,QAAQ,gCAK5B,QAAS4tB,KACJnxB,EAAQsH,MAAMyC,EAAK/C,aACvB+C,EAAK/C,YAAchH,EAAQsD,KAC1BkD,KAAM,OACN9D,MAAOjD,EAAW8D,QAAQ,0BAC1B0D,KAAMxH,EAAW8D,QAAQ,wBACzB2D,QAAS,EACTC,iBAAiB,IAInB,QAASiqB,KACRD,IACAE,IACAtnB,EAAKunB,eAAiBC,IACtBxxB,EAAe6H,WAAY,EAC3B7H,EAAe2hB,UAAW,EAC1B3X,EAAK2M,QAAS,EAGf,QAAS8a,KACRL,IAGAptB,EAAcgsB,gBAAgB/tB,KAAK,SAASgG,GAC3CzG,EAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAASsB,GACnDA,EAAOuC,SAAU,EACjBvC,EAAOmS,WAAY,IAEpB1W,EAAEY,QAAQ6F,EAAQ,SAASlC,GAC1B9B,EAAWsE,IAAI,gBAAiBxC,EAAOvF,KAAMuF,IAG9C,IACI2rB,IADUztB,EAAWQ,IAAI,oBAE7BjD,GAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAASsB,EAAQ4E,GACvD5E,EAAOmS,YACVwZ,EAAe/mB,GAAc3G,EAAcye,kBAAkB9X,GAAY1I,KAAK,SAASgG,GACtF,GAAI0a,GAAY1e,EAAWG,IAAI,gBAAiBuG,EAC1CgY,KACLA,EAAUpiB,QAAU0H,IAEnB,WACFhI,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,WAAY9D,EAAW8D,QAAQ,wBACtEhD,KAAMmK,UAKV/G,EAAGa,IAAIitB,GAAgBzvB,KAAK,SAAS6L,MAAa,WAAW,WAC5DvH,EAAWe,WAAW,qBAErB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,WAAY9D,EAAW8D,QAAQ,2BACrE,WAAW,WAEb,GAAImuB,IACHjrB,QAAS9G,EAAgBmvB,gBACzB1U,WAAYza,EAAgBuvB,mBAC5B5U,SAAU3a,EAAgB2vB,iBAC1BpgB,SAAUvP,EAAgB+vB,iBAG3B/rB,GAAGa,IAAIktB,GAAa1vB,KAAK,SAASgG,GACjChE,EAAWoQ,UAAU,mBACrBpQ,EAAWoQ,UAAU,sBACrBpQ,EAAWoQ,UAAU,mBACrB,KAAKud,KAAM3pB,GAAOvB,QACjBzC,EAAWsE,IAAI,kBAAmBN,EAAOvB,QAAQkrB,IAAIpxB,KAAMyH,EAAOvB,QAAQkrB,IAE3ErrB,GAAWe,WAAW,yBACtB,KAAKuqB,KAAM5pB,GAAOoS,WACjBpW,EAAWsE,IAAI,qBAAsBN,EAAOoS,WAAWwX,IAAIrxB,KAAMyH,EAAOoS,WAAWwX,IAEpF,KAAK7kB,KAAM/E,GAAOsS,SACjBtW,EAAWsE,IAAI,mBAAoBN,EAAOsS,SAASvN,IAAIxM,KAAMyH,EAAOsS,SAASvN,IAE9EzG,GAAWe,WAAW,yBACtBtH,EAAemP,SAAWlH,EAAOkH,SACjC5P,EAAO+H,WAAW,2BAChB,SAASD,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,WAAY9D,EAAW8D,QAAQ,mCACrE,WAAW,WAGb3D,EAAe4wB,iBAAiBxuB,KAAK,SAASgG,GAC7ChE,EAAWoQ,UAAU,kBACrB,KAAKtG,MAAO9F,GACXzG,EAAEY,QAAQ6F,EAAO8F,KAAKxN,QAAS,SAASA,GACvCA,EAAQkG,KAAOwB,EAAO8F,KAAKvN,OAE5ByD,EAAWsE,IAAI,kBAAmBN,EAAO8F,KAAKvN,KAAMyH,EAAO8F,KAE5DxO,GAAO+H,WAAW,2BAEhB,SAASD,GACXpH,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,WAC1B0D,KAAMxH,EAAW8D,QAAQ,6BAExB,WAAW,WAEbvD,EAAQsH,MAAMyC,EAAK/C,aACnB1H,EAAO+H,WAAW,0BAMtB,QAASgqB,KACR,MAAOtnB,GAAK8nB,yBAAyB7vB,KAAK,SAASgG,GAClD,GAAI3D,IAAY0F,EAAK+nB,eACrB/xB,GAAemW,eAAgB,EAC/BnW,EAAeyW,gBAAiB,EAChCzW,EAAe6jB,eAAgB,CAC/B,KAAK9V,MAAO9F,GACXhE,EAAWsE,IAAI,aAAcN,EAAO8F,KAAKvN,KAAMyH,EAAO8F,MAC7B,WAArB9F,EAAO8F,KAAKvN,MAAqByH,EAAO8F,KAAKzF,SAChDtI,EAAemW,eAAgB,EAC/B7R,EAASjC,KAAK2H,EAAKgoB,eACY,YAArB/pB,EAAO8F,KAAKvN,MAAsByH,EAAO8F,KAAKzF,SACxDtI,EAAeyW,gBAAiB,EAChCnS,EAASjC,KAAK2H,EAAKioB,gBACY,WAArBhqB,EAAO8F,KAAKvN,MAAqByH,EAAO8F,KAAKzF,UACvDtI,EAAe6jB,eAAgB,EAC/Bvf,EAASjC,KAAK2H,EAAKkoB,cAGrBtuB,GAAGa,IAAIH,GAAUrC,KAAK,WACrB1C,EAAO+H,WAAW,sBAChB,WACFrH,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,0BAC1B0D,KAAMxH,EAAW8D,QAAQ,kCAExB,WAAW,WACbwG,EAAKmoB,cAAe,EACpB5yB,EAAO+H,WAAW,mBAEjB,SAASD,GACXpH,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,0BAC1B0D,KAAMxH,EAAW8D,QAAQ,kCAK5B,QAASguB,KAGR,MAAO1tB,GAAU,WACZkG,EAAKjF,UACR0sB,IACAznB,EAAKooB,eAAgB,GAErBpoB,EAAKooB,eAAgB,GAEpB,KAjMJ,GAAIpoB,GAAO7J,IAEXA,MAAK8G,YACL9G,KAAKgyB,cAAe,EACpBhyB,KAAKkyB,iBAAkB,EACvBlyB,KAAKmyB,cAAe,EACpBnyB,KAAK4E,UAAW,EAChB5E,KAAKoxB,eAAiB,KACtBpxB,KAAKwW,QAAS,EA4Ld9S,EAAQuC,OAAS,WAChB4D,EAAKjF,UAAW,GAGjBlB,EAAQwC,QAAU,WACjB2D,EAAKjF,UAAW,EACZiF,EAAKooB,gBACRX,IACAznB,EAAKooB,eAAgB,IAIvBjyB,KAAK2xB,uBAAyB,WAC7B,MAAOlyB,GAAgBivB,oBAGxB1uB,KAAK6xB,WAAa,WACjB,GAAIL,IACHY,kBAAmBvuB,EAAc+rB,iBACjCyC,aAAcxuB,EAAcgsB,gBAG7B,OAAOpsB,GAAGa,IAAIktB,GAAa1vB,KAAK,SAASgG,GACxC,GAAIsqB,GAAoBtqB,EAAOsqB,kBAC3BC,EAAevqB,EAAOuqB,YAG1BhxB,GAAEY,QAAQmwB,EAAmB,SAAS9rB,GACrCxC,EAAWsE,IAAI,oBAAqB9B,EAAKjG,KAAMiG,KAEhDlH,EAAO+H,WAAW,2BAGlB,IAAIwZ,KACJ7c,GAAWoQ,UAAU,iBACrB7S,EAAEY,QAAQowB,EAAc,SAAS7P,GAC5BA,EAAUzK,WACb4I,EAAWze,KAAK2B,EAAcye,kBAAkBE,EAAUniB,MAAMyB,KAAK,SAASgG,GAC7E0a,EAAUpiB,QAAU0H,GAClB,WACF0a,EAAUpiB,WACVN,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,wBAAyB9D,EAAW8D,QAAQ,wBACnFhD,KAAMmiB,EAAUniB,WAInByD,EAAWsE,IAAI,gBAAiBoa,EAAUniB,KAAMmiB,KAEjD/e,EAAGa,IAAIqc,GAAY7e,KAAK,SAASyC,MAAe,WAAW,WAC1D6B,EAAWe,WAAW;IAErB,SAASD,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,wBAAyB9D,EAAW8D,QAAQ,4BAItFrD,KAAK8xB,YAAc,WAGlB,MAFAhuB,GAAWoQ,UAAU,mBAEdxU,EAAe4wB,iBAAiBxuB,KAAK,SAASgG,GACpD,IAAK8F,MAAO9F,GACXzG,EAAEY,QAAQ6F,EAAO8F,KAAKxN,QAAS,SAASA,GACvCA,EAAQkG,KAAOwB,EAAO8F,KAAKvN,OAE5ByD,EAAWsE,IAAI,kBAAmBN,EAAO8F,KAAKvN,KAAMyH,EAAO8F,OAE1D,SAAS1G,GACXpH,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,yBAC1B0D,KAAMxH,EAAW8D,QAAQ,6BAExB,WAAW,WACb+C,EAAWe,WAAW,6BAKxBnH,KAAK+xB,WAAa,WACjBjuB,EAAWoQ,UAAU,iBACrBpQ,EAAWoQ,UAAU,oBACrBpQ,EAAWoQ,UAAU,mBACrB,IAAIoe,IACHC,QAAS9X,EAAckW,gBACvB6B,OAAQ/X,EAAcoW,eAGvB,OAAOptB,GAAGa,IAAIguB,GAAOxwB,KAAK,SAAS6L,GAClC,IAAKC,MAAOD,GAAQ4kB,QACnBzuB,EAAWsE,IAAI,gBAAiBuF,EAAQ4kB,QAAQ3kB,KAAKvN,KAAMsN,EAAQ4kB,QAAQ3kB,KAE5E,KAAKA,MAAOD,GAAQ6kB,OAAOhX,KAC1B1X,EAAWsE,IAAI,mBAAoBuF,EAAQ6kB,OAAOhX,KAAK5N,KAAKvN,KAAMsN,EAAQ6kB,OAAOhX,KAAK5N,KAEvF,KAAKA,MAAOD,GAAQ6kB,OAAO/W,KAC1B3X,EAAWsE,IAAI,mBAAoBuF,EAAQ6kB,OAAO/W,KAAK7N,KAAKvN,KAAMsN,EAAQ6kB,OAAO/W,KAAK7N,KAEvFxO,GAAO+H,WAAW,iBAChB,SAASD,GACXpH,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,wBAC1B0D,KAAMxH,EAAW8D,QAAQ,6BAK5BrD,KAAK8kB,kBAAoB,WAaxB,GAZAjlB,EAAeuB,gBAAiB,EAChCC,EAAEY,QAAQpC,EAAemP,SAAU,SAASO,GAC3C,GAAIA,EAAAA,WAAiB,CACpB1P,EAAeuB,eAAiBmO,CAChC,IAAIE,GAAM,GAAI/L,GAAQwJ,IACtBuC,GAAM,GAAI/L,GAAQwJ,KAAKuC,EAAIC,cAAgB,GAAID,EAAInC,WAAYmC,EAAIE,WACnEf,EAASgB,IAAI,mBAAoBL,EAAQlP,MACxCwP,QAASJ,QAKP5P,EAAeuB,eAAgB,CAEnC,GAAIqxB,IACHpyB,KAAMd,EAAW8D,QAAQ,mBACzB8gB,WAAS,EACT7Y,QAEDzL,GAAemP,UACdyjB,GAED5yB,EAAeuB,eAAiBqxB,EAChChzB,EAAgBiY,WAAWnY,EAAW8D,QAAQ,mBAAoBovB,GAAgB3wB,KAAK,WACtFhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAC5E,SAAS6D,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,wBAE7E,IAAIoM,GAAM,GAAI/L,GAAQwJ,IACtBuC,GAAM,GAAI/L,GAAQwJ,KAAKuC,EAAIC,cAAgB,GAAID,EAAInC,WAAYmC,EAAIE,WACnEf,EAASgB,IAAI,mBAAoBrQ,EAAW8D,QAAQ,oBACnDwM,QAASJ,IAEVrQ,EAAO+H,WAAW,4BAIpBnH,KAAK4xB,aAAe,WACnB,GAAIJ,IACHjrB,QAAS9G,EAAgBmvB,gBACzB1U,WAAYza,EAAgBuvB,mBAC5B5U,SAAU3a,EAAgB2vB,iBAC1BpgB,SAAUvP,EAAgB+vB,iBAG3B,OAAO/rB,GAAGa,IAAIktB,GAAa1vB,KAAK,SAASgG,GACxC,IAAK2pB,KAAM3pB,GAAOvB,QACjBzC,EAAWsE,IAAI,kBAAmBN,EAAOvB,QAAQkrB,IAAIpxB,KAAMyH,EAAOvB,QAAQkrB,IAE3EryB,GAAO+H,WAAW,yBAClB,KAAKuqB,KAAM5pB,GAAOoS,WACjBpW,EAAWsE,IAAI,qBAAsBN,EAAOoS,WAAWwX,IAAIrxB,KAAMyH,EAAOoS,WAAWwX,IAEpFtyB,GAAO+H,WAAW,4BAClB,KAAK0F,KAAM/E,GAAOsS,SACjBtW,EAAWsE,IAAI,mBAAoBN,EAAOsS,SAASvN,IAAIxM,KAAMyH,EAAOsS,SAASvN,IAI9E,IAFAzN,EAAO+H,WAAW,2BAEa,IAA3BW,EAAOkH,SAAS5M,OACnByH,EAAKib,oBACL1lB,EAAO+H,WAAW,8BACZ,CACNtH,EAAemP,SAAWlH,EAAOkH,QACjC,IAAI0jB,GAAe9jB,EAAS3K,IAAI,mBAChCpE,GAAeuB,gBAAiB,EAE1BsxB,GACLrxB,EAAEY,QAAQ6F,EAAOkH,SAAU,SAASO,GAC/BA,EAAQlP,OAASqyB,IACpB7yB,EAAeuB,eAAiBmO,EAChCnQ,EAAO+H,WAAW,6BAGftH,EAAeuB,gBACnByI,EAAKib,qBAGNjb,EAAKib,sBAGL,SAAS5d,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,0BAA2B9D,EAAW8D,QAAQ,8BAIxFrD,KAAK2yB,cAAgB,WACpB9yB,EAAemZ,MAAQ,KACvBnZ,EAAe2hB,UAAW,EAC1BpiB,EAAOwzB,UAAW,EAClB/yB,EAAemP,YACfnP,EAAeuB,eAAiB,KAChCyI,EAAK2M,QAAS,EACdpQ,EAAWe,WAAW,eACtBf,EAAWe,WAAW,gBACtBf,EAAWe,WAAW,eACtBf,EAAWe,WAAW,0BACtBf,EAAWe,WAAW,qBAGvB/H,EAAOmE,IAAI,eAAgB,WAC1BsG,EAAKgoB,eAGNzyB,EAAOmE,IAAI,gBAAiB,WAC3BsG,EAAKioB,gBAGN1yB,EAAOmE,IAAI,eAAgB,WAC1BsG,EAAKkoB,eAGN3yB,EAAOmE,IAAI,cAAe,WACzBO,EAAWoQ,UAAU,mBAGtB9U,EAAOmE,IAAI,eAAgB,WAC1BO,EAAWoQ,UAAU,mBACrBrU,EAAemP,YACfnP,EAAeuB,gBAAiB,IAGjChC,EAAOmE,IAAI,cAAe,WACzBO,EAAWoQ,UAAU,iBACrBpQ,EAAWoQ,UAAU,oBACrBpQ,EAAWoQ,UAAU,sBAGtB9U,EAAOmE,IAAI,UAAW,WACrB+tB,MAGDlyB,EAAOmE,IAAI,YAAa,WACvBnE,EAAO+H,WAAW,4BAGnB/H,EAAOmE,IAAI,eAAgB,WAC1B2tB,MAGD9xB,EAAOmE,IAAI,eAAgB,WACtBsG,EAAKmoB,aACRhB,GAAY,GACFnnB,EAAKqoB,iBACflB,GAAY,KAId5xB,EAAOmE,IAAI,cAAe,SAASgV,EAAOS,GACzClV,EAAWsE,IAAI,aAAc,QAAS4Q,GACtC3Z,EAAM6uB,SAASC,QAAQC,OAAOC,cAAgB,UAAYrV,EAAMsV,aAChE4C,MAGD9xB,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOS,GAC3C3Z,EAAM6uB,SAASC,QAAQC,OAAOC,cAAgB,UAAYrV,EAAMsV,aAChExqB,EAAWsE,IAAI,aAAc,QAAS4Q,GACjCnP,EAAK2M,QACT0a,MAIF9xB,EAAOmE,IAAI,kBAAmB,SAASgV,EAAOS,GAC7CnP,EAAK8oB,kBAGNvzB,EAAOmE,IAAI,eAAgB,SAASgV,EAAOS,GAC1ClZ,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,0BAA2B9D,EAAW8D,QAAQ,kBACtFwG,EAAK8oB,kBAGNvzB,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOS,GAC3C5Z,EAAO+H,WAAW,eAGnB/H,EAAOmE,IAAI,gBAAiB,SAASgV,EAAOjE,GAC3CzK,EAAK8oB,kBAGN1xB,OAIHsM,QAAQ6E,OAAO,eACb4B,QAAQ,mBAgBP,YAAa,aAAc,UAAW,aAAc,iBAAkB,kBAAmB,kBAAmB,gBAAiB,iBAf9H,SAASI,EAAW7U,EAAYO,EAASgE,EAAYjE,EAAgB4gB,EAAiBhhB,EAAiBoE,EAAenE,GACrH,GAAImzB,KAsRJ,OApRAA,GAAgB5kB,QAAU,SAAS7N,GACdgU,EAAUC,MAC7BG,WAAW,EACXC,YAAa,uCACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,KACNC,SACCzU,QAAS,WACR,MAAOA,QAMXyyB,EAAgBjxB,WAAa,SAASY,EAAOswB,GACxB1e,EAAUC,MAC7BG,WAAW,EACXC,YAAa,qCACbC,WAAY,iBACZC,aAAc,iBACdC,KAAM,KACNC,SACCrS,MAAO,WACN,MAAOA,IAERswB,IAAK,WACJ,MAAOA,QAMXD,EAAgBlZ,eAAiB,SAASvZ,GACzC,GAAIiG,GAAM,aACNkJ,EAAU1P,EAAeuB,cAO7B,IANKmO,EAAQqG,QACZrG,EAAQqG,UAEJrG,EAAQqG,MAAMC,IAClBtG,EAAQqG,MAAMC,MAETzV,EAAQwF,OAAQ,CACrB,GAAIsF,IACHtF,OAAQxF,EAAQwF,OAChBU,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdgG,IAAKA,EAENkJ,GAAQqG,MAAMC,EAAE3T,KAAKgJ,OACf,CACN,GAAIA,IACH5E,KAAMlG,EAAQkG,KACdjG,KAAMD,EAAQC,KACdgG,IAAKA,EAENkJ,GAAQqG,MAAMC,EAAE3T,KAAKgJ,GAEtB,MAAOzL,GAAgBiY,WAAWnI,EAAQlP,KAAMkP,GAASzN,KAAK,WAC7DhC,EAAQsD,KACPkD,KAAM,UACN9D,MAAOjD,EAAW8D,QAAQ,6BAC1B0D,KAAMxH,EAAW8D,QAAQ,wCAExB,WACFvD,EAAQsD,KACPkD,KAAM,QACN9D,MAAOjD,EAAW8D,QAAQ,6BAC1B0D,KAAMxH,EAAW8D,QAAQ,wCAK5BwvB,EAAgBxS,cAAgB,SAAS5Z,GACxC,MAAO8N,eAAgBH,EAAUC,MAChCG,WAAW,EACXC,YAAa,iDACbC,WAAY,6BACZC,aAAc,6BACdC,KAAM,KACNC,SACCpO,OAAQ,WACP,MAAOA,QAMXosB,EAAgB1a,oBAAsB,SAAS/X,GAC9C,GAAI2V,GAAmBlW,EAAekW,gBAOtC,OANyBgd,UAArBhd,GACH1U,EAAEwM,OAAOkI,EAAkB,SAASc,GACnC,MAAQA,GAAOvQ,OAASlG,EAAQkG,MAAQuQ,EAAOzW,QAAQwF,SAAWxF,EAAQwF,QAAUiR,EAAOzW,QAAQC,OAASD,EAAQC,OAGtHR,EAAekW,iBAAmBA,GAC3B,GAGR8c,EAAgB1M,aAAe,SAASM,GACnBrS,EAAUC,MAC7BG,WAAW,EACXC,YAAa,sCACbC,WAAY,oBACZC,aAAc,oBACdC,KAAM,KACNC,SACC4R,SAAU,WACT,MAAOA,QAMXoM,EAAgBvN,WAAa,SAASI,GACjBtR,EAAUC,MAC7BG,WAAW,EACXC,YAAa,sCACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,KACNC,SACC6Q,OAAQ,WACP,MAAOA,QAMXmN,EAAgBhN,WAAa,SAASE,GACjB3R,EAAUC,MAC7BG,WAAW,EACXC,YAAa,sCACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,KACNC,SACCkR,OAAQ,WACP,MAAOA,QAMX8M,EAAgBxM,WAAa,SAASM,GACjBvS,EAAUC,MAC7BG,WAAW,EACXC,YAAa,sCACbC,WAAY,mBACZC,aAAc,mBACdC,KAAM,KACNC,SACC8R,OAAQ,WACP,MAAOA,QAMXkM,EAAgB1S,WAAa,SAAS1Z,GACjB2N,EAAUC,MAC7BG,WAAW,EACXC,YAAa,sCACbC,WAAY,kBACZC,aAAc,kBACdC,KAAM,KACNC,SACCpO,OAAQ,WACP,MAAOA,QAMXosB,EAAgBzS,aAAe,SAAS3Z,GACvC,MAAOga,GAAgBpM,KAAK9U,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,0BAA0BvB,KAAK,SAASgG,GAC3H,MAAOrI,GAAgB2gB,aAAa3Z,EAAOpG,MAAMyB,KAAK,WACrDgC,EAAW+J,OAAO,kBAAmBpH,EAAOpG,MAC5CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,2BAC7E,SAAS6D,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,iBAAkB9D,EAAW8D,QAAQ,6BAKhFwvB,EAAgBtZ,UAAY,SAAShB,EAAOya,GACvB5e,EAAUC,MAC7BG,WAAW,EACXC,YAAa,oCACbC,WAAY,iBACZC,aAAc,iBACdC,KAAM,KACNC,SACC0D,MAAO,WACN,MAAOA,IAERya,UAAW,WACV,MAAOA,QAMXH,EAAgBrZ,gBAAkB,SAASjB,GAC1C,MAAOkI,GAAgBpM,KAAK9U,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,6BAA6BvB,KAAK,SAASgG,GACjI,MAAOrI,GAAgB+Z,gBAAgBjB,EAAMlY,MAAMyB,KAAK,WACvDgC,EAAW+J,OAAO,qBAAsB0K,EAAMlY,MAC9CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,8BAChF,SAAS6D,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,oBAAqB9D,EAAW8D,QAAQ,gCAKnFwvB,EAAgBhZ,cAAgB,SAASQ,GACxC,MAAOoG,GAAgBpM,KAAK9U,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAA2BvB,KAAK,SAASgG,GAC7H,MAAOrI,GAAgBoa,cAAcQ,EAAQha,MAAMyB,KAAK,WACvDgC,EAAW+J,OAAO,mBAAoBwM,EAAQha,MAC9CP,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,4BAC9E,SAAS6D,GACXpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,8BAKjFwvB,EAAgB9b,iBAAmB,SAASnR,EAAQU,EAAMjG,GACzD,GAAI2M,GAAWlJ,EAAWG,IAAI,gBAAiB2B,EAC/C,IAAMoH,GAAcA,EAAS5M,QAC5B,OAAQkG,GACP,IAAK,SACJ,GAAM0G,EAAS5M,QAAQqK,UAAYuC,EAAS5M,QAAQqK,SAASpK,GAC5D,MAAO2M,GAAS5M,QAAQqK,SAASpK,EAElC,MACD,KAAK,SACJ,GAAM2M,EAAS5M,QAAQyK,SAAWmC,EAAS5M,QAAQyK,QAAQxK,GAC1D,MAAO2M,GAAS5M,QAAQyK,QAAQxK,EAEjC,MACD,KAAK,SACJ,GAAM2M,EAAS5M,QAAQ0K,SAAWkC,EAAS5M,QAAQ0K,QAAQzK,GAC1D,MAAO2M,GAAS5M,QAAQ0K,QAAQzK,EAEjC,MACD,KAAK,SACJ,GAAM2M,EAAS5M,QAAQ2K,SAAWiC,EAAS5M,QAAQ2K,QAAQ1K,GAC1D,MAAO2M,GAAS5M,QAAQ2K,QAAQ1K,GAKpC,OAAO,GAGRwyB,EAAgBI,kBAAoB,SAAS5iB,EAAShQ,GACrD,GAAMgQ,GAAahQ,EAAM,CACxB,GAAIgnB,GAAWvjB,EAAWG,IAAI,kBAAmBoM,GAC7CjQ,EAAUiB,EAAE2C,KAAKqjB,EAASjnB,QAAS,SAASuK,GAC/C,MAAOA,GAAItK,OAASA,GAErB,OAAOD,KAAW,EAEnB,OAAO,GAGRyyB,EAAgB/L,cAAgB,SAAS7Y,GAIxC,MAHA5M,GAAEwM,OAAOhO,EAAeuB,eAAe+V,YAAa,SAAS+b,GAC5D,MAAOA,GAAW7yB,OAAS4N,EAAQ5N,OAE7BZ,EAAgB0D,qBAAqBrB,KAAK,WAChDhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAC5E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,0BAIvEwvB,KAIVtlB,QAAQ6E,OAAO,eACVsC,WAAW,kBAgBX,SAAU,aAAc,oBAAqB,aAAc,UAAW,mBAAoB,kBAAmB,kBAAmB,aAAc,4BAA6B,QAAS,YAfrL,SAAStV,EAAQgH,EAAYmU,EAAmBhb,EAAYO,EAASsK,EAAkBxK,EAAiBH,EAAiBqE,EAAYkM,EAA2BuI,EAAOya,GA4FnK,QAAS/xB,KACRsX,IACL1O,EAAKzB,KAAM,EACY,cAAnByB,EAAKmpB,WACRnpB,EAAKsQ,UAAY5M,QAAQC,KAAK+K,GAC9B1O,EAAKsQ,UAAUgZ,aAAgB5a,EAAM7S,UACrCmE,EAAKsQ,UAAUiZ,sBACdC,QAAQ,EACRC,QAAQ,EACRC,SAAS,EACTC,WAAW,EACXC,UAAU,EACVC,QAAQ,EACRC,UAAU,GAEU,IAAjBpb,EAAM7S,SACTmE,EAAKsQ,UAAUiZ,sBACdC,OAAsC,KAAP,EAArB9a,EAAMqb,cAChBN,OAAsC,KAAP,EAArB/a,EAAMqb,cAChBL,QAAuC,KAAP,EAArBhb,EAAMqb,cACjBJ,UAAyC,KAAP,EAArBjb,EAAMqb,cACnBH,SAAyC,KAAR,GAArBlb,EAAMqb,cAClBF,OAAuC,KAAR,GAArBnb,EAAMqb,cAChBD,SAAyC,KAAR,GAArBpb,EAAMqb,gBAGpB/pB,EAAKgqB,OAAS,GAAI3mB,MAAuB,IAAlBqL,EAAMmB,YACA,YAAnB7P,EAAKmpB,YACfnpB,EAAKwQ,QAAQ5H,UAAY8F,EAAM9F,UAC/B5I,EAAKwQ,QAAQyZ,OAASvb,EAAMub,OAC5BjqB,EAAKwQ,QAAQja,QAAUmY,EAAMnY,SAE9ByJ,EAAKoW,WAAa1H,EAAMhS,QACxBsD,EAAK6I,cAAgB6F,EAAMwb,YAG5B1yB,EAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAAUsB,GAChDA,EAAOuC,SAAWvC,EAAOmS,YAC5B1W,EAAEY,QAAQ2D,EAAOxF,QAAQqK,SAAU,SAASrK,EAASC,GAChDD,EAAQsG,QAAQ2T,SACnBxQ,EAAKmqB,yBAAyB9xB,MAAMuQ,UAAW,SAAUqhB,OAAQluB,EAAOvF,KAAMD,QAASC,EAAMuH,QAASxH,EAAQwH,SAE/G,IAAI+C,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,OAAO,EAERoC,GAAKoqB,eAAexpB,SAASvI,KAAKyI,KAEnCtJ,EAAEY,QAAQ2D,EAAOxF,QAAQyK,QAAS,SAASzK,EAASC,GAC/CD,EAAQsG,QAAQ2T,SACnBxQ,EAAKmqB,yBAAyB9xB,MAAMuQ,UAAW,SAAUqhB,OAAQluB,EAAOvF,KAAMD,QAASC,EAAMuH,QAASxH,EAAQwH,SAE/G,IAAI+C,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,MAAO,EAERoC,GAAKoqB,eAAeppB,QAAQ3I,KAAKyI,KAElCtJ,EAAEY,QAAQ2D,EAAOxF,QAAQ0K,QAAS,SAAS1K,EAASC,GAC/CD,EAAQsG,QAAQ2T,SACnBxQ,EAAKmqB,yBAAyB9xB,MAAMuQ,UAAW,SAAUqhB,OAAQluB,EAAOvF,KAAMD,QAASC,EAAMuH,QAASxH,EAAQwH,SAE/G,IAAI+C,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,MAAO,GACPf,QAAStG,EAAQsG,QACjB8B,eAAgBpI,EAAQqH,MAAMe,eAE/BqB,GAAKoqB,eAAenpB,QAAQ5I,KAAKyI,KAElCtJ,EAAEY,QAAQ2D,EAAOxF,QAAQ2K,QAAS,SAAS3K,EAASC,GAC/CD,EAAQsG,QAAQ2T,SACnBxQ,EAAKmqB,yBAAyB9xB,MAAMuQ,UAAW,SAAUqhB,OAAQluB,EAAOvF,KAAMD,QAASC,EAAMuH,QAASxH,EAAQwH,SAE/G,IAAI+C,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,MAAO,EACPf,QAAStG,EAAQsG,QAElBmD,GAAKoqB,eAAelpB,QAAQ7I,KAAKyI,QAKpCtJ,EAAEY,QAAQ6B,EAAWQ,IAAI,mBAAoB,SAAU+L,EAAS6jB,GAC/D,GAAI9c,GAAW/V,EAAE2C,KAAKgM,EAA0BG,WAAY,SAAUC,GACrE,MAAOA,GAAO9J,OAAS4tB,GAAe7jB,EAAQlI,SAE/C9G,GAAEY,QAAQoO,EAAQjQ,QAAS,SAAUA,GAChCA,EAAQsG,SAAWtG,EAAQsG,QAAQ2T,SACtCxQ,EAAKmqB,yBAAyB9xB,MAAMuQ,UAAW,UAAWqhB,OAAQzjB,EAAQhQ,KAAMD,QAASA,EAAQC,KAAMuH,QAASxH,EAAQC,SAGpH+W,GACL/V,EAAEY,QAAQmV,EAASuT,SAAU,SAAUjiB,EAASyrB,GAC/C,GAAIC,IAAa5hB,MAAO9J,EAAQlG,MAAOnC,KAAM6zB,EAAc,IAAMC,EAAa1hB,UAAW,UACzF5I,GAAKwqB,kBAAkBnyB,KAAKkyB,GAC5BvqB,EAAKyqB,6BAA6BJ,EAAc,IAAMC,GAAe9jB,EAAQjQ,QACvEiQ,EAAQsa,SAASwJ,KACtBtqB,EAAK0qB,mCAAmCL,EAAc,IAAMC,MAC5D9yB,EAAEY,QAAQoO,EAAQsa,SAASwJ,GAAavJ,WAAY,SAAU4J,EAAkBC,GAC/E,GAAIC,IACHr0B,KAAMo0B,EACNjyB,MAASkG,EAAQkiB,WAAW6J,GAAsBl1B,EAAW8D,QAAQqF,EAAQkiB,WAAW6J,IAAuBA,EAC/GnuB,KAAMkuB,EAAiBluB,KACvBquB,SAAUH,EAAiBG,SAE5B9qB,GAAK0qB,mCAAmCL,EAAc,IAAMC,GAAajyB,KAAKwyB,KAE/E7qB,EAAK+qB,iCAAiCV,EAAc,IAAMC,MAC1D9yB,EAAEY,QAAQoO,EAAQsa,SAASwJ,GAAarsB,OAAQ,SAAU+sB,EAAeC,GACxE,GAA0B,SAAtBA,EAA8B,CACjC,GAAIC,IACHvyB,MAAOjD,EAAW8D,QAAQ,8BAC1BiD,KAAMuuB,EAEPhrB,GAAK+qB,iCAAiCV,EAAc,IAAMC,GAAajyB,KAAK6yB,OACtE,CACN,GAAIA,IACH10B,KAAMy0B,EACNtyB,MAAOjD,EAAW8D,QAAQqF,EAAQZ,OAAOgtB,GAAmBtyB,OAC5D8D,KAAMuuB,EAAcvuB,KAErBuD,GAAK+qB,iCAAiCV,EAAc,IAAMC,GAAajyB,KAAK6yB,WAQlF1zB,EAAEY,QAAQ6B,EAAWQ,IAAI,mBAAoB,SAAU+L,EAAS6jB,GAC/D,GAAI9c,GAAW/V,EAAE2C,KAAKgM,EAA0BG,WAAY,SAAUC,GACrE,MAAOA,GAAO9J,OAAS4tB,GAAe7jB,EAAQlI,SAEzCiP,IACL/V,EAAEY,QAAQmV,EAASzJ,QAAS,SAAU7F,EAAQktB,GAC7C,GAAMltB,EAAOxB,MAAUwB,EAAOtF,MAAO,CACpC,GAAIyyB,IAAgBziB,MAAO1K,EAAOtF,MAAOnC,KAAM6zB,EAAc,IAAMc,EAAYviB,UAAW,UAAWnM,KAAMwB,EAAOxB,KAClHuD,GAAKwqB,kBAAkBnyB,KAAK+yB,GAC5BprB,EAAKyqB,6BAA6BJ,EAAc,IAAMc,GAAc3kB,EAAQjQ,YAE5EiB,GAAEY,QAAQ6F,EAAQ,SAAUotB,EAAWC,GACtC,GAAIF,IAAgBziB,MAAO0iB,EAAU1yB,MAAOnC,KAAM6zB,EAAc,IAAMiB,EAAe1iB,UAAW,UAAWnM,KAAM4uB,EAAU5uB,KAAM8uB,MAAOD,EACxItrB,GAAKwqB,kBAAkBnyB,KAAK+yB,GAC5BprB,EAAKyqB,6BAA6BJ,EAAc,IAAMiB,GAAiB9kB,EAAQjQ,cAxP/E,GAAIyJ,GAAO7J,IAEXA,MAAKoI,KAAM,EACXpI,KAAKkH,OACVmuB,aAAa,EACb/gB,QAAS,IAEJtU,KAAKs1B,iBAAmB/nB,QAAQC,KAAK1J,EAAWQ,IAAI,oBACpDtE,KAAKq0B,kBAAoB9mB,QAAQC,KAAKpD,EAAiBsI,eACvD1S,KAAKg0B,4BACLh0B,KAAK4S,yBAA2BxI,EAAiBwI,yBACjD5S,KAAKuY,MAAQA,IAClBlY,KAAM,GACNgb,YAAa,GACblT,SAAS,GAEJnI,KAAKma,WACVgZ,cAAc,EACdztB,UACAkuB,aAAc,EACd2B,cAAc,EACdnC,sBACCC,QAAQ,EACRC,QAAQ,EACRC,SAAS,EACTC,WAAW,EACXC,UAAU,EACVC,QAAQ,EACRC,UAAU,IAGN3zB,KAAKqa,SACV5H,WAAW,EACXqhB,QAAQ,EACR1zB,SAAS,GAEJJ,KAAKigB,cACLjgB,KAAK0S,iBACL1S,KAAK6zB,OAAS,GAAI3mB,MAClBlN,KAAKi0B,gBACVxpB,YACAI,WACAC,WACAC,YAED/K,KAAKs0B,gCACLt0B,KAAK40B,oCACL50B,KAAKu0B,sCACLv0B,KAAKuS,wBACLvS,KAAKw1B,YAAa,EAClBx1B,KAAKy1B,WAAY,EACjBz1B,KAAKi1B,cACJS,UAAW,KACXjuB,MAAO,EACPmjB,eAED5qB,KAAKgzB,UAAYA,EAEjBhzB,KAAK21B,cACL31B,KAAK41B,iBAEC51B,KAAK61B,mBACVC,WACCC,MAAM,EACNvmB,KACCumB,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,oBAE1B4yB,OACCF,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,sBAE1B+D,OACC2uB,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,sBAE1B6yB,MACCH,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,qBAE1BkJ,MACCwpB,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,qBAE1B+b,OACC2W,MAAM,EACNC,KAAMz2B,EAAW8D,QAAQ,wBA0K5BrD,KAAKm2B,aAAe,SAASte,GAC5BA,EAAEue,iBACFve,EAAEwe,kBAEFxsB,EAAKmI,QAAS,GAGThS,KAAKs2B,mBAAqB,SAASl2B,EAASkG,GACjD,MAAMlG,IAAakG,EACXlG,EAAQwF,OAAS,IAAMU,EAAO,IAAMlG,EAAQC,KAE5C,eAITL,KAAKu2B,oBAAsB,SAAUn2B,EAASoF,GAC7C,MAAMpF,IAAaoF,EACXA,EAAS,IAAMpF,EAAQC,KAEvB,eAITL,KAAKw2B,oBAAsB,SAAUp2B,GACpC,MAAOA,GAAQqS,UAAY,IAAMrS,EAAQ0zB,OAAS,IAAM1zB,EAAQA,SAG3DJ,KAAK6M,GAAK,SAAU0gB,GACzB,MAAOhuB,GAAW8D,QAAQkqB,IAG3BvtB,KAAKy2B,iBAAmB,WACvB,GAAM5sB,EAAK6sB,kBAAwD,WAApC7sB,EAAK6sB,iBAAiBjkB,UACpD,OAAQ5I,EAAK6sB,iBAAiBr2B,MAC7B,IAAK,SACL,IAAK,SACL,IAAK,SACJ,QAASwJ,EAAK2rB,UAEf,KAAK,SACJ,QAAK3rB,EAAK2rB,eAGA3rB,EAAKorB,aAAaS,YAAgB7rB,EAAKorB,aAAa0B,cAAiB9sB,EAAKorB,aAAa2B,iBAG7F,IAAM/sB,EAAK6sB,kBAAwD,YAApC7sB,EAAK6sB,iBAAiBjkB,UAAyB,CACpF,IAAK5I,EAAKorB,aAAaS,YAAe7rB,EAAKorB,aAAaxtB,OAAqC,IAA5BoC,EAAKorB,aAAaxtB,QAAiBoC,EAAK2rB,WACxG,OAAO,CAGR,IAAIqB,IAAM,CAOV,OANAx1B,GAAEY,QAAQ4H,EAAK0qB,mCAAmC1qB,EAAK6sB,iBAAiBr2B,MAAO,SAAUy2B,GACpFA,EAAUnC,WAAc9qB,EAAKorB,aAAarK,WAAWkM,EAAUz2B,OAA0D,IAAjDwJ,EAAKorB,aAAarK,WAAWkM,EAAUz2B,QAClHw2B,GAAM,KAIDA,EAER,OAAO,GAGR72B,KAAK+2B,kBAAoB,SAAUtvB,GAClC,MAAOlI,GAAW8D,QAAQ,eAAiBoE,IAGtCzH,KAAKg3B,0BAA4B,WACtCntB,EAAKorB,aAAaxiB,UAAY,SAC9B5I,EAAKorB,aAAa70B,QAAUyJ,EAAK2rB,WAAWn1B,KAC5CwJ,EAAKorB,aAAarK,WAAWhlB,OAASiE,EAAK2rB,WAAW5vB,OACtDiE,EAAKorB,aAAarK,WAAWqM,aAAeptB,EAAK2rB,WAAWlvB,MAG7DtG,KAAKk3B,aAAe,WASnB,GARwC,WAApCrtB,EAAK6sB,iBAAiBjkB,WAA0B5I,EAAKorB,aAAa0B,cACrE9sB,EAAKorB,aAAaG,MAAQ,OAC1BvrB,EAAKorB,aAAaxtB,MAAQoC,EAAKorB,aAAa0B,aAEL,WAApC9sB,EAAK6sB,iBAAiBjkB,WAA0B5I,EAAKorB,aAAa2B,cACrE/sB,EAAKorB,aAAaG,MAAQ,UAC1BvrB,EAAKorB,aAAaxtB,MAAQoC,EAAKorB,aAAa2B,aAEL,YAApC/sB,EAAK6sB,iBAAiBjkB,UAAyB,CAClD,GAAI0kB,GAAettB,EAAK6sB,iBAAiBr2B,KAAKqW,MAAM,IACpD7M,GAAKorB,aAAaG,MAAQvrB,EAAK6sB,iBAAiBtB,MAChDvrB,EAAKorB,aAAaxiB,UAAY,UAC9B5I,EAAKorB,aAAa70B,QAAUyJ,EAAK2rB,WAAWn1B,KAC5CwJ,EAAKorB,aAAarK,WAAWva,QAAUxG,EAAK2rB,WAAWlvB,KACvDuD,EAAKorB,aAAa5kB,QAAU8mB,EAAa,GACzCttB,EAAKorB,aAAavsB,QAAUyuB,EAAa,GACnCttB,EAAK4rB,UAAUp1B,OACpBwJ,EAAKorB,aAAaG,MAAQvrB,EAAK4rB,UAAUp1B,MAI3CwJ,EAAK6I,cAAcxQ,KAAK2H,EAAKorB,cAC7BprB,EAAKorB,cACJS,UAAW,KACXjuB,MAAO,EACPmjB,gBAIF5qB,KAAKo3B,gBAAkB,SAAUz1B,GAChCkI,EAAK6I,cAAcnE,OAAO5M,EAAO,IAGlC3B,KAAKq3B,iBAAmB,SAAU3B,GACjC,GAAMA,GAAqC,WAAxBA,EAAUjjB,UAC5B,OAAQijB,EAAU9K,WAAWqM,cAC5B,IAAK,SACJ,GAAIK,GAAYj2B,EAAE2C,KAAK6F,EAAKoqB,eAAexpB,SAAU,SAAUrK,GAC9D,MAAOs1B,GAAU9K,WAAWhlB,SAAWxF,EAAQwF,QAAU8vB,EAAUt1B,UAAYA,EAAQC,MAExF,OAASi3B,GAAU/3B,EAAW8D,QAAQ,gBAAgB,IAAIi0B,EAAU1vB,QAAQ,KAAK8tB,EAAUjuB,MAAMlI,EAAW8D,QAAQ,uBAAuB9D,EAAW8D,QAAQ,yBAAyB9D,EAAW8D,QAAQ,gBAAgB,IAAI9D,EAAW8D,QAAQ,YAElP,KAAK,SACJ,GAAIk0B,GAAYl2B,EAAE2C,KAAK6F,EAAKoqB,eAAeppB,QAAS,SAAUzK,GAC7D,MAAOs1B,GAAU9K,WAAWhlB,SAAWxF,EAAQwF,QAAU8vB,EAAUt1B,UAAYA,EAAQC,MAExF,OAASk3B,GAAUh4B,EAAW8D,QAAQ,gBAAgB,IAAIk0B,EAAU3vB,QAAQ,IAAI8tB,EAAUA,UAAU,IAAIA,EAAUjuB,MAAMlI,EAAW8D,QAAQ,gBAAgB,IAAI9D,EAAW8D,QAAQ,YAEnL,KAAK,SACJ,GAAIm0B,GAAYn2B,EAAE2C,KAAK6F,EAAKoqB,eAAenpB,QAAS,SAAU1K,GAC7D,MAAOs1B,GAAU9K,WAAWhlB,SAAWxF,EAAQwF,QAAU8vB,EAAUt1B,UAAYA,EAAQC,MAExF,KAAMm3B,EAOL,MAAOj4B,GAAW8D,QAAQ,YAN1B,IAAwB,YAApBqyB,EAAUN,MACb,MAAO71B,GAAW8D,QAAQ,gBAAgB,IAAIm0B,EAAU5vB,QAAQ,IAAI8tB,EAAUA,UAAU,IAAIA,EAAUjuB,KAChG,IAAwB,SAApBiuB,EAAUN,MACpB,MAAO71B,GAAW8D,QAAQ,gBAAgB,IAAIm0B,EAAU5vB,QAAQ,IAAI8tB,EAAUA,UAAU,IAAIn2B,EAAW8D,QAAQ,eAAeqyB,EAAUjuB,MAK1I,MACD,KAAK,SACJ,GAAIgwB,GAAYp2B,EAAE2C,KAAK6F,EAAKoqB,eAAelpB,QAAS,SAAU3K,GAC7D,MAAOs1B,GAAU9K,WAAWhlB,SAAWxF,EAAQwF,QAAU8vB,EAAUt1B,UAAYA,EAAQC,MAExF,OAASo3B,GAAUl4B,EAAW8D,QAAQ,gBAAgB,IAAIo0B,EAAU7vB,QAAQ,IAAI8tB,EAAUA,UAAU,IAAIA,EAAUjuB,MAAMlI,EAAW8D,QAAQ,gBAAgB,IAAI9D,EAAW8D,QAAQ,iBAG9K,IAAMqyB,GAAqC,YAAxBA,EAAUjjB,UAAyB,CAC5D,GAAIilB,GAAer2B,EAAE2C,KAAK6F,EAAKwqB,kBAAmB,SAAUsD,GAC3D,MAAOA,GAAKt3B,OAASq1B,EAAUrlB,QAAU,IAAMqlB,EAAUhtB,UAEtDkvB,EAAYr4B,EAAW8D,QAAQ,6BACnC,IAAMqyB,EAAUN,MAAO,CACtB,GAAIF,GAAY7zB,EAAE2C,KAAK6F,EAAK+qB,iCAAiC8C,EAAar3B,MAAO,SAAUw2B,GAC1F,MAAOA,GAAIx2B,OAASq1B,EAAUN,OAE/BwC,GAAc1C,EAAUA,EAAU1yB,MAAMjD,EAAW8D,QAAQ,8BAE5D,MAASq0B,GAAan4B,EAAW8D,QAAQq0B,EAAallB,OAAO,IAAIolB,EAAU,IAAIlC,EAAUA,UAAU,IAAIA,EAAUjuB,MAAMlI,EAAW8D,QAAQ,eAI5IrD,KAAK8uB,UAAY,SAASroB,GACzBoD,EAAKoW,WAAW/d,MAAM7B,KAAMoG,EAAOpG,KAAM8H,SAAS,UAC3C0B,GAAKyrB,iBAAiB7uB,EAAOpG,OAGrCL,KAAKogB,aAAe,SAAUze,GAC7B,GAAI8E,GAASoD,EAAKoW,WAAWte,EAC7BkI,GAAKyrB,iBAAiB7uB,EAAOpG,MAAQkN,QAAQC,KAAK1J,EAAWG,IAAI,kBAAmBwC,EAAOpG,OAC3FwJ,EAAKoW,WAAW1R,OAAO5M,EAAO,IAG/B3B,KAAK63B,aAAe,WACnB,IAAKhuB,EAAK0O,MAAMlY,KAEf,MADAwJ,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,yBACjC,CAGR,IAAIwG,EAAKzB,IACR,GAAuB,cAAnByB,EAAKmpB,WACR,GAAMlvB,EAAWG,IAAI,qBAAsB4F,EAAK0O,MAAMlY,MAErD,MADAwJ,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,6BACjC,MAEF,IAAuB,YAAnBwG,EAAKmpB,WACTlvB,EAAWG,IAAI,mBAAoB4F,EAAK0O,MAAMlY,MAEnD,MADAwJ,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,6BACjC,CAOV,IAFAwG,EAAK3C,MAAMmuB,aAAc,GAEpBxrB,EAAKmpB,UAET,MADAnpB,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,yBACjC,CAGR,IAAuB,cAAnBwG,EAAKmpB,UAA2B,CACnC,IAAKnpB,EAAKgqB,OAET,MADAhqB,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,mCACjC,CACD,IAAIwG,EAAKgqB,OAAS,GAAI3mB,QAAWrD,EAAK0O,MAAM7S,OAElD,MADAmE,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,gCACjC,MAEF,MAAuB,YAAnBwG,EAAKmpB,WACVnpB,EAAKwQ,QAAQ5H,WAAc5I,EAAKwQ,QAAQyZ,QAAWjqB,EAAKwQ,QAAQja,SAEpE,MADAyJ,GAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,6BACjC,CAIT,OAA+B,KAA3BwG,EAAKoW,WAAW7d,QACnByH,EAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,2BACjC,IAGRwG,EAAK3C,MAAMoN,QAAU,IACd,IAGFtU,KAAKmsB,KAAO,WACM,cAAnBtiB,EAAKmpB,WACRnpB,EAAKsQ,UAAU9Z,KAAOwJ,EAAK0O,MAAMlY,KACjCwJ,EAAKsQ,UAAUkB,YAAcxR,EAAK0O,MAAM8C,YACxCxR,EAAKsQ,UAAUhS,QAAU0B,EAAK0O,MAAMpQ,QACpC0B,EAAKsQ,UAAUT,UAAY7Q,KAAKC,MAAMe,EAAKgqB,OAAOzmB,UAAY,KAChC,IAA1BvD,EAAKsQ,UAAUzU,SAElBmE,EAAKsQ,UAAUyZ,aAAe,EAC9B/pB,EAAKsQ,UAAUiZ,qBAAqBC,SAAWxpB,EAAKsQ,UAAUyZ,cAAgB,GAC9E/pB,EAAKsQ,UAAUiZ,qBAAqBE,SAAWzpB,EAAKsQ,UAAUyZ,cAAgB,GAC9E/pB,EAAKsQ,UAAUiZ,qBAAqBG,UAAY1pB,EAAKsQ,UAAUyZ,cAAgB,GAC/E/pB,EAAKsQ,UAAUiZ,qBAAqBI,YAAc3pB,EAAKsQ,UAAUyZ,cAAgB,GACjF/pB,EAAKsQ,UAAUiZ,qBAAqBK,WAAa5pB,EAAKsQ,UAAUyZ,cAAgB,IAChF/pB,EAAKsQ,UAAUiZ,qBAAqBM,SAAW7pB,EAAKsQ,UAAUyZ,cAAgB,IAC9E/pB,EAAKsQ,UAAUiZ,qBAAqBO,WAAa9pB,EAAKsQ,UAAUyZ,cAAgB,KAEjF/pB,EAAKsQ,UAAU5T,QAAUsD,EAAKoW,WAC9BpW,EAAKsQ,UAAU4Z,WAAalqB,EAAK6I,cAE7B7I,EAAKzB,IACR3I,EAAgByvB,aAAarlB,EAAKsQ,WAAWrY,KAAK,WACjDhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAChFS,EAAWsE,IAAI,qBAAsByB,EAAKsQ,UAAU9Z,KAAMwJ,EAAKsQ,WAC/D/T,EAAWe,WAAW,8BACpB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAC5E,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3BrrB,EAAgB0vB,aAAatlB,EAAKsQ,UAAU9Z,KAAMwJ,EAAKsQ,WAAWrY,KAAK,WACtEhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAChFS,EAAWsE,IAAI,qBAAsByB,EAAKsQ,UAAU9Z,KAAMwJ,EAAKsQ,WAC/D/T,EAAWe,WAAW,8BACpB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,kBAAmB9D,EAAW8D,QAAQ,2BAC5E,WAAW,WACbkX,EAAkBuQ,QAAQ,YAGC,YAAnBjhB,EAAKmpB,YACfnpB,EAAKwQ,QAAQha,KAAOwJ,EAAK0O,MAAMlY,KAC/BwJ,EAAKwQ,QAAQgB,YAAcxR,EAAK0O,MAAM8C,YACtCxR,EAAKwQ,QAAQlS,QAAU0B,EAAK0O,MAAMpQ,QAClC0B,EAAKwQ,QAAQ9T,QAAUsD,EAAKoW,WAC5BpW,EAAKwQ,QAAQ0Z,WAAalqB,EAAK6I,cAC3B7I,EAAKzB,IACR3I,EAAgB6vB,WAAWzlB,EAAKwQ,SAASvY,KAAK,WAC7ChC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC9ES,EAAWsE,IAAI,mBAAoByB,EAAKwQ,QAAQha,KAAMwJ,EAAKwQ,SAC3DjU,EAAWe,WAAW,4BACpB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC1E,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3BrrB,EAAgB8vB,WAAW1lB,EAAKwQ,QAAQha,KAAMwJ,EAAKwQ,SAASvY,KAAK,WAChEhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC9ES,EAAWsE,IAAI,mBAAoByB,EAAKwQ,QAAQha,KAAMwJ,EAAKwQ,SAC3DjU,EAAWe,WAAW,4BACpB,WACFrH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,gBAAiB9D,EAAW8D,QAAQ,yBAC1E,WAAW,WACbkX,EAAkBuQ,QAAQ,aAMxB9qB,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B7pB,OAsBRsM,QAAQ6E,OAAO,eAAe2C,UAAU,gBACpCN,YAAa,2CACbC,WAAYzM,uBACZyhB,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,YACN0iB,UAAW,gBACX1Y,gBAAgB,OAGvB9J,OAqBD+G,QAAQ6E,OAAO,eAAe2C,UAAU,cACpCN,YAAa,yCACbC,WAAYrM,qBACZqhB,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,UACN0iB,UAAW,cACX1Y,gBAAgB,OAGvB9J,OAED+G,QAAQ6E,OAAO,eACdsC,WAAW,uBAAwB,SAAU,SAAStV,GAEnD,GAAI04B,GAAY,IAEhB93B,MAAKiB,KAAO,SAASb,EAASsG,GAE5B,MADAoxB,GAAY13B,EAAQ03B,UAAUpxB,GAAS4E,KAAK,cAI9CtL,KAAK+3B,WAAa,SAAS33B,GACzB,MAAG03B,GACMA,EAAUE,aAAa53B,GAAS,GAElC,MAGTJ,KAAKi4B,QAAU,SAAS73B,GACtB,MAAG03B,IACDA,EAAUI,WAAW93B,GACdA,GAEF,SAKbmN,QAAQ6E,OAAO,eAEd4W,UAAU,aAAc,WAAY,SAASzT,GAE1C,OACE4iB,SAAU,IACVzjB,WAAY,sBACZ2U,OACE/Q,SAAU,IACV8f,YAAa,IACbC,WAAY,IACZC,cAAe,IACfC,aAAc,IACd7xB,QAAS,KAEX4iB,KAAM,SAAUD,EAAOjpB,EAASo4B,EAAO9jB,EAAY+jB,GAEjD/jB,EAAWzT,KAAKb,EAASipB,EAAM3iB,SAE/BtG,EAAQs4B,GAAG,SAAU,SAAU7gB,EAAGW,GAChCjD,EAAS,WACP8T,EAAMsP,SACNtP,EAAM/Q,UAAUC,MAAOV,EAAGW,MAAOA,QAIrCpY,EAAQs4B,GAAG,YAAa,SAAS7gB,EAAG+gB,GAClCvP,EAAM+O,aAAa7f,MAAOV,EAAG+gB,GAAIA,MAGnCx4B,EAAQs4B,GAAG,WAAY,SAAS7gB,EAAG+gB,GACjCrjB,EAAS,WACP8T,EAAMsP,SACNtP,EAAMgP,YAAY9f,MAAOV,EAAG+gB,GAAIA,aAOxC5P,UAAU,iBAAkB,WAAY,SAASzT,GAEjD,OACE4iB,SAAU,IACVzjB,WAAY,sBACZmkB,QAAS,aACTxP,OACEyP,cAAe,IACfC,YAAa,IACbC,cAAe,IACfC,QAAS,IACTC,QAAS,IACTC,YAAa,IACbC,aAAc,IACdC,cAAe,KAEjB/P,KAAM,SAAUD,EAAOjpB,EAASo4B,EAAO9jB,GAErC7D,EAAEzQ,GAASwY,KAAK,YAAayQ,EAAM4P,SACnCpoB,EAAEzQ,GAASwY,KAAK,YAAayQ,EAAM6P,SACnCroB,EAAEzQ,GAASwY,KAAK,gBAAiByQ,EAAM8P,aACvCtoB,EAAEzQ,GAASwY,KAAK,iBAAkByQ,EAAM+P,cACxCvoB,EAAEzQ,GAASwY,KAAK,wBAAyByQ,EAAMgQ,cAC/C,IACI3gB,IADShE,EAAWujB,QAAQ73B,GACrBA,EAAQkL,KAAK,mBACxBiK,GAAS,WACP8T,EAAM0P,aAAargB,KAAMA,MAG3B2Q,EAAMtX,OAAO,WAAY,MAAOlB,GAAEzQ,GAASwY,KAAK,cAAiB,SAAS0gB,GACxEjQ,EAAM4P,QAAUK,IAGlBjQ,EAAMtX,OAAO,WAAY,MAAOlB,GAAEzQ,GAASwY,KAAK,cAAiB,SAAS0gB,GACxEjQ,EAAM6P,QAAUI,IAGlBjQ,EAAMtX,OAAO,WAAY,MAAOlB,GAAEzQ,GAASwY,KAAK,kBAAqB,SAAS0gB,GAC5EjQ,EAAM8P,YAAcG,IAGtBjQ,EAAMtX,OAAO,WAAY,MAAOlB,GAAEzQ,GAASwY,KAAK,mBAAsB,SAAS0gB,GAC7EjQ,EAAM+P,aAAeE,IAGvBl5B,EAAQm5B,KAAK,WAAY,WACvB,GAAI7gB,GAAOtY,EAAQkL,KAAK,kBACxB+d,GAAM2P,eAAetgB,KAAMA,IAC3BhE,EAAWqjB,WAAW33B,UAgEhCmN,QAAQ6E,OAAO,eAAe2C,UAAU,aACpCN,YAAa,yCACbC,WAAYnM,oBACZmhB,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,SACN0iB,UAAW,aACX1Y,gBAAgB,OAIxB/C,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,SAAU,oBAAqB,aAAc,UAAW,mBAAoB,gBAAiB,SAf9F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAASsK,EAAkBvG,EAAekiB,GAQtF,QAAS9kB,KACd4I,EAAKkc,OAAOvV,MAAO,EAEVnP,EAAEY,QAAQ4H,EAAKujB,iBAAkB,SAASC,GACtC9tB,EAAW8tB,EAAa7a,OAAO1Q,KAAK,SAAUwrB,GAC1CD,EAAaC,QAAUA,MAZnC,GAAIzjB,GAAO7J,IAEXA,MAAK+lB,OAASA,EACd/lB,KAAK+lB,OAAOpe,WAAa3H,KAAK+lB,OAAOne,QAErC5H,KAAKotB,iBAAmBhjB,EAAiBuI,mBAYzC3S,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAK6M,GAAK,SAAU0gB,GACzB,MAAOhuB,GAAW8D,QAAQkqB,IAGrBvtB,KAAKw5B,WAAa,WACd3vB,EAAKkc,OAAOne,QAAUiC,EAAKkc,OAAOpe,WAClCkC,EAAKkc,OAAO9X,QAAUpE,EAAKkc,OAAO0H,eAAe,EAAE,EACnD5pB,EAAc6pB,cAAc7jB,EAAKkc,OAAOngB,OAAQ,SAAUiE,EAAKkc,OAAO1lB,KAAMwJ,EAAKkc,QAAQjkB,KAAK,SAAUC,GACpG3C,EAAO+H,WAAW,wBAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC9E,SAAU6D,GACTpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC5E,WAAW,WACVkX,EAAkBuQ,QAAQ,YAIlC7pB,OA0BRsM,QAAQ6E,OAAO,eAAe2C,UAAU,eACpCN,YAAa,mDACbC,WAAYvL,sBACZugB,UACItpB,QAAS,OAGhB4T,QAAQ,sBAAA,QAAA,YAAA,aAAA,UAAA,iBAAA,yBAAA,kBAAA,aAAsB,SAAS3U,EAAO+U,EAAW7U,EAAYO,EAASN,EAAgBmqB,EAAwBlJ,EAAiB3c,GACpI,GAAI8lB,GAAUpqB,EAAeU,QAAUV,EAAeW,cAClDs5B,IA8EJ,OA3EAA,GAAYC,YAAc,WACtB,MAAO/P,GAAuBG,YAAY,MAAOF,EAAU,kBAG/D6P,EAAYE,QAAU,SAAUt5B,GAC5B,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,gBAAkBvpB,IAGjFo5B,EAAYG,QAAU,SAAUC,GAC5B,MAAOlQ,GAAuBG,YAAY,OAAQF,EAAU,gBAAiBiQ,IAGjFJ,EAAYK,QAAU,SAAUz5B,EAAMw5B,GAClC,MAAOlQ,GAAuBG,YAAY,MAAOF,EAAU,gBAAkBvpB,EAAMw5B,IAGvFJ,EAAYM,WAAa,SAAU15B,GAC/B,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,gBAAkBvpB,IAGpFo5B,EAAY9vB,YAAc,SAAUtJ,EAAMqI,EAASY,EAAQC,EAAQC,GACrE,MAAgB,UAAZd,GAAmC,UAAZA,EACnBihB,EAAuBG,YAAY,MAAOF,EAAU,gBAAkBvpB,EAAO,YAAcqI,GAC5E,UAAZA,EACHihB,EAAuBG,YAAY,MAAOF,EAAU,gBAAkBvpB,EAAO,YAAcqI,EAAU,IAAMY,GAE3GqgB,EAAuBG,YAAY,MAAOF,EAAU,gBAAkBvpB,EAAO,YAAcqI,EAAU,IAAMY,EAAS,IAAMC,EAAS,IAAMC,IAIlJiwB,EAAY9R,WAAa,WACJvT,EAAUC,MAC7BG,WAAW,EACXC,YAAa,gDACbC,WAAY,uBACZC,aAAc,uBACdC,KAAM,KACNC,SACCglB,KAAM,WACL,MAAO,WAMXJ,EAAYjS,YAAc,SAAUnX,GACf+D,EAAUC,MAC7BG,WAAW,EACXC,YAAa,gDACbC,WAAY,uBACZC,aAAc,uBACdC,KAAM,KACNC,SACCglB,KAAM,WACL,MAAOxpB,QAMXopB,EAAYhS,cAAgB,SAAUpX,GACrC,MAAOoQ,GAAgBpM,KAAK9U,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,yBAAyBvB,KAAK,WACvH,MAAO23B,GAAYM,WAAW1pB,EAAQhQ,MAAMyB,KAAK,WAChD,GAAIsV,GAAWtT,EAAWG,IAAI,kBAAmB,eACjD5C,GAAEwM,OAAOuJ,EAAShX,QAAS,SAAUA,GACpC,MAAOA,GAAQC,OAASgQ,EAAQhQ,OAEjCyD,EAAWsE,IAAI,kBAAmB,eAAgBgP,GAClDtX,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,iCACnF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,uBAAwB9D,EAAW8D,QAAQ,mCAK5Eo2B,KAGV3mB,QAAA,kCAAO,SAAaE,GACpBA,EAAgCG,QAAQ,kBAExCuX,KAAA,4BAAA,qBAAI,SAAS1a,EAA2B5G,GACrC4G,EAA0B5H,KACtB9B,KAAM,eACN0iB,UAAW,eACXzB,WAAY,qBACZlX,QAASjH,EACTkH,gBAAgB,EAChBsE,KAAM,EACNrE,UACL/N,MAAO,qBACPkO,OAAQ,eAET4G,aAAc,EACdE,YAAa,EACb/G,KAAM,cACNka,UACCqP,OACCx3B,MAAO,mCACPooB,YACCthB,OAAQ,oDACRC,OAAQ,oDACRC,OAAQ,qDAET1B,QACCmyB,QACC3zB,KAAM,UACN9D,MAAO,kDAER03B,QACC5zB,KAAM,UACN9D,MAAO,oDAIV23B,OACC33B,MAAO,mCACPooB,YACCthB,OAAQ,qDAETxB,QACCxB,KAAM,SACN9D,MAAO,4CAGT43B,OACC53B,MAAO,mCACPooB,cACA9iB,QACCxB,KAAM,SACN9D,MAAO,4CAGT63B,OACC73B,MAAO,mCACPooB,cACA9iB,QACCmyB,QACC3zB,KAAM,UACN9D,MAAO,kDAER03B,QACC5zB,KAAM,UACN9D,MAAO,0DAQb+K,QAAQ6E,OAAO,eACVsC,WAAW,wBAgBX,aAAc,oBAAqB,aAAc,aAAc,UAAW,qBAAsB,OAfjG,SAAStO,EAAYmU,EAAmBhb,EAAYuE,EAAYhE,EAASsJ,EAAoBywB,GAMzF,QAAS54B,KACR44B,GACLhwB,EAAKgwB,KAAOA,EACZhwB,EAAKzB,KAAM,GAEXyB,EAAKgwB,QAVD,GAAIhwB,GAAO7J,IAEXA,MAAK0J,YACL1J,KAAKoI,KAAM,EAWXpI,KAAK+E,OAAS,WACnBwV,EAAkBuQ,QAAQ,UAGrB9qB,KAAKmsB,KAAO,WACbtiB,EAAKzB,IACRgB,EAAmBwwB,QAAQ/vB,EAAKgwB,MAAM/3B,KAAK,WAC1C+H,EAAKgwB,KAAKvzB,KAAO,eACjBuD,EAAKgwB,KAAKxpB,QAAUjH,EACpBtF,EAAWG,IAAI,kBAAmB,gBAAgB7D,QAAQ8B,KAAK2H,EAAKgwB,MACpEzzB,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,+BACjF,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,8BAC/E,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3B1hB,EAAmB0wB,QAAQjwB,EAAKgwB,KAAKx5B,KAAMwJ,EAAKgwB,MAAM/3B,KAAK,WAC1D,GAAIw4B,GAAQx2B,EAAWG,IAAI,kBAAmB,gBAAgB7D,OAC9DiB,GAAEY,QAAQq4B,EAAO,SAAUT,GACtBA,EAAKx5B,OAASwJ,EAAKgwB,KAAKx5B,OAC3Bw5B,EAAKxe,YAAcxR,EAAKgwB,KAAKxe,eAG/BjV,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,+BACjF,SAAU6D,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,qBAAsB9D,EAAW8D,QAAQ,8BAC/E,WAAW,WACbkX,EAAkBuQ,QAAQ,YAKvB7pB,OA4BRsM,QAAQ6E,OAAO,eAAe2C,UAAU,aACpCN,YAAa,yCACbC,WAAY9K,oBACZ8f,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,SACN0iB,UAAW,aACX1Y,gBAAgB,OAsBxB/C,QAAQ6E,OAAO,eACVsC,WAAW,mBAgBX,SAAU,aAAc,oBAAqB,aAAc,UAAW,mBAAoB,kBAAmB,kBAAmB,aAAc,4BAA6B,SAf5K,SAAStV,EAAQgH,EAAYmU,EAAmBhb,EAAYO,EAASsK,EAAkBxK,EAAiBH,EAAiBqE,EAAYkM,EAA2BvJ,GAoB5J,QAASxF,KACP4I,EAAKpD,SACToD,EAAKzB,KAAM,EACXyB,EAAKpD,QACJ8zB,WACA7zB,aAGFrF,EAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAAUsB,GAChDA,EAAOuC,SAAWvC,EAAOmS,YAC5B1W,EAAEY,QAAQ2D,EAAOxF,QAAQqK,SAAU,SAASrK,EAASC,GACpD,GAAIsK,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,OAAO,EAERoC,GAAKoqB,eAAexpB,SAASvI,KAAKyI,KAEnCtJ,EAAEY,QAAQ2D,EAAOxF,QAAQyK,QAAS,SAASzK,EAASC,GACnD,GAAIsK,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,MAAO,EAERoC,GAAKoqB,eAAeppB,QAAQ3I,KAAKyI,KAElCtJ,EAAEY,QAAQ2D,EAAOxF,QAAQ0K,QAAS,SAAS1K,EAASC,GACnD,GAAIsK,IACH/E,OAAQA,EAAOvF,KACfiG,KAAM,SACNjG,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBH,MAAO,GACPe,eAAgBpI,EAAQqH,MAAMe,eAE/BqB,GAAKoqB,eAAenpB,QAAQ5I,KAAKyI,QAKpCtJ,EAAEY,QAAQ6B,EAAWQ,IAAI,mBAAoB,SAAU+L,EAAS6jB,GAC/D,GAAI9c,GAAW/V,EAAE2C,KAAKgM,EAA0BG,WAAY,SAAUC,GACrE,MAAOA,GAAO9J,OAAS4tB,GAAe7jB,EAAQlI,SAEzCiP,IACL/V,EAAEY,QAAQmV,EAASuT,SAAU,SAAUjiB,EAASyrB,GAC/C,GAAIC,IAAa5hB,MAAO9J,EAAQlG,MAAOnC,KAAM6zB,EAAc,IAAMC,EAAa1hB,UAAW,UACzF5I,GAAKyqB,6BAA6BJ,EAAc,IAAMC,GAAe9jB,EAAQjQ,QAC7EyJ,EAAK0I,qBAAqBrQ,KAAKkyB,GACzB/jB,EAAQsa,UAActa,EAAQsa,SAASwJ,KAC5CtqB,EAAK0qB,mCAAmCL,EAAc,IAAMC,MAC5D9yB,EAAEY,QAAQoO,EAAQsa,SAASwJ,GAAavJ,WAAY,SAAU4J,EAAkBC,GAC/E,GAAIC,IACHr0B,KAAMo0B,EACNjyB,MAASkG,EAAQkiB,WAAW6J,GAAsBl1B,EAAW8D,QAAQqF,EAAQkiB,WAAW6J,IAAuBA;AAC/GnuB,KAAMkuB,EAAiBluB,KACvBquB,SAAUH,EAAiBG,SAE5B9qB,GAAK0qB,mCAAmCL,EAAc,IAAMC,GAAajyB,KAAKwyB,UAjFhF,GAAI7qB,GAAO7J,IAEXA,MAAKyG,OAASA,EACdzG,KAAKoI,KAAM,EACXpI,KAAKo0B,WAAY,EACjBp0B,KAAKw6B,eAAgB,EACrBx6B,KAAKw1B,cACLx1B,KAAKuS,qBAAuBhF,QAAQC,KAAKpD,EAAiBmI,sBAC1DvS,KAAKi0B,gBACRxpB,YACAI,WACAC,YAED9K,KAAKkH,OACJoN,QAAS,IAEVtU,KAAKu0B,sCACLv0B,KAAKs0B,gCAyEDt0B,KAAKy6B,uBAAyB,WACjC5wB,EAAKuqB,UAAUh0B,QAAUyJ,EAAK2rB,WAAWn1B,KACzCwJ,EAAKuqB,UAAUxJ,WAAWhlB,OAASiE,EAAK2rB,WAAW5vB,OACnDiE,EAAKuqB,UAAUxJ,WAAWqM,aAAeptB,EAAK2rB,WAAWlvB,MAGtDtG,KAAK06B,wBAA0B,WAClC7wB,EAAKuqB,UAAUh0B,QAAUyJ,EAAK2rB,WAAWn1B,MAGtCL,KAAKs2B,mBAAqB,SAASl2B,EAASkG,GAC/C,MAAMlG,IAAakG,EACXlG,EAAQwF,OAAS,IAAMU,EAAO,IAAMlG,EAAQC,KAE5C,eAITL,KAAKu2B,oBAAsB,SAAUn2B,EAASoF,GAC7C,MAAMpF,IAAaoF,EACXA,EAAS,IAAMpF,EAAQC,KAEvB,eAILL,KAAK26B,UAAY,WACpB9wB,EAAKuqB,cAGNp0B,KAAK46B,iBAAmB,WAOvB,OANA/wB,EAAKuqB,WACJ3hB,UAAW,GACXrS,QAAS,GACTwqB,eAGO/gB,EAAK2wB,cAAcn6B,MAC1B,IAAK,SACJwJ,EAAKuqB,UAAU3hB,UAAY,SAC3B5I,EAAKuqB,UAAU1rB,QAAU,EACzBmB,EAAKuqB,UAAUxJ,WAAWqM,aAAe,QACzC,MACD,KAAK,SACJptB,EAAKuqB,UAAU3hB,UAAY,SAC3B5I,EAAKuqB,UAAU1rB,QAAU,EACzBmB,EAAKuqB,UAAUxJ,WAAWqM,aAAe,QACzC,MACD,KAAK,SACJptB,EAAKuqB,UAAU3hB,UAAY,SAC3B5I,EAAKuqB,UAAU1rB,QAAU,GACzBmB,EAAKuqB,UAAUxJ,WAAWqM,aAAe,SACzCptB,EAAKuqB,UAAUxJ,WAAWjiB,KAAO,MACjC,MACD,SACC,GAAIkyB,GAAwBhxB,EAAK2wB,cAAcn6B,KAAKqW,MAAM,IAC1D7M,GAAKuqB,UAAUxJ,WAAWva,QAAUwqB,EAAsB,GAC1DhxB,EAAKuqB,UAAU1rB,QAAUmyB,EAAsB,GAC/ChxB,EAAKuqB,UAAU3hB,UAAY,YAK9BzS,KAAK86B,aAAe,SAAUC,GAC7BlxB,EAAKpD,OAAO8zB,QAAQhsB,OAAOwsB,EAAQ,IAGhC/6B,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAK6M,GAAK,SAAU0gB,GACvB,MAAOhuB,GAAW8D,QAAQkqB,IAG3BvtB,KAAK+2B,kBAAoB,SAAUtvB,GAClC,MAAOlI,GAAW8D,QAAQ,eAAiBoE,IAGxCzH,KAAKmsB,KAAO,WACXtiB,EAAKzB,IACR3I,EAAgBqvB,UAAUjlB,EAAKpD,QAAQ3E,KAAK,WAC3ChC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC7ES,EAAWsE,IAAI,kBAAmByB,EAAKpD,OAAOpG,KAAMwJ,EAAKpD,QACzDL,EAAWe,WAAW,2BACpB,SAAUD,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBACzE,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3BrrB,EAAgBsvB,UAAUllB,EAAKpD,OAAOpG,KAAMwJ,EAAKpD,QAAQ3E,KAAK,WAC7DhC,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC7ES,EAAWsE,IAAI,kBAAmByB,EAAKpD,OAAOpG,KAAMwJ,EAAKpD,QACzDL,EAAWe,WAAW,2BACpB,SAAUD,GACZpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBACzE,WAAW,WACbkX,EAAkBuQ,QAAQ,YAKzB9qB,KAAKg7B,wBAA0B,SAAUx1B,GAC5C,GAAIpF,GAAUR,EAAgBmX,iBAAiBvR,EAAOolB,WAAWhlB,OAAQJ,EAAOolB,WAAWqM,aAAczxB,EAAOpF,QAChH,OAAMA,GACEA,EAAQwH,QAERrI,EAAW8D,QAAQ,cAIxBrD,KAAKi7B,yBAA2B,SAAUz1B,GAC7C,GAAIpF,GAAUR,EAAgBqzB,kBAAkBztB,EAAOolB,WAAWva,QAAS7K,EAAOpF,QAClF,OAAMA,GACEA,EAAQC,KAERd,EAAW8D,QAAQ,cAI5BrD,KAAKk7B,4BAA8B,SAAU11B,GAC5C,GAAI21B,KAMJ,OALA95B,GAAEY,QAAQuD,EAAOolB,WAAY,SAAUkM,EAAWlpB,GACrC,YAARA,GACHutB,EAASj5B,MAAM7B,KAAMuN,EAAKnG,MAAOqvB,MAG5BqE,GAGRn7B,KAAKo7B,sBAAwB,SAAU51B,GACtC,OAAQA,EAAOolB,WAAWqM,cACzB,IAAK,SACJ,MAAwB,KAAjBzxB,EAAOkD,QAAYnJ,EAAW8D,QAAQ,aAAa9D,EAAW8D,QAAQ,aAE9E,KAAK,SACJ,MAAOmC,GAAOkD,QAAU,IAEzB,KAAK,SACJ,GAAIqd,GAASnmB,EAAgBmX,iBAAiBvR,EAAOolB,WAAWhlB,OAAQ,SAAUJ,EAAOpF,QACzF,IAAM2lB,EAAQ,CACb,GAAIhd,GAAOgd,EAAOrf,QAAQqC,MAAM,EAChC,OAAOvD,GAAOkD,QAAU,IAAMK,EAAO,KAAOvD,EAAOolB,WAAWjiB,KAAO,IAErE,MAAO,UAMP3I,KAAKq7B,gBAAkB,WAC1BxxB,EAAKuqB,WAAY,GAGlBp0B,KAAKs7B,cAAgB,WACpBzxB,EAAKpD,OAAO8zB,QAAQr4B,KAAK2H,EAAKuqB,WAC9BvqB,EAAK2wB,eAAgB,GAGtBx6B,KAAKu7B,cAAgB,WACpB,IAAK1xB,EAAKpD,OAAOpG,KAChB,OAAO,CAER,IAAIuW,GAAQvV,EAAE2C,KAAKF,EAAWQ,IAAI,mBAAoB,SAAUmC,GAC/D,MAAOA,GAAOpG,OAASwJ,EAAKpD,OAAOpG,MAEpC,OAAMuW,IAAS/M,EAAKzB,KACnByB,EAAK3C,MAAMoN,QAAU/U,EAAW8D,QAAQ,4BACjC,GAE2B,IAA/BwG,EAAKpD,OAAO8zB,QAAQn4B,QAOzBpC,KAAKw7B,cAAgB,WACpB,IAAK3xB,EAAK2wB,cACT,OAAO,CAGR,KAAK3wB,EAAKuqB,UAAUh0B,QACnB,OAAO,CAGR,IAAqC,YAAjCyJ,EAAK2wB,cAAc/nB,UAAyB,CAC/C,IAAK5I,EAAK2rB,WACT,OAAO,CAGR,IAAIiG,IAAM,CAMV,IALAp6B,EAAEY,QAAQ4H,EAAK0qB,mCAAmC1qB,EAAK2wB,cAAcn6B,MAAO,SAAUy2B,EAAW4E,GAC5F5E,EAAUnC,WAAa9qB,EAAKuqB,UAAUxJ,WAAWkM,EAAUz2B,QAC9Do7B,GAAM,MAGHA,EACJ,OAAO,EAKT,OAAO,GAGRz7B,KAAK27B,eAAiB,SAASjzB,EAAS2H,GACvC,GAAIurB,GAAav6B,EAAE2C,KAAK6F,EAAK0I,qBAAsB,SAAU/M,GAC5D,MAAOA,GAAOnF,OAASgQ,EAAU,IAAM3H,GAExC,OAAOkzB,GAAWr8B,EAAW8D,QAAQu4B,EAAWppB,OAAO,aAGxDxS,KAAK67B,iBAAmB,SAAS/E,EAAWzmB,EAAS3H,GACpD,GAAMmB,EAAK0qB,mCAAoC,CAC9C,GAAIuH,GAAez6B,EAAE2C,KAAK6F,EAAK0qB,mCAAmClkB,EAAU,IAAM3H,GAAU,SAAUW,GACrG,MAAOA,GAAMhJ,OAASy2B,GAEvB,OAAOgF,GAAaA,EAAat5B,MAAM,cAIrCvB,OA4BRsM,QAAQ6E,OAAO,eAAe2C,UAAU,aACpCN,YAAa,yCACbC,WAAY5K,oBACZ4f,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,SACN0iB,UAAW,aACX1Y,gBAAgB,OAIxB/C,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,SAAU,oBAAqB,aAAc,UAAW,mBAAoB,gBAAiB,SAf9F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAASsK,EAAkBvG,EAAe6hB,GAQtF,QAASzkB,KACd4I,EAAK6b,OAAOlV,MAAO,EAEVnP,EAAEY,QAAQ4H,EAAKujB,iBAAkB,SAASC,GACtC9tB,EAAW8tB,EAAa7a,OAAO1Q,KAAK,SAAUwrB,GAC1CD,EAAaC,QAAUA,MAZnC,GAAIzjB,GAAO7J,IAEXA,MAAK0lB,OAASA,EACd1lB,KAAK0lB,OAAO/d,WAAa3H,KAAK0lB,OAAO9d,QAErC5H,KAAKotB,iBAAmBhjB,EAAiBuI,mBAYzC3S,KAAK6M,GAAK,SAAU0gB,GACzB,MAAOhuB,GAAW8D,QAAQkqB,IAGrBvtB,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAK+7B,WAAa,WACdlyB,EAAK6b,OAAO9d,QAAUiC,EAAK6b,OAAO/d,WAClCkC,EAAK6b,OAAOzX,QAAUpE,EAAK6b,OAAO+H,eAAe,EAAE,EACnD5pB,EAAc6pB,cAAc7jB,EAAK6b,OAAO9f,OAAQ,SAAUiE,EAAK6b,OAAOrlB,KAAMwJ,EAAK6b,QAAQ5jB,KAAK,SAAUC,GACpG3C,EAAO+H,WAAW,wBAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC9E,SAAU6D,GACTpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC5E,WAAW,WACVkX,EAAkBuQ,QAAQ,YAIlC7pB,OAiORsM,QAAQ6E,OAAO,eAAe2C,UAAU,cACpCN,YAAa,2CACbC,WAAYvK,qBACZuf,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,UACN0iB,UAAW,cACX1Y,gBAAgB,OAwBxB/C,QAAQ6E,OAAO,eAAe2C,UAAU,aACpCN,YAAa,yCACbC,WAAYlG,oBACZkb,UACItpB,QAAS,OAGhBsqB,KAAA,4BAAI,SAAS1a,GACVA,EAA0B5H,KACtB9B,KAAM,SACN0iB,UAAW,aACX1Y,gBAAgB,OAIxB/C,QAAQ6E,OAAO,eACVsC,WAAW,qBAgBX,SAAU,oBAAqB,aAAc,UAAW,mBAAoB,gBAAiB,WAf9F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAASsK,EAAkBvG,EAAe4iB,GAQtF,QAASxlB,KACd4I,EAAK4c,SAASjW,MAAO,EAEZnP,EAAEY,QAAQ4H,EAAKujB,iBAAkB,SAASC,GACtC9tB,EAAW8tB,EAAa7a,OAAO1Q,KAAK,SAAUwrB,GAC1CD,EAAaC,QAAUA,MAZnC,GAAIzjB,GAAO7J,IAEXA,MAAKymB,SAAWA,EAChBzmB,KAAKymB,SAAS9e,WAAa3H,KAAKymB,SAAS7e,QAEzC5H,KAAKotB,iBAAmBhjB,EAAiBuI,mBAYzC3S,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAK6M,GAAK,SAAU0gB,GACzB,MAAOhuB,GAAW8D,QAAQkqB,IAGrBvtB,KAAKg8B,aAAe,WAChBnyB,EAAK4c,SAAS7e,QAAUiC,EAAK4c,SAAS9e,WACtCkC,EAAK4c,SAASxY,QAAUpE,EAAK4c,SAASgH,eAAe,EAAE,EACvD5pB,EAAc6pB,cAAc7jB,EAAK4c,SAAS7gB,OAAQ,SAAUiE,EAAK4c,SAASpmB,KAAMwJ,EAAK4c,UAAU3kB,KAAK,SAAUC,GAC1G3C,EAAO+H,WAAW,yBAClBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC9E,SAAU6D,GACTpH,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBAC5E,WAAW,WACVkX,EAAkBuQ,QAAQ,YAIlC7pB,OA8DRsM,QAAQ6E,OAAO,eAAe2C,UAAU,gBACvCN,YAAa,qDACbC,WAAYhG,iBACZiG,aAAc,qBA8CfpH,QAAQ6E,OAAO,eAAe2C,UAAU,eACpCN,YAAa,mDACbC,WAAY3E,gBACZ4E,aAAc,oBAGlBpH,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,oBAAqB,QAAS,UAf/B,SAAS6F,EAAmB/X,EAAO8R,GAG/BtU,KAAKwC,MAAQA,EACbxC,KAAKsU,QAAUA,EAEftU,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAKi8B,GAAK,WACN1hB,EAAkB6E,MAAM,UAMpC7R,QAAQ6E,OAAO,eACVsC,WAAW,iBAgBX,oBAAqB,QAAS,UAAW,cAf1C,SAAS6F,EAAmB/X,EAAO8R,EAASQ,GACxC,GAAIjL,GAAO7J,IAEXA,MAAKwC,MAAQA,EACbxC,KAAKsU,QAAUA,EACftU,KAAK8U,YAAcA,EACnB9U,KAAKyH,MAAQ,GAEbzH,KAAK+E,OAAS,WACVwV,EAAkBuQ,QAAQ,WAG9B9qB,KAAKi8B,GAAK,WACN1hB,EAAkB6E,OAAO8c,OAAQ,QAASz0B,MAAOoC,EAAKpC,YAMlE8F,QAAQ6E,OAAO,eACVsC,WAAW,kBAgBX,SAAU,oBAAqB,aAAc,QAAS,MAfvD,SAAStV,EAAQmb,EAAmBhb,EAAYiD,EAAOswB,GAMnD,QAAS7xB,MALT,GAAI4I,GAAO7J,IAEXA,MAAKwC,MAAQA,EACbxC,KAAK8yB,IAAMA,EAKX9yB,KAAKof,MAAQ,WACT7E,EAAkBuQ,QAAQ,UAG9B9qB,KAAK+qB,aAAe,WACzB,MAAOxrB,GAAW8D,QAAQ,eAAiBwG,EAAKrH,OAG3CvB,OAIRsM,QAAQ6E,OAAO,eACVsC,WAAW,oBAgBX,SAAU,oBAAqB,aAAc,UAAW,gBAAiB,mBAAoB,UAf9F,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAAS+D,EAAeuG,EAAkBhK,GA8BtF,QAASa,KACd4I,EAAK6D,aA9BA,GAAI7D,GAAO7J,IAEXA,MAAKI,QAAUA,EACfJ,KAAKsL,QACLtL,KAAKoL,aAAehB,EAAiBgB,aACrCpL,KAAKqL,UAAY5D,MAAO,GAE9BzH,KAAK0G,SACJiF,OACCrF,KAAM,YACNsF,YAAY,QACZC,EAAG,SAASC,GAAK,MAAOA,GAAEC,WAC1BC,EAAG,SAASF,GAAK,MAAOA,GAAErE,OAC1BwE,YAAY,EACZC,YAAa,SAASJ,GACrB,MAAOK,IAAGC,OAAO,QAAQN,IAE1BO,mBAAoB,IACpBC,OAASH,GAAGI,KAAKC,QACjBC,OACCC,UAAWnN,EAAW8D,QAAQ,sBAE/BsJ,OACCD,UAAWtM,EAAQsG,QAAQqC,KAC3B6D,kBAAmB,MAShB5M,KAAK0N,WAAa,WACvB,GAAIT,GAAO,GAAIC,KAEf,QAAQrD,EAAKwB,SAAS5D,OACrB,IAAK,GACJwF,EAAKE,QAAQF,EAAKG,UAAY,KAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,KAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,MAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKE,QAAQF,EAAKG,UAAY,OAC9B,MACD,KAAK,GACJH,EAAKI,SAASJ,EAAKK,WAAa,GAIzBzJ,EAAc6J,WAAWtN,EAAQwF,OAAQxF,EAAQkG,KAAMlG,EAAQC,KAAMwI,KAAKC,MAAMmE,EAAKG,UAAY,MAAOtL,KAAK,SAAUgG,GACnH+B,EAAKyB,OACL,IAAIyC,IACfH,IAAKxN,EAAQwH,QACboG,UAEiBlG,IAAUA,EAAO1F,OAAS,IAC3Cf,EAAEY,QAAQ6F,EAAQ,SAAUmG,GAC3B,GAAIC,GAAU,GAAIhB,MAAyB,IAApBe,EAAQlC,WAC3BtE,GAASsE,UAAWmC,EAASzG,MAAOwC,WAAWgE,EAAQxG,OAC3DsG,GAAOC,OAAO9L,KAAKuF,KAEpBoC,EAAKyB,KAAKpJ,KAAK6L,OAKZ/N,KAAK6M,GAAK,SAAUpF,GACzB,MAAOlI,GAAW8D,QAAQoE,IAGrBzH,KAAKof,MAAQ,WACT7E,EAAkBuQ,QAAQ,UAG9B9qB,KAAK+qB,aAAe,WACzB,MAAOxrB,GAAW8D,QAAQ,iBAAmBjD,EAAQwH,SAGhD3G,OAIRsM,QAAQ6E,OAAO,eACVsC,WAAW,8BAgBX,SAAU,oBAAqB,aAAc,UAAW,mBAAoB,aAAc,4BAA6B,kBAAmB,SAf3I,SAAStV,EAAQmb,EAAmBhb,EAAYO,EAAS0a,EAAkB1W,EAAYkM,EAA2BvQ,EAAiBgH,GAS/H,QAASxF,KACT4I,EAAKpD,OAAOC,QAAQC,OACxBkD,EAAKpD,OAAOC,QAAQC,SAEjBpH,EAAWuP,QACdjF,EAAKnD,QAAU8T,EAAiBiF,aAC3BC,mBAAmB,mCAAmCngB,EAAWuP,MAAM,SACvE6Q,WAAW,YACXA,WAAW,UAAW,SACtBA,WAAW,UAAU,IAG3Bte,EAAEY,QAAQ6B,EAAWQ,IAAI,iBAAkB,SAAUsB,GAChDA,EAAOuC,SAAWvC,EAAOmS,YAC5B1W,EAAEY,QAAQ2D,EAAOxF,QAAQqK,SAAU,SAASrK,EAASC,GACpD,GAAI87B,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,cAAgBT,EAAOvF,KAAO,WAAaA,IAEvDsK,GACH8H,UAAW,SACX7M,OAAQA,EAAOvF,KACfiG,KAAM,SACN81B,UAAW78B,EAAW8D,QAAQ,gBAC9BhD,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBu0B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,KAEpB96B,EAAEY,QAAQ2D,EAAOxF,QAAQyK,QAAS,SAASzK,EAASC,GACnD,GAAI87B,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,cAAgBT,EAAOvF,KAAO,WAAaA,IAEvDsK,GACH8H,UAAW,SACX7M,OAAQA,EAAOvF,KACfiG,KAAM,SACN81B,UAAW78B,EAAW8D,QAAQ,gBAC9BhD,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBu0B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,KAEpB96B,EAAEY,QAAQ2D,EAAOxF,QAAQ0K,QAAS,SAAS1K,EAASC,GACnD,GAAI87B,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,cAAgBT,EAAOvF,KAAO,WAAaA,IAEvDsK,GACH8H,UAAW,SACX7M,OAAQA,EAAOvF,KACfiG,KAAM,SACN81B,UAAW78B,EAAW8D,QAAQ,gBAC9BhD,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBu0B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,KAEpB96B,EAAEY,QAAQ2D,EAAOxF,QAAQ2K,QAAS,SAAS3K,EAASC,GACnD,GAAI87B,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,cAAgBT,EAAOvF,KAAO,WAAaA,IAEvDsK,GACH8H,UAAW,SACX7M,OAAQA,EAAOvF,KACfiG,KAAM,SACN81B,UAAW78B,EAAW8D,QAAQ,gBAC9BhD,KAAMA,EACNuH,QAASxH,EAAQwH,QACjBu0B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,QAKtB96B,EAAEY,QAAQ6B,EAAWQ,IAAI,sBAAuB,SAAU6V,GACzD,GAAIgiB,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,wBAA0B8T,EAAU9Z,OAEhDsK,GACH8H,UAAW,WACXnM,KAAM,YACN81B,UAAW78B,EAAW8D,QAAQ,mBAC9BhD,KAAM8Z,EAAU9Z,KAChBuH,QAASuS,EAAU9Z,KACnB87B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,KAGpB96B,EAAEY,QAAQ6B,EAAWQ,IAAI,mBAAoB,SAAU+L,EAAS6jB,GAC/D,GAAI9jB,GAAS/O,EAAE2C,KAAKgM,EAA0BG,WAAY,SAAUC,GACnE,MAAOA,GAAO9J,OAAS4tB,GAAe7jB,EAAQlI,SAE/C9G,GAAEY,QAAQoO,EAAQjQ,QAAS,SAAUA,GACpC,GAAI+7B,KAAa96B,EAAE2C,KAAK6F,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC3D,MAAOA,KAAQ,cAAgB6tB,EAAc,IAAM9zB,EAAQC,OAExDsK,GACH8H,UAAW,UACXnM,KAAM4tB,EACNkI,UAAW78B,EAAW8D,QAAQ+M,EAAOmX,YACrClnB,KAAMD,EAAQC,KACduH,QAASxH,EAAQC,KACjB87B,SAAUA,EAEXtyB,GAAKe,YAAY1I,KAAKyI,GACtBd,EAAKwyB,SAASn6B,KAAKi6B,OA1HhB,GAAItyB,GAAO7J,IAEXA,MAAKyG,OAASA,EAEdzG,KAAK4K,eACL5K,KAAK0G,WACL1G,KAAKq8B,YAyHLr8B,KAAKs8B,UAAY,SAAU36B,GAChCkI,EAAKe,YAAYjJ,GAAOw6B,UAAYtyB,EAAKe,YAAYjJ,GAAOw6B,SAC5DtyB,EAAKwyB,SAAS16B,GAASkI,EAAKe,YAAYjJ,GAAOw6B,UAGhDn8B,KAAK+E,OAAS,WACbwV,EAAkBuQ,QAAQ,WAG3B9qB,KAAKi8B,GAAK,WAIT56B,EAAEwM,OAAOhE,EAAKpD,OAAOC,QAAQC,KAAM,SAAUN,GAC5C,MAAOA,GAAIk2B,WAAW,cAIvB,IAAIC,GAAmBn7B,EAAEmF,OAAOqD,EAAKe,YAAa,SAAUxK,GAC3D,MAAOA,GAAQ+7B,UAEhB96B,GAAEY,QAAQu6B,EAAkB,SAAUp8B,GACrC,GAAIiG,GAAM,WAETA,IADyB,WAAtBjG,EAAQqS,UACJ,KAAOrS,EAAQwF,OAAS,IAAMxF,EAAQkG,KAAO,IAAMlG,EAAQC,KAClC,YAAtBD,EAAQqS,UACX,KAAOrS,EAAQkG,KAAO,IAAMlG,EAAQC,KAEpC,KAAOD,EAAQkG,KAAO,IAAMlG,EAAQC,KAE5CwJ,EAAKpD,OAAOC,QAAQC,KAAKzE,KAAKmE,KAE/B5G,EAAgBsvB,UAAUllB,EAAKpD,OAAOpG,KAAMwJ,EAAKpD,QAAQ3E,KAAK,WAC7DgC,EAAWsE,IAAI,kBAAmByB,EAAKpD,OAAOpG,KAAMwJ,EAAKpD,QACzD3G,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,yBAC3E,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,eAAgB9D,EAAW8D,QAAQ,wBACzE,WAAW,WACbkX,EAAkBuQ,QAAQ,YAItB7pB,OA0FRsM,QAAQ6E,OAAO,eAAe2C,UAAU,qBACpCN,YAAa,+DACbC,WAAY1D,4BACZ0Y,UACItpB,QAAS,OAGhB4oB,UAAU,SAAA,OAAS,SAAS/X,GAE5B,OACCknB,SAAU,IACV9O,OAASyJ,IAAK,KACdtJ,SAAS,EACTN,SAAU,iDACVI,KAAM,SAAUD,GACfA,EAAMtX,OAAO,MAAO,SAAU0qB,EAAQC,GACtB3J,SAAX0J,IACHpT,EAAMhU,IAAMpE,EAAK0rB,mBAAmBF,WAMxCzoB,QAAQ,4BAAA,QAAA,YAAA,aAAA,UAAA,iBAAA,yBAAA,kBAAA,aAA4B,SAAS3U,EAAO+U,EAAW7U,EAAYO,EAASN,EAAgBmqB,EAAwBlJ,EAAiB3c,GAC1I,GAAI8lB,GAAUpqB,EAAeU,QAAUV,EAAeW,cAClD+Q,IAgFJ,OA7EAA,GAAyB0rB,yBAA2B,WAChD,MAAOjT,GAAuBG,YAAY,MAAOF,EAAU,wBAG/D1Y,EAAyBC,qBAAuB,SAAU9Q,GACtD,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,sBAAwBvpB,IAGvF6Q,EAAyB2rB,qBAAuB,SAAUC,GACtD,MAAOnT,GAAuBG,YAAY,OAAQF,EAAU,sBAAuBkT,IAGvF5rB,EAAyB6rB,qBAAuB,SAAU18B,EAAMy8B,GAC5D,MAAOnT,GAAuBG,YAAY,MAAOF,EAAU,sBAAwBvpB,EAAMy8B,IAG7F5rB,EAAyB8rB,wBAA0B,SAAU38B,GACzD,MAAOspB,GAAuBG,YAAY,SAAUF,EAAU,sBAAwBvpB,IAG1F6Q,EAAyBQ,KAAO,SAAUrR,GACtC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,sBAAwBvpB,EAAO,UAG9F6Q,EAAyBG,MAAQ,SAAUhR,GACvC,MAAOspB,GAAuBG,YAAY,MAAOF,EAAU,sBAAwBvpB,EAAO,YAG9F6Q,EAAyBxI,QAAU,SAAUrI,EAAMqI,GAC/C,MAAOihB,GAAuBG,YAAY,MAAOF,EAAU,sBAAwBvpB,EAAO,YAAcqI,IAG/GwI,EAAyByW,WAAa,WACjBvT,EAAUC,MAC7BG,WAAW,EACXC,YAAa,4DACbC,WAAY,6BACZC,aAAc,6BACdC,KAAM,KACNC,SACCzU,QAAS,WACR,MAAO,WAMX8Q,EAAyBsW,YAAc,SAAUnX,GAC5B+D,EAAUC,MAC7BG,WAAW,EACXC,YAAa,4DACbC,WAAY,6BACZC,aAAc,6BACdC,KAAM,KACNC,SACCzU,QAAS,WACR,MAAOiQ,QAMXa,EAAyBuW,cAAgB,SAAUpX,GAClD,MAAOoQ,GAAgBpM,KAAK9U,EAAW8D,QAAQ,6BAA8B9D,EAAW8D,QAAQ,sCAAsCvB,KAAK,WAC1I,MAAOoP,GAAyB8rB,wBAAwB3sB,EAAQhQ,MAAMyB,KAAK,WAC1E,GAAIsV,GAAWtT,EAAWG,IAAI,kBAAmB,qBACjD5C,GAAEwM,OAAOuJ,EAAShX,QAAS,SAAUA,GACpC,MAAOA,GAAQC,OAASgQ,EAAQhQ,OAEjCyD,EAAWsE,IAAI,kBAAmB,qBAAsBgP,GACxDtX,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,6BAA8B9D,EAAW8D,QAAQ,uCACzF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,6BAA8B9D,EAAW8D,QAAQ,yCAKlF6N,KAGV4B,QAAA,kCAAO,SAAaE,GACpBA,EAAgCG,QAAQ,wBAExCuX,KAAA,4BAAA,2BAAI,SAAS1a,EAA2BkB,GACrClB,EAA0B5H,KACtB9B,KAAM,qBACN0iB,UAAW,qBACXzB,WAAY,2BACZlX,QAASa,EACTZ,gBAAgB,EAChBsE,KAAM,EACNrE,UACL/N,MAAO,sBACPkO,OAAQ,SAET4G,aAAc,EACdE,YAAa,EACb/G,KAAM,QACNka,iBAKFpd,QAAQ6E,OAAO,eACVsC,WAAW,8BAgBX,aAAc,oBAAqB,aAAc,aAAc,UAAW,2BAA4B,UAfvG,SAAStO,EAAYmU,EAAmBhb,EAAYuE,EAAYhE,EAASoR,EAA0B9Q,GAgB/F,QAASa,KACRb,IACLyJ,EAAKzJ,QAAUiB,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,sBAAsB7D,QAAS,SAAUuK,GAChG,MAAOA,GAAItK,OAASD,EAAQC,OAE7BwJ,EAAKzB,KAAM,GApBP,GAAIyB,GAAO7J,IAEXA,MAAK0J,YACL1J,KAAKoI,KAAM,EACXpI,KAAKI,SACVC,KAAM,GACNgb,YAAa,GACb4hB,UAAW,GACXC,WAAY,GACZC,iBAAiB,EACjBC,aAAc,GACdC,aAAc,EACdC,qBAAsB,IAYjBt9B,KAAKu9B,kBAAoB,WAC9B,GAAI3mB,GAAQvV,EAAE2C,KAAKF,EAAWG,IAAI,kBAAmB,sBAAsB7D,QAAS,SAAUA,GAC7F,MAAOA,GAAQC,OAASwJ,EAAKzJ,QAAQC,MAEtC,SAASuW,GAAU/M,EAAKzB,MACjByB,EAAKzJ,QAAQC,OACbwJ,EAAKzJ,QAAQ68B,WACbpzB,EAAKzJ,QAAQ+8B,mBACXtzB,EAAKzJ,QAAQg9B,eAAkBvzB,EAAKzJ,QAAQi9B,eAAkBxzB,EAAKzJ,QAAQk9B,wBAG/Et9B,KAAKmsB,KAAO,WACbtiB,EAAKzB,IACR8I,EAAyB2rB,qBAAqBhzB,EAAKzJ,SAAS0B,KAAK,WAChE+H,EAAKzJ,QAAQkG,KAAO,qBACpBuD,EAAKzJ,QAAQiQ,QAAUa,EACvBpN,EAAWG,IAAI,kBAAmB,sBAAsB7D,QAAQ8B,KAAK2H,EAAKzJ,SAC1EgG,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,qCACvF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,oCACrF,WAAW,WACbkX,EAAkBuQ,QAAQ,WAG3B5Z,EAAyB6rB,qBAAqBlzB,EAAKzJ,QAAQC,KAAMwJ,EAAKzJ,SAAS0B,KAAK,WACnF+H,EAAKzJ,QAAQkG,KAAO,qBACpBuD,EAAKzJ,QAAQiQ,QAAUa,EACvB9K,EAAWe,WAAW,0BACtBrH,EAAQsD,IAAI,UAAW7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,qCACvF,WACFvD,EAAQsD,IAAI,QAAS7D,EAAW8D,QAAQ,2BAA4B9D,EAAW8D,QAAQ,oCACrF,WAAW,WACbkX,EAAkBuQ,QAAQ,YAKvB9qB,KAAK+E,OAAS,WACnBwV,EAAkBuQ,QAAQ,UAGrB7pB,OAIRsM,QAAQ6E,OAAO,eAAesY,KAAK,iBAAkB,SAAS8S,GAAiBA,EAAe5tB,IAAI,uBAAuB,iGACzH4tB,EAAe5tB,IAAI,+BAA+B,qiEAClD4tB,EAAe5tB,IAAI,2BAA2B,idAC9C4tB,EAAe5tB,IAAI,yBAAyB,kyCAC5C4tB,EAAe5tB,IAAI,8BAA8B;AACjD4tB,EAAe5tB,IAAI,qBAAqB,ksEACxC4tB,EAAe5tB,IAAI,uBAAuB,uzCAC1C4tB,EAAe5tB,IAAI,6BAA6B,kpBAChD4tB,EAAe5tB,IAAI,iCAAiC,utUACpD4tB,EAAe5tB,IAAI,2BAA2B,gpBAC9C4tB,EAAe5tB,IAAI,2BAA2B,udAC9C4tB,EAAe5tB,IAAI,2BAA2B,s5BAC9C4tB,EAAe5tB,IAAI,uBAAuB,4tJAC1C4tB,EAAe5tB,IAAI,6BAA6B,w9BAChD4tB,EAAe5tB,IAAI,4DAA4D,wuHAC/E4tB,EAAe5tB,IAAI,+DAA+D,mjFAClF4tB,EAAe5tB,IAAI,0DAA0D,+zDAC7E4tB,EAAe5tB,IAAI,oDAAoD;AACvE4tB,EAAe5tB,IAAI,uDAAuD,q8EAC1E4tB,EAAe5tB,IAAI,gDAAgD,ukCACnE4tB,EAAe5tB,IAAI,mDAAmD,07BACtE4tB,EAAe5tB,IAAI,+CAA+C,glDAClE4tB,EAAe5tB,IAAI,8CAA8C,wlFACjE4tB,EAAe5tB,IAAI,iDAAiD,4xJACpE4tB,EAAe5tB,IAAI,sCAAsC,izDACzD4tB,EAAe5tB,IAAI,yCAAyC,u8DAC5D4tB,EAAe5tB,IAAI,sCAAsC,uoEACzD4tB,EAAe5tB,IAAI,yCAAyC,8/CAC5D4tB,EAAe5tB,IAAI,uCAAuC,sdAC1D4tB,EAAe5tB,IAAI,oCAAoC,8wBACvD4tB,EAAe5tB,IAAI,qCAAqC,kjBACxD4tB,EAAe5tB,IAAI,uCAAuC,65BAC1D4tB,EAAe5tB,IAAI,iDAAiD,q1CACpE4tB,EAAe5tB,IAAI,2CAA2C,qiDAC9D4tB,EAAe5tB,IAAI,oCAAoC;AACvD4tB,EAAe5tB,IAAI,2CAA2C,gsBAC9D4tB,EAAe5tB,IAAI,yCAAyC,iXAC5D4tB,EAAe5tB,IAAI,sCAAsC,61SACzD4tB,EAAe5tB,IAAI,yCAAyC,4KAC5D4tB,EAAe5tB,IAAI,sCAAsC,qnEACzD4tB,EAAe5tB,IAAI,yCAAyC,6MAC5D4tB,EAAe5tB,IAAI,sCAAsC,00DACzD4tB,EAAe5tB,IAAI,yCAAyC,gUAC5D4tB,EAAe5tB,IAAI,mDAAmD,+5FACtE4tB,EAAe5tB,IAAI,qDAAqD","file":"scripts/app-d2e96dfd83.js","sourcesContent":["angular.module(\"sagremorApp\", [\r\n\"ui.bootstrap\",\r\n\"ui.router\", \r\n\"ngCookies\",\r\n\"angularMoment\",\r\n\"frapontillo.bootstrap-switch\", \r\n\"toaster\", \r\n\"ui.bootstrap.contextMenu\", \r\n\"pascalprecht.translate\",\r\n\"ngSanitize\",\r\n\"ui.bootstrap.datetimepicker\",\r\n\"datatables\",\r\n\"angular.img\",\r\n\"nvd3\",\r\n\"oauth\"\r\n])\r\n.constant(\"_\", window._)\r\n.constant(\"sagremorConstant\", {\r\n    scriptActionElements: [\r\n        {name: \"switch\", label: \"script_action_benoic_switch\", submodule: \"benoic\"},\r\n        {name: \"dimmer\", label: \"script_action_benoic_dimmer\", submodule: \"benoic\"},\r\n        {name: \"heater\", label: \"script_action_benoic_heater\", submodule: \"benoic\"}\r\n    ],\r\n    conditionList: [\r\n        {name: \"switch\", label: \"event_condition_benoic_switch\", submodule: \"benoic\"},\r\n        {name: \"dimmer\", label: \"event_condition_benoic_dimmer\", submodule: \"benoic\"},\r\n        {name: \"heater\", label: \"event_condition_benoic_heater\", submodule: \"benoic\"},\r\n        {name: \"sensor\", label: \"event_condition_benoic_sensor\", submodule: \"benoic\"}\r\n    ],\r\n    monitoredEveryEnum: [\r\n        {value: 60, label: \"monitor_1_minute\"},\r\n        {value: 120, label: \"monitor_2_minutes\"},\r\n        {value: 300, label: \"monitor_5_minutes\"},\r\n        {value: 600, label: \"monitor_10_minutes\"},\r\n        {value: 900, label: \"monitor_15_minutes\"},\r\n        {value: 1200, label: \"monitor_20_minutes\"},\r\n        {value: 1800, label: \"monitor_30_minutes\"},\r\n        {value: 3600, label: \"monitor_1_hour\"},\r\n        {value: 7200, label: \"monitor_2_hours\"},\r\n        {value: 10800, label: \"monitor_3_hours\"},\r\n        {value: 14400, label: \"monitor_4_hours\"},\r\n        {value: 18000, label: \"monitor_5_hours\"},\r\n        {value: 21600, label: \"monitor_6_hours\"},\r\n        {value: 43200, label: \"monitor_12_hours\"},\r\n        {value: 86400, label: \"monitor_1_day\"}\r\n    ],\r\n    schedulerRepeatEveryEnum: [\r\n        {value: 0, label: \"event_scheduler_repeat_every_minutes\"},\r\n        {value: 1, label: \"event_scheduler_repeat_every_hours\"},\r\n        {value: 2, label: \"event_scheduler_repeat_every_days\"},\r\n        {value: 3, label: \"event_scheduler_repeat_every_days_of_week\"},\r\n        {value: 4, label: \"event_scheduler_repeat_every_months\"},\r\n        {value: 5, label: \"event_scheduler_repeat_every_year\"},\r\n    ],\r\n    langList: [\r\n        {name: \"fr\", display: \"Fr\"},\r\n        {name: \"en\", display: \"En\"}\r\n    ],\r\n    durationList: [\r\n        {value: 0, label: \"duration_last_hour\"},\r\n        {value: 1, label: \"duration_last_2_hours\"},\r\n        {value: 2, label: \"duration_last_6_hours\"},\r\n        {value: 3, label: \"duration_last_12_hours\"},\r\n        {value: 4, label: \"duration_last_day\"},\r\n        {value: 5, label: \"duration_last_2_days\"},\r\n        {value: 6, label: \"duration_last_3_days\"},\r\n        {value: 7, label: \"duration_last_7_days\"},\r\n        {value: 8, label: \"duration_last_month\"},\r\n    ],\r\n    colorList: [\r\n\t\t{ style:\"background:Aqua\", value:\"#00FFFF\", label:\"Aqua\"},\r\n\t\t{ style:\"background:Brown\", value:\"#A52A2A\", label:\"Brown\"},\r\n\t\t{ style:\"background:Blue\", value:\"#0000FF\", label:\"Blue\"},\r\n\t\t{ style:\"background:Chartreuse\", value:\"#7FFF00\", label:\"Chartreuse\"},\r\n\t\t{ style:\"background:DarkGreen\", value:\"#006400\", label:\"Dark Green\"},\r\n\t\t{ style:\"background:DarkOrange\", value:\"#FF8C00\", label:\"Dark Orange\"},\r\n\t\t{ style:\"background:DarkRed\", value:\"#8B0000\", label:\"Dark Red\"},\r\n\t\t{ style:\"background:DarkTurquoise\", value:\"#00CED1\", label:\"Dark Turquoise\"},\r\n\t\t{ style:\"background:DarkViolet\", value:\"#9400D3\", label:\"Dark Violet\"},\r\n\t\t{ style:\"background:Green\", value:\"#008000\", label:\"Green\"},\r\n\t\t{ style:\"background:LawnGreen\", value:\"#7CFC00\", label:\"Lawn Green\"},\r\n\t\t{ style:\"background:LightGreen\", value:\"#90EE90\", label:\"Light Green\"},\r\n\t\t{ style:\"background:LightSeaGreen\", value:\"#20B2AA\", label:\"Light Sea Green\"},\r\n\t\t{ style:\"background:LightSlateGray\", value:\"#778899\", label:\"Light Slate Gray\"},\r\n\t\t{ style:\"background:Lime\", value:\"#00FF00\", label:\"Lime\"},\r\n\t\t{ style:\"background:Magenta\", value:\"#FF00FF\", label:\"Magenta\"},\r\n\t\t{ style:\"background:MediumBlue\", value:\"#0000CD\", label:\"Medium Blue\"},\r\n\t\t{ style:\"background:MediumSpringGreen\", value:\"#00FA9A\", label:\"Medium Spring Green\"},\r\n\t\t{ style:\"background:Navy\", value:\"#000080\", label:\"Navy\"},\r\n\t\t{ style:\"background:Orange\", value:\"#FFA500\", label:\"Orange\"},\r\n\t\t{ style:\"background:Purple\", value:\"#800080\", label:\"Purple\"},\r\n\t\t{ style:\"background:Red\", value:\"#FF0000\", label:\"Red\"},\r\n\t\t{ style:\"background:Teal\", value:\"#008080\", label:\"Teal\"},\r\n\t\t{ style:\"background:Turquoise\", value:\"#40E0D0\", label:\"Turquoise\"},\r\n\t\t{ style:\"background:Violet\", value:\"#EE82EE\", label:\"Violet\"},\r\n\t\t{ style:\"background:Yellow\", value:\"#FFFF00\", label:\"Yellow\"},\r\n\t\t{ style:\"background:YellowGreen\", value:\"#9ACD32\", label:\"Yellow Green\"}\r\n    ]\r\n\r\n})\r\n.config(function ($translateProvider, $translatePartialLoaderProvider) {\r\n\t$translateProvider.useLoader(\"$translatePartialLoader\", {\r\n\t\turlTemplate: \"components/{part}/i18n/{lang}.json\"\r\n\t});\r\n\t$translatePartialLoaderProvider.addPart(\"core\");\r\n\t$translateProvider\r\n\t// see: http://angular-translate.github.io/docs/#/guide/09_language-negotiation\r\n\t.registerAvailableLanguageKeys(['en', 'fr'], {\r\n\t  'en_US': 'en',\r\n\t  'en_UK': 'en',\r\n\t  'en_CA': 'en',\r\n\t  'fr_FR': 'fr',\r\n\t  'fr_CA': 'fr',\r\n\t  'fr_BE': 'fr',\r\n\t  '*': 'en'\r\n\t  })\r\n\t.fallbackLanguage('en')\r\n\t.determinePreferredLanguage();\r\n\r\n\t// interpolation for pluralization\r\n\t$translateProvider.useCookieStorage();\r\n\t$translateProvider.useSanitizeValueStrategy(\"escape\");\r\n})\r\n.factory(\"sharedData\", function() {\r\n    var sharedData = {};\r\n    \r\n    var add = function(share, name, data) {\r\n        if (!sharedData[share]) {\r\n            sharedData[share] = {};\r\n        }\r\n        sharedData[share][name] = data;\r\n    };\r\n    \r\n    var get = function(share, name) {\r\n        if (!!sharedData[share] && !!sharedData[share][name]) {\r\n            return sharedData[share][name];\r\n        } else {\r\n            return undefined;\r\n        }\r\n    };\r\n    \r\n    var remove = function(share, name) {\r\n        return delete sharedData[share][name];\r\n    };\r\n    \r\n    var removeAll = function (share) {\r\n\t\tsharedData[share] = {};\r\n\t};\r\n    \r\n    var all = function(share) {\r\n        return sharedData[share];\r\n    };\r\n    \r\n    return {\r\n        all: all,\r\n        get: get,\r\n        add: add,\r\n        remove: remove,\r\n        removeAll: removeAll\r\n    };\r\n})\r\n.factory(\"sagremorParams\", function () {\r\n    var params = {};\r\n    \r\n    return params;\r\n})\r\n.factory(\"sagremorConfirm\", function ($uibModal) {\r\n    \r\n    var open = function (title, message) {\r\n        return modalInstance = $uibModal.open({\r\n            animation: true,\r\n            templateUrl: \"components/modals/confirm.modal.html\",\r\n            controller: \"ConfirmModalCtrl\",\r\n            controllerAs: \"ConfirmModalCtrl\",\r\n            size: \"sm\",\r\n            resolve: {\r\n                title: function () {\r\n                    return title;\r\n                },\r\n                message: function () {\r\n                    return message;\r\n                }\r\n            }\r\n        }).result;\r\n    };\r\n    \r\n    return {open: open};\r\n})\r\n.factory(\"sagremorEdit\", function ($uibModal) {\r\n    \r\n    var open = function (title, message, placeholder) {\r\n        return modalInstance = $uibModal.open({\r\n            animation: true,\r\n            templateUrl: \"components/modals/edit.modal.html\",\r\n            controller: \"EditModalCtrl\",\r\n            controllerAs: \"EditModalCtrl\",\r\n            size: \"sm\",\r\n            resolve: {\r\n                title: function () {\r\n                    return title;\r\n                },\r\n                message: function () {\r\n                    return message;\r\n                },\r\n                placeholder: function () {\r\n                    return placeholder;\r\n                }\r\n            }\r\n        }).result;\r\n    };\r\n    \r\n    return {open: open};\r\n})\r\n.service(\"sagGenericInjectorManager\", function () {\r\n    var self = this;\r\n    self.components = [];\r\n    \r\n    this.add = function (config) {\r\n\t\tif (!self.get(config.type)) {\r\n\t\t\tself.components.push(config);\r\n\t\t}\r\n    };\r\n    \r\n    this.get = function (type) {\r\n\t\treturn _.find(self.components, function (component) {\r\n\t\t\treturn component.type === type;\r\n\t\t});\r\n\t};\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .config(function($locationProvider) {\r\n        $locationProvider.html5Mode(true).hashPrefix('!');\r\n    })\r\n    .config(function ($stateProvider, $urlRouterProvider) {\r\n        \r\n        $stateProvider\r\n            .state(\"dashboard\", {\r\n                url: \"/\",\r\n                templateUrl: \"app/dashboard/dashboard.html\",\r\n                controller: \"DashboardCtrl\",\r\n                controllerAs: \"DashboardCtrl\"\r\n            })\r\n            .state(\"error\", {\r\n                url: \"/error\",\r\n                templateUrl: \"app/error/error.html\",\r\n                controller: \"ErrorCtrl\",\r\n                controllerAs: \"ErrorCtrl\"\r\n            })\r\n            .state(\"switches\", {\r\n                url: \"/switches\",\r\n                templateUrl: \"app/switches/switches.html\",\r\n                controller: \"switchesCtrl\",\r\n                controllerAs: \"switchesCtrl\"\r\n            })\r\n            .state(\"heaters\", {\r\n                url: \"/heaters\",\r\n                templateUrl: \"app/heaters/heaters.html\",\r\n                controller: \"heatersCtrl\",\r\n                controllerAs: \"heatersCtrl\"\r\n            })\r\n            .state(\"sensors\", {\r\n                url: \"/sensors\",\r\n                templateUrl: \"app/sensors/sensors.html\",\r\n                controller: \"sensorsCtrl\",\r\n                controllerAs: \"sensorsCtrl\"\r\n            })\r\n            .state(\"service\", {\r\n                url: \"/service/:service\",\r\n                templateUrl: \"app/service/service.html\",\r\n                controller: \"serviceCtrl\",\r\n                controllerAs: \"serviceCtrl\"\r\n            })\r\n            .state(\"scripts\", {\r\n                url: \"/scripts\",\r\n                templateUrl: \"app/scripts/scripts.html\",\r\n                controller: \"scriptsCtrl\",\r\n                controllerAs: \"scriptsCtrl\"\r\n            })\r\n            .state(\"events\", {\r\n                url: \"/events\",\r\n                templateUrl: \"app/events/events.html\",\r\n                controller: \"eventsCtrl\",\r\n                controllerAs: \"eventsCtrl\"\r\n            })\r\n            .state(\"monitors\", {\r\n                url: \"/monitors\",\r\n                templateUrl: \"app/monitors/monitors.html\",\r\n                controller: \"monitorsCtrl\",\r\n                controllerAs: \"monitorsCtrl\"\r\n            })\r\n            .state(\"logs\", {\r\n                url: \"/logs\",\r\n                templateUrl: \"app/logs/logs.html\",\r\n                controller: \"logsCtrl\",\r\n                controllerAs: \"logsCtrl\"\r\n            })\r\n            .state(\"parameters\", {\r\n                url: \"/parameters\",\r\n                templateUrl: \"app/parameters/parameters.html\",\r\n                controller: \"ParametersCtrl\",\r\n                controllerAs: \"ParametersCtrl\"\r\n            });\r\n            \r\n        $urlRouterProvider.otherwise(\"/\");\r\n    });\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"DashboardCtrl\",\r\n        function($scope, $location, $translate, $timeout, toaster, sharedData, sagremorParams, sagremorService, sagremorEdit, angharadFactory, benoicFactory, carleonFactory, sagGenericInjectorManager) {\r\n\r\n            var self = this;\r\n\r\n            this._timeout = null;\r\n            this.sagremorParams = sagremorParams;\r\n            this.dashboardWidgets = [];\r\n            this.dashboardWidgetsDisplay = [];\r\n            this.profileName = \"\";\r\n            this.isInit = true;\r\n            this.connected = true;\r\n\r\n            this.options = {\r\n                cellHeight: 100,\r\n                verticalHargin: 10,\r\n                disableResize: false\r\n            };\r\n\r\n            this.init = function() {\r\n                self.isInit = true;\r\n                getDashboardElements();\r\n                self.menu = [{\r\n                    name: \"remove_from_dashboard\",\r\n                    display: $translate.instant(\"remove_from_dashboard\"),\r\n                    action: function(param) {\r\n                        self.removeFromDashboard(param);\r\n                    }\r\n                }];\r\n            };\r\n\r\n            this.menuSelect = function(menuItem, element) {\r\n                menuItem.action(element);\r\n            };\r\n\r\n            this.addTitleLine = function() {\r\n                return sagremorEdit.open($translate.instant(\"dashboard_add_line\"), $translate.instant(\"dashboard_add_line_value\"), $translate.instant(\"dashboard_add_line_placeholder\")).then(function(result) {\r\n                    newDashboardSeparator(result.value);\r\n                });\r\n            };\r\n\r\n            function getDashboardElements() {\r\n                self.dashboardWidgetsDisplay = [];\r\n                var profile = sagremorParams.currentProfile;\r\n                if (!!profile) {\r\n                    self.profileName = profile.name;\r\n                    if (!!profile.addTo && !!profile.addTo.D && profile.addTo.D.length > 0) {\r\n                        getDashboardElementsCurrentProfile();\r\n                    }\r\n                } else {\r\n                    self.profileName = \"\";\r\n                }\r\n                for (key in self.dashboardWidgets) {\r\n                    if (!!self.dashboardWidgets[key]) {\r\n                        self.dashboardWidgetsDisplay.push(self.dashboardWidgets[key]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function getDashboardElementsCurrentProfile() {\r\n                var profile = sagremorParams.currentProfile;\r\n                if (!!profile && !!profile.addTo && !!profile.addTo.D) {\r\n                    _.forEach(profile.addTo.D, function(element) {\r\n                        if (!!element.device) {\r\n                            if (sagremorParams.benoicEnabled) {\r\n                                addBenoicElementToDashboard(element, element.tag);\r\n                            }\r\n                        } else if (element.type === \"script\") {\r\n                            addScriptToDashboard(element, element.tag);\r\n                        } else if (element.type === \"scheduler\" || element.type === \"trigger\") {\r\n                            addEventToDashboard(element, element.tag);\r\n                        } else if (element.type === \"separator\") {\r\n                            addDashboardSeparator(element.name, element.tag);\r\n                        } else if (element.type === \"monitor\") {\r\n                            addMonitorToDashboard(element, element.tag);\r\n                        } else if (sagremorParams.carleonEnabled) {\r\n                            addCarleonElementToDashboard(element, element.tag);\r\n                        }\r\n                    });\r\n                }\r\n                self.isInit = false;\r\n            }\r\n\r\n            function addBenoicElementToDashboard(element, tag) {\r\n                var tagParams = tag.split(\"$\");\r\n                if (tagParams.length >= 4) {\r\n                    var x = tagParams[2];\r\n                    var y = tagParams[3];\r\n                    var curHeight = 1;\r\n                    if (element.type === \"dimmer\" || element.type === \"heater\") {\r\n                        curHeight = 2;\r\n                    }\r\n                    var found = _.find(self.dashboardWidgets, function(widget) {\r\n                        return widget && widget.type === element.type && widget.device === element.device && widget.name === element.name;\r\n                    });\r\n                    var bElt = sagremorService.getBenoicElement(element.device, element.type, element.name);\r\n                    if (!!bElt) {\r\n                        if (!found) {\r\n                            var icon = \"\";\r\n                            switch (element.type) {\r\n                                case \"switch\":\r\n                                    icon = \"toggle-on\";\r\n                                    break;\r\n                                case \"dimmer\":\r\n                                    icon = \"lightbulb-o\";\r\n                                    break;\r\n                                case \"heater\":\r\n                                    icon = \"fire\";\r\n                                    break;\r\n                                case \"sensor\":\r\n                                    icon = \"line-chart\";\r\n                                    break;\r\n                            }\r\n                            bElt.device = element.device;\r\n                            bElt.name = element.name;\r\n                            var index = y * 10 + x;\r\n                            var dashboardElement = {\r\n                                type: element.type,\r\n                                device: element.device,\r\n                                name: element.name,\r\n                                element: bElt,\r\n                                x: x,\r\n                                y: y,\r\n                                width: 3,\r\n                                height: curHeight,\r\n                                tag: tag,\r\n                                icon: icon\r\n                            };\r\n                            self.dashboardWidgets.push(dashboardElement);\r\n                        } else {\r\n                            _.forEach(self.dashboardWidgets, function(widget) {\r\n                                if (widget && widget.type === element.type && widget.device === element.device && widget.name === element.name) {\r\n                                    bElt.device = element.device;\r\n                                    bElt.name = element.name;\r\n                                    widget.element = bElt;\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            function addScriptToDashboard(element, tag) {\r\n                var elt = sharedData.get(\"angharadScripts\", element.name);\r\n                var found = _.find(self.dashboardWidgets, function(widget) {\r\n                    return widget && widget.type === element.type && widget.name === element.name;\r\n                });\r\n                if (!!elt && !found) {\r\n                    var tagParams = tag.split(\"$\");\r\n                    if (tagParams.length >= 4) {\r\n                        var x = tagParams[2];\r\n                        var y = tagParams[3];\r\n                        var curHeight = 1;\r\n                        var icon = \"tasks\";\r\n                        var index = y * 10 + x;\r\n                        var dashboardElement = {\r\n                            type: element.type,\r\n                            name: element.name,\r\n                            element: elt,\r\n                            x: x,\r\n                            y: y,\r\n                            width: 3,\r\n                            height: curHeight,\r\n                            tag: tag,\r\n                            icon: icon\r\n                        };\r\n                        self.dashboardWidgets.push(dashboardElement);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function addEventToDashboard(element, tag) {\r\n                var elt = false;\r\n                var icon = \"\";\r\n                var found = _.find(self.dashboardWidgets, function(widget) {\r\n                    return widget.type === element.type && widget.name === element.name;\r\n                });\r\n                if (element.type === \"scheduler\") {\r\n                    elt = sharedData.get(\"angharadSchedulers\", element.name);\r\n                    icon = \"calendar\";\r\n                } else {\r\n                    elt = sharedData.get(\"angharadTriggers\", element.name);\r\n                    icon = \"bell\";\r\n                }\r\n                if (!!elt && !found) {\r\n                    var tagParams = tag.split(\"$\");\r\n                    if (tagParams.length >= 4) {\r\n                        var x = tagParams[2];\r\n                        var y = tagParams[3];\r\n                        var curHeight = element.type === \"scheduler\" ? 2 : 1;\r\n                        var index = y * 10 + x;\r\n                        var dashboardElement = {\r\n                            type: element.type,\r\n                            name: element.name,\r\n                            element: elt,\r\n                            x: x,\r\n                            y: y,\r\n                            width: 3,\r\n                            height: curHeight,\r\n                            tag: tag,\r\n                            icon: icon\r\n                        };\r\n                        self.dashboardWidgets.push(dashboardElement);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function addMonitorToDashboard(element, tag) {\r\n                var elt = _.find(sagremorParams.currentProfile.monitorList, function(monitor) {\r\n                    return monitor.name === element.name;\r\n                });\r\n                var found = _.find(self.dashboardWidgets, function(widget) {\r\n                    return widget && widget.type === element.type && widget.name === element.name;\r\n                });\r\n                if (!!elt && !found) {\r\n                    var tagParams = tag.split(\"$\");\r\n                    if (tagParams.length >= 4) {\r\n                        var x = tagParams[2];\r\n                        var y = tagParams[3];\r\n                        var curHeight = 4;\r\n                        var icon = \"bar-chart\";\r\n                        var index = y * 10 + x;\r\n                        var dashboardElement = {\r\n                            type: element.type,\r\n                            name: element.name,\r\n                            element: elt,\r\n                            x: x,\r\n                            y: y,\r\n                            width: 6,\r\n                            height: curHeight,\r\n                            tag: tag,\r\n                            icon: icon\r\n                        };\r\n                        self.dashboardWidgets.push(dashboardElement);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function addCarleonElementToDashboard(element, tag) {\r\n                var injector = _.find(sagGenericInjectorManager.components, function(inject) {\r\n                    return inject.type === element.type;\r\n                });\r\n                var service = sharedData.get(\"carleonServices\", element.type);\r\n                var elt = !!service && !!service.element && _.find(service.element, function(cElt) {\r\n                    return cElt.name === element.name;\r\n                });\r\n                var found = _.find(self.dashboardWidgets, function(widget) {\r\n                    return widget && widget.type === element.type && widget.name === element.name;\r\n                });\r\n                if (!!elt && !found) {\r\n                    var tagParams = tag.split(\"$\");\r\n                    if (tagParams.length >= 4) {\r\n                        var x = tagParams[2];\r\n                        var y = tagParams[3];\r\n                        var curHeight = injector.widgetHeight;\r\n                        var curWidth = injector.widgetWidth;\r\n                        var icon = injector.icon;\r\n                        var index = y * 10 + x;\r\n                        var dashboardElement = {\r\n                            type: element.type,\r\n                            name: element.name,\r\n                            element: element,\r\n                            x: x,\r\n                            y: y,\r\n                            width: curWidth,\r\n                            height: curHeight,\r\n                            tag: tag,\r\n                            icon: icon\r\n                        };\r\n                        self.dashboardWidgets.push(dashboardElement);\r\n                    }\r\n                }\r\n            }\r\n\r\n            function addDashboardSeparator(value, tag) {\r\n                var tagParams = tag.split(\"$\");\r\n                if (tagParams.length >= 4) {\r\n                    var y = tagParams[3];\r\n                    var index = y * 10;\r\n                    var dashboardElement = {\r\n                        type: \"separator\",\r\n                        name: value,\r\n                        x: 0,\r\n                        y: y,\r\n                        width: 20,\r\n                        height: 1,\r\n                        tag: tag\r\n                    };\r\n                    self.dashboardWidgets.push(dashboardElement);\r\n                }\r\n            }\r\n\r\n            function newDashboardSeparator(value) {\r\n                var dashboardElement = {\r\n                    type: \"separator\",\r\n                    name: value,\r\n                    x: 0,\r\n                    y: 0,\r\n                    width: 10,\r\n                    height: 1\r\n                };\r\n                var profile = sagremorParams.currentProfile;\r\n                if (!profile.addTo) {\r\n                    profile.addTo = {\r\n                        D: []\r\n                    };\r\n                }\r\n                if (!profile.addTo.D) {\r\n                    profile.addTo.D = [];\r\n                }\r\n                self.dashboardWidgetsDisplay.push(dashboardElement);\r\n                var newElement = {\r\n                    type: \"separator\",\r\n                    name: value,\r\n                    tag: \"SGMR$D$0$0\"\r\n                };\r\n                profile.addTo.D.push(newElement);\r\n                angharadFactory.setProfile(profile.name, profile).then(function() {\r\n                    toaster.pop({\r\n                        type: \"success\",\r\n                        title: $translate.instant(\"angharad_add_to_dashboard\"),\r\n                        body: $translate.instant(\"angharad_add_to_dashboard_success\")\r\n                    });\r\n                }, function() {\r\n                    toaster.pop({\r\n                        type: \"error\",\r\n                        title: $translate.instant(\"angharad_add_to_dashboard\"),\r\n                        body: $translate.instant(\"angharad_add_to_dashboard_error\")\r\n                    });\r\n                });\r\n            }\r\n\r\n            this.removeFromDashboard = function(w) {\r\n                var profile = sagremorParams.currentProfile;\r\n                if (!!profile && !!profile.addTo && !!profile.addTo.D) {\r\n                    _.forEach(profile.addTo.D, function(element, key) {\r\n                        if (element && element.type === w.type && element.name === w.name && w.tag === element.tag) {\r\n                            profile.addTo.D.splice(key, 1);\r\n                        }\r\n                    });\r\n                }\r\n                var index = self.dashboardWidgetsDisplay.indexOf(w);\r\n                self.dashboardWidgetsDisplay.splice(index, 1);\r\n                sagremorParams.currentProfile = profile;\r\n                angharadFactory.setProfile(profile.name, profile).then(function() {\r\n                    toaster.pop(\"success\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_success\"));\r\n                }, function() {\r\n                    toaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profiles_save_error\"));\r\n                });\r\n            };\r\n\r\n            this.onChange = function(event, items) {\r\n                if (self._timeout) {\r\n                    // if there is already a timeout in process cancel it\r\n                    $timeout.cancel(self._timeout);\r\n                }\r\n                self._timeout = $timeout(function() {\r\n                    if (!self.isInit) {\r\n                        if (sagremorParams.carleonEnabled) {\r\n                            var changed = false;\r\n                            _.forEach(items, function(item) {\r\n                                var element = _.find(self.dashboardWidgetsDisplay, function(widget) {\r\n                                    return widget.type === $(item.el).attr(\"data-sag-type\") &&\r\n                                        widget.name === $(item.el).attr(\"data-sag-name\") &&\r\n                                        (!widget.device || widget.device === $(item.el).attr(\"data-sag-device\"));\r\n                                });\r\n                                if (!!element) {\r\n                                    var newTag = \"SGMR$D$\" + item.x + \"$\" + item.y;\r\n                                    if (updateTag(element, newTag)) {\r\n                                        changed = true;\r\n                                        element.tag = newTag;\r\n                                    }\r\n                                }\r\n                            });\r\n                            if (changed) {\r\n                                var dashboardWidgetsDisplay = _(sagremorParams.currentProfile.addTo.D).chain().sortBy(function(widget) {\r\n                                    var splitted = widget.tag.split(\"$\");\r\n                                    return splitted[2];\r\n                                }).sortBy(function(widget) {\r\n                                    var splitted = widget.tag.split(\"$\");\r\n                                    return splitted[3];\r\n                                }).value();\r\n                                sagremorParams.currentProfile.addTo.D = dashboardWidgetsDisplay;\r\n\r\n                                angharadFactory.setProfile(sagremorParams.currentProfile.name, sagremorParams.currentProfile).then(function() {\r\n                                    toaster.pop(\"success\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_success\"));\r\n                                }, function() {\r\n                                    toaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profiles_save_error\"));\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                    self._timeout = null;\r\n                }, 5000);\r\n            };\r\n\r\n            function updateTag(element, newTag) {\r\n                if (newTag !== element.tag) {\r\n                    var profile = sagremorParams.currentProfile;\r\n                    if (!!profile) {\r\n                        if (!profile.addTo) {\r\n                            profile.addTo = {\r\n                                D: []\r\n                            };\r\n                        }\r\n                        if (!profile.addTo.D) {\r\n                            profile.addTo.D = [];\r\n                        }\r\n                        var elt = _.find(profile.addTo.D, function(e) {\r\n                            return element.tag == e.tag;\r\n                        });\r\n                        if (!!elt) {\r\n                            elt.tag = newTag;\r\n                        } else {\r\n                            element.tag = newTag;\r\n                            profile.addTo.D.push(element);\r\n                        }\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            function getProfileElementFromTag(tag) {\r\n                var profile = sagremorParams.currentProfile;\r\n                if (!!profile && !!profile.addTo && !!profile.addTo.D) {\r\n                    var elt = _.find(profile.addTo.D, function(element) {\r\n                        return element.tag == tag;\r\n                    });\r\n                    return elt || false;\r\n                }\r\n                return false;\r\n            }\r\n\r\n            $scope.$on(\"angharadProfileUpdated\", function() {\r\n                self.isInit = true;\r\n                self.dashboardWidgets = [];\r\n                getDashboardElements();\r\n            });\r\n\r\n            $scope.$on(\"refreshDashboard\", function() {\r\n                self.isInit = true;\r\n                getDashboardElements();\r\n            });\r\n\r\n            $scope.$on(\"benoicDevicesChanged\", function() {\r\n                self.isInit = true;\r\n                getDashboardElements();\r\n            });\r\n\r\n            $scope.$on(\"carleonServicesChanged\", function() {\r\n                self.isInit = true;\r\n                getDashboardElements();\r\n            });\r\n\r\n            $scope.$on(\"oauth:login\", function(event, token) {\r\n              self.connected = true;\r\n            });\r\n\r\n            $scope.$on('oauth:refresh', function(event, token) {\r\n              self.connected = true;\r\n            });\r\n\r\n            $scope.$on('oauth:denied', function(event, token) {\r\n              self.connected = false;\r\n            });\r\n\r\n            $scope.$on('oauth:expired', function(event, token) {\r\n              self.connected = false;\r\n            });\r\n\r\n            $scope.$on('oauth:invalid', function(event, token) {\r\n              self.connected = false;\r\n            });\r\n\r\n            this.init();\r\n\r\n        });\r\n\r\n/**\r\n * Workaround for using jquery 3 with gridstack (I F****ing hate bower !)\r\n */\r\n$.fn.size = function() {\r\n    return this.length;\r\n};\r\n\nangular.module(\"sagremorApp\")\r\n\t.controller(\"ErrorCtrl\",\r\n\tfunction($scope, sagremorParams) {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tthis.errorMessage = \"\";\r\n\r\n\t\tthis.init = function() {\r\n\t\t\tif (!!sagremorParams.errorMessage) {\r\n\t\t\t\tself.errorMessage = sagremorParams.errorMessage;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$scope.$on(\"generalError\", function () {\r\n\t\t\tself.init();\r\n\t\t});\r\n\r\n\t\tself.init();\r\n\t}\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"eventsCtrl\",\r\n    function($scope, $translate, sagremorService, angharadFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.schedulerList = [];\r\n        this.triggerList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\r\n\t\t\t$translate([\"edit\", \"remove\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\tself.menuScheduler = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editEvent(param, \"scheduler\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"remove\", \r\n\t\t\t\t\t\tdisplay: results.remove, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.removeScheduler(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"angharadSchedulersChanged\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tparam.type = !!param.next_time?\"scheduler\":\"trigger\";\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\tself.menuTrigger = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editEvent(param, \"trigger\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"remove\", \r\n\t\t\t\t\t\tdisplay: results.remove, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.removeTrigger(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"angharadTriggersChanged\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tparam.type = !!param.next_time?\"scheduler\":\"trigger\";\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\t\r\n\t\t\t\tself.updateSchedulers();\r\n\t\t\t\tself.updateTriggers();\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        this.updateSchedulers = function () {\r\n            var events = sharedData.all(\"angharadSchedulers\");\r\n            self.schedulerList = [];\r\n            for (key in events) {\r\n\t\t\t\tself.schedulerList.push(events[key]);\r\n            }\r\n        };\r\n        \r\n        this.updateTriggers = function () {\r\n            var events = sharedData.all(\"angharadTriggers\");\r\n            self.triggerList = [];\r\n            for (key in events) {\r\n\t\t\t\tself.triggerList.push(events[key]);\r\n            }\r\n        };\r\n        \r\n        this.refreshEvents = function () {\r\n\t\t\tvar schedulers = sharedData.all(\"angharadSchedulers\");\r\n            for (key in schedulers) {\r\n\t\t\t\tvar found = _.find(self.schedulerList, function (scheduler) {\r\n\t\t\t\t\treturn scheduler.name === key;\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\tself.schedulerList.push(schedulers[key]);\r\n\t\t\t\t}\r\n            }\r\n            \r\n            for (var index = self.schedulerList.length - 1; index >= 0; index--) {\r\n\t\t\t\tif (!sharedData.get(\"angharadSchedulers\", self.schedulerList[index].name)) {\r\n\t\t\t\t\tself.schedulerList.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar triggers = sharedData.all(\"angharadTriggers\");\r\n            for (key in triggers) {\r\n\t\t\t\tvar found = _.find(self.triggerList, function (trigger) {\r\n\t\t\t\t\treturn trigger.name === key;\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\tself.triggerList.push(triggers[key]);\r\n\t\t\t\t}\r\n            }\r\n            \r\n            for (var index = self.triggerList.length - 1; index >= 0; index--) {\r\n\t\t\t\tif (!sharedData.get(\"angharadTriggers\", self.triggerList[index].name)) {\r\n\t\t\t\t\tself.triggerList.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n        \r\n        this.newEvent = function () {\r\n\t\t\tsagremorService.editEvent(null);\r\n\t\t};\r\n\t\t\r\n        $scope.$on(\"angharadSchedulersChanged\", function () {\r\n            self.updateSchedulers();\r\n        });\r\n        \r\n        $scope.$on(\"angharadTriggersChanged\", function () {\r\n            self.updateTriggers();\r\n        });\r\n        \r\n        $scope.$on(\"refreshAngharadEvents\", function () {\r\n            self.refreshEvents();\r\n        });\r\n        \r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"FiltersModalCtrl\",\r\n    function($scope, $q, $uibModalInstance, $translate, toaster, DTOptionsBuilder, garethFactory, sharedData) {\r\n        var self = this;\r\n        \r\n        this.filterList = sharedData.all(\"garethFilters\");\r\n        this.AlertSmtpList = sharedData.all(\"garethAlertsSmtp\");\r\n        this.AlertHttpList = sharedData.all(\"garethAlertsHttp\");\r\n        this.editFilter = false;\r\n        this.addFilter = false;\r\n        this.newClause = false;\r\n        this.newAlertSmtp = false;\r\n        this.newAlertHttp = false;\r\n        this.newAlertHttpHeader = false;\r\n        this.displayAlert = false;\r\n        this.customFilter = {\r\n\t\t\tname: \"\",\r\n\t\t\tdescription: \"\",\r\n\t\t\tfilter_clauses: [\r\n\t\t\t],\r\n\t\t\tfilter_alerts: {\r\n\t\t\t\tsmtp: [],\r\n\t\t\t\thttp: []\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tself.menu = [\r\n\t\t\t{\r\n\t\t\t\tname: \"smtp\", \r\n\t\t\t\tdisplay: $translate.instant(\"logs_menu_smtp\"), \r\n\t\t\t\taction: function () {\r\n\t\t\t\t\tself.addAlertSmtp();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: \"http\", \r\n\t\t\t\tdisplay: $translate.instant(\"logs_menu_http\"), \r\n\t\t\t\taction: function () {\r\n\t\t\t\t\tself.addAlertHttp();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\t\r\n\t\tself.menuSelect = function(menuItem, element) {\r\n\t\t\tmenuItem.action(element);\r\n\t\t};\r\n    \r\n\t\tthis.customClause = {\r\n\t\t\telement: \"\",\r\n\t\t\toperator: \"\",\r\n\t\t\tvalue: \"\"\r\n\t\t};\r\n\t\t\r\n\t\tthis.customHttpAlert = {\r\n\t\t\tname: \"\",\r\n\t\t\tmethod: \"\",\r\n\t\t\turl: \"\",\r\n\t\t\tbody: \"\",\r\n\t\t\thttp_headers: [\r\n\t\t\t]\r\n\t\t};\r\n\t\tthis.customHttpAlertHeader = {\r\n\t\t\tkey: \"\",\r\n\t\t\tvalue: \"\"\r\n\t\t};\r\n\t\tthis.existingHttpAlert = \"\";\r\n\t\tthis.customHttpAlertMethodSelect = \"GET\";\r\n\t\t\r\n\t\tthis.customSmtpAlert = {\r\n\t\t\tname: \"\",\r\n\t\t\thost: \"\",\r\n\t\t\tport: 0,\r\n\t\t\ttls: false,\r\n\t\t\tcheck_ca: false,\r\n\t\t\tuser: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tfrom: \"\",\r\n\t\t\tto: \"\",\r\n\t\t\tcc: \"\",\r\n\t\t\tbcc: \"\",\r\n\t\t\tsubject: \"\",\r\n\t\t\tbody: \"\"\r\n\t\t};\r\n\t\tthis.existingSmtpAlert = \"\";\r\n        \r\n        function init() {\r\n        }\r\n        \r\n\t\t$scope.$on(\"garethChange\", function () {\r\n\t\t\tself.filterList = sharedData.all(\"garethFilters\");\r\n\t\t\tself.AlertList = sharedData.all(\"garethAlerts\");\r\n\t\t});\r\n        \r\n        this.newFilter = function () {\r\n\t\t\tself.editFilter = true;\r\n\t\t\tself.addFilter = true;\r\n\t\t\tself.customFilter = {\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tdescription: \"\",\r\n\t\t\t\tfilter_clauses: [\r\n\t\t\t\t],\r\n\t\t\t\tfilter_alerts: {\r\n\t\t\t\t\tsmtp: [],\r\n\t\t\t\t\thttp: []\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\tthis.addClause = function () {\r\n\t\t\tself.newClause = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isClauseValid = function () {\r\n\t\t\treturn !!self.customClause.element && !!self.customClause.operator && !!self.customClause.value;\r\n\t\t};\r\n\t\t\r\n\t\tthis.addNewClause = function () {\r\n\t\t\tif (self.customClause.element === \"priority\") {\r\n\t\t\t\tself.customClause.value = parseInt(self.customClause.value);\r\n\t\t\t}\r\n\t\t\tself.customFilter.filter_clauses.push(self.customClause);\r\n\t\t\tself.customClause = {\r\n\t\t\t\telement: \"\",\r\n\t\t\t\toperator: \"\",\r\n\t\t\t\tvalue: \"\"\r\n\t\t\t};\r\n\t\t\tself.newClause = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeClause = function (index){\r\n\t\t\tself.customFilter.filter_clauses.splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelAddClause = function () {\r\n\t\t\tself.newClause = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.getClauseElement = function (element) {\r\n\t\t\treturn $translate.instant(\"clause_option_\" + element);\r\n\t\t};\r\n        \r\n\t\tthis.getClauseOperator = function (operator) {\r\n\t\t\tswitch (operator) {\r\n\t\t\t\tcase \"=\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_equal\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"!=\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_different\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"<\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_lower\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"<=\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_lower_equal\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \">\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_higher\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \">=\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_higher_equal\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"contains\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_contains\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"notcontains\":\r\n\t\t\t\t\treturn $translate.instant(\"clause_operator_notcontains\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.getClauseValue = function (clause) {\r\n\t\t\tif (clause.element === \"priority\") {\r\n\t\t\t\tswitch (clause.value) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\treturn $translate.instant(\"logs_priority_none\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\treturn $translate.instant(\"logs_priority_low\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\treturn $translate.instant(\"logs_priority_medium\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\treturn $translate.instant(\"logs_priority_high\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\treturn $translate.instant(\"logs_priority_critical\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn clause.value;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.addAlertSmtp = function () {\r\n\t\t\tself.newAlertSmtp = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.addAlertHttp = function () {\r\n\t\t\tself.newAlertHttp = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isSmtpAlertValid = function () {\r\n\t\t\tif (!!self.existingSmtpAlert) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar found = _.find(self.AlertSmtpList, function (alert) {\r\n\t\t\t\treturn alert.name === self.customSmtpAlert.name;\r\n\t\t\t});\r\n\t\t\tif (found) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn !!self.customSmtpAlert.name && \r\n\t\t\t\t\t!!self.customSmtpAlert.host && \r\n\t\t\t\t\t!!self.customSmtpAlert.from && \r\n\t\t\t\t\t!!self.customSmtpAlert.to && \r\n\t\t\t\t\t!!self.customSmtpAlert.subject && \r\n\t\t\t\t\t!!self.customSmtpAlert.body;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelAddSmtpAlert = function () {\r\n\t\t\tself.newAlertSmtp = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.postNewSmtpAlert = function () {\r\n\t\t\tif (!!self.existingSmtpAlert) {\r\n\t\t\t\tself.customFilter.filter_alerts.smtp.push(self.existingSmtpAlert.name);\r\n\t\t\t\tself.existingSmtpAlert = \"\";\r\n\t\t\t\tself.newAlertSmtp = false;\r\n\t\t\t} else {\r\n\t\t\t\tgarethFactory.addAlert(\"smtp\", self.customSmtpAlert).then(function () {\r\n\t\t\t\t\tself.customFilter.filter_alerts.smtp.push(self.customSmtpAlert.name);\r\n\t\t\t\t\tsharedData.add(\"garethAlertsSmtp\", self.customSmtpAlert.name, self.customSmtpAlert);\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_save_success\"));\r\n\t\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\tself.customSmtpAlert = {\r\n\t\t\t\t\t\tname: \"\",\r\n\t\t\t\t\t\thost: \"\",\r\n\t\t\t\t\t\tport: 0,\r\n\t\t\t\t\t\ttls: false,\r\n\t\t\t\t\t\tcheck_ca: false,\r\n\t\t\t\t\t\tuser: \"\",\r\n\t\t\t\t\t\tpassword: \"\",\r\n\t\t\t\t\t\tfrom: \"\",\r\n\t\t\t\t\t\tto: \"\",\r\n\t\t\t\t\t\tsubject: \"\",\r\n\t\t\t\t\t\tbody: \"\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.newAlertSmtp = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.addAlertHttpHeader = function () {\r\n\t\t\tself.newAlertHttpHeader = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelAddAlertHttpHeader = function () {\r\n\t\t\tself.newAlertHttpHeader = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.addNewAlertHttpHeader = function () {\r\n\t\t\tself.customHttpAlert.http_headers.push(self.customHttpAlertHeader);\r\n\t\t\tself.customHttpAlertHeader = {\r\n\t\t\t\tkey: \"\",\r\n\t\t\t\tvalue: \"\"\r\n\t\t\t};\r\n\t\t\tself.newAlertHttpHeader = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isHttpAlertValid = function () {\r\n\t\t\tif (!!self.existingHttpAlert) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar found = _.find(self.AlertHttpList, function (alert) {\r\n\t\t\t\treturn alert.name === self.customHttpAlert.name;\r\n\t\t\t});\r\n\t\t\tif (found) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn !!self.customHttpAlert.name && \r\n\t\t\t\t\t(!!self.customHttpAlert.method || !!self.customHttpAlertMethodSelect) && \r\n\t\t\t\t\t!!self.customHttpAlert.url;\r\n\t\t};\r\n\t\t\r\n\t\tthis.postNewHttpAlert = function () {\r\n\t\t\tif (!!self.existingHttpAlert) {\r\n\t\t\t\tself.customFilter.filter_alerts.http.push(self.existingHttpAlert.name);\r\n\t\t\t\tself.existingHttpAlert = \"\";\r\n\t\t\t\tself.newAlertHttp = false;\r\n\t\t\t} else {\r\n\t\t\t\tif (self.customHttpAlertMethodSelect !== \"custom\") {\r\n\t\t\t\t\tself.customHttpAlert.method = self.customHttpAlertMethodSelect;\r\n\t\t\t\t}\r\n\t\t\t\tgarethFactory.addAlert(\"http\", self.customHttpAlert).then(function () {\r\n\t\t\t\t\tself.customFilter.filter_alerts.http.push(self.customHttpAlert.name);\r\n\t\t\t\t\tsharedData.add(\"garethAlertsHttp\", self.customHttpAlert.name, self.customHttpAlert);\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_save_success\"));\r\n\t\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\tself.customHttpAlertHeader = {\r\n\t\t\t\t\t\tkey: \"\",\r\n\t\t\t\t\t\tvalue: \"\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.customHttpAlert = {\r\n\t\t\t\t\t\tname: \"\",\r\n\t\t\t\t\t\tmethod: \"\",\r\n\t\t\t\t\t\turl: \"\",\r\n\t\t\t\t\t\tbody: \"\",\r\n\t\t\t\t\t\thttp_headers: [\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.newAlertHttp = false;\r\n\t\t\t\t\tself.newAlertHttpHeader = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelAddHttpAlert = function () {\r\n\t\t\tself.newAlertHttp = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeAlert = function (type, index) {\r\n\t\t\tself.customFilter.filter_alerts[type].splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.isFilterValid = function () {\r\n\t\t\treturn !!self.customFilter.name && self.customFilter.filter_clauses.length > 0;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelNewFilter = function () {\r\n\t\t\tself.editFilter = false;\r\n\t\t\tself.addFilter = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.postNewFilter = function () {\r\n\t\t\tvar promise = null;\r\n\t\t\tif (self.addFilter) {\r\n\t\t\t\tpromise = garethFactory.addFilter(self.customFilter);\r\n\t\t\t} else {\r\n\t\t\t\tpromise = garethFactory.setFilter(self.customFilter.name, self.customFilter)\r\n\t\t\t}\r\n\t\t\tpromise.then(function () {\r\n\t\t\t\tsharedData.add(\"garethFilters\", self.customFilter.name, self.customFilter);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_filter\"), $translate.instant(\"logs_filter_save_success\"));\r\n\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_filter\"), $translate.instant(\"logs_filter_save_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\tself.editFilter = false;\r\n\t\t\t\tself.addFilter = false;\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeCustomFilter = function (filter) {\r\n\t\t\tgarethFactory.removeFilter(filter.name).then(function () {\r\n\t\t\t\tsharedData.remove(\"garethFilters\", filter.name);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_filter\"), $translate.instant(\"logs_filter_remove_success\"));\r\n\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_filter\"), $translate.instant(\"logs_filter_remove_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.editCustomFilter = function (filter) {\r\n\t\t\tself.customFilter = filter;\r\n\t\t\tself.editFilter = true;\r\n\t\t\tself.addFilter = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.showAlerts = function () {\r\n\t\t\tself.displayAlert = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.showFilters = function () {\r\n\t\t\tself.displayAlert = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeSmtpAlert = function (alert) {\r\n\t\t\tgarethFactory.removeAlert(\"smtp\", alert.name).then(function () {\r\n\t\t\t\tsharedData.remove(\"garethAlertsSmtp\", alert.name);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_remove_success\"));\r\n\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_remove_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeHttpAlert = function (alert) {\r\n\t\t\tgarethFactory.removeAlert(\"http\", alert.name).then(function () {\r\n\t\t\t\tsharedData.remove(\"garethAlertsHttp\", alert.name);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_remove_success\"));\r\n\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_alert\"), $translate.instant(\"logs_alert_remove_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.close = function () {\r\n\t\t\t$uibModalInstance.close(\"ok\");\r\n\t\t};\r\n        \r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"logsCtrl\",\r\n    function($scope, $translate, $uibModal, toaster, DTOptionsBuilder, garethFactory, sharedData) {\r\n      \r\n        var self = this;\r\n        \r\n        this.messageList = [];\r\n        this.filterList = [];\r\n        this.options = {};\r\n        \r\n        this.searchOptions = {\r\n\t\t\tlimit: 20,\r\n\t\t\toffset: 0\r\n\t\t};\r\n\t\t\r\n\t\t$scope.$on(\"garethChange\", function () {\r\n\t\t\tself.getFilters();\r\n\t\t\tself.search();\r\n\t\t});\r\n        \r\n        this.init = function () {\r\n\t\t\tif ($translate.use()) {\r\n\t\t\t\tself.options = DTOptionsBuilder.newOptions()\r\n\t\t\t\t\t\t\t\t.withLanguageSource(\"components/core/i18n/datatables.\"+$translate.use()+\".json\")\r\n\t\t\t\t\t\t\t\t.withOption(\"order\", [1, \"desc\"]);\r\n\t\t\t\tself.getFilters();\r\n\t\t\t\tself.search();\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\tthis.getPriority = function (message) {\r\n\t\t\tswitch (message.priority) {\r\n\t\t\t\tcase \"NONE\":\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_none\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"LOW\":\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_low\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"MEDIUM\":\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_medium\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"HIGH\":\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_high\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"CRITICAL\":\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_critical\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn $translate.instant(\"logs_priority_not_found\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.search = function () {\r\n\t\t\tif (self.searchOptions.limit > 0 && self.searchOptions.offset >= 0) {\r\n\t\t\t\tif (!!self.searchOptions.filter) {\r\n\t\t\t\t\tgarethFactory.getFilteredMessages(self.searchOptions.filter.name, self.searchOptions.limit, self.searchOptions.offset).then(function (result) {\r\n\t\t\t\t\t\tself.messageList = result;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgarethFactory.getAllMessages(self.searchOptions.limit, self.searchOptions.offset).then(function (result) {\r\n\t\t\t\t\t\tself.messageList = result;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"logs_search\"), $translate.instant(\"logs_search_error\"));\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.getFilters = function () {\r\n\t\t\tself.filterList = sharedData.all(\"garethFilters\");\r\n\t\t};\r\n\t\t\r\n\t\tthis.filterManagement = function () {\r\n\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\tanimation: true,\r\n\t\t\t\ttemplateUrl: \"app/logs/filters.modal.html\",\r\n\t\t\t\tcontroller: \"FiltersModalCtrl\",\r\n\t\t\t\tcontrollerAs: \"FiltersModalCtrl\",\r\n\t\t\t\tsize: \"md\",\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\t$scope.$on(\"changeLang\", function () {\r\n\t\t\tself.options = DTOptionsBuilder.newOptions()\r\n\t\t\t\t\t\t\t.withLanguageSource(\"components/core/i18n/datatables.\"+$translate.use()+\".json\");\r\n\t\t});\r\n\t\t\r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"scriptsCtrl\",\r\n    function($scope, $translate, sagremorService, angharadFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.scriptList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\t\t\t\t\t$translate([\"edit\", \"monitor\", \"bind_to_element\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\t\t\tself.menuScript = [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\t\t\tdisplay: $translate.instant(\"edit\"), \r\n\t\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\t\tsagremorService.editScript(param);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: \"remove\", \r\n\t\t\t\t\t\t\t\tdisplay: $translate.instant(\"remove\"),\r\n\t\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\t\tsagremorService.removeScript(param).then(function () {\r\n\t\t\t\t\t\t\t\t\t\t$scope.$broadcast(\"angharadScriptsChanged\");\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: \"bind_to_element\", \r\n\t\t\t\t\t\t\t\tdisplay: $translate.instant(\"bind_to_element\"),\r\n\t\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\t\tsagremorService.bindToElement(param);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\t\t\tdisplay: $translate.instant(\"add_to_dashboard\"),\r\n\t\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\t\tparam.type = \"script\";\r\n\t\t\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tself.updateScripts();\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n        \r\n        $scope.$on(\"angharadScriptsChanged\", function () {\r\n            self.updateScripts();\r\n        });\r\n        \r\n        this.updateScripts = function () {\r\n            var scripts = sharedData.all(\"angharadScripts\");\r\n            self.scriptList = [];\r\n            for (key in scripts) {\r\n\t\t\t\tself.scriptList.push(scripts[key]);\r\n            }\r\n        };\r\n        \r\n        $scope.$on(\"refreshAngharadScripts\", function () {\r\n            self.refreshScripts();\r\n        });\r\n        \r\n        this.refreshScripts = function () {\r\n\t\t\t\t\tvar scripts = sharedData.all(\"angharadScripts\");\r\n\t\t\t\t\t\t\t\tfor (key in scripts) {\r\n\t\t\t\t\t\tvar found = _.find(self.scriptList, function (script) {\r\n\t\t\t\t\t\t\treturn script.name === key;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tself.scriptList.push(scripts[key]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tfor (var index = self.scriptList.length - 1; index >= 0; index--) {\r\n\t\t\t\t\t\tif (!sharedData.get(\"angharadScripts\", self.scriptList[index].name)) {\r\n\t\t\t\t\t\t\tself.scriptList.splice(index, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n        \r\n        this.newScript = function () {\r\n\t\t\t\t\tsagremorService.editScript(null);\r\n\t\t\t\t};\r\n\t\t\r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"ParametersCtrl\",\r\n    function($scope, $rootScope, $q, $location, $translate, $cookies, $window, toaster, angharadFactory, benoicFactory, carleonFactory, sharedData, sagremorConfirm, sagremorParams) {\r\n      \r\n\t\tvar self = this;\r\n\r\n\t\tthis.submodules;\r\n\r\n\t\tthis.deviceList = [];\r\n\t\tthis.deviceTypes = [];\r\n\t\tthis.deviceTypesEnabled = [];\r\n\t\tthis.deviceAdded = false;\r\n\t\tthis.deviceUpdated = false;\r\n\r\n\t\tthis.newDeviceName = \"\";\r\n\t\tthis.newDeviceDescription = \"\";\r\n\t\tthis.newDeviceType = \"\";\r\n\t\tthis.newDeviceConnect = true;\r\n\r\n\t\tthis.deviceOptionList = [];\r\n\t\tthis.deviceOptionListDisplay = false;\r\n\r\n\t\tthis.profileList = [];\r\n\t\tthis.currentProfile = false;\r\n\t\tthis.profileAdded = false;\r\n\t\t\r\n\t\tthis.serviceList = [];\r\n\t\t\r\n\t\tthis.sagremorParams = sagremorParams;\r\n\r\n\t\tthis.init = function() {\r\n\t\t\tif (!sagremorParams.loggedIn) {\r\n\t\t\t\t$location.path(\"/login\");\r\n\t\t\t}\r\n\r\n\t\t\tself.submodules = sharedData.all(\"submodules\");\r\n\t\t\tself.deviceList = sharedData.all(\"benoicDevices\");\r\n\t\t\tself.initDeviceTypes();\r\n\t\t\tself.serviceList = sharedData.all(\"carleonServices\");\r\n\t\t\tself.selectedLang = $translate.use();\r\n\t\t\tself.profileList = sagremorParams.profiles;\r\n\t\t\tself.currentProfile = sagremorParams.currentProfile;\r\n\t\t};\r\n\r\n\t\t$scope.$on(\"submodulesChanged\", function () {\r\n\t\t\tself.submodules = sharedData.all(\"submodules\");\r\n\t\t});\r\n\r\n\t\t$scope.$on(\"benoicDevicesChanged\", function () {\r\n\t\t\tself.deviceList = sharedData.all(\"benoicDevices\");\r\n\t\t});\r\n\r\n\t\t$scope.$on(\"benoicDeviceTypesChanged\", function () {\r\n\t\t\tself.initDeviceTypes();\r\n\t\t});\r\n\r\n\t\t$scope.$on(\"carleonServicesChanged\", function () {\r\n\t\t\tself.serviceList = sharedData.all(\"carleonServices\");\r\n\t\t});\r\n\r\n\t\tthis.addDevice = function () {\r\n\t\t\tself.deviceAdded = true;\r\n\t\t};\r\n\r\n\t\tthis.isDeviceValid = function () {\r\n\t\t\tif (!self.newDeviceName || self.newDeviceName.length > 64) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var name in self.deviceList) {\r\n\t\t\t\tif (self.newDeviceName === name) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!self.newDeviceDescription || self.newDeviceDescription > 128) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (!self.newDeviceType) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var key in self.deviceOptionList) {\r\n\t\t\t\tvar option = self.deviceOptionList[key];\r\n\r\n\t\t\t\tif (!option.optional && !option.value) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tthis.postNewDevice = function () {\r\n\r\n\t\t\tvar curOptions = {};\r\n\t\t\t_.forEach(self.deviceOptionList, function (option) {\r\n\t\t\t\tif (option.type === \"boolean\") {\r\n\t\t\t\t\tcurOptions[option.name] = !!option.value;\r\n\t\t\t\t} else if (option.type === \"numeric\") {\r\n\t\t\t\t\tcurOptions[option.name] = parseFloat(option.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurOptions[option.name] = option.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar deviceName = self.newDeviceName;\r\n\t\t\tbenoicFactory.addDevice({name: deviceName, display: self.newDeviceName, description: self.newDeviceDescription, enabled: true, type_uid: self.newDeviceType, options: curOptions}).then(function (response) {\r\n\t\t\t\tif (self.newDeviceConnect) {\r\n\t\t\t\t\tself.connectDevice({name: deviceName, connected: true}).then(function(result) {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_add\"), $translate.instant(\"device_add_success\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_add\"), $translate.instant(\"device_add_success\"));\r\n\t\t\t\t}\r\n\t\t\t}, function (error) {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_add\"), $translate.instant(\"device_add_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\tself.deviceAdded = false;\r\n\t\t\t\tself.deviceList = sharedData.all(\"benoicDevices\");\r\n\t\t\t\tself.newDeviceName = \"\";\r\n\t\t\t\tself.newDeviceDescription = \"\";\r\n\t\t\t\tself.newDeviceType = \"\";\r\n\t\t\t\tself.newDeviceConnect = true;\r\n\t\t\t\tself.deviceOptionList = [];\r\n\t\t\t\t$rootScope.$broadcast(\"reinitBenoic\");\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.cancelNewDevice = function () {\r\n\t\t\tself.deviceAdded = false;\r\n\t\t\tself.newDeviceName = \"\";\r\n\t\t\tself.newDeviceDescription = \"\";\r\n\t\t\tself.newDeviceType = \"\";\r\n\t\t\tself.deviceOptionList = [];\r\n\t\t};\r\n\r\n\t\tthis.setDeviceOptions = function () {\r\n\t\t\tif (!!self.newDeviceType) {\r\n\t\t\t\tself.deviceOptionList = _.find(self.deviceTypes, function(type) { return type.uid === self.newDeviceType; }).options;\r\n\t\t\t\tself.deviceOptionListDisplay = true;\r\n\t\t\t} else {\r\n\t\t\t\tself.deviceOptionListDisplay = false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.connectDevice = function (device) {\r\n\t\t\tif (device.connected) {\r\n\t\t\t\treturn benoicFactory.connectDevice(device.name).then(function (response) {\r\n\t\t\t\t\tbenoicFactory.getDeviceOverview(device.name).then(function (result) {\r\n\t\t\t\t\t\tsharedData.get(\"benoicDevices\", device.name).element = result;\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_connect\"), $translate.instant(\"device_connect_success\"));\r\n\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_connect\"), $translate.instant(\"device_connect_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_connect\"), $translate.instant(\"device_connect_error\"));\r\n\t\t\t\t\tdevice.connected = false;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn benoicFactory.disconnectDevice(device.name).then(function (response) {\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_disconnect\"), $translate.instant(\"device_disconnect_success\"));\r\n\t\t\t\t\tvar curDevice = sharedData.get(\"benoicDevices\", device.name);\r\n\t\t\t\t\tif (!!curDevice) {\r\n\t\t\t\t\t\tcurDevice.element = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_disconnect\"), $translate.instant(\"device_disconnect_error\"));\r\n\t\t\t\t\tdevice.connected = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.editDevice = function (device) {\r\n\t\t\tdevice.newDescription = device.description;\r\n\t\t\tdevice.update = true;\r\n\t\t\tself.deviceUpdated = true;\r\n\t\t\tself.deviceOptionListDisplay = true;\r\n\t\t\tself.deviceOptionList = _.find(self.deviceTypes, {uid: device.type_uid}).options;\r\n\t\t\tself.newDeviceType = device.type_uid;\r\n\t\t\t_.forEach(self.deviceOptionList, function (option) {\r\n\t\t\t\toption.value = device.options[option.name];\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.saveDevice = function (device) {\r\n\t\t\tdevice.description = device.newDescription;\r\n\t\t\t_.forEach(self.deviceOptionList, function (option) {\r\n\t\t\t\tdevice.options[option.name] = option.value;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tbenoicFactory.setDevice(device).then(function (response) {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_save\"), $translate.instant(\"device_save_success\"));\r\n\t\t\t}, function (error) {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_save\"), $translate.instant(\"device_save_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\tself.deviceUpdated = false;\r\n\t\t\t\tself.deviceOptionListDisplay = false;\r\n\t\t\t\tself.deviceOptionList = [];\r\n\t\t\t\tdevice.update = false;\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.cancelEditDevice = function (device) {\r\n\t\t\tdevice.newDescription = device.description;\r\n\t\t\tself.deviceUpdated = false;\r\n\t\t\tself.deviceOptionListDisplay = false;\r\n\t\t\tself.deviceOptionList = [];\r\n\t\t\tdevice.update = false;\r\n\t\t};\r\n\r\n\t\tthis.removeDevice = function (device) {\r\n\t\t\tsagremorConfirm.open($translate.instant(\"device_remove\"), $translate.instant(\"device_remove_confirm\")).then (function(result) {\r\n\t\t\t\tbenoicFactory.removeDevice(device.name).then(function (response) {\r\n\t\t\t\t\tsharedData.remove(\"benoicDevices\", device.name);\r\n\t\t\t\t\tself.deviceList = sharedData.all(\"benoicDevices\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"device_remove\"), $translate.instant(\"device_remove_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"device_remove\"), $translate.instant(\"device_remove_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.initDeviceTypes = function () {\r\n\t\t\tself.deviceTypes = sharedData.all(\"benoicDeviceTypes\");\r\n\t\t\tself.deviceTypesEnabled = _.filter(sharedData.all(\"benoicDeviceTypes\"), {enabled: true});\r\n\t\t\t_.forEach(self.deviceTypes, function (type) {\r\n\t\t\t\t$translate(type.uid + \"_device_type\").then(function(translate) {\r\n\t\t\t\t\ttype.translate = translate;\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttype.translate = type.name;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.reloadBenoicDeviceTypes = function () {\r\n\t\t\tbenoicFactory.reloadDeviceTypes().then(function (result) {\r\n\t\t\t\tsharedData.removeAll(\"benoicDeviceTypes\");\r\n\t\t\t\t_.forEach(result, function (deviceType) {\r\n\t\t\t\t\tsharedData.add(\"benoicDeviceTypes\", deviceType.uid, deviceType);\r\n\t\t\t\t});\r\n\t\t\t\tself.initDeviceTypes();\r\n\t\t\t\t$rootScope.$broadcast(\"refresh\");\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.reloadCarleonServices = function () {\r\n\t\t\tcarleonFactory.reloadServiceList().then(function (result) {\r\n\t\t\t\tsharedData.removeAll(\"carleonServices\");\r\n\t\t\t\tfor (key in result) {\r\n\t\t\t\t\t_.forEach(result[key].element, function (element) {\r\n\t\t\t\t\t\telement.type = result[key].name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsharedData.add(\"carleonServices\", result[key].name, result[key]);\r\n\t\t\t\t}\r\n\t\t\t\t$rootScope.$broadcast(\"refresh\");\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.submoduleEnable = function(submodule) {\r\n\t\t\treturn sagremorConfirm.open($translate.instant(\"param_submodule_enable\"), $translate.instant(\"param_submodule_enable_confirm\")).then(function () {\r\n\t\t\t\tif (submodule === \"benoic\") {\r\n\t\t\t\t\tangharadFactory.enableSubmodule(submodule, self.submodules.benoic.enabled).then(function (response) {\r\n\t\t\t\t\t\tsagremorParams.benoicEnabled = self.submodules.benoic.enabled;\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"submodulesChanged\");\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshDashboard\")\r\n\t\t\t\t\t\tif (self.submodules.benoic.enabled) {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"reinitBenoic\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"closeBenoic\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_success\"));\r\n\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (submodule === \"carleon\") {\r\n\t\t\t\t\tangharadFactory.enableSubmodule(submodule, self.submodules.carleon.enabled).then(function (response) {\r\n\t\t\t\t\t\tsagremorParams.carleonEnabled = self.submodules.carleon.enabled;\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"submodulesChanged\");\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshDashboard\")\r\n\t\t\t\t\t\tif (self.submodules.carleon.enabled) {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"reinitCarleon\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"closeCarleon\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_success\"));\r\n\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (submodule === \"gareth\") {\r\n\t\t\t\t\tangharadFactory.enableSubmodule(submodule, self.submodules.gareth.enabled).then(function (response) {\r\n\t\t\t\t\t\tsagremorParams.garethEnabled = self.submodules.gareth.enabled;\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"submodulesChanged\");\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshDashboard\")\r\n\t\t\t\t\t\tif (self.submodules.gareth.enabled) {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"reinitGareth\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"closeGareth\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_success\"));\r\n\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"submodules\"), $translate.instant(\"submodules_enable_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, function () {\r\n\t\t\t\tself.submodules[submodule].enabled = !self.submodules[submodule].enabled;\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.addProfile = function () {\r\n\t\t\tself.newProfileName = \"\";\r\n\t\t\tself.newProfileDescription = \"\";\r\n\t\t\tself.newProfileDefault = false;\r\n\t\t\tself.profileAdded = true;\r\n\t\t};\r\n\r\n\t\tthis.cancelNewProfile = function () {\r\n\t\t\tself.profileAdded = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isProfileValid = function () {\r\n\t\t\tvar result = self.newProfileName.length > 0;\r\n\t\t\t_.forEach(self.profileList, function (profile) {\r\n\t\t\t\tif (profile.name === self.newProfileName) {\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t};\r\n\t\t\r\n\t\tthis.saveNewProfile = function () {\r\n\t\t\tvar newProfile = {name: self.newProfileName, description: self.newProfileDescription, default: self.newProfileDefault};\r\n\t\t\tangharadFactory.setProfile(self.newProfileName, newProfile).then(function () {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_add_success\"));\r\n\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\tself.profileList.push(newProfile);\r\n\t\t\t}, function (error) {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_add_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\tself.profileAdded = false;\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.removeProfile = function (profile) {\r\n\t\t\tsagremorConfirm.open($translate.instant(\"profile_remove\"), $translate.instant(\"profile_remove_confirm\")).then (function(result) {\r\n\t\t\t\tangharadFactory.removeProfile(profile.name).then(function () {\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_remove_success\"));\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t_.remove(self.profileList, function (curProfile) {\r\n\t\t\t\t\t\treturn profile.name === curProfile.name;\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_remove_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.cleanProfile = function (profile) {\r\n\t\t\tsagremorConfirm.open($translate.instant(\"profile_clean\"), $translate.instant(\"profile_clean_confirm\")).then (function(result) {\r\n\t\t\t\tvar cleanProfile = {name: profile.name, description: profile.description, default: profile.default};\r\n\t\t\t\tangharadFactory.setProfile(profile.name, cleanProfile).then(function (result) {\r\n\t\t\t\t\tfor (key in sagremorParams.profiles) {\r\n\t\t\t\t\t\tif (sagremorParams.profiles[key].name === cleanProfile.name) {\r\n\t\t\t\t\t\t\tsagremorParams.profiles[key] = cleanProfile;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sagremorParams.currentProfile.name === cleanProfile.name) {\r\n\t\t\t\t\t\tsagremorParams.currentProfile = cleanProfile;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_success\"));\r\n\t\t\t\t\tprofile = cleanProfile;\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.editProfile = function (profile) {\r\n\t\t\tprofile.update = true;\r\n\t\t\tprofile.newName = profile.name;\r\n\t\t\tprofile.newDescription = profile.description;\r\n\t\t};\r\n\r\n\t\tthis.cancelEditProfile = function (profile) {\r\n\t\t\tprofile.update = false;\r\n\t\t\tprofile.name = profile.newName;\r\n\t\t\tprofile.description = profile.newDescription;\r\n\t\t};\r\n\r\n\t\tthis.isUpdateProfileValid = function (profile) {\r\n\t\t\tvar result = profile.newName.length > 0;\r\n\t\t\t_.forEach(self.profileList, function (curProfile) {\r\n\t\t\t\tif (profile.name !== curProfile.name && profile.newName === curProfile.name) {\r\n\t\t\t\t\t// Duplicate name, avoid\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\tthis.saveProfile = function (profile) {\r\n\t\t\tif (profile.name !== profile.savedName) {\r\n\t\t\t\t// Remve old profile, then add new one\r\n\t\t\t\tvar savedName = profile.newName;\r\n\t\t\t\tprofile.name = profile.newName;\r\n\t\t\t\tprofile.description = profile.newDescription;\r\n\t\t\t\tdelete profile.newName;\r\n\t\t\t\tdelete profile.newDescription;\r\n\t\t\t\tdelete profile.update;\r\n\t\t\t\tvar promises = {\r\n\t\t\t\t\tremove: angharadFactory.removeProfile(savedName),\r\n\t\t\t\t\tadd: angharadFactory.setProfile(profile.name, profile)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$q.all(promises).then(function (results) {\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t  // Update profile\r\n\t\t\t\tdelete profile.savedName;\r\n\t\t\t\tdelete profile.savedDescription;\r\n\t\t\t\tdelete profile.update;\r\n\t\t\t\tangharadFactory.setProfile(profile.name, profile).then(function (result) {\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.setDefaultProfile = function (profile) {\r\n\t\t\tif (!profile.default) {\r\n\t\t\t\t// Update just this one\r\n\t\t\t\tdelete profile.savedName;\r\n\t\t\t\tdelete profile.savedDescription;\r\n\t\t\t\tdelete profile.update;\r\n\t\t\t\tangharadFactory.setProfile(profile.name, profile).then(function (result) {\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Set this one to default, and set the other default to false\r\n\t\t\t\tdelete profile.update;\r\n\t\t\t\tangharadFactory.setProfile(profile.name, profile).then(function (result) {\r\n\t\t\t\t\t_.forEach(self.profileList, function (curProfile) {\r\n\t\t\t\t\t\tif (curProfile.default && curProfile.name !== profile.name) {\r\n\t\t\t\t\t\t\tcurProfile.default = false;\r\n\t\t\t\t\t\t\tangharadFactory.setProfile(curProfile.name, curProfile).then(function (result) {\r\n\t\t\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profiles\"), $translate.instant(\"profiles_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.useProfile = function (profile) {\r\n\t\t\tsagremorParams.currentProfile = profile;\r\n\t\t\tvar exp = new $window.Date();\r\n\t\t\texp = new $window.Date(exp.getFullYear() + 10, exp.getMonth(), exp.getDate());\r\n\t\t\t$cookies.put(\"ANGHARAD_PROFILE\", profile.name, {expires: exp});\r\n\t\t\t$rootScope.$broadcast(\"angharadProfileUpdated\");\r\n\t\t};\r\n\t\t\r\n\t\tthis.enableCarleonService = function (service) {\r\n\t\t\tcarleonFactory.enableService(service.name, service.enabled).then(function () {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_services\"), $translate.instant(\"carleon_services_enabled_success\"));\r\n\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_services\"), $translate.instant(\"carleon_services_enabled_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\t$scope.$on(\"angharadProfileChanged\", function () {\r\n\t\t\tself.profileList = sagremorParams.profiles;\r\n\t\t});\r\n\r\n\t\t$scope.$on(\"angharadProfileUpdated\", function () {\r\n\t\t\tself.currentProfile = sagremorParams.currentProfile;\r\n\t\t});\r\n\r\n\t\tthis.init();\r\n    }\r\n).filter(\"deviceTypeName\", [\r\n    \"sharedData\",\r\n    function(sharedData) {\r\n        return function(input) {\r\n          var types = sharedData.all(\"benoicDeviceTypes\");\r\n          for (key in types) {\r\n            if (types[key].uid === input) {\r\n              return types[key].name;\r\n            }\r\n          }\r\n          return false;\r\n        };\r\n    }]);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"sensorsCtrl\",\r\n    function($scope, $location, $translate, sagremorService, benoicFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.sensorList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\t\t\tif (!sagremorParams.loggedIn) {\r\n\t\t\t\t$location.path(\"/login\");\r\n\t\t\t}\r\n\t\t\t$translate([\"edit\", \"monitor\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\tself.menuSensor = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editSensor(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"monitor\", \r\n\t\t\t\t\t\tdisplay: results.monitor, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.monitor(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\t\r\n\t\t\t\tself.updateSensors();\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        $scope.$on(\"benoicDevicesChanged\", function () {\r\n            self.updateSensors();\r\n        });\r\n        \r\n        $scope.$on(\"benoicSensorsChanged\", function () {\r\n            self.updateSensors();\r\n        });\r\n        \r\n        this.updateSensors = function () {\r\n            var devices = sharedData.all(\"benoicDevices\");\r\n\t\t\tself.sensorList = [];\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.sensors) {\r\n                        var sensors = devices[key].element.sensors[se];\r\n                        sensors.device = deviceName;\r\n                        sensors.name = se;\r\n                        self.sensorList.push(sensors);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        \r\n        $scope.$on(\"refreshDevices\", function () {\r\n            self.refreshElements();\r\n        });\r\n        \r\n        this.refreshElements = function () {\r\n\t\t\t// Add all elements that are not in self.sensorList\r\n\t\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.sensors) {\r\n\t\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\t\tvar found = _.find(self.sensorList, function (element) {\r\n\t\t\t\t\t\t\treturn element.name === se && element.device === deviceName;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tvar sensor = devices[key].element.sensors[se];\r\n\t\t\t\t\t\t\tsensor.device = deviceName;\r\n\t\t\t\t\t\t\tsensor.name = se;\r\n\t\t\t\t\t\t\tself.sensorList.push(sensor);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar sensor = devices[key].element.sensors[se];\r\n\t\t\t\t\t\t\tsensor.device = deviceName;\r\n\t\t\t\t\t\t\tsensor.name = se;\r\n\t\t\t\t\t\t\tvar index = _.indexOf(self.sensorList, _.find(self.sensorList, {device: deviceName, name: se}));\r\n\t\t\t\t\t\t\tself.sensorList.splice(index, 1, sensor);\r\n\t\t\t\t\t\t}\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Remove all elements from self.sensorList that are no longer in devices\r\n            _.remove(self.sensorList, function (sensor) {\r\n\t\t\t\tvar found = _.find(sharedData.all(\"benoicDevices\"), function (device, deviceName) {\r\n\t\t\t\t\treturn !device.element || _.find(device.element.sensors, function (element, eltName) {\r\n\t\t\t\t\t\treturn eltName === sensor.name && deviceName === sensor.device;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"heatersCtrl\",\r\n    function($scope, $location, $translate, sagremorService, benoicFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.heaterList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\t\t\tif (!sagremorParams.loggedIn) {\r\n\t\t\t\t$location.path(\"/login\");\r\n\t\t\t}\r\n\t\t\t$translate([\"edit\", \"monitor\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\tself.menuSensor = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editHeater(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"monitor\", \r\n\t\t\t\t\t\tdisplay: results.monitor, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.monitor(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\t\r\n\t\t\t\tself.updateHeaters();\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        $scope.$on(\"benoicDevicesChanged\", function () {\r\n            self.updateHeaters();\r\n        });\r\n        \r\n        $scope.$on(\"benoicHeatersChanged\", function () {\r\n            self.updateHeaters();\r\n        });\r\n        \r\n        this.updateHeaters = function () {\r\n            var devices = sharedData.all(\"benoicDevices\");\r\n\t\t\tself.heaterList = [];\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.heaters) {\r\n                        var heaters = devices[key].element.heaters[se];\r\n                        heaters.device = deviceName;\r\n                        heaters.name = se;\r\n                        self.heaterList.push(heaters);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        \r\n        $scope.$on(\"refreshDevices\", function () {\r\n            self.refreshElements();\r\n        });\r\n        \r\n        this.refreshElements = function () {\r\n\t\t\t// Add all elements that are not in self.heaterList\r\n\t\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.heaters) {\r\n\t\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\t\tvar found = _.find(self.heaterList, function (element) {\r\n\t\t\t\t\t\t\treturn element.name === se && element.device === deviceName;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tvar heater = devices[key].element.heaters[se];\r\n\t\t\t\t\t\t\theater.device = deviceName;\r\n\t\t\t\t\t\t\theater.name = se;\r\n\t\t\t\t\t\t\tself.heaterList.push(heater);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar heater = devices[key].element.heaters[se];\r\n\t\t\t\t\t\t\theater.device = deviceName;\r\n\t\t\t\t\t\t\theater.name = se;\r\n\t\t\t\t\t\t\tvar index = _.indexOf(self.heaterList, _.find(self.heaterList, {device: deviceName, name: se}));\r\n\t\t\t\t\t\t\tself.heaterList.splice(index, 1, heater);\r\n\t\t\t\t\t\t}\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Remove all elements from self.heaterList that are no longer in devices\r\n            _.remove(self.heaterList, function (heater) {\r\n\t\t\t\tvar found = _.find(sharedData.all(\"benoicDevices\"), function (device, deviceName) {\r\n\t\t\t\t\treturn !device.element || _.find(device.element.heaters, function (element, eltName) {\r\n\t\t\t\t\t\treturn eltName === heater.name && deviceName === heater.device;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"switchesCtrl\",\r\n    function($scope, $location, $translate, sagremorService, benoicFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.switchList = [];\r\n        this.dimmerList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\t\t\tif (!sagremorParams.loggedIn) {\r\n\t\t\t\t$location.path(\"/login\");\r\n\t\t\t}\r\n\t\t\t$translate([\"edit\", \"monitor\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\tself.menuSwitcher = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editSwitcher(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"monitor\", \r\n\t\t\t\t\t\tdisplay: results.monitor, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.monitor(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\tself.menuDimmer = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\tdisplay: results.edit, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.editDimmer(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"monitor\", \r\n\t\t\t\t\t\tdisplay: results.monitor, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.monitor(param);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\t\r\n\t\t\t\tself.updateSwitchers();\r\n\t\t\t\tself.updateDimmers();\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        $scope.$on(\"benoicDevicesChanged\", function () {\r\n            self.updateSwitchers();\r\n            self.updateDimmers();\r\n        });\r\n        \r\n        $scope.$on(\"benoicSwitchesChanged\", function () {\r\n            self.updateSwitchers();\r\n            self.updateDimmers();\r\n        });\r\n        \r\n        this.updateSwitchers = function () {\r\n            var devices = sharedData.all(\"benoicDevices\");\r\n\t\t\tself.switchList = [];\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (sw in devices[key].element.switches) {\r\n                        var switcher = devices[key].element.switches[sw];\r\n                        switcher.device = deviceName;\r\n                        switcher.name = sw;\r\n                        self.switchList.push(switcher);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        \r\n        this.updateDimmers = function () {\r\n            var devices = sharedData.all(\"benoicDevices\");\r\n\t\t\tself.dimmerList = [];\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (di in devices[key].element.dimmers) {\r\n                        var dimmer = devices[key].element.dimmers[di];\r\n                        dimmer.device = deviceName;\r\n                        dimmer.name = di;\r\n                        self.dimmerList.push(dimmer);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        \r\n        $scope.$on(\"refreshDevices\", function () {\r\n            self.refreshElements();\r\n        });\r\n        \r\n        this.refreshElements = function () {\r\n\t\t\t// Add all elements that are not in self.dimmerList\r\n\t\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.dimmers) {\r\n\t\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\t\tvar found = _.find(self.dimmerList, function (element) {\r\n\t\t\t\t\t\t\treturn element.name === se && element.device === deviceName;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tvar dimmer = devices[key].element.dimmers[se];\r\n\t\t\t\t\t\t\tdimmer.device = deviceName;\r\n\t\t\t\t\t\t\tdimmer.name = se;\r\n\t\t\t\t\t\t\tself.dimmerList.push(dimmer);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar dimmer = devices[key].element.dimmers[se];\r\n\t\t\t\t\t\t\tdimmer.device = deviceName;\r\n\t\t\t\t\t\t\tdimmer.name = se;\r\n\t\t\t\t\t\t\tvar index = _.indexOf(self.dimmerList, _.find(self.dimmerList, {device: deviceName, name: se}));\r\n\t\t\t\t\t\t\tself.dimmerList.splice(index, 1, dimmer);\r\n\t\t\t\t\t\t}\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Remove all elements from self.dimmerList that are no longer in devices\r\n            _.remove(self.dimmerList, function (dimmer) {\r\n\t\t\t\tvar found = _.find(sharedData.all(\"benoicDevices\"), function (device, deviceName) {\r\n\t\t\t\t\treturn _.find(device.element.dimmers, function (element, eltName) {\r\n\t\t\t\t\t\treturn eltName === dimmer.name && deviceName === dimmer.device;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// Add all elements that are not in self.switchList\r\n\t\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n            for (key in devices) {\r\n                var deviceName = devices[key].name;\r\n                if (devices[key].connected && devices[key].enabled) {\r\n                    for (se in devices[key].element.switches) {\r\n\t\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\t\tvar found = _.find(self.switchList, function (element) {\r\n\t\t\t\t\t\t\treturn element.name === se && element.device === deviceName;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tvar switcher = devices[key].element.dimmers[se];\r\n\t\t\t\t\t\t\tswitcher.device = deviceName;\r\n\t\t\t\t\t\t\tswitcher.name = se;\r\n\t\t\t\t\t\t\tself.switchList.push(switcher);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar switcher = devices[key].element.switches[se];\r\n\t\t\t\t\t\t\tswitcher.device = deviceName;\r\n\t\t\t\t\t\t\tswitcher.name = se;\r\n\t\t\t\t\t\t\tvar index = _.indexOf(self.switchList, _.find(self.switchList, {device: deviceName, name: se}));\r\n\t\t\t\t\t\t\tself.switchList.splice(index, 1, switcher);\r\n\t\t\t\t\t\t}\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Remove all elements from self.switchList that are no longer in devices\r\n            _.remove(self.switchList, function (switcher) {\r\n\t\t\t\tvar found = _.find(sharedData.all(\"benoicDevices\"), function (device, deviceName) {\r\n\t\t\t\t\treturn !device.element || _.find(device.element.dimmers, function (element, eltName) {\r\n\t\t\t\t\t\treturn eltName === dimmer.name && deviceName === dimmer.device;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"monitorsCtrl\",\r\n    function($scope, $translate, toaster, sagremorService, angharadFactory, carleonFactory, sagremorParams, sagremorEdit) {\r\n      \r\n        var self = this;\r\n        \r\n        this.monitorList = [];\r\n        this.sagremorParams = sagremorParams;\r\n        \r\n        this.init = function () {\r\n\r\n\t\t\t$translate([\"edit\", \"remove\", \"add_to_dashboard\"]).then(function (results) {\r\n\t\t\t\tself.menu = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"remove\", \r\n\t\t\t\t\t\tdisplay: results.remove, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tsagremorService.removeMonitor(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\tdisplay: results.add_to_dashboard, \r\n\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\tparam.type = \"monitor\";\r\n\t\t\t\t\t\t\tsagremorService.addToDashboard(param).then(function () {\r\n\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\tself.updateMonitors();\r\n\t\t\t});\r\n\t\t};\r\n        \r\n        $scope.$on(\"angharadProfileChanged\", function () {\r\n            self.updateMonitors();\r\n        });\r\n        \r\n        this.updateMonitors = function () {\r\n\t\t\tvar profile = sagremorParams.currentProfile;\r\n\t\t\tif (!!profile && !!profile.monitorList) {\r\n\t\t\t\tself.monitorList = profile.monitorList;\r\n\t\t\t}\r\n        };\r\n        \r\n        this.newMonitor = function () {\r\n\t\t\treturn sagremorEdit.open($translate.instant(\"monitor_new_title\"), $translate.instant(\"monitor_new_value\"), $translate.instant(\"monitor_new_placeholder\")).then(function (result) {\r\n\t\t\t\taddMonitor(result.value);\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tfunction addMonitor(name) {\r\n\t\t\tif (sagremorParams.currentProfile) {\r\n\t\t\t\tvar exist = _.find(sagremorParams.currentProfile.monitorList, function (monitor) {\r\n\t\t\t\t\treturn monitor.name === name;\r\n\t\t\t\t});\r\n\t\t\t\tif (!sagremorParams.currentProfile.monitorList) {\r\n\t\t\t\t\tsagremorParams.currentProfile.monitorList = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (!exist && !!name) {\r\n\t\t\t\t\tvar monitor = {name: name, elements: []};\r\n\t\t\t\t\tsagremorParams.currentProfile.monitorList.push(monitor);\r\n\t\t\t\t\tangharadFactory.saveCurrentProfile().then(function() {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"monitor_save\"), $translate.instant(\"monitor_save_success\"));\r\n\t\t\t\t\t}, function () {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"monitor_save\"), $translate.instant(\"monitor_save_error\"));\r\n\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n        \r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"serviceCtrl\",\r\n    function($scope, $stateParams, $location, $translate, $uibModal, toaster, sagGenericInjectorManager, sagremorService, carleonFactory, sharedData, sagremorParams) {\r\n      \r\n        var self = this;\r\n        \r\n        this.serviceList = [];\r\n        this.title = \"\"\r\n        \r\n        this.sagremorParams = sagremorParams;\r\n        this.currentInjectors = _.filter(sagGenericInjectorManager.components, function (component) {\r\n\t\t\treturn component.leftMenu && component.leftMenu.target === $stateParams.service;\r\n\t\t});\r\n\t\tthis.size = 1;\r\n        \r\n        this.init = function () {\r\n\t\t\tif (!sagremorParams.loggedIn) {\r\n\t\t\t\t$location.path(\"/login\");\r\n\t\t\t}\r\n\t\t\tloadServices();\r\n\t\t};\r\n\t\t\r\n\t\tfunction loadServices () {\r\n\t\t\t_.forEach(self.currentInjectors, function (currentInjector) {\r\n\t\t\t\tvar cService = sharedData.get(\"carleonServices\", currentInjector.type);\r\n\t\t\t\tif (!!cService && cService.enabled && !_.find(self.serviceList, {type: currentInjector.type})) {\r\n\t\t\t\t\tvar service = {type: currentInjector.type};\r\n\t\t\t\t\tself.title = currentInjector.leftMenu.title;\r\n\t\t\t\t\tservice.size = currentInjector.size || 1\r\n\t\t\t\t\tservice.serviceGroup = {title: currentInjector.groupTitle, list: [], service: currentInjector.service};\r\n\t\t\t\t\tservice.menu = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"edit\", \r\n\t\t\t\t\t\t\tdisplay: $translate.instant(\"edit\"), \r\n\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\tparam.service.editService(param);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"remove\", \r\n\t\t\t\t\t\t\tdisplay: $translate.instant(\"remove\"), \r\n\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\tparam.service.removeService(param).then(function () {\r\n\t\t\t\t\t\t\t\t\t$scope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: \"add_to_dashboard\", \r\n\t\t\t\t\t\t\tdisplay: $translate.instant(\"add_to_dashboard\"), \r\n\t\t\t\t\t\t\taction: function (param) {\r\n\t\t\t\t\t\t\t\tif (sagremorService.addToDashboard(param)) {\r\n\t\t\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t\tself.serviceList.push(service);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t_.forEach(self.currentInjectors, function (currentInjector) {\r\n\t\t\t\tvar cService = sharedData.get(\"carleonServices\", currentInjector.type);\r\n\t\t\t\tif (!!cService && cService.enabled && !!cService.element) {\r\n\t\t\t\t\tvar serviceGroup = _.find(self.serviceList, {type: currentInjector.type});\r\n\t\t\t\t\tif (!!serviceGroup && !serviceGroup.list) {\r\n\t\t\t\t\t\tserviceGroup.list = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t!serviceGroup || _.forEach(cService.element, function (element) {\r\n\t\t\t\t\t\tvar exist = _.find(serviceGroup.list, function (elt) {\r\n\t\t\t\t\t\t\treturn elt.name === element.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exist) {\r\n\t\t\t\t\t\t\tvar elt = {name: element.name, type: element.type, description: element.description, service: currentInjector.service};\r\n\t\t\t\t\t\t\tserviceGroup.list.push(elt);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t!serviceGroup || _.forEach(serviceGroup.list, function (elt, index) {\r\n\t\t\t\t\t\tvar exist = _.find(cService.element, function (serviceElt) {\r\n\t\t\t\t\t\t\treturn serviceElt.name === elt.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!exist) {\r\n\t\t\t\t\t\t\tserviceGroup.list.splice(index, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tthis.addService = function (service) {\r\n\t\t\tservice.addService();\r\n\t\t};\r\n\t\t\r\n\t\t$scope.$on(\"carleonServicesChanged\", function () {\r\n\t\t\tloadServices();\r\n\t\t});\r\n        \r\n\t\t$scope.$on(\"refreshCarleonServices\", function () {\r\n\t\t\tloadServices();\r\n\t\t});\r\n\t\r\n        this.init();\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"usersCtrl\",\r\n    function($scope, $translate, toaster, DTOptionsBuilder, angharadFactory, sagremorConfirm) {\r\n      \r\n        var self = this;\r\n        \r\n        this.userList = [];\r\n        this.tokenList = [];\r\n        \r\n        this.options = {};\r\n        \r\n        this.newUser = false;\r\n        this.user = {\r\n\t\t\tlogin: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tenabled: true\r\n\t\t};\r\n\t\tthis.usersEnabled = true;\r\n\t\t\r\n\t\tthis.searchOptions = {\r\n\t\t\tlogin: \"\",\r\n\t\t\tenabled: \"\",\r\n\t\t};\r\n        \r\n        this.init = function () {\r\n\t\t\tif ($translate.use()) {\r\n\t\t\t\tself.options = DTOptionsBuilder.newOptions()\r\n\t\t\t\t\t\t\t\t.withLanguageSource(\"components/core/i18n/datatables.\"+$translate.use()+\".json\");\r\n\t\t\t}\r\n\t\t\tself.getUserList();\r\n\t\t\tself.getTokenList();\r\n\t\t};\r\n\t\t\r\n\t\tthis.getUserList = function () {\r\n\t\t\tangharadFactory.getUserList().then(function (result) {\r\n\t\t\t\tself.userList = result;\r\n\t\t\t}, function (error) {\r\n\t\t\t\tif (error.status === 404) {\r\n\t\t\t\t\tself.usersEnabled = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_get_user_list\"), $translate.instant(\"users_get_user_list_error\"));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.addUser = function () {\r\n\t\t\tself.newUser = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelNewUser = function () {\r\n\t\t\tself.newUser = false;\r\n\t\t\tself.user = {\r\n\t\t\t\tlogin: \"\",\r\n\t\t\t\tpassword: \"\",\r\n\t\t\t\tenabled: true\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\tthis.isNewUserValid = function () {\r\n\t\t\tvar found = _.find(self.userList, {login: self.user.login});\r\n\t\t\t\r\n\t\t\tif (found) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn !!self.user.login && self.user.login.length > 0 && !!self.user.password && self.user.password.length > 0;\r\n\t\t};\r\n\t\t\r\n\t\tthis.createNewUser = function () {\r\n\t\t\tangharadFactory.addUser(self.user).then(function () {\r\n\t\t\t\tself.userList.push(self.user);\r\n\t\t\t\tself.newUser = false;\r\n\t\t\t\tself.user = {\r\n\t\t\t\t\tlogin: \"\",\r\n\t\t\t\t\tpassword: \"\",\r\n\t\t\t\t\tenabled: true\r\n\t\t\t\t};\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.displayChangePassword = function (user) {\r\n\t\t\tuser.changePassword = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelChangePassword = function (user) {\r\n\t\t\tuser.changePassword = false;\r\n\t\t\tuser.password = \"\";\r\n\t\t};\r\n\t\t\r\n\t\tthis.changePassword = function (user) {\r\n\t\t\tangharadFactory.setUser(user.login, user).then(function () {\r\n\t\t\t\tuser.password = \"\";\r\n\t\t\t\tuser.changePassword = false;\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.enableUser = function (user) {\r\n\t\t\tangharadFactory.setUser(user.login, {enabled: user.enabled}).then(function () {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_save_user\"), $translate.instant(\"users_save_user_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeUser = function (user) {\r\n\t\t\treturn sagremorConfirm.open($translate.instant(\"users_user_remove\"), $translate.instant(\"users_user_remove_confirm\", {login: user.login})).then(function () {\r\n\t\t\t\treturn angharadFactory.removeUser(user.login).then(function () {\r\n\t\t\t\t\t_.remove(self.userList, {login: user.login});\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"users_user_remove\"), $translate.instant(\"users_user_remove_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_user_remove\"), $translate.instant(\"users_user_remove_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.getTokenList = function () {\r\n\t\t\tvar options = {\r\n\t\t\t\tlogin: self.searchOptions.login\r\n\t\t\t};\r\n\t\t\tif (self.searchOptions.enabled === \"true\") {\r\n\t\t\t\toptions.enabled = true;\r\n\t\t\t} else if (self.searchOptions.enabled === \"false\") {\r\n\t\t\t\toptions.enabled = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tangharadFactory.getTokenList(options).then(function (result) {\r\n\t\t\t\tself.tokenList = result;\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_get_token_list\"), $translate.instant(\"users_get_token_list_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.displayToken = function (token) {\r\n\t\t\treturn token.substring(0, 4) + \"****-****-****-****-********\" + token.substring(32);\r\n\t\t};\r\n\t\t\r\n\t\tthis.revokeToken = function (token) {\r\n\t\t\treturn sagremorConfirm.open($translate.instant(\"users_token_revoke\"), $translate.instant(\"users_token_revoke_confirm\")).then(function () {\r\n\t\t\t\treturn angharadFactory.revokeToken(token.token).then(function () {\r\n\t\t\t\t\ttoken.enabled = false;\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"users_token_revoke\"), $translate.instant(\"users_token_revoke_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"users_token_revoke\"), $translate.instant(\"users_token_revoke_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n        this.init();\r\n        \r\n\t\t$scope.$on(\"changeLang\", function () {\r\n\t\t\tself.options = DTOptionsBuilder.newOptions()\r\n\t\t\t\t\t\t\t.withLanguageSource(\"components/core/i18n/datatables.\"+$translate.use()+\".json\");\r\n\t\t});\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\").directive(\"sagGenericInjector\", function ($compile, sagGenericInjectorManager, sharedData) {\r\n    \r\n    var template = \"<directive element=\\\"elt\\\"></directive>\";\r\n    \r\n    var templateNotFound = \"<div class=\\\"container has-error\\\" data-translate=\\\"injector_not_found\\\"></div>\";\r\n     \r\n    var templateDisabled = \"<div class=\\\"container has-error\\\" data-translate=\\\"injector_disabled\\\"></div>\";\r\n     \r\n    return{\r\n        scope: {\r\n            type: \"=\",\r\n            elt: \"=\"\r\n        },\r\n        link: function(scope, element) {\r\n            var config = _.find(sagGenericInjectorManager.components, {type: scope.type});\r\n\t\t\tvar service = sharedData.get(\"carleonServices\", scope.type);\r\n\t\t\tif (config.carleonService && service && service.enabled) {\r\n\t\t\t\tcontent = $compile(template.replace(/directive/g, config.directive))(scope);\r\n\t\t\t} else if (config.carleonService && service && !service.enabled) {\r\n\t\t\t\tcontent = $compile(templateDisabled)(scope);\r\n\t\t\t} else if (!config.carleonService) {\r\n\t\t\t\tcontent = $compile(template.replace(/directive/g, config.directive))(scope);\r\n\t\t\t} else {\r\n\t\t\t\tcontent = $compile(templateNotFound)(scope);\r\n\t\t\t}\r\n            element.append(content);\r\n        }\r\n    }});\r\n\nfunction carleonMotionController ($scope, $http, $translatePartialLoader, $translate, angharadConfig, angharadFactory, carleonFactory, carleonMotionFactory, sagremorService, sagremorParams, toaster) {\r\n    var ctrl = this;\r\n    \r\n    this.urlBaseImages = angharadConfig.baseUrl + angharadConfig.prefixCarleon + \"service-motion/\" + ctrl.element.name + \"/image/\";\r\n    this.urlBaseStream = angharadConfig.baseUrl + angharadConfig.prefixCarleon + \"service-motion/\" + ctrl.element.name + \"/stream/\";\r\n    this.name = ctrl.element.name;\r\n\r\n    this.images = [];\r\n    this.fileListName = [];\r\n    this.fileList = {};\r\n    this.selectedFileList = \"\";\r\n    this.offset = 0;\r\n    \r\n    this.streamList = [];\r\n    this.selectedStream = false;\r\n    this.streamUri = \"\";\r\n    \r\n    this.online = false;\r\n    \r\n    this.profileParams = {};\r\n    \r\n    this.init = function () {\r\n\t\tctrl.refresh();\r\n\t\tctrl.getFromProfile();\r\n    }\r\n    \r\n    this.getFromProfile = function () {\r\n\t\tif (sagremorParams.currentProfile && _.has(sagremorParams.currentProfile, \"carleon.serviceMotion.\"+ctrl.element.name)) {\r\n\t\t\tctrl.profileParams = sagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name];\r\n\t\t} else if (!!sagremorParams.currentProfile) {\r\n\t\t\tif (!sagremorParams.currentProfile.carleon) {\r\n\t\t\t\tsagremorParams.currentProfile.carleon = {};\r\n\t\t\t}\r\n\t\t\tif (!sagremorParams.currentProfile.carleon.serviceMotion) {\r\n\t\t\t\tsagremorParams.currentProfile.carleon.serviceMotion = {};\r\n\t\t\t}\r\n\t\t\tif (!sagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name]) {\r\n\t\t\t\tsagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name] = {\r\n\t\t\t\t\tselectedFileList: \"\",\r\n\t\t\t\t\tselectedStream: \"\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n    \r\n    this.openPopupImage = function (imgArray, index) {\r\n\t\tcarleonMotionFactory.imagePopup(imgArray, index);\r\n\t};\r\n    \r\n    this.refresh = function () {\r\n\t\tctrl.fileListName = [];\r\n\t\tctrl.streamList = [];\r\n\t\tcarleonMotionFactory.status(ctrl.element.name, ctrl.offset).then(function (response) {\r\n\t\t\tctrl.online = response.online;\r\n\t\t\tctrl.fileList = response.file_list;\r\n\t\t\t_.forEach(response.file_list, function (fileList, name) {\r\n\t\t\t\tctrl.fileListName.push(name);\r\n\t\t\t});\r\n\t\t\tif (!!sagremorParams.currentProfile && !!sagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name].selectedFileList) {\r\n\t\t\t\tctrl.selectedFileList = sagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name].selectedFileList;\r\n\t\t\t\tctrl.changeSelectedFileList();\r\n\t\t\t} else if (ctrl.fileListName.length === 1) {\r\n\t\t\t\tctrl.selectedFileList = ctrl.fileListName[0];\r\n\t\t\t\tctrl.changeSelectedFileList();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_.forEach(response.stream_list, function (stream) {\r\n\t\t\t\tvar image = {\r\n\t\t\t\t\tname: ctrl.element.name,\r\n\t\t\t\t\ttitle: stream.name,\r\n\t\t\t\t\tstream: stream.uri,\r\n\t\t\t\t\tsnapshotUri: stream.snapshot_uri\r\n\t\t\t\t};\r\n\t\t\t\tctrl.streamList.push(image);\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n\tthis.canPrevious = function () {\r\n\t\treturn ctrl.offset > 0;\r\n\t};\r\n\t\r\n\tthis.canNext = function () {\r\n\t\treturn ctrl.fileList[ctrl.selectedFileList].length == 20;\r\n\t};\r\n    \r\n\tthis.previousList = function () {\r\n\t\tctrl.offset -= 20;\r\n\t\tctrl.refresh();\r\n\t};\r\n\t\r\n\tthis.nextList = function () {\r\n\t\tctrl.offset += 20;\r\n\t\tctrl.refresh();\r\n\t};\r\n\t\r\n    this.changeSelectedFileList = function () {\r\n\t\tctrl.images = [];\r\n\t\t_.forEach(ctrl.fileList[ctrl.selectedFileList], function (file) {\r\n\t\t\tvar image = {\r\n\t\t\t\tthumb: ctrl.urlBaseImages + ctrl.selectedFileList + \"/\" + file + \"?thumbnail=true\",\r\n\t\t\t\timg: ctrl.urlBaseImages + ctrl.selectedFileList + \"/\" + file,\r\n\t\t\t\ttitle: file\r\n\t\t\t}\r\n\t\t\tctrl.images.push(image);\r\n\t\t});\r\n\t\tsagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name].selectedStream = \"\";\r\n\t\tsagremorParams.currentProfile.carleon.serviceMotion[ctrl.element.name].selectedFileList = ctrl.selectedFileList;\r\n\t\tangharadFactory.saveCurrentProfile().then(function () {\r\n\t\t\t//toaster.pop(\"success\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_success\"));\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_error\"));\r\n\t\t});\r\n\t};\r\n\t\r\n\tthis.openStream = function () {\r\n\t\tcarleonMotionFactory.imagePopup(ctrl.streamList, 0);\r\n\t};\r\n\t\r\n\t$scope.$on(\"refreshCarleonServices\", function () {\r\n\t\tctrl.refresh();\r\n\t});\r\n\t\r\n\t$scope.$on(\"carleonServicesChanged\", function () {\r\n\t\tctrl.init();\r\n\t});\r\n\t\r\n\t$scope.$on(\"angharadProfileChanged\", function () {\r\n\t\tctrl.getFromProfile();\r\n\t});\r\n\t\r\n    this.init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"serviceMotion\", {\r\n    templateUrl: \"components/carleonMotion/carleonMotion.template.html\",\r\n    controller: carleonMotionController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.factory(\"carleonMotionFactory\", function($http, $uibModal, $translate, toaster, angharadConfig, angharadBackendService, sagremorConfirm, sharedData) {\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixCarleon;\r\n    var carleonMotionFactory = {};\r\n\r\n\t/* Motion service */\r\n    carleonMotionFactory.getMotionServiceList = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-motion/\");\r\n    };\r\n\r\n    carleonMotionFactory.getMotionService = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-motion/\" + name);\r\n    };\r\n\r\n    carleonMotionFactory.addMotionService = function (motionService) {\r\n        return angharadBackendService.httpRequest(\"POST\", urlBase + \"service-motion/\", motionService);\r\n    };\r\n\r\n    carleonMotionFactory.setMotionService = function (name, motionService) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-motion/\" + name, motionService);\r\n    };\r\n\r\n    carleonMotionFactory.removeMotionService = function (name) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"service-motion/\" + name);\r\n    };\r\n\r\n    carleonMotionFactory.status = function (name, offset) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-motion/\" + name + \"/status\", null, {offset: offset});\r\n    };\r\n\r\n    carleonMotionFactory.image = function (name, file_list, file_name, thumbnail) {\r\n\t\tvar urlParam = {};\r\n\t\tif (thumbnail) {\r\n\t\t\turlParam.thumbnail = \"\";\r\n\t\t}\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-motion/\" + name + \"/image/\" + file_list + \"/\" + file_name, null, urlParam);\r\n    };\r\n\r\n    carleonMotionFactory.stream = function (name, stream_name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-motion/\" + name + \"/stream/\" + stream_name);\r\n    };\r\n\r\n    carleonMotionFactory.snapshot = function (name, stream_name) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-motion/\" + name + \"/stream/\" + stream_name + \"/snapshot\");\r\n    };\r\n\r\n\tcarleonMotionFactory.addService = function () {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonMotion/carleonMotion.modal.html\",\r\n\t\t\tcontroller: \"carleonMotionModalCtrl\",\r\n\t\t\tcontrollerAs: \"carleonMotionModalCtrl\",\r\n\t\t\tsize: \"md\",\r\n\t\t\tresolve: {\r\n\t\t\t\tmotion: function () {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tcarleonMotionFactory.editService = function (service) {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonMotion/carleonMotion.modal.html\",\r\n\t\t\tcontroller: \"carleonMotionModalCtrl\",\r\n\t\t\tcontrollerAs: \"carleonMotionModalCtrl\",\r\n\t\t\tsize: \"md\",\r\n\t\t\tresolve: {\r\n\t\t\t\tmotion: function () {\r\n\t\t\t\t\treturn service;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tcarleonMotionFactory.removeService = function (service) {\r\n\t\treturn sagremorConfirm.open($translate.instant(\"carleon_motion_remove\"), $translate.instant(\"carleon_motion_confirm\")).then(function () {\r\n\t\t\treturn carleonMotionFactory.removeMotionService(service.name).then(function () {\r\n\t\t\t\tvar injector = sharedData.get(\"carleonServices\", \"service-motion\");\r\n\t\t\t\t_.remove(injector.element, function (element) {\r\n\t\t\t\t\treturn element.name === service.name;\r\n\t\t\t\t});\r\n\t\t\t\tsharedData.add(\"carleonServices\", \"service-motion\", injector);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_motion_remove\"), $translate.instant(\"carleon_motion_remove_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_motion_remove\"), $translate.instant(\"carleon_motion_remove_error\"));\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n\tcarleonMotionFactory.imagePopup = function (imgArray, index) {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonMotion/carleonMotion.image.modal.html\",\r\n\t\t\tcontroller: \"carleonMotionImageModalCtrl\",\r\n\t\t\tcontrollerAs: \"carleonMotionImageModalCtrl\",\r\n\t\t\tsize: \"lg\",\r\n\t\t\tresolve: {\r\n\t\t\t\timgArray: function () {\r\n\t\t\t\t\treturn imgArray;\r\n\t\t\t\t},\r\n\t\t\t\tindex: function () {\r\n\t\t\t\t\treturn index;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n        \r\n    return carleonMotionFactory;\r\n\r\n})\r\n.config(function run($translatePartialLoaderProvider) {\r\n\t$translatePartialLoaderProvider.addPart(\"carleonMotion\");\r\n})\r\n.run(function(sagGenericInjectorManager, carleonMotionFactory) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"service-motion\",\r\n        directive: \"service-motion\",\r\n        groupTitle: \"carleon_motion_title\",\r\n        service: carleonMotionFactory,\r\n        carleonService: true,\r\n        size: 3,\r\n        leftMenu: {\r\n\t\t\ttitle: \"carleon_motion_title\",\r\n\t\t\ttarget: \"carleonMotion\"\r\n\t\t},\r\n\t\twidgetHeight: 5,\r\n\t\twidgetWidth: 6,\r\n\t\ticon: \"camera\",\r\n\t\tcommands: {\r\n\t\t\tonline: {\r\n\t\t\t\ttitle: \"carleon_motion_command_online_title\",\r\n\t\t\t\tparameters: {},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\ttitle: \"carleon_motion_command_online_result_title\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsnapshot: {\r\n\t\t\t\ttitle: \"carleon_motion_command_snapshot_title\",\r\n\t\t\t\tparameters: {\r\n\t\t\t\t\tstream: \"carleon_motion_command_snapshot_parameter_stream_title\",\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\ttitle: \"carleon_motion_command_snapshot_result_title\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"carleonMotionImageModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, carleonMotionFactory, imgArray, index) {\r\n        var self = this;\r\n        \r\n        this.imgArray = imgArray;\r\n        this.index = index;\r\n        this.currentImage = {\r\n\t\t\tname: \"\",\r\n\t\t\ttitle: \"\",\r\n\t\t\timg: \"\",\r\n\t\t\tstream: \"\",\r\n\t\t\tsnapshotUri: \"\"\r\n\t\t};\r\n        \r\n        function init() {\r\n\t\t\tself.currentImage = self.imgArray[self.index];\r\n\t\t\t$scope.$broadcast(\"carleonMotionImageIframe\", self.currentImage);\r\n        }\r\n        \r\n        this.close = function () {\r\n            $uibModalInstance.dismiss(\"close\");\r\n        };\r\n        \r\n        this.displayTitle = function () {\r\n\t\t\treturn $translate.instant(\"image_title\") + self.currentImage.title;\r\n\t\t};\r\n\t\t\r\n\t\tthis.changeImage = function (delta) {\r\n\t\t\tself.index += delta;\r\n\t\t\tself.currentImage = self.imgArray[self.index];\r\n\t\t\t$scope.$broadcast(\"carleonMotionImageIframe\", self.currentImage);\r\n\t\t};\r\n\t\t\r\n\t\tthis.canPrevious = function () {\r\n\t\t\treturn self.index > 0;\r\n\t\t};\r\n\t\t\r\n\t\tthis.canNext = function () {\r\n\t\t\treturn self.index < self.imgArray.length - 1;\r\n\t\t};\r\n\t\t\r\n\t\tthis.snapshot = function () {\r\n\t\t\tcarleonMotionFactory.snapshot(self.currentImage.name, self.currentImage.title).then(function () {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_motion_snapshot\"), $translate.instant(\"carleon_motion_snapshot_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_motion_snapshot\"), $translate.instant(\"carleon_motion_snapshot_error\"));\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n\t\tthis.showIndex = function () {\r\n\t\t\treturn (self.index + 1) + \" / \" + self.imgArray.length;\r\n\t\t};\r\n\t\t\r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"carleonMotionModalCtrl\", \r\n    function($rootScope, $uibModalInstance, $translate, sharedData, toaster, carleonMotionFactory, motion) {\r\n        var self = this;\r\n\r\n        this.messages = {};\r\n        this.add = true;\r\n        this.addFileList = false;\r\n        this.addStream = false;\r\n        this.newFileList = {};\r\n        this.newStream = {};\r\n\r\n        function init() {\r\n\t\t\tif (!!motion) {\r\n\t\t\t\tself.motion = _.find(sharedData.get(\"carleonServices\", \"service-motion\").element, function (elt) {\r\n\t\t\t\t\treturn elt.name === motion.name;\r\n\t\t\t\t});\r\n\t\t\t\tself.add = false;\r\n\t\t\t} else {\r\n\t\t\t\tself.motion = {\r\n\t\t\t\t\tfile_list: [],\r\n\t\t\t\t\tstream_list: []\r\n\t\t\t\t};\r\n\t\t\t}\r\n        }\r\n        \r\n        this.addNewFileList = function () {\r\n\t\t\tself.addFileList = true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeFileList = function (index) {\r\n\t\t\tself.motion.file_list.splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.saveNewFileList = function () {\r\n\t\t\tself.motion.file_list.push(self.newFileList);\r\n\t\t\tself.newFileList = {};\r\n\t\t\tself.addFileList = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelNewFileList = function () {\r\n\t\t\tself.newFileList = {};\r\n\t\t\tself.addFileList = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isFileListValid = function () {\r\n\t\t\treturn !!self.newFileList.name && !!self.newFileList.path && !!self.newFileList.thumbnail_path;\r\n\t\t};\r\n\t\t\r\n\t\tthis.addNewStream = function () {\r\n\t\t\tself.addStream = true;\r\n\t\t};\r\n        \r\n\t\tthis.removeStream = function (index) {\r\n\t\t\tself.motion.stream_list.splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.saveNewStream = function () {\r\n\t\t\tself.motion.stream_list.push(self.newStream);\r\n\t\t\tself.newStream = {};\r\n\t\t\tself.addStream = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancelNewStream = function () {\r\n\t\t\tself.newStream = {};\r\n\t\t\tself.addStream = false;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isStreamValid = function () {\r\n\t\t\treturn !!self.newStream.name && !!self.newStream.uri;\r\n\t\t};\r\n\t\t\r\n\t\tthis.isCameraValid = function () {\r\n\t\t\tvar found = _.find(sharedData.get(\"carleonServices\", \"service-motion\").element, function (element) {\r\n\t\t\t\treturn element.name === self.motion.name;\r\n\t\t\t});\r\n\t\t\treturn (!found || !self.add) && !!self.motion.name && !!self.motion.config_uri;\r\n\t\t};\r\n\t\t\r\n        this.cancel = function () {\r\n\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t};\r\n\r\n        this.save = function () {\r\n\t\t\tif (self.add) {\r\n\t\t\t\tcarleonMotionFactory.addMotionService(self.motion).then(function () {\r\n\t\t\t\t\tself.motion.type = \"service-motion\";\r\n\t\t\t\t\tself.motion.service = carleonMotionFactory;\r\n\t\t\t\t\tsharedData.get(\"carleonServices\", \"service-motion\").element.push(self.motion);\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_motion_save\"), $translate.instant(\"carleon_motion_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_motion_save\"), $translate.instant(\"carleon_motion_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcarleonMotionFactory.setMotionService(self.motion.name, self.motion).then(function () {\r\n\t\t\t\t\tself.motion.type = \"service-motion\";\r\n\t\t\t\t\tself.motion.service = carleonMotionFactory;\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_motion_save\"), $translate.instant(\"carleon_motion_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_motion_save\"), $translate.instant(\"carleon_motion_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n        init();\r\n    }\r\n);\r\n\nfunction carleonMpdController($scope, $q, $window, $translatePartialLoader, $translate, $interval, angharadConfig, carleonFactory, carleonMpdFactory, benoicFactory, sagremorParams, sharedData, toaster) {\r\n\tvar ctrl = this;\r\n\r\n\tthis.mpd = {};\r\n\tthis.mpdElement = {};\r\n\tthis.playlists = [];\r\n\tthis.selectedPlaylist = false;\r\n\tthis._interval = null;\r\n\tthis.hasFocus = true;\r\n\r\n\tfunction init() {\r\n\t\tctrl.mpdElement = _.find(sharedData.get(\"carleonServices\", \"service-mpd\").element, function (mpd) {\r\n\t\t\treturn mpd.name === ctrl.element.name;\r\n\t\t});\r\n\t\t\r\n\t\tvar promises = [\r\n\t\t\tcarleonMpdFactory.getMpdStatus(ctrl.element.name),\r\n\t\t\tcarleonMpdFactory.getMpdPlaylists(ctrl.element.name)\r\n\t\t];\r\n\r\n\t\t$q.all(promises).then(function(responses) {\r\n\t\t\tctrl.mpd = responses[0];\r\n\t\t\tctrl.playlists = responses[1];\r\n\t\t\tif (ctrl.mpd.state === \"play\" || ctrl.mpd.state === \"pause\") {\r\n\t\t\t\tstartRefreshStatusInterval();\r\n\t\t\t}\r\n\t\t}, function() {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd\"), $translate.instant(\"carleon_mpd_load_error\", {\r\n\t\t\t\tname: ctrl.element.name\r\n\t\t\t}));\r\n\t\t});\r\n\t}\r\n\r\n\tfunction startRefreshStatusInterval() {\r\n\t\tctrl._interval = $interval(function() {\r\n\t\t\tif (ctrl.hasFocus) {\r\n\t\t\t\tctrl.refreshStatus();\r\n\t\t\t}\r\n\t\t}, 1000 * 10);\r\n\t}\r\n\r\n\tthis.refreshStatus = function() {\r\n\t\tcarleonMpdFactory.getMpdStatus(ctrl.element.name).then(function(response) {\r\n\t\t\tctrl.mpd = response;\r\n\t\t\tif ((ctrl.mpd.state === \"play\" || ctrl.mpd.state === \"pause\") && ctrl._interval == null) {\r\n\t\t\t\tstartRefreshStatusInterval();\r\n\t\t\t} else if (ctrl._interval != null && ctrl.mpd.state !== \"play\" && ctrl.mpd.state !== \"pause\") {\r\n\t\t\t\t$interval.cancel(ctrl._interval);\r\n\t\t\t\tctrl._interval = null;\r\n\t\t\t}\r\n\t\t}, function() {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd\"), $translate.instant(\"carleon_mpd_load_error\", {\r\n\t\t\t\tname: ctrl.element.name\r\n\t\t\t}));\r\n\t\t});\r\n\t};\r\n\r\n\tthis.displayVolume = function() {\r\n\t\treturn ctrl.mpd.volume + \"%\";\r\n\t};\r\n\r\n\tthis.setVolume = function(delta) {\r\n\t\tvar newVolume = ctrl.mpd.volume + delta;\r\n\t\tif (newVolume >= 0 && newVolume <= 100) {\r\n\t\t\tcarleonMpdFactory.setMpdVolume(ctrl.element.name, newVolume).then(function() {\r\n\t\t\t\tctrl.mpd.volume = newVolume;\r\n\t\t\t}, function() {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd\"), $translate.instant(\"carleon_mpd_volume_error\"));\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tthis.displayVolumeCommand = function(delta) {\r\n\t\treturn (delta > 0 ? \"+\" : \"\") + delta + \" %\"\r\n\t};\r\n\r\n\tthis.setAction = function(action) {\r\n\t\tvar actionUrl = action;\r\n\t\tif (action === \"repeat\") {\r\n\t\t\tactionUrl += (\"/\" + (ctrl.mpd.repeat?\"0\":\"1\"));\r\n\t\t\tctrl.mpd.repeat = !ctrl.mpd.repeat;\r\n\t\t}\r\n\t\tif (action === \"random\") {\r\n\t\t\tactionUrl += (\"/\" + (ctrl.mpd.random?\"0\":\"1\"));\r\n\t\t\tctrl.mpd.random = !ctrl.mpd.random;\r\n\t\t}\r\n\t\tif (action === \"play\" && ctrl.mpdElement.device && ctrl.mpdElement.switch) {\r\n\t\t\tbenoicFactory.setElement(ctrl.mpdElement.device, \"switch\", ctrl.mpdElement.switch, \"1\");\r\n\t\t}\r\n\t\tif (action === \"stop\" && ctrl.mpdElement.device && ctrl.mpdElement.switch) {\r\n\t\t\tbenoicFactory.setElement(ctrl.mpdElement.device, \"switch\", ctrl.mpdElement.switch, \"0\");\r\n\t\t}\r\n\t\tcarleonMpdFactory.setMpdAction(ctrl.element.name, actionUrl).then(function() {\r\n\t\t\tctrl.refreshStatus();\r\n\t\t}, function() {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd\"), $translate.instant(\"carleon_mpd_volume_error\"));\r\n\t\t});\r\n\t};\r\n\r\n\tthis.loadPlaylist = function() {\r\n\t\tif (!!ctrl.selectedPlaylist) {\r\n\t\t\tif (ctrl.mpdElement.device && ctrl.mpdElement.switch) {\r\n\t\t\t\tbenoicFactory.setElement(ctrl.mpdElement.device, \"switch\", ctrl.mpdElement.switch, \"1\");\r\n\t\t\t}\r\n\t\t\tcarleonMpdFactory.loadMpdPlaylist(ctrl.element.name, ctrl.selectedPlaylist).then(function() {\r\n\t\t\t\tctrl.refreshStatus();\r\n\t\t\t}, function() {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd\"), $translate.instant(\"carleon_mpd_load_playlist_error\"));\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t$scope.$on(\"refreshCarleonServices\", function() {\r\n\t\tctrl.refreshStatus();\r\n\t});\r\n\r\n\t$scope.$on(\"carleonServicesChanged\", function() {\r\n\t\tinit();\r\n\t});\r\n\r\n\t$scope.$on(\"$destroy\", function() {\r\n\t\t$interval.cancel(ctrl._interval);\r\n\t\tctrl._interval = null;\r\n\t});\r\n\r\n\t$window.onblur = function() {\r\n\t\tctrl.hasFocus = false;\r\n\t};\r\n\r\n\t$window.onfocus = function() {\r\n\t\tctrl.hasFocus = true;\r\n\t};\r\n\r\n\tinit();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"serviceMpd\", {\r\n\t\ttemplateUrl: \"components/carleonMpd/carleonMpd.template.html\",\r\n\t\tcontroller: carleonMpdController,\r\n\t\tbindings: {\r\n\t\t\telement: \"=\"\r\n\t\t}\r\n\t})\r\n\t.factory(\"carleonMpdFactory\", function($http, $uibModal, $translate, toaster, angharadConfig, angharadBackendService, sagremorConfirm, sharedData) {\r\n\t\tvar urlBase = angharadConfig.baseUrl + angharadConfig.prefixCarleon;\r\n\t\tvar carleonMpdFactory = {};\r\n\r\n\t\t/* Mpd service */\r\n\t\tcarleonMpdFactory.getMpdServiceList = function() {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"service-mpd/\");\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.getMpdService = function(name) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"service-mpd/\" + name);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.addMpdService = function(mpdService) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"POST\", urlBase + \"service-mpd/\", mpdService);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.setMpdService = function(name, mpdService) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-mpd/\" + name, mpdService);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.removeMpdService = function(name) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"DELETE\", urlBase + \"service-mpd/\" + name);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.getMpdStatus = function(name) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"service-mpd/\" + name + \"/status\");\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.getMpdPlaylists = function(name) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"service-mpd/\" + name + \"/playlists\");\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.setMpdAction = function(name, action) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-mpd/\" + name + \"/action/\" + action);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.loadMpdPlaylist = function(name, playlist) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-mpd/\" + name + \"/playlist/\" + playlist);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.setMpdVolume = function(name, volume) {\r\n\t\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-mpd/\" + name + \"/volume/\" + volume);\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.addService = function() {\r\n\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\tanimation: true,\r\n\t\t\t\ttemplateUrl: \"components/carleonMpd/carleonMpd.modal.html\",\r\n\t\t\t\tcontroller: \"carleonMpdModalCtrl\",\r\n\t\t\t\tcontrollerAs: \"carleonMpdModalCtrl\",\r\n\t\t\t\tsize: \"md\",\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tmpd: function() {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.editService = function(service) {\r\n\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\tanimation: true,\r\n\t\t\t\ttemplateUrl: \"components/carleonMpd/carleonMpd.modal.html\",\r\n\t\t\t\tcontroller: \"carleonMpdModalCtrl\",\r\n\t\t\t\tcontrollerAs: \"carleonMpdModalCtrl\",\r\n\t\t\t\tsize: \"md\",\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tmpd: function() {\r\n\t\t\t\t\t\treturn service;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tcarleonMpdFactory.removeService = function(service) {\r\n\t\t\treturn sagremorConfirm.open($translate.instant(\"carleon_mpd_remove\"), $translate.instant(\"carleon_mpd_confirm\")).then(function() {\r\n\t\t\t\treturn carleonMpdFactory.removeMpdService(service.name).then(function() {\r\n\t\t\t\t\tvar injector = sharedData.get(\"carleonServices\", \"service-mpd\");\r\n\t\t\t\t\t_.remove(injector.element, function(element) {\r\n\t\t\t\t\t\treturn element.name === service.name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsharedData.add(\"carleonServices\", \"service-mpd\", injector);\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mpd_remove\"), $translate.instant(\"carleon_mpd_remove_success\"));\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd_remove\"), $translate.instant(\"carleon_mpd_remove_error\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\treturn carleonMpdFactory;\r\n\r\n\t})\r\n\t.config(function run($translatePartialLoaderProvider) {\r\n\t\t$translatePartialLoaderProvider.addPart(\"carleonMpd\");\r\n\t})\r\n\t.run(function(sagGenericInjectorManager, carleonMpdFactory) {\r\n\t\tsagGenericInjectorManager.add({\r\n\t\t\ttype: \"service-mpd\",\r\n\t\t\tdirective: \"service-mpd\",\r\n\t\t\tgroupTitle: \"carleon_mpd_title\",\r\n\t\t\tservice: carleonMpdFactory,\r\n\t\t\tcarleonService: true,\r\n\t\t\tsize: 2,\r\n\t\t\tleftMenu: {\r\n\t\t\t\ttitle: \"carleon_music_title\",\r\n\t\t\t\ttarget: \"music\"\r\n\t\t\t},\r\n\t\t\twidgetHeight: 4,\r\n\t\t\twidgetWidth: 3,\r\n\t\t\ticon: \"music\",\r\n\t\t\tcommands: {\r\n\t\t\t\taction: {\r\n\t\t\t\t\ttitle: \"carleon_mpd_command_action_title\",\r\n\t\t\t\t\tparameters: {\r\n\t\t\t\t\t\taction: \"carleon_mpd_command_action_parameter_action_title\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\ttitle: \"carleon_mpd_command_action_result_title\"\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tload_playlist: {\r\n\t\t\t\t\ttitle: \"carleon_mpd_command_playlist_title\",\r\n\t\t\t\t\tparameters: {\r\n\t\t\t\t\t\tplaylist: \"carleon_mpd_command_playlist_parameter_plsylist_title\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\ttitle: \"carleon_mpd_command_playlist_result_title\"\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tset_volume: {\r\n\t\t\t\t\ttitle: \"carleon_mpd_command_volume_title\",\r\n\t\t\t\t\tparameters: {\r\n\t\t\t\t\t\tvolume: \"carleon_mpd_command_volume_parameter_volume_title\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tresult: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\ttitle: \"carleon_mpd_command_volume_result_title\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\nangular.module(\"sagremorApp\")\r\n\t\t.controller(\"carleonMpdModalCtrl\", \r\n\t\tfunction($rootScope, $uibModalInstance, $translate, sharedData, toaster, carleonMpdFactory, mpd) {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis.messages = {};\r\n\t\t\tthis.add = true;\r\n\t\t\tthis.mpd = {\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tdescription: \"\",\r\n\t\t\t\thost: \"\",\r\n\t\t\t\tport: 0,\r\n\t\t\t\tpassword: \"\",\r\n\t\t\t\tdevice: \"\",\r\n\t\t\t\tswitch: \"\"\r\n\t\t\t}\r\n\t\t\tthis.switches = [];\r\n\t\t\tthis.switchAttached = {};\r\n\r\n\t\tfunction init() {\r\n\t\t\tif (!!mpd) {\r\n\t\t\t\tself.mpd = _.find(sharedData.get(\"carleonServices\", \"service-mpd\").element, function (elt) {\r\n\t\t\t\t\treturn elt.name === mpd.name;\r\n\t\t\t\t});\r\n\t\t\t\tself.add = false;\r\n\t\t\t} else {\r\n\t\t\t\tself.mpd = {\r\n\t\t\t\t\tfile_list: [],\r\n\t\t\t\t\tstream_list: []\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function (device) {\r\n\t\t\t\tif (device.enabled && device.connected) {\r\n\t\t\t\t\t_.forEach(device.element.switches, function(element, name) {\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"switch\",\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (elt.name === self.mpd.switch && elt.device === self.mpd.device) {\r\n\t\t\t\t\t\t\tself.switchAttached = elt;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.switches.push(elt);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\t\t\r\n\t\tthis.isMpdValid = function () {\r\n\t\t\tvar found = _.find(sharedData.get(\"carleonServices\", \"service-mpd\").element, function (element) {\r\n\t\t\t\treturn element.name === self.mpd.name;\r\n\t\t\t});\r\n\t\t\treturn (!found || !self.add) && !!self.mpd.name && !!self.mpd.host;\r\n\t\t};\r\n\t\t\t\t\r\n\t\tthis.save = function () {\r\n\t\t\tif (self.add) {\r\n\t\t\t\tcarleonMpdFactory.addMpdService(self.mpd).then(function () {\r\n\t\t\t\t\tself.mpd.type = \"service-mpd\";\r\n\t\t\t\t\tself.mpd.service = carleonMpdFactory;\r\n\t\t\t\t\tsharedData.get(\"carleonServices\", \"service-mpd\").element.push(self.mpd);\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mpd_save\"), $translate.instant(\"carleon_mpd_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd_save\"), $translate.instant(\"carleon_mpd_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcarleonMpdFactory.setMpdService(self.mpd.name, self.mpd).then(function () {\r\n\t\t\t\t\tself.mpd.type = \"service-mpd\";\r\n\t\t\t\t\tself.mpd.service = carleonMpdFactory;\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mpd_save\"), $translate.instant(\"carleon_mpd_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mpd_save\"), $translate.instant(\"carleon_mpd_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancel = function () {\r\n\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t};\r\n\t\t\r\n\t\tthis.changeSwitch = function () {\r\n\t\t\tif (self.switchAttached) {\r\n\t\t\t\tself.mpd.device = self.switchAttached.device;\r\n\t\t\t\tself.mpd.switch = self.switchAttached.name;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tinit();\r\n\t\t}\r\n);\r\n\nfunction sagContainerController ($rootScope, $translate, toaster, sharedData, angharadFactory) {\r\n    var ctrl = this;\r\n    \r\n    this.scripts = [];\r\n    \r\n    function init() {\r\n\t\tvar tag = \"SGMR$SCR$\";\r\n\t\tswitch (ctrl.type) {\r\n\t\t\tcase \"switch\":\r\n\t\t\t\ttag += \"B$\" + ctrl.element.device + \"$switch$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"dimmer\":\r\n\t\t\t\ttag += \"B$\" + ctrl.element.device + \"$dimmer$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"heater\":\r\n\t\t\t\ttag += \"B$\" + ctrl.element.device + \"$heater$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"sensor\":\r\n\t\t\t\ttag += \"B$\" + ctrl.element.device + \"$sensor$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"scheduler\":\r\n\t\t\t\ttag += \"A$scheduler$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// Carleon service\r\n\t\t\t\ttag += \"C$\" + ctrl.type + \"$\" + ctrl.element.name;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tctrl.scripts = _.filter(sharedData.all(\"angharadScripts\"), function (script) {\r\n\t\t\treturn !!_.find(script.options.tags, function (oneTag) {\r\n\t\t\t\treturn oneTag === tag;\r\n\t\t\t});\r\n\t\t});\r\n    }\r\n    \r\n    this.runScript = function (script) {\r\n\t\tvar loaderToast = toaster.pop({type: \"wait\", title: $translate.instant(\"angharad_loading_script_title\"), body: $translate.instant(\"angharad_loading_script_message\"), timeout: 0, showCloseButton: false});\r\n\t\tangharadFactory.runScript(script.name).then(function () {\r\n\t\t\ttoaster.pop(\"success\", $translate.instant(\"script_run\", {name: script.name}), $translate.instant(\"script_run_success\"));\r\n\t\t}, function (error) {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"script_run\", {name: script.name}), $translate.instant(\"script_run_error\"));\r\n\t\t})[\"finally\"](function () {\r\n\t\t\t$rootScope.$broadcast(\"refresh\");\r\n\t\t\ttoaster.clear(loaderToast);\r\n\t\t});\r\n\t};\r\n    \r\n    ctrl.menuSelect = function(menuItem, element) {\r\n        menuItem.action(element);\r\n    };\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagContainer\", {\r\n    templateUrl: \"components/container/container.template.html\",\r\n    controller: sagContainerController,\r\n    transclude: true,\r\n    bindings: {\r\n        type: \"=\",\r\n        menu: \"=\",\r\n        title: \"=\",\r\n        size: \"=\",\r\n        element: \"=\",\r\n        dashboard: \"=\",\r\n        sagParams: \"=\",\r\n        icon: \"=\"\r\n    }\r\n});\r\n\nfunction sagDimmerController (benoicFactory, sagremorParams, $translate) {\r\n    var ctrl = this;\r\n    \r\n    ctrl.element.valueChecked = (ctrl.element.value === 1);\r\n    ctrl.adminMode = sagremorParams.adminMode;\r\n    ctrl.element.newDisplay = ctrl.element.display;\r\n    \r\n    function init() {\r\n        ctrl.element.type = \"dimmer\";\r\n    }\r\n    \r\n    ctrl.setDimmer = function (value) {\r\n        if (value === 0 && ctrl.element.value === 0) {\r\n\t\t\tbenoicFactory.setElement(ctrl.element.device, \"dimmer\", ctrl.element.name, 101).then(function (result) {\r\n\t\t\t\tctrl.element.value = result.value;\r\n\t\t\t});\r\n\t\t} else if (value >= 0 && value <= 100) {\r\n\t\t\tbenoicFactory.setElement(ctrl.element.device, \"dimmer\", ctrl.element.name, value).then(function () {\r\n\t\t\t\tctrl.element.value = value;\r\n\t\t\t});\r\n\t\t}\r\n    };\r\n    \r\n    ctrl.addDimmer = function (value) {\r\n\t\tif (ctrl.element.value + value >= 0 && ctrl.element.value + value <= 100) {\r\n\t\t\tbenoicFactory.setElement(ctrl.element.device, \"dimmer\", ctrl.element.name, ctrl.element.value + value).then(function () {\r\n\t\t\t\tctrl.element.value += value;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n    \r\n    ctrl.Dimmervalue = function () {\r\n\t\treturn ctrl.element.value + \"%\"\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagDimmer\", {\r\n    templateUrl: \"components/dimmer/dimmer.template.html\",\r\n    controller: sagDimmerController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"dimmer\",\r\n        directive: \"sag-dimmer\",\r\n        carleonService: false\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"DimmersModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, sagremorConstant, benoicFactory, dimmer) {\r\n        var self = this;\r\n        \r\n        this.dimmer = dimmer;\r\n        this.dimmer.newDisplay = this.dimmer.display;\r\n        \r\n        this.monitorEveryEnum = sagremorConstant.monitoredEveryEnum;\r\n        \r\n        function init() {\r\n\t\t\tself.dimmer.menu = false;\r\n            \r\n            _.forEach(self.monitorEveryEnum, function(monitorEvery) {\r\n                $translate(monitorEvery.label).then(function (trLabel) {\r\n                    monitorEvery.trLabel = trLabel;\r\n                });\r\n            });\r\n        }\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.tr = function (id) {\r\n\t\t\treturn $translate.instant(id);\r\n\t\t};\r\n        \r\n        this.saveDimmer = function () {\r\n            self.dimmer.display = self.dimmer.newDisplay;\r\n            self.dimmer.monitor = self.dimmer.monitorChecked?1:0;\r\n            benoicFactory.updateElement(self.dimmer.device, \"dimmer\", self.dimmer.name, self.dimmer).then(function (response) {\r\n                $scope.$broadcast(\"benoicDimmersChanged\");\r\n                toaster.pop(\"success\", $translate.instant(\"dimmer_save\"), $translate.instant(\"dimmer_save_success\"));\r\n            }, function (error) {\r\n                toaster.pop(\"error\", $translate.instant(\"dimmer_save\"), $translate.instant(\"dimmer_save_error\"));\r\n            })[\"finally\"](function () {\r\n                $uibModalInstance.dismiss(\"close\");\r\n            });\r\n        };\r\n        \r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n  .factory(\"angharadBackendService\",\r\n  function($http, $q, $rootScope, AccessToken, sagremorParams, sharedData) {\r\n    var angharadBackendFactory = {};\r\n    \r\n    angharadBackendFactory.httpRequest = function (method, url, data, params) {\r\n      var deferred = $q.defer();\r\n      \r\n      var token = sharedData.get(\"oauthToken\", \"token\");\r\n      var now = new Date();\r\n      if (token.expires_at.valueOf() < now.valueOf()) {\r\n        // This is a lousy way to refresh the token if the refresh wasn't called in time, for example after sleep mode\r\n        AccessToken.forceRefresh().then(function (token) {\r\n          $http.defaults.headers.common.Authorization = \"Bearer \" + token.access_token;\r\n          $http({method: method, url: url, data: data, params: params}).then(function (response) {\r\n            deferred.resolve(response.data);\r\n          }, function (error) {\r\n            deferred.reject(error);\r\n          });\r\n        }, function (error) {\r\n          deferred.reject(error);\r\n        });\r\n      } else {\r\n        $http({method: method, url: url, data: data, params: params}).then(function (response) {\r\n          deferred.resolve(response.data);\r\n        }, function (error) {\r\n          deferred.reject(error);\r\n        });\r\n      }\r\n      \r\n      return deferred.promise;\r\n    };\r\n    \r\n    return angharadBackendFactory;\r\n  })\r\n  .factory(\"angharadFactory\", \r\n  function($http, $q, angharadConfig, angharadBackendService, sagremorParams) {\r\n\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixAngharad;\r\n    var dataFactory = {};\r\n    \r\n    dataFactory.getSumboduleList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"submodule/\");\r\n    };\r\n\r\n    dataFactory.getSubmodule = function (name) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"submodule/\" + name);\r\n    };\r\n\r\n    dataFactory.enableSubmodule = function (name, enabled) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"submodule/\" + name + \"/enable/\" + (enabled?\"1\":\"0\"));\r\n    };\r\n\r\n    dataFactory.getScriptList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"script/\");\r\n    };\r\n\r\n    dataFactory.getScript = function (name) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"script/\" + name);\r\n    };\r\n\r\n    dataFactory.addScript = function (script) {\r\n      return angharadBackendService.httpRequest(\"POST\", urlBase + \"script/\", script);\r\n    };\r\n\r\n    dataFactory.setScript = function (name, script) {\r\n      return angharadBackendService.httpRequest(\"PUT\", urlBase + \"script/\" + name, script);\r\n    };\r\n\r\n    dataFactory.removeScript = function (name) {\r\n      return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"script/\" + name);\r\n    };\r\n\r\n    dataFactory.runScript = function (name) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"script/\" + name + \"/run\");\r\n    };\r\n\r\n    dataFactory.getSchedulerList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"scheduler/\");\r\n    };\r\n\r\n    dataFactory.getScheduler = function (name) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"scheduler/\" + name);\r\n    };\r\n\r\n    dataFactory.enableScheduler = function (name, enabled) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"scheduler/\" + name + \"/enable/\" + (enabled?\"1\":\"0\"));\r\n    };\r\n\r\n    dataFactory.addScheduler = function (scheduler) {\r\n      return angharadBackendService.httpRequest(\"POST\", urlBase + \"scheduler/\", scheduler);\r\n    };\r\n\r\n    dataFactory.setScheduler = function (name, scheduler) {\r\n      return angharadBackendService.httpRequest(\"PUT\", urlBase + \"scheduler/\" + name, scheduler);\r\n    };\r\n\r\n    dataFactory.removeScheduler = function (name) {\r\n      return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"scheduler/\" + name);\r\n    };\r\n\r\n    dataFactory.getTriggerList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"trigger/\");\r\n    };\r\n\r\n    dataFactory.getTrigger = function (name) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"trigger/\" + name);\r\n    };\r\n\r\n    dataFactory.enableTrigger = function (name, enabled) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"trigger/\" + name + \"/enable/\" + (enabled?\"1\":\"0\"));\r\n    };\r\n\r\n    dataFactory.addTrigger = function (trigger) {\r\n      return angharadBackendService.httpRequest(\"POST\", urlBase + \"trigger/\", trigger);\r\n    };\r\n\r\n    dataFactory.setTrigger = function (name, trigger) {\r\n      return angharadBackendService.httpRequest(\"PUT\", urlBase + \"trigger/\" + name, trigger);\r\n    };\r\n\r\n    dataFactory.removeTrigger = function (name) {\r\n      return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"trigger/\" + name);\r\n    };\r\n\r\n    /* Profile endpoints */\r\n    dataFactory.getProfileList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"profile\");\r\n    };\r\n\r\n    dataFactory.getProfile = function (profile_id) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"profile/\" + profile_id);\r\n    };\r\n\r\n    dataFactory.setProfile = function (profile_id, profile) {\r\n      return angharadBackendService.httpRequest(\"PUT\", urlBase + \"profile/\" + profile_id, profile);\r\n    };\r\n\r\n    dataFactory.removeProfile = function (profile_id) {\r\n      return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"profile/\" + profile_id);\r\n    };\r\n    \r\n    /* Users endpoints */\r\n    dataFactory.getUserList = function () {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"user/\");\r\n    };\r\n\r\n    dataFactory.addUser = function (user) {\r\n      return angharadBackendService.httpRequest(\"POST\", urlBase + \"user/\", user);\r\n    };\r\n\r\n    dataFactory.setUser = function (name, user) {\r\n      return angharadBackendService.httpRequest(\"PUT\", urlBase + \"user/\" + name, user);\r\n    };\r\n\r\n    dataFactory.removeUser = function (name) {\r\n      return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"user/\" + name);\r\n    };\r\n    \r\n    /* Token endpoints */\r\n    dataFactory.getTokenList = function (options) {\r\n      return angharadBackendService.httpRequest(\"GET\", urlBase + \"token/\", null, options);\r\n    };\r\n\r\n    dataFactory.revokeToken = function (token) {\r\n      return angharadBackendService.httpRequest(\"POST\", urlBase + \"token/\", {token: token});\r\n    };\r\n\r\n    \r\n    dataFactory.saveCurrentProfile = function () {\r\n      var profile = sagremorParams.currentProfile;\r\n      var deferred = $q.defer();\r\n      if (!!profile) {\r\n        return dataFactory.setProfile(profile.name, profile);\r\n      } else {\r\n        deferred.reject(error);\r\n        return deferred.promise;\r\n      }\r\n    };\r\n\r\n    return dataFactory;\r\n  }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .factory(\"benoicFactory\", \r\n    function($http, angharadConfig, angharadBackendService) {\r\n\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixBenoic;\r\n    var dataFactory = {};\r\n\r\n    dataFactory.getDeviceTypes = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"deviceTypes/\");\r\n    };\r\n\r\n    dataFactory.reloadDeviceTypes = function () {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"deviceTypes/reload\");\r\n    };\r\n\r\n    dataFactory.getDeviceList = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\");\r\n    };\r\n\r\n    dataFactory.getDevice = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + name);\r\n    };\r\n    \r\n    dataFactory.addDevice = function (device) {\r\n        return angharadBackendService.httpRequest(\"POST\", urlBase + \"device/\", device);\r\n    };\r\n\r\n    dataFactory.setDevice = function (device) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"device/\" + device.name, device);\r\n    };\r\n\r\n    dataFactory.removeDevice = function (name) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"device/\" + name);\r\n    };\r\n    \r\n    dataFactory.connectDevice = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + name + \"/connect\");\r\n    };\r\n\r\n    dataFactory.disconnectDevice = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + name + \"/disconnect\");\r\n    };\r\n\r\n    dataFactory.pingDevice = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + name + \"/ping\");\r\n    };\r\n\r\n    dataFactory.getDeviceOverview = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + name + \"/overview\");\r\n    };\r\n\r\n    dataFactory.setElement = function (deviceName, elementType, elementName, elementValue, additionalOptions) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"device/\" + deviceName + \"/\" + elementType + \"/\" + elementName + \"/\" + elementValue, null, additionalOptions);\r\n    };\r\n\r\n    dataFactory.updateElement = function (deviceName, elementType, elementName, element) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"device/\" + deviceName + \"/\" + elementType + \"/\" + elementName, element);\r\n    };\r\n\r\n    dataFactory.getMonitor = function (deviceName, elementType, elementName, from) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"monitor/\" + deviceName + \"/\" + elementType + \"/\" + elementName, null, !!from?{from: from}:null);\r\n    };\r\n    \r\n    dataFactory.addTag = function (deviceName, elementType, elementName, tag) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"device/\" + deviceName + \"/\" + elementType + \"/\" + elementName + \"/\" + tag);\r\n    };\r\n\r\n    dataFactory.removeTag = function (deviceName, elementType, elementName, tag) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"device/\" + deviceName + \"/\" + elementType + \"/\" + elementName + \"/\" + tag);\r\n    };\r\n\r\n    return dataFactory;\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .factory(\"carleonFactory\", \r\n    function($http, $q, angharadConfig, angharadBackendService, sagremorParams) {\r\n\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixCarleon;\r\n    var dataFactory = {};\r\n\r\n    /* Base Carleon endpoints */\r\n    dataFactory.getServiceList = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service\");\r\n    };\r\n\r\n    dataFactory.reloadServiceList = function () {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service/reload\");\r\n    };\r\n\r\n    dataFactory.enableService = function (service_name, enable) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service/\" + service_name + \"/enable/\" + (enable?\"1\":\"0\"));\r\n    };\r\n\r\n    dataFactory.elementCleanup = function (service_name, element) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service/\" + service_name + \"/\" + element + \"/cleanup\");\r\n    };\r\n\r\n    dataFactory.addTag = function (service_name, element, tag) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service/\" + service_name + \"/\" + element + \"/\" + tag);\r\n    };\r\n\r\n    dataFactory.removeTag = function (service_name, element, tag) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"service/\" + service_name + \"/\" + element + \"/\" + tag);\r\n    };\r\n\r\n    return dataFactory;\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n\t.factory(\"garethFactory\", \r\n\tfunction(angharadConfig, angharadBackendService, sagremorParams) {\r\n\r\n\tvar urlBase = angharadConfig.baseUrl + angharadConfig.prefixGareth;\r\n\tvar dataFactory = {};\r\n\r\n\t/* Gareth endpoints */\r\n\tdataFactory.getAllMessages = function (limit, offset) {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"message\", null, {limit: limit, offset: offset});\r\n\t};\r\n\r\n\tdataFactory.getFilteredMessages = function (filter, limit, offset) {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"message/\" + filter, null, {limit: limit, offset: offset});\r\n\t};\r\n\r\n\t/* Filters */\r\n\tdataFactory.getFilterList = function () {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"filter\");\r\n\t};\r\n\r\n\tdataFactory.getFilter = function (name) {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"filter/\" + name);\r\n\t};\r\n\r\n\tdataFactory.addFilter = function (filter) {\r\n\t\treturn angharadBackendService.httpRequest(\"POST\", urlBase + \"filter/\", filter);\r\n\t};\r\n\r\n\tdataFactory.setFilter = function (name, filter) {\r\n\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"filter/\" + name, filter);\r\n\t};\r\n\r\n\tdataFactory.removeFilter = function (name) {\r\n\t\treturn angharadBackendService.httpRequest(\"DELETE\", urlBase + \"filter/\" + name);\r\n\t};\r\n\r\n\t/* Alerts */\r\n\tdataFactory.getAlertList = function () {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"alert\");\r\n\t};\r\n\r\n\tdataFactory.getAlert = function (type, name) {\r\n\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"alert/\" + type + \"/\" + name);\r\n\t};\r\n\r\n\tdataFactory.addAlert = function (type, alert) {\r\n\t\treturn angharadBackendService.httpRequest(\"POST\", urlBase + \"alert/\" + type, alert);\r\n\t};\r\n\r\n\tdataFactory.setAlert = function (type, name, alert) {\r\n\t\treturn angharadBackendService.httpRequest(\"PUT\", urlBase + \"alert/\" + type + \"/\" + name, alert);\r\n\t};\r\n\r\n\tdataFactory.removeAlert = function (type, name) {\r\n\t\treturn angharadBackendService.httpRequest(\"DELETE\", urlBase + \"alert/\" + type + \"/\" + name);\r\n\t};\r\n\r\n\treturn dataFactory;\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n\t.controller(\"sagremorCtrl\",\r\n\t\tfunction($scope, $rootScope, $interval, $window, $http, $q, $location, $cookies, $translate, toaster, angharadFactory, benoicFactory, carleonFactory, garethFactory, sharedData, sagremorParams, angharadConfig) {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis.loaderToast;\r\n\t\t\tthis.initComplete = false;\r\n\t\t\tthis.benoicInitError = false;\r\n\t\t\tthis.shoudRefresh = false;\r\n\t\t\tthis.hasFocus = true;\r\n\t\t\tthis.refreshTimeout = null;\r\n\t\t\tthis.isInit = false;\r\n\r\n\t\t\tfunction init() {\r\n\t\t\t\t$translate(\"angharad_loading_title\").then(function(title) {\r\n\t\t\t\t\t// Nothing to do here, just waiting for lang files to be loaded before starting\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction closeLoader(result) {\r\n\t\t\t\ttoaster.clear(self.loaderToast);\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"success\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"angharad_loading_title\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"init_message_loading_complete\")\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"angharad_loading_title\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"init_message_loading_error\")\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction popLoader() {\r\n        toaster.clear(self.loaderToast);\r\n\t\t\t\tself.loaderToast = toaster.pop({\r\n\t\t\t\t\ttype: \"wait\",\r\n\t\t\t\t\ttitle: $translate.instant(\"angharad_loading_title\"),\r\n\t\t\t\t\tbody: $translate.instant(\"init_message_loading\"),\r\n\t\t\t\t\ttimeout: 0,\r\n\t\t\t\t\tshowCloseButton: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction initParameters() {\r\n\t\t\t\tpopLoader();\r\n\t\t\t\tgetApiData();\r\n\t\t\t\tself.refreshTimeout = startRefreshTimeout();\r\n\t\t\t\tsagremorParams.adminMode = false;\r\n\t\t\t\tsagremorParams.loggedIn = true;\r\n\t\t\t\tself.isInit = true;\r\n\t\t\t}\r\n\r\n\t\t\tfunction refreshData() {\r\n\t\t\t\tpopLoader();\r\n\r\n\t\t\t\t// Refresh benoic devices with overview\r\n\t\t\t\tbenoicFactory.getDeviceList().then(function(result) {\r\n\t\t\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function(device) {\r\n\t\t\t\t\t\tdevice.enabled = false;\r\n\t\t\t\t\t\tdevice.connected = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(result, function(device) {\r\n\t\t\t\t\t\tsharedData.add(\"benoicDevices\", device.name, device);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n\t\t\t\t\tvar devicePromises = {};\r\n\t\t\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function(device, deviceName) {\r\n\t\t\t\t\t\tif (device.connected) {\r\n\t\t\t\t\t\t\tdevicePromises[deviceName] = benoicFactory.getDeviceOverview(deviceName).then(function(result) {\r\n\t\t\t\t\t\t\t\tvar curDevice = sharedData.get(\"benoicDevices\", deviceName);\r\n\t\t\t\t\t\t\t\tif (!!curDevice) {\r\n\t\t\t\t\t\t\t\t\tcurDevice.element = result;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, function() {\r\n\t\t\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"refresh\"), $translate.instant(\"refresh_device_error\", {\r\n\t\t\t\t\t\t\t\t\tname: deviceName\r\n\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$q.all(devicePromises).then(function(results) {})[\"finally\"](function() {\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshDevices\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"refresh\"), $translate.instant(\"refresh_device_error\"));\r\n\t\t\t\t})[\"finally\"](function() {\r\n\t\t\t\t\t// Refresh scripts and events\r\n\t\t\t\t\tvar promiseList = {\r\n\t\t\t\t\t\tscripts: angharadFactory.getScriptList(),\r\n\t\t\t\t\t\tschedulers: angharadFactory.getSchedulerList(),\r\n\t\t\t\t\t\ttriggers: angharadFactory.getTriggerList(),\r\n\t\t\t\t\t\tprofiles: angharadFactory.getProfileList()\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$q.all(promiseList).then(function(result) {\r\n\t\t\t\t\t\tsharedData.removeAll(\"angharadScripts\");\r\n\t\t\t\t\t\tsharedData.removeAll(\"angharadSchedulers\");\r\n\t\t\t\t\t\tsharedData.removeAll(\"angharadTriggers\");\r\n\t\t\t\t\t\tfor (sc in result.scripts) {\r\n\t\t\t\t\t\t\tsharedData.add(\"angharadScripts\", result.scripts[sc].name, result.scripts[sc]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshAngharadScripts\");\r\n\t\t\t\t\t\tfor (sh in result.schedulers) {\r\n\t\t\t\t\t\t\tsharedData.add(\"angharadSchedulers\", result.schedulers[sh].name, result.schedulers[sh]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (tr in result.triggers) {\r\n\t\t\t\t\t\t\tsharedData.add(\"angharadTriggers\", result.triggers[tr].name, result.triggers[tr]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"refreshAngharadEvents\");\r\n\t\t\t\t\t\tsagremorParams.profiles = result.profiles;\r\n\t\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"refresh\"), $translate.instant(\"refresh_scripts_events_error\"));\r\n\t\t\t\t\t})[\"finally\"](function() {\r\n\t\t\t\t\t\t// Refresh carleon services elements\r\n\r\n\t\t\t\t\t\tcarleonFactory.getServiceList().then(function(result) {\r\n\t\t\t\t\t\t\tsharedData.removeAll(\"carleonServices\");\r\n\t\t\t\t\t\t\tfor (key in result) {\r\n\t\t\t\t\t\t\t\t_.forEach(result[key].element, function(element) {\r\n\t\t\t\t\t\t\t\t\telement.type = result[key].name;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tsharedData.add(\"carleonServices\", result[key].name, result[key]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$scope.$broadcast(\"refreshCarleonServices\");\r\n\r\n\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\t\t\ttitle: $translate.instant(\"refresh\"),\r\n\t\t\t\t\t\t\t\tbody: $translate.instant(\"refresh_carleon_error\")\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})[\"finally\"](function() {\r\n\t\t\t\t\t\t\t// All done, refreshing dashboard now\r\n\t\t\t\t\t\t\ttoaster.clear(self.loaderToast);\r\n\t\t\t\t\t\t\t$scope.$broadcast(\"refreshDashboard\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction getApiData() {\r\n\t\t\t\treturn self.initAngharadSubmodules().then(function(result) {\r\n\t\t\t\t\tvar promises = [self.initAngharad()];\r\n\t\t\t\t\tsagremorParams.benoicEnabled = false;\r\n\t\t\t\t\tsagremorParams.carleonEnabled = false;\r\n\t\t\t\t\tsagremorParams.garethEnabled = false;\r\n\t\t\t\t\tfor (key in result) {\r\n\t\t\t\t\t\tsharedData.add(\"submodules\", result[key].name, result[key]);\r\n\t\t\t\t\t\tif (result[key].name === \"benoic\" && result[key].enabled) {\r\n\t\t\t\t\t\t\tsagremorParams.benoicEnabled = true;\r\n\t\t\t\t\t\t\tpromises.push(self.initBenoic());\r\n\t\t\t\t\t\t} else if (result[key].name === \"carleon\" && result[key].enabled) {\r\n\t\t\t\t\t\t\tsagremorParams.carleonEnabled = true;\r\n\t\t\t\t\t\t\tpromises.push(self.initCarleon());\r\n\t\t\t\t\t\t} else if (result[key].name === \"gareth\" && result[key].enabled) {\r\n\t\t\t\t\t\t\tsagremorParams.garethEnabled = true;\r\n\t\t\t\t\t\t\tpromises.push(self.initGareth());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$q.all(promises).then(function() {\r\n\t\t\t\t\t\t$scope.$broadcast(\"submodulesChanged\");\r\n\t\t\t\t\t}, function() {\r\n\t\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\t\ttitle: $translate.instant(\"angharad_loading_title\"),\r\n\t\t\t\t\t\t\tbody: $translate.instant(\"init_message_loading_error\")\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})[\"finally\"](function() {\r\n\t\t\t\t\t\tself.initComplete = true;\r\n\t\t\t\t\t\t$scope.$broadcast(\"initComplete\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"angharad_loading_title\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"init_message_loading_error\")\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction startRefreshTimeout() {\r\n\t\t\t\t// Refresh every 5 minutes if the window has the focus\r\n\t\t\t\t// If the window has not the focus, set a flag to refresh the page when it will have the focus\r\n\t\t\t\treturn $interval(function() {\r\n\t\t\t\t\tif (self.hasFocus) {\r\n\t\t\t\t\t\trefreshData();\r\n\t\t\t\t\t\tself.shouldRefresh = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.shouldRefresh = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000 * 60 * 5);\r\n\t\t\t}\r\n\r\n\t\t\t$window.onblur = function() {\r\n\t\t\t\tself.hasFocus = false;\r\n\t\t\t};\r\n\r\n\t\t\t$window.onfocus = function() {\r\n\t\t\t\tself.hasFocus = true;\r\n\t\t\t\tif (self.shouldRefresh) {\r\n\t\t\t\t\trefreshData();\r\n\t\t\t\t\tself.shouldRefresh = false;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.initAngharadSubmodules = function() {\r\n\t\t\t\treturn angharadFactory.getSumboduleList();\r\n\t\t\t};\r\n\r\n\t\t\tthis.initBenoic = function() {\r\n\t\t\t\tvar promiseList = {\r\n\t\t\t\t\tdeviceTypesResult: benoicFactory.getDeviceTypes(),\r\n\t\t\t\t\tdeviceResult: benoicFactory.getDeviceList()\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn $q.all(promiseList).then(function(result) {\r\n\t\t\t\t\tvar deviceTypesResult = result.deviceTypesResult;\r\n\t\t\t\t\tvar deviceResult = result.deviceResult;\r\n\r\n\t\t\t\t\t// Handle device types\r\n\t\t\t\t\t_.forEach(deviceTypesResult, function(type) {\r\n\t\t\t\t\t\tsharedData.add(\"benoicDeviceTypes\", type.name, type);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$scope.$broadcast(\"benoicDeviceTypesChanged\");\r\n\r\n\t\t\t\t\t// Handle devices\r\n\t\t\t\t\tvar deviceList = [];\r\n\t\t\t\t\tsharedData.removeAll(\"benoicDevices\");\r\n\t\t\t\t\t_.forEach(deviceResult, function(curDevice) {\r\n\t\t\t\t\t\tif (curDevice.connected) {\r\n\t\t\t\t\t\t\tdeviceList.push(benoicFactory.getDeviceOverview(curDevice.name).then(function(result) {\r\n\t\t\t\t\t\t\t\tcurDevice.element = result;\r\n\t\t\t\t\t\t\t}, function() {\r\n\t\t\t\t\t\t\t\tcurDevice.element = {};\r\n\t\t\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"benoic_loading_title\"), $translate.instant(\"benoic_loading_error\", {\r\n\t\t\t\t\t\t\t\t\tname: curDevice.name\r\n\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsharedData.add(\"benoicDevices\", curDevice.name, curDevice);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$q.all(deviceList).then(function(responses) {})[\"finally\"](function() {\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"benoicDevicesChanged\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"benoic_loading_title\"), $translate.instant(\"benoic_loading_error\"));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.initCarleon = function() {\r\n\t\t\t\tsharedData.removeAll(\"carleonServices\");\r\n\r\n\t\t\t\treturn carleonFactory.getServiceList().then(function(result) {\r\n\t\t\t\t\tfor (key in result) {\r\n\t\t\t\t\t\t_.forEach(result[key].element, function(element) {\r\n\t\t\t\t\t\t\telement.type = result[key].name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsharedData.add(\"carleonServices\", result[key].name, result[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"carleon_loading_title\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"carleon_loading_error\")\r\n\t\t\t\t\t});\r\n\t\t\t\t})[\"finally\"](function() {\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t});\r\n\r\n\t\t\t};\r\n\r\n\t\t\tthis.initGareth = function() {\r\n\t\t\t\tsharedData.removeAll(\"garethFilters\");\r\n\t\t\t\tsharedData.removeAll(\"garethAlertsSmtp\");\r\n\t\t\t\tsharedData.removeAll(\"garethAlertsHttp\");\r\n\t\t\t\tvar qList = {\r\n\t\t\t\t\tfilters: garethFactory.getFilterList(),\r\n\t\t\t\t\talerts: garethFactory.getAlertList()\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn $q.all(qList).then(function(results) {\r\n\t\t\t\t\tfor (key in results.filters) {\r\n\t\t\t\t\t\tsharedData.add(\"garethFilters\", results.filters[key].name, results.filters[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (key in results.alerts.smtp) {\r\n\t\t\t\t\t\tsharedData.add(\"garethAlertsSmtp\", results.alerts.smtp[key].name, results.alerts.smtp[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (key in results.alerts.http) {\r\n\t\t\t\t\t\tsharedData.add(\"garethAlertsHttp\", results.alerts.http[key].name, results.alerts.http[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.$broadcast(\"garethChange\");\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"gareth_loading_title\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"gareth_loading_error\")\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tthis.setDefaultProfile = function() {\r\n\t\t\t\tsagremorParams.currentProfile = false;\r\n\t\t\t\t_.forEach(sagremorParams.profiles, function(profile) {\r\n\t\t\t\t\tif (profile.default) {\r\n\t\t\t\t\t\tsagremorParams.currentProfile = profile;\r\n\t\t\t\t\t\tvar exp = new $window.Date();\r\n\t\t\t\t\t\texp = new $window.Date(exp.getFullYear() + 10, exp.getMonth(), exp.getDate());\r\n\t\t\t\t\t\t$cookies.put(\"ANGHARAD_PROFILE\", profile.name, {\r\n\t\t\t\t\t\t\texpires: exp\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!sagremorParams.currentProfile) {\r\n\t\t\t\t\t// No profile, add default one\r\n\t\t\t\t\tvar defaultProfile = {\r\n\t\t\t\t\t\tname: $translate.instant(\"profile_default\"),\r\n\t\t\t\t\t\tdefault: true,\r\n\t\t\t\t\t\tdata: {}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tsagremorParams.profiles = [\r\n\t\t\t\t\t\tdefaultProfile\r\n\t\t\t\t\t];\r\n\t\t\t\t\tsagremorParams.currentProfile = defaultProfile;\r\n\t\t\t\t\tangharadFactory.setProfile($translate.instant(\"profile_default\"), defaultProfile).then(function() {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_success\"));\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar exp = new $window.Date();\r\n\t\t\t\t\texp = new $window.Date(exp.getFullYear() + 10, exp.getMonth(), exp.getDate());\r\n\t\t\t\t\t$cookies.put(\"ANGHARAD_PROFILE\", $translate.instant(\"profile_default\"), {\r\n\t\t\t\t\t\texpires: exp\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.initAngharad = function() {\r\n\t\t\t\tvar promiseList = {\r\n\t\t\t\t\tscripts: angharadFactory.getScriptList(),\r\n\t\t\t\t\tschedulers: angharadFactory.getSchedulerList(),\r\n\t\t\t\t\ttriggers: angharadFactory.getTriggerList(),\r\n\t\t\t\t\tprofiles: angharadFactory.getProfileList()\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn $q.all(promiseList).then(function(result) {\r\n\t\t\t\t\tfor (sc in result.scripts) {\r\n\t\t\t\t\t\tsharedData.add(\"angharadScripts\", result.scripts[sc].name, result.scripts[sc]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.$broadcast(\"angharadScriptsChanged\");\r\n\t\t\t\t\tfor (sh in result.schedulers) {\r\n\t\t\t\t\t\tsharedData.add(\"angharadSchedulers\", result.schedulers[sh].name, result.schedulers[sh]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.$broadcast(\"angharadSchedulersChanged\");\r\n\t\t\t\t\tfor (tr in result.triggers) {\r\n\t\t\t\t\t\tsharedData.add(\"angharadTriggers\", result.triggers[tr].name, result.triggers[tr]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.$broadcast(\"angharadTriggersChanged\");\r\n\r\n\t\t\t\t\tif (result.profiles.length === 0) {\r\n\t\t\t\t\t\tself.setDefaultProfile();\r\n\t\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsagremorParams.profiles = result.profiles;\r\n\t\t\t\t\t\tvar profile_name = $cookies.get(\"ANGHARAD_PROFILE\");\r\n\t\t\t\t\t\tsagremorParams.currentProfile = false;\r\n\r\n\t\t\t\t\t\tif (!!profile_name) {\r\n\t\t\t\t\t\t\t_.forEach(result.profiles, function(profile) {\r\n\t\t\t\t\t\t\t\tif (profile.name === profile_name) {\r\n\t\t\t\t\t\t\t\t\tsagremorParams.currentProfile = profile;\r\n\t\t\t\t\t\t\t\t\t$scope.$broadcast(\"angharadProfileChanged\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (!sagremorParams.currentProfile) {\r\n\t\t\t\t\t\t\t\tself.setDefaultProfile();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.setDefaultProfile();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, function(error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"angharad_loading_title\"), $translate.instant(\"angharad_loading_error\"));\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tthis.closeSagremor = function() {\r\n\t\t\t\tsagremorParams.token = null;\r\n\t\t\t\tsagremorParams.loggedIn = false;\r\n\t\t\t\t$scope.isLogged = false;\r\n\t\t\t\tsagremorParams.profiles = [];\r\n\t\t\t\tsagremorParams.currentProfile = null;\r\n\t\t\t\tself.isInit = false;\r\n\t\t\t\t$rootScope.$broadcast(\"closeBenoic\");\r\n\t\t\t\t$rootScope.$broadcast(\"closeCarleon\");\r\n\t\t\t\t$rootScope.$broadcast(\"closeGareth\");\r\n\t\t\t\t$rootScope.$broadcast(\"angharadProfileUpdated\");\r\n\t\t\t\t$rootScope.$broadcast(\"refreshDashboard\");\r\n\t\t\t};\r\n\r\n\t\t\t$scope.$on(\"reinitBenoic\", function() {\r\n\t\t\t\tself.initBenoic();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"reinitCarleon\", function() {\r\n\t\t\t\tself.initCarleon();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"reinitGareth\", function() {\r\n\t\t\t\tself.initGareth();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"closeBenoic\", function() {\r\n\t\t\t\tsharedData.removeAll(\"benoicDevices\");\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"closeCarleon\", function() {\r\n\t\t\t\tsharedData.removeAll(\"carleonServices\");\r\n\t\t\t\tsagremorParams.profiles = [];\r\n\t\t\t\tsagremorParams.currentProfile = false;\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"closeGareth\", function() {\r\n\t\t\t\tsharedData.removeAll(\"garethFilters\");\r\n\t\t\t\tsharedData.removeAll(\"garethAlertsSmtp\");\r\n\t\t\t\tsharedData.removeAll(\"garethAlertsHttp\");\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"refresh\", function() {\r\n\t\t\t\trefreshData();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"reconnect\", function() {\r\n\t\t\t\t$scope.$broadcast(\"oauth:external:refresh\");\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"loginSuccess\", function() {\r\n\t\t\t\tinitParameters();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on(\"initComplete\", function() {\r\n\t\t\t\tif (self.initComplete) {\r\n\t\t\t\t\tcloseLoader(true);\r\n\t\t\t\t} else if (self.benoicInitError) {\r\n\t\t\t\t\tcloseLoader(false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:login', function(event, token) {\r\n\t\t\t\tsharedData.add(\"oauthToken\", \"token\", token);\r\n\t\t\t\t$http.defaults.headers.common.Authorization = \"Bearer \" + token.access_token;\r\n\t\t\t\tinitParameters();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:refresh', function(event, token) {\r\n\t\t\t\t$http.defaults.headers.common.Authorization = \"Bearer \" + token.access_token;\r\n\t\t\t\tsharedData.add(\"oauthToken\", \"token\", token);\r\n\t\t\t\tif (!self.isInit) {\r\n\t\t\t\t\tinitParameters();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:loggedOut', function(event, token) {\r\n\t\t\t\tself.closeSagremor();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:denied', function(event, token) {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"angharad_loading_title\"), $translate.instant(\"access_denied\"));\r\n\t\t\t\tself.closeSagremor();\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:expired', function(event, token) {\r\n\t\t\t\t$scope.$broadcast(\"reconnect\");\r\n\t\t\t});\r\n\r\n\t\t\t$scope.$on('oauth:invalid', function(event, message) {\r\n\t\t\t\tself.closeSagremor();\r\n\t\t\t});\r\n\r\n\t\t\tinit();\r\n\t\t}\r\n\t);\r\n\nangular.module(\"sagremorApp\")\r\n\t.factory(\"sagremorService\",\r\n\t\tfunction($uibModal, $translate, toaster, sharedData, sagremorParams, sagremorConfirm, angharadFactory, benoicFactory, carleonFactory) {\r\n\t\t\tvar sagremorFactory = {};\r\n\r\n\t\t\tsagremorFactory.monitor = function(element) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/modals/monitor.modal.html\",\r\n\t\t\t\t\tcontroller: \"MonitorModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"MonitorModalCtrl\",\r\n\t\t\t\t\tsize: \"md\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\telement: function() {\r\n\t\t\t\t\t\t\treturn element;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.imagePopup = function(title, src) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/modals/image.modal.html\",\r\n\t\t\t\t\tcontroller: \"ImageModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"ImageModalCtrl\",\r\n\t\t\t\t\tsize: \"lg\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\ttitle: function() {\r\n\t\t\t\t\t\t\treturn title;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsrc: function() {\r\n\t\t\t\t\t\t\treturn src;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.addToDashboard = function(element) {\r\n\t\t\t\tvar tag = \"SGMR$D$0$0\";\r\n\t\t\t\tvar profile = sagremorParams.currentProfile;\r\n\t\t\t\tif (!profile.addTo) {\r\n\t\t\t\t\tprofile.addTo = {};\r\n\t\t\t\t}\r\n\t\t\t\tif (!profile.addTo.D) {\r\n\t\t\t\t\tprofile.addTo.D = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (!!element.device) {\r\n\t\t\t\t\tvar newElement = {\r\n\t\t\t\t\t\tdevice: element.device,\r\n\t\t\t\t\t\ttype: element.type,\r\n\t\t\t\t\t\tname: element.name,\r\n\t\t\t\t\t\ttag: tag\r\n\t\t\t\t\t};\r\n\t\t\t\t\tprofile.addTo.D.push(newElement);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar newElement = {\r\n\t\t\t\t\t\ttype: element.type,\r\n\t\t\t\t\t\tname: element.name,\r\n\t\t\t\t\t\ttag: tag\r\n\t\t\t\t\t};\r\n\t\t\t\t\tprofile.addTo.D.push(newElement);\r\n\t\t\t\t}\r\n\t\t\t\treturn angharadFactory.setProfile(profile.name, profile).then(function() {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"success\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"angharad_add_to_dashboard\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"angharad_add_to_dashboard_success\")\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\ttoaster.pop({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: $translate.instant(\"angharad_add_to_dashboard\"),\r\n\t\t\t\t\t\tbody: $translate.instant(\"angharad_add_to_dashboard_error\")\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.bindToElement = function(script) {\r\n\t\t\t\treturn modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/modals/scriptBindElement.modal.html\",\r\n\t\t\t\t\tcontroller: \"ScriptBindElementModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"ScriptBindElementModalCtrl\",\r\n\t\t\t\t\tsize: \"md\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tscript: function() {\r\n\t\t\t\t\t\t\treturn script;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.removeFromDashboard = function(element) {\r\n\t\t\t\tvar dashboardWidgets = sagremorParams.dashboardWidgets;\r\n\t\t\t\tif (dashboardWidgets !== undefined) {\r\n\t\t\t\t\t_.remove(dashboardWidgets, function(widget) {\r\n\t\t\t\t\t\treturn (widget.type === element.type && widget.element.device === element.device && widget.element.name === element.name);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tsagremorParams.dashboardWidgets = dashboardWidgets;\r\n\t\t\t\treturn true;\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editSwitcher = function(switcher) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/switch/switch.modal.html\",\r\n\t\t\t\t\tcontroller: \"SwitchesModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"SwitchesModalCtrl\",\r\n\t\t\t\t\tsize: \"sm\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tswitcher: function() {\r\n\t\t\t\t\t\t\treturn switcher;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editSensor = function(sensor) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/sensor/sensor.modal.html\",\r\n\t\t\t\t\tcontroller: \"SensorsModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"SensorsModalCtrl\",\r\n\t\t\t\t\tsize: \"sm\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tsensor: function() {\r\n\t\t\t\t\t\t\treturn sensor;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editHeater = function(heater) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/heater/heater.modal.html\",\r\n\t\t\t\t\tcontroller: \"HeatersModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"HeatersModalCtrl\",\r\n\t\t\t\t\tsize: \"sm\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\theater: function() {\r\n\t\t\t\t\t\t\treturn heater;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editDimmer = function(dimmer) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/dimmer/dimmer.modal.html\",\r\n\t\t\t\t\tcontroller: \"DimmersModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"DimmersModalCtrl\",\r\n\t\t\t\t\tsize: \"sm\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tdimmer: function() {\r\n\t\t\t\t\t\t\treturn dimmer;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editScript = function(script) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/script/script.modal.html\",\r\n\t\t\t\t\tcontroller: \"ScriptModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"ScriptModalCtrl\",\r\n\t\t\t\t\tsize: \"md\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tscript: function() {\r\n\t\t\t\t\t\t\treturn script;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.removeScript = function(script) {\r\n\t\t\t\treturn sagremorConfirm.open($translate.instant(\"script_remove\"), $translate.instant(\"script_remove_confirm\")).then(function(result) {\r\n\t\t\t\t\treturn angharadFactory.removeScript(script.name).then(function() {\r\n\t\t\t\t\t\tsharedData.remove(\"angharadScripts\", script.name);\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"script_remove\"), $translate.instant(\"script_remove_success\"));\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"script_remove\"), $translate.instant(\"script_remove_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.editEvent = function(event, eventType) {\r\n\t\t\t\tvar modalInstance = $uibModal.open({\r\n\t\t\t\t\tanimation: true,\r\n\t\t\t\t\ttemplateUrl: \"components/event/event.modal.html\",\r\n\t\t\t\t\tcontroller: \"EventModalCtrl\",\r\n\t\t\t\t\tcontrollerAs: \"EventModalCtrl\",\r\n\t\t\t\t\tsize: \"md\",\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\tevent: function() {\r\n\t\t\t\t\t\t\treturn event;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\teventType: function() {\r\n\t\t\t\t\t\t\treturn eventType;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.removeScheduler = function(event) {\r\n\t\t\t\treturn sagremorConfirm.open($translate.instant(\"scheduler_remove\"), $translate.instant(\"scheduler_remove_confirm\")).then(function(result) {\r\n\t\t\t\t\treturn angharadFactory.removeScheduler(event.name).then(function() {\r\n\t\t\t\t\t\tsharedData.remove(\"angharadSchedulers\", event.name);\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"scheduler_remove\"), $translate.instant(\"scheduler_remove_success\"));\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"scheduler_remove\"), $translate.instant(\"scheduler_remove_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.removeTrigger = function(trigger) {\r\n\t\t\t\treturn sagremorConfirm.open($translate.instant(\"trigger_remove\"), $translate.instant(\"trigger_remove_confirm\")).then(function(result) {\r\n\t\t\t\t\treturn angharadFactory.removeTrigger(trigger.name).then(function() {\r\n\t\t\t\t\t\tsharedData.remove(\"angharadTriggers\", trigger.name);\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"trigger_remove\"), $translate.instant(\"trigger_remove_success\"));\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"trigger_remove\"), $translate.instant(\"trigger_remove_error\"));\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.getBenoicElement = function(device, type, name) {\r\n\t\t\t\tvar elements = sharedData.get(\"benoicDevices\", device);\r\n\t\t\t\tif (!!elements && !!elements.element) {\r\n\t\t\t\t\tswitch (type) {\r\n\t\t\t\t\t\tcase \"switch\":\r\n\t\t\t\t\t\t\tif (!!elements.element.switches && elements.element.switches[name]) {\r\n\t\t\t\t\t\t\t\treturn elements.element.switches[name];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"dimmer\":\r\n\t\t\t\t\t\t\tif (!!elements.element.dimmers && elements.element.dimmers[name]) {\r\n\t\t\t\t\t\t\t\treturn elements.element.dimmers[name];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"heater\":\r\n\t\t\t\t\t\t\tif (!!elements.element.heaters && elements.element.heaters[name]) {\r\n\t\t\t\t\t\t\t\treturn elements.element.heaters[name];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"sensor\":\r\n\t\t\t\t\t\t\tif (!!elements.element.sensors && elements.element.sensors[name]) {\r\n\t\t\t\t\t\t\t\treturn elements.element.sensors[name];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.getCarleonElement = function(service, name) {\r\n\t\t\t\tif (!!service && !!name) {\r\n\t\t\t\t\tvar cService = sharedData.get(\"carleonServices\", service);\r\n\t\t\t\t\tvar element = _.find(cService.element, function(elt) {\r\n\t\t\t\t\t\treturn elt.name === name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn element || false;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tsagremorFactory.removeMonitor = function(monitor) {\r\n\t\t\t\t_.remove(sagremorParams.currentProfile.monitorList, function(curMonitor) {\r\n\t\t\t\t\treturn curMonitor.name === monitor.name;\r\n\t\t\t\t});\r\n\t\t\t\treturn angharadFactory.saveCurrentProfile().then(function() {\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"monitor_save\"), $translate.instant(\"monitor_save_success\"));\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"monitor_save\"), $translate.instant(\"monitor_save_error\"));\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\treturn sagremorFactory;\r\n\t\t}\r\n\t);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"EventModalCtrl\",\r\n    function($scope, $rootScope, $uibModalInstance, $translate, toaster, sagremorConstant, sagremorService, angharadFactory, sharedData, sagGenericInjectorManager, event, eventType) {\r\n        var self = this;\r\n        \r\n        this.add = true;\r\n        this.error = {\r\n\t\t\tnameInvalid: true,\r\n\t\t\tmessage: \"\"\r\n\t\t};\r\n        this.globalScriptList = angular.copy(sharedData.all(\"angharadScripts\"));\r\n        this.globalElementList = angular.copy(sagremorConstant.conditionList);\r\n        this.globalTriggerElementList = [];\r\n        this.schedulerRepeatEveryEnum = sagremorConstant.schedulerRepeatEveryEnum;\r\n        this.event = event||{\r\n\t\t\tname: \"\",\r\n\t\t\tdescription: \"\",\r\n\t\t\tenabled: true\r\n\t\t};\r\n        this.scheduler = {\r\n\t\t\trepeatSwitch: false,\r\n\t\t\trepeat: -1,\r\n\t\t\trepeat_value: 0,\r\n\t\t\tremove_after: false,\r\n\t\t\trepeatEveryDayOfWeek: {\r\n\t\t\t\tsunday: false,\r\n\t\t\t\tmonday: false,\r\n\t\t\t\ttuesday: false,\r\n\t\t\t\twednesday: false,\r\n\t\t\t\tthursday: false,\r\n\t\t\t\tfriday: false,\r\n\t\t\t\tsaturday: false\r\n\t\t\t}\r\n\t\t};\r\n        this.trigger = {\r\n\t\t\tsubmodule: false,\r\n\t\t\tsource: false,\r\n\t\t\telement: false\r\n\t\t};\r\n        this.scriptList = [];\r\n        this.conditionList = [];\r\n        this.myDate = new Date();\r\n        this.benoicElements = {\r\n\t\t\tswitches: [],\r\n\t\t\tdimmers: [],\r\n\t\t\theaters: [],\r\n\t\t\tsensors: []\r\n\t\t}\r\n\t\tthis.carleonConditionElementsList = {};\r\n\t\tthis.carleonConditionResultParameters = {};\r\n\t\tthis.carleonConditionCommandsParameters = {};\r\n\t\tthis.scriptActionElements = [];\r\n\t\tthis.tmpElement = false;\r\n\t\tthis.tmpResult = false;\r\n\t\tthis.newCondition = {\r\n\t\t\tcondition: \"==\",\r\n\t\t\tvalue: 0,\r\n\t\t\tparameters: {}\r\n\t\t};\r\n\t\tthis.eventType = eventType;\r\n\t\t\r\n\t\tthis.newTrigger = {};\r\n\t\tthis.newTriggerTag = {};\r\n        \r\n        this.datePickerOptions = {\r\n\t\t\tbuttonBar: {\r\n\t\t\t\tshow: true,\r\n\t\t\t\tnow: {\r\n\t\t\t\t\tshow: false,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_now\")\r\n\t\t\t\t},\r\n\t\t\t\ttoday: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_today\")\r\n\t\t\t\t},\r\n\t\t\t\tclear: {\r\n\t\t\t\t\tshow: false,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_clear\")\r\n\t\t\t\t},\r\n\t\t\t\tdate: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_date\")\r\n\t\t\t\t},\r\n\t\t\t\ttime: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_time\")\r\n\t\t\t\t},\r\n\t\t\t\tclose: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\ttext: $translate.instant(\"date_picker_close\")\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n        \r\n        function init() {\r\n\t\t\tif (!!event) {\r\n\t\t\t\tself.add = false;\r\n\t\t\t\tif (self.eventType === \"scheduler\") {\r\n\t\t\t\t\tself.scheduler = angular.copy(event);\r\n\t\t\t\t\tself.scheduler.repeatSwitch = (event.repeat > -1);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek = {\r\n\t\t\t\t\t\tsunday: false,\r\n\t\t\t\t\t\tmonday: false,\r\n\t\t\t\t\t\ttuesday: false,\r\n\t\t\t\t\t\twednesday: false,\r\n\t\t\t\t\t\tthursday: false,\r\n\t\t\t\t\t\tfriday: false,\r\n\t\t\t\t\t\tsaturday: false\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (event.repeat === 3) {\r\n\t\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek = {\r\n\t\t\t\t\t\t\tsunday: ((event.repeat_value & 1) !== 0),\r\n\t\t\t\t\t\t\tmonday: ((event.repeat_value & 2) !== 0),\r\n\t\t\t\t\t\t\ttuesday: ((event.repeat_value & 4) !== 0),\r\n\t\t\t\t\t\t\twednesday: ((event.repeat_value & 8) !== 0),\r\n\t\t\t\t\t\t\tthursday: ((event.repeat_value & 16) !== 0),\r\n\t\t\t\t\t\t\tfriday: ((event.repeat_value & 32) !== 0),\r\n\t\t\t\t\t\t\tsaturday: ((event.repeat_value & 64) !== 0)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.myDate = new Date(event.next_time * 1000);\r\n\t\t\t\t} else if (self.eventType === \"trigger\") {\r\n\t\t\t\t\tself.trigger.submodule = event.submodule;\r\n\t\t\t\t\tself.trigger.source = event.source;\r\n\t\t\t\t\tself.trigger.element = event.element;\r\n\t\t\t\t}\r\n\t\t\t\tself.scriptList = event.scripts;\r\n\t\t\t\tself.conditionList = event.conditions;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function (device) {\r\n\t\t\t\tif (device.enabled && device.connected) {\r\n\t\t\t\t\t_.forEach(device.element.switches, function(element, name) {\r\n\t\t\t\t\t\tif (element.options.trigger) {\r\n\t\t\t\t\t\t\tself.globalTriggerElementList.push({submodule: \"benoic\", source: device.name, element: name, display: element.display});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"switch\",\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tvalue: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.benoicElements.switches.push(elt);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.dimmers, function(element, name) {\r\n\t\t\t\t\t\tif (element.options.trigger) {\r\n\t\t\t\t\t\t\tself.globalTriggerElementList.push({submodule: \"benoic\", source: device.name, element: name, display: element.display});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"dimmer\",\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tvalue: 0\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.benoicElements.dimmers.push(elt);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.heaters, function(element, name) {\r\n\t\t\t\t\t\tif (element.options.trigger) {\r\n\t\t\t\t\t\t\tself.globalTriggerElementList.push({submodule: \"benoic\", source: device.name, element: name, display: element.display});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"heater\",\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tvalue: 20,\r\n\t\t\t\t\t\t\toptions: element.options,\r\n\t\t\t\t\t\t\tavailableModes: element.value.availableModes,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.benoicElements.heaters.push(elt);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.sensors, function(element, name) {\r\n\t\t\t\t\t\tif (element.options.trigger) {\r\n\t\t\t\t\t\t\tself.globalTriggerElementList.push({submodule: \"benoic\", source: device.name, element: name, display: element.display});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"sensor\",\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\t\t\toptions: element.options\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.benoicElements.sensors.push(elt);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t_.forEach(sharedData.all(\"carleonServices\"), function (service, serviceName) {\r\n\t\t\t\tvar injector = _.find(sagGenericInjectorManager.components, function (inject) {\r\n\t\t\t\t\treturn inject.type === serviceName && service.enabled;\r\n\t\t\t\t});\r\n\t\t\t\t_.forEach(service.element, function (element) {\r\n\t\t\t\t\tif (element.options && element.options.trigger) {\r\n\t\t\t\t\t\tself.globalTriggerElementList.push({submodule: \"carleon\", source: service.name, element: element.name, display: element.name});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (!!injector) {\r\n\t\t\t\t\t_.forEach(injector.commands, function (command, commandName) {\r\n\t\t\t\t\t\tvar newAction = {label: command.title, name: serviceName + \"$\" + commandName, submodule: \"carleon\"};\r\n\t\t\t\t\t\tself.globalElementList.push(newAction);\r\n\t\t\t\t\t\tself.carleonConditionElementsList[serviceName + \"$\" + commandName] = service.element;\r\n\t\t\t\t\t\tif (!!service.commands[commandName]) {\r\n\t\t\t\t\t\t\tself.carleonConditionCommandsParameters[serviceName + \"$\" + commandName] = [];\r\n\t\t\t\t\t\t\t_.forEach(service.commands[commandName].parameters, function (serviceParameter, serviceParameterName) {\r\n\t\t\t\t\t\t\t\tvar commandParameter = {\r\n\t\t\t\t\t\t\t\t\tname: serviceParameterName,\r\n\t\t\t\t\t\t\t\t\ttitle: !!command.parameters[serviceParameterName]?$translate.instant(command.parameters[serviceParameterName]):serviceParameterName,\r\n\t\t\t\t\t\t\t\t\ttype: serviceParameter.type,\r\n\t\t\t\t\t\t\t\t\trequired: serviceParameter.required\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tself.carleonConditionCommandsParameters[serviceName + \"$\" + commandName].push(commandParameter);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tself.carleonConditionResultParameters[serviceName + \"$\" + commandName] = [];\r\n\t\t\t\t\t\t\t_.forEach(service.commands[commandName].result, function (serviceResult, serviceResultName) {\r\n\t\t\t\t\t\t\t\tif (serviceResultName === \"type\") {\r\n\t\t\t\t\t\t\t\t\tvar commandResult = {\r\n\t\t\t\t\t\t\t\t\t\ttitle: $translate.instant(\"condition_result_one_value\"),\r\n\t\t\t\t\t\t\t\t\t\ttype: serviceResult\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.carleonConditionResultParameters[serviceName + \"$\" + commandName].push(commandResult);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar commandResult = {\r\n\t\t\t\t\t\t\t\t\t\tname: serviceResultName,\r\n\t\t\t\t\t\t\t\t\t\ttitle: $translate.instant(command.result[serviceResultName].title),\r\n\t\t\t\t\t\t\t\t\t\ttype: serviceResult.type\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.carleonConditionResultParameters[serviceName + \"$\" + commandName].push(commandResult);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t_.forEach(sharedData.all(\"carleonServices\"), function (service, serviceName) {\r\n\t\t\t\tvar injector = _.find(sagGenericInjectorManager.components, function (inject) {\r\n\t\t\t\t\treturn inject.type === serviceName && service.enabled;\r\n\t\t\t\t});\r\n\t\t\t\tif (!!injector) {\r\n\t\t\t\t\t_.forEach(injector.results, function (result, resultName) {\r\n\t\t\t\t\t\tif (!!result.type && !!result.title) {\r\n\t\t\t\t\t\t\tvar newCondition = {label: result.title, name: serviceName + \"$\" + resultName, submodule: \"carleon\", type: result.type};\r\n\t\t\t\t\t\t\tself.globalElementList.push(newCondition);\r\n\t\t\t\t\t\t\tself.carleonConditionElementsList[serviceName + \"$\" + resultName] = service.element;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_.forEach(result, function (curResult, curResultName) {\r\n\t\t\t\t\t\t\t\tvar newCondition = {label: curResult.title, name: serviceName + \"$\" + curResultName, submodule: \"carleon\", type: curResult.type, field: curResultName};\r\n\t\t\t\t\t\t\t\tself.globalElementList.push(newCondition);\r\n\t\t\t\t\t\t\t\tself.carleonConditionElementsList[serviceName + \"$\" + curResultName] = service.element;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n        }\r\n        \r\n\t\tthis.openCalendar = function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tself.isOpen = true;\r\n\t\t};\r\n\t\t\r\n        this.trackBenoicElement = function(element, type) {\r\n\t\t\tif (!!element && !!type) {\r\n\t\t\t\treturn element.device + \"$\" + type + \"$\" + element.name;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"err$err$err\";\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.trackCarleonElement = function (element, action) {\r\n\t\t\tif (!!element && !!action) {\r\n\t\t\t\treturn action + \"$\" + element.name;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"err$err$err\";\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.trackTriggerElement = function (element) {\r\n\t\t\treturn element.submodule + \"$\" + element.source + \"$\" + element.element;\r\n\t\t};\r\n        \r\n        this.tr = function (id) {\r\n\t\t\treturn $translate.instant(id);\r\n\t\t};\r\n\t\t\r\n\t\tthis.isConditionValid = function () {\r\n\t\t\tif (!!self.newConditionType && self.newConditionType.submodule === \"benoic\") {\r\n\t\t\t\tswitch (self.newConditionType.name) {\r\n\t\t\t\t\tcase \"switch\":\r\n\t\t\t\t\tcase \"dimmer\":\r\n\t\t\t\t\tcase \"sensor\":\r\n\t\t\t\t\t\treturn !!self.tmpElement;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"heater\":\r\n\t\t\t\t\t\tif (!self.tmpElement) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn !!self.newCondition.condition && (!!self.newCondition.commandMode || !!self.newCondition.commandHeat);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (!!self.newConditionType && self.newConditionType.submodule === \"carleon\") {\r\n\t\t\t\tif (!self.newCondition.condition || (!self.newCondition.value && self.newCondition.value !== 0) || !self.tmpElement) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar res = true;\r\n\t\t\t\t_.forEach(self.carleonConditionCommandsParameters[self.newConditionType.name], function (parameter) {\r\n\t\t\t\t\tif (parameter.required && (!self.newCondition.parameters[parameter.name] && self.newCondition.parameters[parameter.name] !== 0)) {\r\n\t\t\t\t\t\tres = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\t\r\n\t\tthis.heaterModeDisplay = function (value) {\r\n\t\t\treturn $translate.instant(\"heater_mode_\" + value);\r\n\t\t};\r\n    \r\n        this.setConditionBenoicElement = function () {\r\n\t\t\tself.newCondition.submodule = \"benoic\";\r\n\t\t\tself.newCondition.element = self.tmpElement.name;\r\n\t\t\tself.newCondition.parameters.device = self.tmpElement.device;\r\n\t\t\tself.newCondition.parameters.element_type = self.tmpElement.type;\r\n\t\t};\r\n        \r\n\t\tthis.addCondition = function () {\r\n\t\t\tif (self.newConditionType.submodule === \"benoic\" && self.newCondition.commandMode) {\r\n\t\t\t\tself.newCondition.field = \"mode\";\r\n\t\t\t\tself.newCondition.value = self.newCondition.commandMode;\r\n\t\t\t}\r\n\t\t\tif (self.newConditionType.submodule === \"benoic\" && self.newCondition.commandHeat) {\r\n\t\t\t\tself.newCondition.field = \"command\";\r\n\t\t\t\tself.newCondition.value = self.newCondition.commandHeat;\r\n\t\t\t}\r\n\t\t\tif (self.newConditionType.submodule === \"carleon\") {\r\n\t\t\t\tvar nameSplitted = self.newConditionType.name.split(\"$\");\r\n\t\t\t\tself.newCondition.field = self.newConditionType.field;\r\n\t\t\t\tself.newCondition.submodule = \"carleon\";\r\n\t\t\t\tself.newCondition.element = self.tmpElement.name;\r\n\t\t\t\tself.newCondition.parameters.service = self.tmpElement.type\r\n\t\t\t\tself.newCondition.service = nameSplitted[0];\r\n\t\t\t\tself.newCondition.command = nameSplitted[1];\r\n\t\t\t\tif (!!self.tmpResult.name) {\r\n\t\t\t\t\tself.newCondition.field = self.tmpResult.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself.conditionList.push(self.newCondition);\r\n\t\t\tself.newCondition = {\r\n\t\t\t\tcondition: \"==\",\r\n\t\t\t\tvalue: 0,\r\n\t\t\t\tparameters: {}\r\n\t\t\t};\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeCondition = function (index) {\r\n\t\t\tself.conditionList.splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.displayCondition = function (condition) {\r\n\t\t\tif (!!condition && condition.submodule === \"benoic\") {\r\n\t\t\t\tswitch (condition.parameters.element_type) {\r\n\t\t\t\t\tcase \"switch\":\r\n\t\t\t\t\t\tvar curSwitch = _.find(self.benoicElements.switches, function (element) {\r\n\t\t\t\t\t\t\treturn condition.parameters.device === element.device && condition.element === element.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn !!curSwitch?$translate.instant(\"switch_title\")+\" \"+curSwitch.display+\" \"+(condition.value?$translate.instant(\"condition_switch_on\"):$translate.instant(\"condition_switch_off\")):$translate.instant(\"switch_title\")+\" \"+$translate.instant(\"not_found\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"dimmer\":\r\n\t\t\t\t\t\tvar curDimmer = _.find(self.benoicElements.dimmers, function (element) {\r\n\t\t\t\t\t\t\treturn condition.parameters.device === element.device && condition.element === element.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn !!curDimmer?$translate.instant(\"dimmer_title\")+\" \"+curDimmer.display+\" \"+condition.condition+\" \"+condition.value:$translate.instant(\"dimmer_title\")+\" \"+$translate.instant(\"not_found\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"heater\":\r\n\t\t\t\t\t\tvar curHeater = _.find(self.benoicElements.heaters, function (element) {\r\n\t\t\t\t\t\t\treturn condition.parameters.device === element.device && condition.element === element.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!!curHeater) {\r\n\t\t\t\t\t\t\tif (condition.field === \"command\") {\r\n\t\t\t\t\t\t\t\treturn $translate.instant(\"heater_title\")+\" \"+curHeater.display+\" \"+condition.condition+\" \"+condition.value;\r\n\t\t\t\t\t\t\t} else if (condition.field === \"mode\") {\r\n\t\t\t\t\t\t\t\treturn $translate.instant(\"heater_title\")+\" \"+curHeater.display+\" \"+condition.condition+\" \"+$translate.instant(\"heater_mode_\"+condition.value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn $translate.instant(\"not_found\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"sensor\":\r\n\t\t\t\t\t\tvar curSensor = _.find(self.benoicElements.sensors, function (element) {\r\n\t\t\t\t\t\t\treturn condition.parameters.device === element.device && condition.element === element.name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn !!curSensor?$translate.instant(\"sensor_title\")+\" \"+curSensor.display+\" \"+condition.condition+\" \"+condition.value:$translate.instant(\"sensor_title\")+\" \"+$translate.instant(\"not_found\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (!!condition && condition.submodule === \"carleon\") {\r\n\t\t\t\tvar curCondition = _.find(self.globalElementList, function (cond) {\r\n\t\t\t\t\treturn cond.name === condition.service + \"$\" + condition.command;\r\n\t\t\t\t});\r\n\t\t\t\tvar fieldName = $translate.instant(\"condition_result_one_value\");\r\n\t\t\t\tif (!!condition.field) {\r\n\t\t\t\t\tvar curResult = _.find(self.carleonConditionResultParameters[curCondition.name], function (res) {\r\n\t\t\t\t\t\treturn res.name === condition.field;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tfieldName = !!curResult?curResult.title:$translate.instant(\"condition_result_one_value\");\r\n\t\t\t\t}\r\n\t\t\t\treturn !!curCondition?$translate.instant(curCondition.label)+\" \"+fieldName+\" \"+condition.condition+\" \"+condition.value:$translate.instant(\"not_found\");\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.addScript = function(script) {\r\n\t\t\tself.scriptList.push({name: script.name, enabled: true});\r\n\t\t\tdelete self.globalScriptList[script.name];\r\n\t\t};\r\n\t\t\r\n\t\tthis.removeScript = function (index) {\r\n\t\t\tvar script = self.scriptList[index];\r\n\t\t\tself.globalScriptList[script.name] = angular.copy(sharedData.get(\"angharadScripts\", script.name));\r\n\t\t\tself.scriptList.splice(index, 1);\r\n\t\t};\r\n\t\t\r\n\t\tthis.isEventValid = function () {\r\n\t\t\tif (!self.event.name) {\r\n\t\t\t\tself.error.message = $translate.instant(\"event_name_mandatory\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (self.add) {\r\n\t\t\t\tif (self.eventType === \"scheduler\") {\r\n\t\t\t\t\tif (!!sharedData.get(\"angharadSchedulers\", self.event.name)) {\r\n\t\t\t\t\t\tself.error.message = $translate.instant(\"event_name_already_exist\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (self.eventType === \"trigger\") {\r\n\t\t\t\t\tif (!!sharedData.get(\"angharadTriggers\", self.event.name)) {\r\n\t\t\t\t\t\tself.error.message = $translate.instant(\"event_name_already_exist\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself.error.nameInvalid = false;\r\n\t\t\t\r\n\t\t\tif (!self.eventType) {\r\n\t\t\t\tself.error.message = $translate.instant(\"event_type_mandatory\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (self.eventType === \"scheduler\") {\r\n\t\t\t\tif (!self.myDate) {\r\n\t\t\t\t\tself.error.message = $translate.instant(\"event_scheduler_date_mandatory\");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else if (self.myDate < new Date() && !self.event.repeat) {\r\n\t\t\t\t\tself.error.message = $translate.instant(\"event_scheduler_date_future\");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} else if (self.eventType === \"trigger\") {\r\n\t\t\t\tif (!self.trigger.submodule || !self.trigger.source || !self.trigger.element) {\r\n\t\t\t\t\tself.error.message = $translate.instant(\"event_trigger_no_element\");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (self.scriptList.length === 0) {\r\n\t\t\t\tself.error.message = $translate.instant(\"event_script_mandatory\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself.error.message = \"\";\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n        this.save = function () {\r\n\t\t\tif (self.eventType === \"scheduler\") {\r\n\t\t\t\tself.scheduler.name = self.event.name;\r\n\t\t\t\tself.scheduler.description = self.event.description;\r\n\t\t\t\tself.scheduler.enabled = self.event.enabled;\r\n\t\t\t\tself.scheduler.next_time = Math.round(self.myDate.getTime() / 1000);\r\n\t\t\t\tif (self.scheduler.repeat === 3) {\r\n\t\t\t\t\t// Day of week\r\n\t\t\t\t\tself.scheduler.repeat_value = 0;\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.sunday && (self.scheduler.repeat_value += 1);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.monday && (self.scheduler.repeat_value += 2);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.tuesday && (self.scheduler.repeat_value += 4);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.wednesday && (self.scheduler.repeat_value += 8);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.thursday && (self.scheduler.repeat_value += 16);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.friday && (self.scheduler.repeat_value += 32);\r\n\t\t\t\t\tself.scheduler.repeatEveryDayOfWeek.saturday && (self.scheduler.repeat_value += 64);\r\n\t\t\t\t}\r\n\t\t\t\tself.scheduler.scripts = self.scriptList;\r\n\t\t\t\tself.scheduler.conditions = self.conditionList;\r\n\t\t\t\t\r\n\t\t\t\tif (self.add) {\r\n\t\t\t\t\tangharadFactory.addScheduler(self.scheduler).then(function () {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"scheduler_save\"), $translate.instant(\"scheduler_save_success\"));\r\n\t\t\t\t\t\tsharedData.add(\"angharadSchedulers\", self.scheduler.name, self.scheduler);\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"angharadSchedulersChanged\");\r\n\t\t\t\t\t}, function () {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"scheduler_save\"), $translate.instant(\"scheduler_save_error\"));\r\n\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tangharadFactory.setScheduler(self.scheduler.name, self.scheduler).then(function () {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"scheduler_save\"), $translate.instant(\"scheduler_save_success\"));\r\n\t\t\t\t\t\tsharedData.add(\"angharadSchedulers\", self.scheduler.name, self.scheduler);\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"angharadSchedulersChanged\");\r\n\t\t\t\t\t}, function () {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"scheduler_save\"), $translate.instant(\"scheduler_save_error\"));\r\n\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else if (self.eventType === \"trigger\") {\r\n\t\t\t\tself.trigger.name = self.event.name;\r\n\t\t\t\tself.trigger.description = self.event.description;\r\n\t\t\t\tself.trigger.enabled = self.event.enabled;\r\n\t\t\t\tself.trigger.scripts = self.scriptList;\r\n\t\t\t\tself.trigger.conditions = self.conditionList;\r\n\t\t\t\tif (self.add) {\r\n\t\t\t\t\tangharadFactory.addTrigger(self.trigger).then(function () {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"trigger_save\"), $translate.instant(\"trigger_save_success\"));\r\n\t\t\t\t\t\tsharedData.add(\"angharadTriggers\", self.trigger.name, self.trigger);\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"angharadTriggersChanged\");\r\n\t\t\t\t\t}, function () {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"trigger_save\"), $translate.instant(\"trigger_save_error\"));\r\n\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tangharadFactory.setTrigger(self.trigger.name, self.trigger).then(function () {\r\n\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"trigger_save\"), $translate.instant(\"trigger_save_success\"));\r\n\t\t\t\t\t\tsharedData.add(\"angharadTriggers\", self.trigger.name, self.trigger);\r\n\t\t\t\t\t\t$rootScope.$broadcast(\"angharadTriggersChanged\");\r\n\t\t\t\t\t}, function () {\r\n\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"trigger_save\"), $translate.instant(\"trigger_save_error\"));\r\n\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n        };\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        init();\r\n    });\r\n\nfunction sagSchedulerController ($translate, toaster, angharadFactory, sagremorParams, sharedData) {\r\n    var ctrl = this;\r\n    \r\n    function init() {\r\n    }\r\n    \r\n    this.enableScheduler = function () {\r\n\t\tangharadFactory.enableScheduler(ctrl.element.name, ctrl.element.enabled).then(function (result) {\r\n\t\t\tsharedData.add(\"angharadSchedulers\", result.name, result);\r\n\t\t\tctrl.element = result;\r\n\t\t\ttoaster.pop(\"success\", $translate.instant(\"scheduler_enable\"), $translate.instant(\"scheduler_enable_success\"));\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"scheduler_enable\"), $translate.instant(\"scheduler_enable_error\"));\r\n\t\t});\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagScheduler\", {\r\n    templateUrl: \"components/event/scheduler.template.html\",\r\n    controller: sagSchedulerController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"scheduler\",\r\n        directive: \"sag-scheduler\",\r\n        carleonService: false\r\n    });\r\n})\r\n.filter;\r\n\nfunction sagTriggerController ($translate, toaster, angharadFactory, sagremorParams, sharedData) {\r\n    var ctrl = this;\r\n    \r\n    function init() {\r\n    }\r\n    \r\n    this.enableTrigger = function () {\r\n\t\tangharadFactory.enableTrigger(ctrl.element.name, ctrl.element.enabled).then(function (result) {\r\n\t\t\tsharedData.add(\"angharadTrigger\", result.name, result);\r\n\t\t\tctrl.element = result;\r\n\t\t\ttoaster.pop(\"success\", $translate.instant(\"trigger_enable\"), $translate.instant(\"trigger_enable_success\"));\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"trigger_enable\"), $translate.instant(\"trigger_enable_error\"));\r\n\t\t});\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagTrigger\", {\r\n    templateUrl: \"components/event/trigger.template.html\",\r\n    controller: sagTriggerController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"trigger\",\r\n        directive: \"sag-trigger\",\r\n        carleonService: false\r\n    });\r\n})\r\n.filter;\r\n\nangular.module(\"sagremorApp\")\r\n.controller(\"GridstackController\", [\"$scope\", function($scope) {\r\n\r\n    var gridstack = null;\r\n\r\n    this.init = function(element, options) {\r\n      gridstack = element.gridstack(options).data(\"gridstack\");\r\n      return gridstack;\r\n    };\r\n\r\n    this.removeItem = function(element) {\r\n      if(gridstack) {\r\n        return gridstack.removeWidget(element, false);\r\n      }\r\n      return null;\r\n    };\r\n\r\n    this.addItem = function(element) {\r\n      if(gridstack) {\r\n        gridstack.makeWidget(element);\r\n        return element;\r\n      }\r\n      return null;\r\n    };\r\n\r\n}]);\r\n\nangular.module('sagremorApp')\r\n\r\n.directive('gridstack', ['$timeout', function($timeout) {\r\n\r\n    return {\r\n      restrict: \"A\",\r\n      controller: 'GridstackController',\r\n      scope: {\r\n        onChange: '&',\r\n        onDragStart: '&',\r\n        onDragStop: '&',\r\n        onResizeStart: '&',\r\n        onResizeStop: '&',\r\n        options: '='\r\n      },\r\n      link: function (scope, element, attrs, controller, ngModel) {\r\n\r\n        controller.init(element, scope.options);\r\n\r\n        element.on('change', function (e, items) {\r\n          $timeout(function() {\r\n            scope.$apply();\r\n            scope.onChange({event: e, items: items});\r\n          });\r\n        });\r\n\r\n        element.on('dragstart', function(e, ui) {\r\n          scope.onDragStart({event: e, ui: ui});\r\n        });\r\n\r\n        element.on('dragstop', function(e, ui) {\r\n          $timeout(function() {\r\n            scope.$apply();\r\n            scope.onDragStop({event: e, ui: ui});\r\n          });\r\n        });\r\n\r\n      }\r\n    };\r\n\r\n}]).directive('gridstackItem', ['$timeout', function($timeout) {\r\n\r\n    return {\r\n      restrict: \"A\",\r\n      controller: 'GridstackController',\r\n      require: '^gridstack',\r\n      scope: {\r\n        gridstackItem: '=',\r\n        onItemAdded: '&',\r\n        onItemRemoved: '&',\r\n        gsItemX: '=',\r\n        gsItemY: '=',\r\n        gsItemWidth: '=',\r\n        gsItemHeight: '=',\r\n        gsItemAutopos: '='\r\n      },\r\n      link: function (scope, element, attrs, controller) {\r\n\r\n        $(element).attr('data-gs-x', scope.gsItemX);\r\n        $(element).attr('data-gs-y', scope.gsItemY);\r\n        $(element).attr('data-gs-width', scope.gsItemWidth);\r\n        $(element).attr('data-gs-height', scope.gsItemHeight);\r\n        $(element).attr('data-gs-auto-position', scope.gsItemAutopos);\r\n        var widget = controller.addItem(element);\r\n        var item = element.data('_gridstack_node');\r\n        $timeout(function() {\r\n          scope.onItemAdded({item: item});\r\n        });\r\n\r\n        scope.$watch(function(){ return $(element).attr('data-gs-x'); }, function(val) {\r\n          scope.gsItemX = val;\r\n        });\r\n\r\n        scope.$watch(function(){ return $(element).attr('data-gs-y'); }, function(val) {\r\n          scope.gsItemY = val;\r\n        });\r\n\r\n        scope.$watch(function(){ return $(element).attr('data-gs-width'); }, function(val) {\r\n          scope.gsItemWidth = val;\r\n        });\r\n\r\n        scope.$watch(function(){ return $(element).attr('data-gs-height'); }, function(val) {\r\n          scope.gsItemHeight = val;\r\n        });\r\n\r\n        element.bind('$destroy', function() {\r\n          var item = element.data('_gridstack_node');\r\n          scope.onItemRemoved({item: item});\r\n          controller.removeItem(element);\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n  }]);\r\n\nfunction sagHeaterController (benoicFactory, sagremorParams, $translate) {\r\n    var ctrl = this;\r\n    \r\n    ctrl.element.valueChecked = (ctrl.element.value === 1);\r\n    ctrl.adminMode = sagremorParams.adminMode;\r\n    ctrl.element.newDisplay = \"\";\r\n    ctrl.availableModes = [];\r\n    \r\n    function init() {\r\n        ctrl.element.type = \"heater\";\r\n        if (!!ctrl.element) {\r\n\t\t\tctrl.element.newDisplay = ctrl.element.display;\r\n\t\t\tctrl.availableModes = ctrl.element.value.availableModes;\r\n\t\t}\r\n    }\r\n    \r\n    ctrl.setHeater = function (value) {\r\n\t\tif (value == null) {\r\n\t\t\tvalue = ctrl.element.value.command;\r\n\t\t} else {\r\n\t\t\tvalue = ctrl.element.value.command + value;\r\n\t\t}\r\n        benoicFactory.setElement(ctrl.element.device, \"heater\", ctrl.element.name, value, {mode: ctrl.element.value.mode}).then(function () {\r\n            ctrl.element.value.command = value;\r\n        });\r\n    };\r\n    \r\n    ctrl.displayCommandValue = function () {\r\n\t\tvar command = !!ctrl.element?(Math.round(ctrl.element.value.command * 100) / 100):0;\r\n        if (!!ctrl.element && !!ctrl.element.options.unit) {\r\n\t\t\tcommand += \" \" + ctrl.element.options.unit\r\n\t\t}\r\n\t\treturn command;\r\n\t};\r\n\t\r\n\tctrl.displayCommand = function (command) {\r\n\t\tvar value = \"\";\r\n\t\tif (command < 0) {\r\n\t\t\tvalue = command;\r\n\t\t} else {\r\n\t\t\tvalue = \"+\" + command;\r\n\t\t}\r\n        if (!!ctrl.element && !!ctrl.element.options.unit) {\r\n\t\t\tvalue += \" \" + ctrl.element.options.unit\r\n\t\t}\r\n\t\treturn value\r\n\t};\r\n\t\r\n\tctrl.modeDisplay = function (value) {\r\n\t\treturn $translate.instant(\"heater_mode_\" + value.toLowerCase());\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagHeater\", {\r\n    templateUrl: \"components/heater/heater.template.html\",\r\n    controller: sagHeaterController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"heater\",\r\n        directive: \"sag-heater\",\r\n        carleonService: false\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"HeatersModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, sagremorConstant, benoicFactory, heater) {\r\n        var self = this;\r\n        \r\n        this.heater = heater;\r\n        this.heater.newDisplay = this.heater.display;\r\n        \r\n        this.monitorEveryEnum = sagremorConstant.monitoredEveryEnum;\r\n        \r\n        function init() {\r\n\t\t\tself.heater.menu = false;\r\n            \r\n            _.forEach(self.monitorEveryEnum, function(monitorEvery) {\r\n                $translate(monitorEvery.label).then(function (trLabel) {\r\n                    monitorEvery.trLabel = trLabel;\r\n                });\r\n            });\r\n        }\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.tr = function (id) {\r\n\t\t\treturn $translate.instant(id);\r\n\t\t};\r\n        \r\n        this.saveHeater = function () {\r\n            self.heater.display = self.heater.newDisplay;\r\n            self.heater.monitor = self.heater.monitorChecked?1:0;\r\n            benoicFactory.updateElement(self.heater.device, \"heater\", self.heater.name, self.heater).then(function (response) {\r\n                $scope.$broadcast(\"benoicHeatersChanged\");\r\n                toaster.pop(\"success\", $translate.instant(\"heater_save\"), $translate.instant(\"heater_save_success\"));\r\n            }, function (error) {\r\n                toaster.pop(\"error\", $translate.instant(\"heater_save\"), $translate.instant(\"heater_save_error\"));\r\n            })[\"finally\"](function () {\r\n                $uibModalInstance.dismiss(\"close\");\r\n            });\r\n        };\r\n        \r\n        init();\r\n    }\r\n);\r\n\nfunction carleonMockController ($translatePartialLoader, $translate, carleonMockFactory, sagremorParams, toaster) {\r\n    var ctrl = this;\r\n    \r\n    ctrl.adminMode = sagremorParams.adminMode;\r\n    ctrl.param = {command: \"exec1\", param1: \"test\", param2: 42, param3: 7.3};\r\n    ctrl.commandList = [\"exec1\", \"exec2\", \"exec3\", \"exec4\"];\r\n    ctrl.messages = {};\r\n    \r\n    function init() {\r\n    }\r\n    \r\n    ctrl.command = function () {\r\n\t\tcarleonMockFactory.commandMock(ctrl.element.name, ctrl.param.command, ctrl.param.param1, ctrl.param.param2, ctrl.param.param3).then(function (result) {\r\n\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mock_command\"), $translate.instant(\"carleon_mock_command_success\"));\r\n\t\t}, function (error) {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mock_command\"), $translate.instant(\"carleon_mock_command_error\"));\r\n\t\t});\r\n\t};\r\n\t\r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"carleonMock\", {\r\n    templateUrl: \"components/carleonMock/carleonMock.template.html\",\r\n    controller: carleonMockController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.factory(\"carleonMockFactory\", function($http, $uibModal, $translate, toaster, angharadConfig, angharadBackendService, sagremorConfirm, sharedData) {\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixCarleon;\r\n    var mockFactory = {};\r\n\r\n\t/* Mock service */\r\n    mockFactory.getMockList = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"mock-service/\");\r\n    };\r\n\r\n    mockFactory.getMock = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"mock-service/\" + name);\r\n    };\r\n\r\n    mockFactory.addMock = function (mock) {\r\n        return angharadBackendService.httpRequest(\"POST\", urlBase + \"mock-service/\", mock);\r\n    };\r\n\r\n    mockFactory.setMock = function (name, mock) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"mock-service/\" + name, mock);\r\n    };\r\n\r\n    mockFactory.removeMock = function (name) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"mock-service/\" + name);\r\n    };\r\n\r\n    mockFactory.commandMock = function (name, command, param1, param2, param3) {\r\n\t\tif (command === \"exec3\" || command === \"exec4\") {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"mock-service/\" + name + \"/command/\" + command);\r\n\t\t} else if (command === \"exec2\") {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"mock-service/\" + name + \"/command/\" + command + \"/\" + param1);\r\n\t\t} else {\r\n\t\t\treturn angharadBackendService.httpRequest(\"GET\", urlBase + \"mock-service/\" + name + \"/command/\" + command + \"/\" + param1 + \"/\" + param2 + \"/\" + param3);\r\n\t\t}\r\n    };\r\n\r\n\tmockFactory.addService = function () {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonMock/carleonMock.modal.html\",\r\n\t\t\tcontroller: \"CarleonMockModalCtrl\",\r\n\t\t\tcontrollerAs: \"CarleonMockModalCtrl\",\r\n\t\t\tsize: \"sm\",\r\n\t\t\tresolve: {\r\n\t\t\t\tmock: function () {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tmockFactory.editService = function (service) {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonMock/carleonMock.modal.html\",\r\n\t\t\tcontroller: \"CarleonMockModalCtrl\",\r\n\t\t\tcontrollerAs: \"CarleonMockModalCtrl\",\r\n\t\t\tsize: \"sm\",\r\n\t\t\tresolve: {\r\n\t\t\t\tmock: function () {\r\n\t\t\t\t\treturn service;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tmockFactory.removeService = function (service) {\r\n\t\treturn sagremorConfirm.open($translate.instant(\"carleon_mock_remove\"), $translate.instant(\"carleon_mock_confirm\")).then(function () {\r\n\t\t\treturn mockFactory.removeMock(service.name).then(function () {\r\n\t\t\t\tvar injector = sharedData.get(\"carleonServices\", \"mock-service\");\r\n\t\t\t\t_.remove(injector.element, function (element) {\r\n\t\t\t\t\treturn element.name === service.name;\r\n\t\t\t\t});\r\n\t\t\t\tsharedData.add(\"carleonServices\", \"mock-service\", injector);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mock_remove\"), $translate.instant(\"carleon_mock_remove_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mock_remove\"), $translate.instant(\"carleon_mock_remove_error\"));\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n    return mockFactory;\r\n\r\n})\r\n.config(function run($translatePartialLoaderProvider) {\r\n\t$translatePartialLoaderProvider.addPart(\"carleonMock\");\r\n})\r\n.run(function(sagGenericInjectorManager, carleonMockFactory) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"mock-service\",\r\n        directive: \"carleon-mock\",\r\n        groupTitle: \"carleon_mock_title\",\r\n        service: carleonMockFactory,\r\n        carleonService: true,\r\n        size: 1,\r\n        leftMenu: {\r\n\t\t\ttitle: \"carleon_mock_title\",\r\n\t\t\ttarget: \"carleonMock\"\r\n\t\t},\r\n\t\twidgetHeight: 3,\r\n\t\twidgetWidth: 3,\r\n\t\ticon: \"thumbs-o-up\",\r\n\t\tcommands: {\r\n\t\t\texec1: {\r\n\t\t\t\ttitle: \"carleon_mock_command_exec1_title\",\r\n\t\t\t\tparameters: {\r\n\t\t\t\t\tparam1: \"carleon_mock_command_exec1_parameter_param1_title\",\r\n\t\t\t\t\tparam2: \"carleon_mock_command_exec1_parameter_param2_title\",\r\n\t\t\t\t\tparam3: \"carleon_mock_command_exec1_parameter_param3_title\"\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tvalue1: {\r\n\t\t\t\t\t\ttype: \"integer\",\r\n\t\t\t\t\t\ttitle: \"carleon_mock_command_exec1_result_value1_title\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tvalue2: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\ttitle: \"carleon_mock_command_exec1_result_value2_title\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\texec2: {\r\n\t\t\t\ttitle: \"carleon_mock_command_exec2_title\",\r\n\t\t\t\tparameters: {\r\n\t\t\t\t\tparam1: \"carleon_mock_command_exec2_parameter_param1_title\"\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\ttitle: \"carleon_mock_command_exec2_result_title\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\texec3: {\r\n\t\t\t\ttitle: \"carleon_mock_command_exec3_title\",\r\n\t\t\t\tparameters: {},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\ttitle: \"carleon_mock_command_exec3_result_title\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\texec4: {\r\n\t\t\t\ttitle: \"carleon_mock_command_exec4_title\",\r\n\t\t\t\tparameters: {},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tvalue1: {\r\n\t\t\t\t\t\ttype: \"integer\",\r\n\t\t\t\t\t\ttitle: \"carleon_mock_command_exec4_result_value1_title\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tvalue2: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\ttitle: \"carleon_mock_command_exec4_result_value2_title\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"CarleonMockModalCtrl\", \r\n    function($rootScope, $uibModalInstance, $translate, sharedData, toaster, carleonMockFactory, mock) {\r\n        var self = this;\r\n\r\n        this.messages = {};\r\n        this.add = true;\r\n\r\n        function init() {\r\n\t\t\tif (!!mock) {\r\n\t\t\t\tself.mock = mock;\r\n\t\t\t\tself.add = false;\r\n\t\t\t} else {\r\n\t\t\t\tself.mock = {};\r\n\t\t\t}\r\n        }\r\n        \r\n        this.cancel = function () {\r\n\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t};\r\n\r\n        this.save = function () {\r\n\t\t\tif (self.add) {\r\n\t\t\t\tcarleonMockFactory.addMock(self.mock).then(function () {\r\n\t\t\t\t\tself.mock.type = \"mock-service\";\r\n\t\t\t\t\tself.mock.service = carleonMockFactory;\r\n\t\t\t\t\tsharedData.get(\"carleonServices\", \"mock-service\").element.push(self.mock);\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mock_save\"), $translate.instant(\"carleon_mock_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mock_save\"), $translate.instant(\"carleon_mock_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcarleonMockFactory.setMock(self.mock.name, self.mock).then(function () {\r\n\t\t\t\t\tvar mocks = sharedData.get(\"carleonServices\", \"mock-service\").element;\r\n\t\t\t\t\t_.forEach(mocks, function (mock) {\r\n\t\t\t\t\t\tif (mock.name === self.mock.name) {\r\n\t\t\t\t\t\t\tmock.description = self.mock.description;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_mock_save\"), $translate.instant(\"carleon_mock_save_success\"));\r\n\t\t\t\t}, function (error) {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_mock_save\"), $translate.instant(\"carleon_mock_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n        init();\r\n    }\r\n);\r\n\nfunction sagScriptController ($rootScope, $translate, toaster, angharadFactory, sagremorParams) {\r\n    var ctrl = this;\r\n    \r\n    this.loaderToast = null;\r\n    \r\n    function init() {\r\n    }\r\n    \r\n    this.runScript = function () {\r\n\t\t\ttoaster.clear(self.loaderToast);\r\n\t\t\tself.loaderToast = toaster.pop({type: \"wait\", title: $translate.instant(\"angharad_loading_script_title\"), body: $translate.instant(\"angharad_loading_script_message\"), timeout: 0, showCloseButton: false});\r\n\t\t\tangharadFactory.runScript(ctrl.element.name).then(function () {\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"script_run\", {name: ctrl.element.name}), $translate.instant(\"script_run_success\"));\r\n\t\t\t}, function (error) {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"script_run\", {name: ctrl.element.name}), $translate.instant(\"script_run_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\ttoaster.clear(self.loaderToast);\r\n\t\t\t\t$rootScope.$broadcast(\"refresh\");\r\n\t\t\t});\r\n\t\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagScript\", {\r\n    templateUrl: \"components/script/script.template.html\",\r\n    controller: sagScriptController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"script\",\r\n        directive: \"sag-script\",\r\n        carleonService: false\r\n    });\r\n});\r\n\n/**\r\n * \r\n * action format:\r\n * \r\n * {\r\n *   \"submodule\": \"submodule_name\",   // Required\r\n *   \"element\": \"element_name\"        // Required\r\n *   \"command\": \"command\"             // Required\r\n *   \"parameters\": {                  // Required for submodule benoic, depends on the element for submodule carleon\r\n *     \"device\": \"device_name\"        // Required for submodule benoic\r\n *     \"element_type\": \"element_type\" // Required for submodule benoic\r\n *     \"service\": \"service_name\"      // Required for carleon\r\n *     \"param1\": \"value1\",            // for a string value\r\n *     \"param2\": 2,                   // for an integer value\r\n *     \"param3\", 3.3                  // for a real value\r\n *   }\r\n * \r\n */\r\nangular.module(\"sagremorApp\")\r\n    .controller(\"ScriptModalCtrl\",\r\n    function($scope, $rootScope, $uibModalInstance, $translate, toaster, sagremorConstant, sagremorService, angharadFactory, sharedData, sagGenericInjectorManager, script) {\r\n        var self = this;\r\n        \r\n        this.script = script;\r\n        this.add = false;\r\n        this.newAction = false;\r\n        this.newActionType = false;\r\n        this.tmpElement = {};\r\n        this.scriptActionElements = angular.copy(sagremorConstant.scriptActionElements);\r\n        this.benoicElements = {\r\n\t\t\t\t\tswitches: [],\r\n\t\t\t\t\tdimmers: [],\r\n\t\t\t\t\theaters: []\r\n\t\t\t\t}\r\n\t\t\t\tthis.error = {\r\n\t\t\t\t\tmessage: \"\"\r\n\t\t\t\t};\r\n\t\t\t\tthis.carleonConditionCommandsParameters = {};\r\n\t\t\t\tthis.carleonConditionElementsList = {};\r\n        \r\n        function init() {\r\n\t\t\t\t\tif (!self.script) {\r\n\t\t\t\t\t\tself.add = true;\r\n\t\t\t\t\t\tself.script = {\r\n\t\t\t\t\t\t\tactions: [],\r\n\t\t\t\t\t\t\toptions: {}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function (device) {\r\n\t\t\t\t\t\tif (device.enabled && device.connected) {\r\n\t\t\t\t\t\t\t_.forEach(device.element.switches, function(element, name) {\r\n\t\t\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\t\t\ttype: \"switch\",\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\t\t\tvalue: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.benoicElements.switches.push(elt);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t_.forEach(device.element.dimmers, function(element, name) {\r\n\t\t\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\t\t\ttype: \"dimmer\",\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\t\t\tvalue: 0\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.benoicElements.dimmers.push(elt);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t_.forEach(device.element.heaters, function(element, name) {\r\n\t\t\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\t\t\ttype: \"heater\",\r\n\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\t\t\tvalue: 20,\r\n\t\t\t\t\t\t\t\t\tavailableModes: element.value.availableModes\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.benoicElements.heaters.push(elt);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t_.forEach(sharedData.all(\"carleonServices\"), function (service, serviceName) {\r\n\t\t\t\t\t\tvar injector = _.find(sagGenericInjectorManager.components, function (inject) {\r\n\t\t\t\t\t\t\treturn inject.type === serviceName && service.enabled;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!!injector) {\r\n\t\t\t\t\t\t\t_.forEach(injector.commands, function (command, commandName) {\r\n\t\t\t\t\t\t\t\tvar newAction = {label: command.title, name: serviceName + \"$\" + commandName, submodule: \"carleon\"};\r\n\t\t\t\t\t\t\t\tself.carleonConditionElementsList[serviceName + \"$\" + commandName] = service.element;\r\n\t\t\t\t\t\t\t\tself.scriptActionElements.push(newAction);\r\n\t\t\t\t\t\t\t\tif (!!service.commands && !!service.commands[commandName]) {\r\n\t\t\t\t\t\t\t\t\tself.carleonConditionCommandsParameters[serviceName + \"$\" + commandName] = [];\r\n\t\t\t\t\t\t\t\t\t_.forEach(service.commands[commandName].parameters, function (serviceParameter, serviceParameterName) {\r\n\t\t\t\t\t\t\t\t\t\tvar commandParameter = {\r\n\t\t\t\t\t\t\t\t\t\t\tname: serviceParameterName,\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: !!command.parameters[serviceParameterName]?$translate.instant(command.parameters[serviceParameterName]):serviceParameterName,\r\n\t\t\t\t\t\t\t\t\t\t\ttype: serviceParameter.type,\r\n\t\t\t\t\t\t\t\t\t\t\trequired: serviceParameter.required\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\tself.carleonConditionCommandsParameters[serviceName + \"$\" + commandName].push(commandParameter);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\r\n        }\r\n        \r\n        this.setActionBenoicElement = function () {\r\n\t\t\t\t\tself.newAction.element = self.tmpElement.name;\r\n\t\t\t\t\tself.newAction.parameters.device = self.tmpElement.device;\r\n\t\t\t\t\tself.newAction.parameters.element_type = self.tmpElement.type;\r\n\t\t\t\t};\r\n        \r\n        this.setActionCarleonElement = function () {\r\n\t\t\t\t\tself.newAction.element = self.tmpElement.name;\r\n\t\t\t\t};\r\n        \r\n        this.trackBenoicElement = function(element, type) {\r\n\t\t\t\t\tif (!!element && !!type) {\r\n\t\t\t\t\t\treturn element.device + \"$\" + type + \"$\" + element.name;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"err$err$err\";\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.trackCarleonElement = function (element, action) {\r\n\t\t\t\t\tif (!!element && !!action) {\r\n\t\t\t\t\t\treturn action + \"$\" + element.name;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"err$err$err\";\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n        \r\n        this.addAction = function () {\r\n\t\t\t\t\tself.newAction = {};\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.changeActionType = function () {\r\n\t\t\t\t\tself.newAction = {\r\n\t\t\t\t\t\tsubmodule: \"\",\r\n\t\t\t\t\t\telement: \"\",\r\n\t\t\t\t\t\tparameters: {\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tswitch (self.newActionType.name) {\r\n\t\t\t\t\t\tcase \"switch\":\r\n\t\t\t\t\t\t\tself.newAction.submodule = \"benoic\";\r\n\t\t\t\t\t\t\tself.newAction.command = 1;\r\n\t\t\t\t\t\t\tself.newAction.parameters.element_type = \"switch\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"dimmer\":\r\n\t\t\t\t\t\t\tself.newAction.submodule = \"benoic\";\r\n\t\t\t\t\t\t\tself.newAction.command = 0;\r\n\t\t\t\t\t\t\tself.newAction.parameters.element_type = \"dimmer\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"heater\":\r\n\t\t\t\t\t\t\tself.newAction.submodule = \"benoic\";\r\n\t\t\t\t\t\t\tself.newAction.command = 20;\r\n\t\t\t\t\t\t\tself.newAction.parameters.element_type = \"heater\";\r\n\t\t\t\t\t\t\tself.newAction.parameters.mode = \"auto\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tvar newActionTypeSplitted = self.newActionType.name.split(\"$\");\r\n\t\t\t\t\t\t\tself.newAction.parameters.service = newActionTypeSplitted[0];\r\n\t\t\t\t\t\t\tself.newAction.command = newActionTypeSplitted[1];\r\n\t\t\t\t\t\t\tself.newAction.submodule = \"carleon\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.removeAction = function ($index) {\r\n\t\t\t\t\tself.script.actions.splice($index, 1);\r\n\t\t\t\t};\r\n\t\t\r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.tr = function (id) {\r\n\t\t\t\t\treturn $translate.instant(id);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.heaterModeDisplay = function (value) {\r\n\t\t\t\t\treturn $translate.instant(\"heater_mode_\" + value);\r\n\t\t\t\t};\r\n    \r\n        this.save = function () {\r\n\t\t\t\t\tif (self.add) {\r\n\t\t\t\t\t\tangharadFactory.addScript(self.script).then(function () {\r\n\t\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant('script_save'), $translate.instant('script_save_success'));\r\n\t\t\t\t\t\t\tsharedData.add(\"angharadScripts\", self.script.name, self.script);\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"angharadScriptsChanged\");\r\n\t\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant('script_save'), $translate.instant('script_save_error'));\r\n\t\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tangharadFactory.setScript(self.script.name, self.script).then(function () {\r\n\t\t\t\t\t\t\ttoaster.pop(\"success\", $translate.instant('script_save'), $translate.instant('script_save_success'));\r\n\t\t\t\t\t\t\tsharedData.add(\"angharadScripts\", self.script.name, self.script);\r\n\t\t\t\t\t\t\t$rootScope.$broadcast(\"angharadScriptsChanged\");\r\n\t\t\t\t\t\t}, function (error) {\r\n\t\t\t\t\t\t\ttoaster.pop(\"error\", $translate.instant('script_save'), $translate.instant('script_save_error'));\r\n\t\t\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n        };\r\n        \r\n        this.getBenoicElementDisplay = function (action) {\r\n\t\t\t\t\tvar element = sagremorService.getBenoicElement(action.parameters.device, action.parameters.element_type, action.element);\r\n\t\t\t\t\tif (!!element) {\r\n\t\t\t\t\t\treturn element.display;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn $translate.instant(\"not_found\");\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\r\n        this.getCarleonElementDisplay = function (action) {\r\n\t\t\t\t\tvar element = sagremorService.getCarleonElement(action.parameters.service, action.element);\r\n\t\t\t\t\tif (!!element) {\r\n\t\t\t\t\t\treturn element.name;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn $translate.instant(\"not_found\");\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.getCarleonElementParameters = function (action) {\r\n\t\t\t\t\tvar toReturn = [];\r\n\t\t\t\t\t_.forEach(action.parameters, function (parameter, key) {\r\n\t\t\t\t\t\tif (key !== \"service\") {\r\n\t\t\t\t\t\t\ttoReturn.push({name: key, value: parameter});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn toReturn;\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.getBenoicElementValue = function (action) {\r\n\t\t\t\t\tswitch (action.parameters.element_type) {\r\n\t\t\t\t\t\tcase \"switch\":\r\n\t\t\t\t\t\t\treturn action.command===1?$translate.instant(\"switch_on\"):$translate.instant(\"switch_off\");\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"dimmer\":\r\n\t\t\t\t\t\t\treturn action.command + \" %\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"heater\":\r\n\t\t\t\t\t\t\tvar heater = sagremorService.getBenoicElement(action.parameters.device, \"heater\", action.element);\r\n\t\t\t\t\t\t\tif (!!heater) {\r\n\t\t\t\t\t\t\t\tvar unit = heater.options.unit||\"\";\r\n\t\t\t\t\t\t\t\treturn action.command + \" \" + unit + \" (\" + action.parameters.mode + \")\";\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn \"error\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n        \r\n        this.cancelAddAction = function () {\r\n\t\t\t\t\tself.newAction = false;\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.saveNewAction = function () {\r\n\t\t\t\t\tself.script.actions.push(self.newAction);\r\n\t\t\t\t\tself.newActionType = false;\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tthis.isScriptValid = function () {\r\n\t\t\t\t\tif (!self.script.name) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar found = _.find(sharedData.all(\"angharadScripts\"), function (script) {\r\n\t\t\t\t\t\treturn script.name === self.script.name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!!found && self.add) {\r\n\t\t\t\t\t\tself.error.message = $translate.instant(\"script_error_name_exist\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.script.actions.length === 0) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tthis.isActionValid = function () {\r\n\t\t\t\t\tif (!self.newActionType) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!self.newAction.element) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (self.newActionType.submodule === \"carleon\") {\r\n\t\t\t\t\t\tif (!self.tmpElement) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar ret = true;\r\n\t\t\t\t\t\t_.forEach(self.carleonConditionCommandsParameters[self.newActionType.name], function (parameter, parameterName) {\r\n\t\t\t\t\t\t\tif (parameter.required && !self.newAction.parameters[parameter.name]) {\r\n\t\t\t\t\t\t\t\tret = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!ret) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.carleonCommand = function(command, service) {\r\n\t\t\t\t\tvar curCommand = _.find(self.scriptActionElements, function (action) {\r\n\t\t\t\t\t\treturn action.name === service + \"$\" + command;\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn curCommand?$translate.instant(curCommand.label):\"not found\";\r\n\t\t\t\t};\r\n\t\t\r\n\t\t\t\tthis.carleonParameter = function(parameter, service, command) {\r\n\t\t\t\t\tif (!!self.carleonConditionCommandsParameters) {\r\n\t\t\t\t\t\tvar curParameter = _.find(self.carleonConditionCommandsParameters[service + \"$\" + command], function (param) {\r\n\t\t\t\t\t\t\treturn param.name === parameter;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn curParameter?curParameter.title:\"not found\";\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n        \r\n        init();\r\n    });\r\n\nfunction sagSensorController (benoicFactory, sagremorParams, $translate) {\r\n    var ctrl = this;\r\n    \r\n    ctrl.adminMode = sagremorParams.adminMode;\r\n    ctrl.element.newDisplay = ctrl.element.display;\r\n    ctrl.messages = {};\r\n    \r\n    function init() {\r\n        ctrl.element.type = \"sensor\";\r\n    }\r\n    \r\n    ctrl.elementDisplayValue = function() {\r\n\t\tvar value = ctrl.element.value;\r\n\t\tif (!isNaN(parseFloat(value)) && isFinite(value)) {\r\n\t\t\tvalue = (Math.round(value * 100) / 100);\r\n\t\t}\r\n        if (!!ctrl.element && !!ctrl.element.options.unit) {\r\n\t\t\tvalue += \" \" + ctrl.element.options.unit\r\n\t\t}\r\n\t\treturn value;\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagSensor\", {\r\n    templateUrl: \"components/sensor/sensor.template.html\",\r\n    controller: sagSensorController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"sensor\",\r\n        directive: \"sag-sensor\",\r\n        carleonService: false\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"SensorsModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, sagremorConstant, benoicFactory, sensor) {\r\n        var self = this;\r\n        \r\n        this.sensor = sensor;\r\n        this.sensor.newDisplay = this.sensor.display;\r\n        \r\n        this.monitorEveryEnum = sagremorConstant.monitoredEveryEnum;\r\n        \r\n        function init() {\r\n\t\t\tself.sensor.menu = false;\r\n            \r\n            _.forEach(self.monitorEveryEnum, function(monitorEvery) {\r\n                $translate(monitorEvery.label).then(function (trLabel) {\r\n                    monitorEvery.trLabel = trLabel;\r\n                });\r\n            });\r\n        }\r\n        \r\n        this.tr = function (id) {\r\n\t\t\treturn $translate.instant(id);\r\n\t\t};\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.saveSensor = function () {\r\n            self.sensor.display = self.sensor.newDisplay;\r\n            self.sensor.monitor = self.sensor.monitorChecked?1:0;\r\n            benoicFactory.updateElement(self.sensor.device, \"sensor\", self.sensor.name, self.sensor).then(function (response) {\r\n                $scope.$broadcast(\"benoicSensorsChanged\");\r\n                toaster.pop(\"success\", $translate.instant(\"sensor_save\"), $translate.instant(\"sensor_save_success\"));\r\n            }, function (error) {\r\n                toaster.pop(\"error\", $translate.instant(\"sensor_save\"), $translate.instant(\"sensor_save_error\"));\r\n            })[\"finally\"](function () {\r\n                $uibModalInstance.dismiss(\"close\");\r\n            });\r\n        };\r\n        \r\n        init();\r\n    }\r\n);\r\n\nfunction sagMonitorController ($scope, $q, $translate, toaster, angharadFactory, benoicFactory, carleonFactory, sagremorParams, sagremorConstant, sharedData) {\r\n    var ctrl = this;\r\n    \r\n    this.elementList = [];\r\n    this.elementListDisplayed = [];\r\n    this.colorList = [];\r\n    this.newElement = false;\r\n    this.newElementColor = false;\r\n    this.durationList = sagremorConstant.durationList;\r\n    this.duration = {value: 4};\r\n    \r\n    this.data = [];\r\n    this.labels = [];\r\n    this.series = [];\r\n    \r\n    this.datasetOverride = [{\r\n\t\tfill: false\r\n\t}];\r\n\t\r\n\r\n\tthis.options = {\r\n\t\tchart: {\r\n\t\t\ttype: \"lineChart\",\r\n\t\t\tinterpolate:\"basis\",\r\n\t\t\tx: function(d) { return d.timestamp; },\r\n\t\t\ty: function(d) { return d.value; },\r\n\t\t\tshowValues: true,\r\n\t\t\tvalueFormat: function(d){\r\n\t\t\t\treturn d3.format(\",.2f\")(d);\r\n\t\t\t},\r\n\t\t\ttransitionDuration: 500,\r\n\t\t\txScale : d3.time.scale(),\r\n\t\t\txAxis: {\r\n\t\t\t\taxisLabel: $translate.instant(\"monitor_date_axis\")\r\n\t\t\t},\r\n\t\t\tyAxis: {\r\n\t\t\t\taxisLabel: \"\",\r\n\t\t\t\taxisLabelDistance: 30\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n    function init() {\r\n\t\tupdateDevices();\r\n\t\tctrl.displayMonitor();\r\n    }\r\n    \r\n    this.tr = function (value) {\r\n\t\treturn $translate.instant(value);\r\n\t};\r\n\t\r\n    $scope.$on(\"updateMonitor-\"+ctrl.element.name, function () {\r\n\t\tctrl.displayMonitor();\r\n\t});\r\n\t\r\n\tfunction updateDevices() {\r\n\t\tvar devices = sharedData.all(\"benoicDevices\");\r\n\t\t\r\n\t\t_.forEach(devices, function (device, deviceName) {\r\n\t\t\tif (!!device.element) {\r\n\t\t\t\t_.forEach(device.element.switches, function (element, name) {\r\n\t\t\t\t\tif (element.monitored && element.enabled) {\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tdevice: deviceName,\r\n\t\t\t\t\t\t\ttype: \"switch\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tctrl.elementList.push(elt);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\r\n\t\t_.forEach(devices, function (device, deviceName) {\r\n\t\t\tif (!!device.element) {\r\n\t\t\t\t_.forEach(device.element.dimmers, function (element, name) {\r\n\t\t\t\t\tif (element.monitored && element.enabled) {\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tdevice: deviceName,\r\n\t\t\t\t\t\t\ttype: \"dimmer\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tctrl.elementList.push(elt);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\r\n\t\t_.forEach(devices, function (device, deviceName) {\r\n\t\t\tif (!!device.element) {\r\n\t\t\t\t_.forEach(device.element.heaters, function (element, name) {\r\n\t\t\t\t\tif (element.monitored && element.enabled) {\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tdevice: deviceName,\r\n\t\t\t\t\t\t\ttype: \"heater\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tctrl.elementList.push(elt);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\r\n\t\t_.forEach(devices, function (device, deviceName) {\r\n\t\t\tif (!!device.element) {\r\n\t\t\t\t_.forEach(device.element.sensors, function (element, name) {\r\n\t\t\t\t\tif (element.monitored && element.enabled) {\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tdevice: deviceName,\r\n\t\t\t\t\t\t\ttype: \"sensor\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tctrl.elementList.push(elt);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n    this.addElement = function () {\r\n\t\tctrl.newElement.color = ctrl.newElementColor;\r\n\t\tctrl.element.elements.push(ctrl.newElement);\r\n\t\tangharadFactory.saveCurrentProfile().then(function () {\r\n\t\t\tctrl.displayMonitor();\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_error\"));\r\n\t\t})[\"finally\"](function () {\r\n\t\t});\r\n\t};\r\n\t\r\n\tthis.displayMonitor = function() {\r\n\t\tvar from = new Date();\r\n\t\t\r\n\t\tswitch (ctrl.duration.value) {\r\n\t\t\tcase 0:\r\n\t\t\t\tfrom.setTime(from.getTime() - 1*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tfrom.setTime(from.getTime() - 2*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tfrom.setTime(from.getTime() - 6*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tfrom.setTime(from.getTime() - 12*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tfrom.setTime(from.getTime() - 24*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tfrom.setTime(from.getTime() - 48*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tfrom.setTime(from.getTime() - 72*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 7:\r\n\t\t\t\tfrom.setTime(from.getTime() - 168*60*60*1000);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 8:\r\n\t\t\t\tfrom.setMonth(from.getMonth() - 1);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tctrl.colorList = angular.copy(sagremorConstant.colorList);\r\n\t\tctrl.elementListDisplayed = angular.copy(ctrl.elementList);\r\n\t\tvar httpMonitor = [];\r\n\t\t\r\n\t\t_.forEach(ctrl.element.elements, function (element) {\r\n\t\t\thttpMonitor.push(benoicFactory.getMonitor(element.device, element.type, element.name, Math.round(from.getTime() / 1000)));\r\n\t\t});\r\n\t\t\r\n\t\tctrl.data = [];\r\n\t\t$q.all(httpMonitor).then(function (results) {\r\n\t\t\tfor (key in results) {\r\n\t\t\t\t_.remove(ctrl.elementListDisplayed, function (curElement) {\r\n\t\t\t\t\treturn curElement.device === ctrl.element.elements[key].device &&\r\n\t\t\t\t\t\t\tcurElement.type === ctrl.element.elements[key].type &&\r\n\t\t\t\t\t\t\tcurElement.name === ctrl.element.elements[key].name;\r\n\t\t\t\t});\r\n\t\t\t\tctrl.series.push(ctrl.element.elements[key].display);\r\n                var myData = {\r\n\t\t\t\t\tkey: ctrl.element.elements[key].display,\r\n\t\t\t\t\tvalues: []\r\n                };\r\n                if (!!results[key] && results[key].length > 0) {\r\n\t\t\t\t\t_.forEach(results[key], function (monitor) {\r\n\t\t\t\t\t\tvar curDate = new Date(monitor.timestamp * 1000);\r\n\t\t\t\t\t\tvar value = {timestamp: curDate, value: parseFloat(monitor.value)};\r\n\t\t\t\t\t\tmyData.values.push(value);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tctrl.data.push(myData);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, function (error) {\r\n\t\t});\r\n\t}\r\n\t\r\n\tthis.newElementValid = function () {\r\n\t\treturn !!ctrl.newElement;\r\n\t};\r\n\t\r\n\tthis.removeSerie = function (serie) {\r\n\t\tif (ctrl.element.elements.indexOf(serie) >= 0) {\r\n\t\t\tctrl.element.elements.splice(ctrl.element.elements.indexOf(serie), 1);\r\n\t\t\tangharadFactory.saveCurrentProfile().then(function () {\r\n\t\t\t\tctrl.displayMonitor();\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"profile_save\"), $translate.instant(\"profile_save_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\tctrl.newElementColor = false;\r\n\t\t\t\tctrl.newElement = false;\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n    \r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"sagMonitor\", {\r\n    templateUrl: \"components/monitor/monitor.template.html\",\r\n    controller: sagMonitorController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"monitor\",\r\n        directive: \"sag-monitor\",\r\n        carleonService: false\r\n    });\r\n});\r\n\nfunction sagSwitchController (benoicFactory, sagremorParams, $translate) {\r\n    var ctrl = this;\r\n    \r\n    ctrl.element.valueChecked = (ctrl.element.value === 1);\r\n    ctrl.adminMode = sagremorParams.adminMode;\r\n    ctrl.element.newDisplay = ctrl.element.display;\r\n    ctrl.messages = {};\r\n    \r\n    function init() {\r\n        ctrl.element.type = \"switch\";\r\n    }\r\n    \r\n    ctrl.toggleSwitcher = function () {\r\n        ctrl.element.value = ctrl.element.valueChecked?1:0;\r\n        benoicFactory.setElement(ctrl.element.device, 'switch', ctrl.element.name, ctrl.element.value);\r\n    };\r\n    \r\n    init();\r\n}\r\n\r\nangular.module('sagremorApp').component('sagSwitch', {\r\n    templateUrl: 'components/switch/switch.template.html',\r\n    controller: sagSwitchController,\r\n    bindings: {\r\n        element: '='\r\n    }\r\n})\r\n.run(function(sagGenericInjectorManager) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"switch\",\r\n        directive: \"sag-switch\",\r\n        carleonService: false\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"SwitchesModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, sagremorConstant, benoicFactory, switcher) {\r\n        var self = this;\r\n        \r\n        this.switcher = switcher;\r\n        this.switcher.newDisplay = this.switcher.display;\r\n        \r\n        this.monitorEveryEnum = sagremorConstant.monitoredEveryEnum;\r\n        \r\n        function init() {\r\n\t\t\tself.switcher.menu = false;\r\n            \r\n            _.forEach(self.monitorEveryEnum, function(monitorEvery) {\r\n                $translate(monitorEvery.label).then(function (trLabel) {\r\n                    monitorEvery.trLabel = trLabel;\r\n                });\r\n            });\r\n        }\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.tr = function (id) {\r\n\t\t\treturn $translate.instant(id);\r\n\t\t};\r\n        \r\n        this.saveSwitcher = function () {\r\n            self.switcher.display = self.switcher.newDisplay;\r\n            self.switcher.monitor = self.switcher.monitorChecked?1:0;\r\n            benoicFactory.updateElement(self.switcher.device, \"switch\", self.switcher.name, self.switcher).then(function (response) {\r\n                $scope.$broadcast(\"benoicSwitchesChanged\");\r\n                toaster.pop(\"success\", $translate.instant(\"switch_save\"), $translate.instant(\"switch_save_success\"));\r\n            }, function (error) {\r\n                toaster.pop(\"error\", $translate.instant(\"switch_save\"), $translate.instant(\"switch_save_error\"));\r\n            })[\"finally\"](function () {\r\n                $uibModalInstance.dismiss(\"close\");\r\n            });\r\n        };\r\n        \r\n        init();\r\n    }\r\n);\r\n\nfunction topRightMenuCtrl($scope, $rootScope, $location, $http, $translate, $cookies, angharadFactory, sagremorConstant, sagremorParams, angharadConfig) {\r\n\tvar self = this;\r\n\r\n\tself.sagremorParams = sagremorParams;\r\n\r\n\tself.selectedLang = $translate.use();\r\n\r\n\tself.langList = sagremorConstant.langList;\r\n\r\n\tself.profiles = sagremorParams.profiles;\r\n\tself.currentProfileName = !!sagremorParams.currentProfile ? sagremorParams.currentProfile.name : \"\";\r\n\r\n\tself.oauth2 = angharadConfig.oauth2;\r\n\r\n\tif ($location.search().type) {\r\n\t\tself.oauth2.responseType = $location.search().type;\r\n\t}\r\n\r\n\tself.changeLang = function() {\r\n\t\t$translate.use(self.selectedLang).then(function() {\r\n\t\t\t$rootScope.$broadcast(\"changeLang\");\r\n\t\t});\r\n\t};\r\n\r\n\tself.changeProfile = function() {\r\n\t\t_.forEach(sagremorParams.profiles, function(profile) {\r\n\t\t\tif (profile.name === self.currentProfileName) {\r\n\t\t\t\tsagremorParams.currentProfile = profile;\r\n\t\t\t\tvar now = new Date();\r\n\t\t\t\tvar exp = new Date(now.getFullYear() + 10, now.getMonth(), now.getDate());\r\n\t\t\t\t$cookies.put(\"ANGHARAD_PROFILE\", self.currentProfileName, {\r\n\t\t\t\t\texpires: exp\r\n\t\t\t\t});\r\n\t\t\t\t$rootScope.$broadcast(\"angharadProfileUpdated\");\r\n\t\t\t\t$rootScope.$broadcast(\"refreshDashboard\");\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tself.refresh = function() {\r\n\t\t$rootScope.$broadcast(\"refresh\");\r\n\t};\r\n\r\n\tself.reconnect = function() {\r\n\t\t$rootScope.$broadcast(\"reconnect\");\r\n\t};\r\n\r\n\t$scope.$on(\"angharadProfileChanged\", function() {\r\n\t\tself.profiles = sagremorParams.profiles;\r\n\t\tself.currentProfileName = !!sagremorParams.currentProfile ? sagremorParams.currentProfile.name : \"\";\r\n\t});\r\n\r\n\t$scope.$on(\"angharadProfileUpdated\", function() {\r\n\t\tself.profiles = sagremorParams.profiles;\r\n\t\tself.currentProfileName = !!sagremorParams.currentProfile ? sagremorParams.currentProfile.name : \"\";\r\n\t});\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"topRightMenu\", {\r\n\ttemplateUrl: \"components/topRightMenu/topRightMenu.template.html\",\r\n\tcontroller: topRightMenuCtrl,\r\n\tcontrollerAs: \"topRightMenuCtrl\"\r\n});\r\n\nfunction topLeftMenuCtrl ($scope, $translate, sagremorParams, sagGenericInjectorManager, sharedData) {\r\n    var self = this;\r\n    \r\n    this.serviceList = [];\r\n    this.sagremorParams = sagremorParams;\r\n    \r\n    function init() {\r\n\t\tself.loadMenu();\r\n\t}\r\n\t\r\n\tthis.loadMenu = function () {\r\n\t\tself.serviceList = [];\r\n\t\t_.forEach(sagGenericInjectorManager.components, function (inject) {\r\n\t\t\tvar service = sharedData.get(\"carleonServices\", inject.type);\r\n\t\t\tif (inject.carleonService && inject.leftMenu && !!service && service.enabled) {\r\n\t\t\t\tvar menu = inject.leftMenu;\r\n\t\t\t\tmenu.icon = inject.icon;\r\n\t\t\t\tif (!_.find(self.serviceList, {target: menu.target})) {\r\n\t\t\t\t\tself.serviceList.push(menu);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n    \r\n    /**\r\n     * Because I couldn't find how to do it with otherwise...\r\n     */\r\n    this.selectTab = function (tabName) {\r\n        $(\".sag-menu\").removeClass(\"active\");\r\n        $(tabName).addClass(\"active\");\r\n    };\r\n    \r\n\t$scope.$on(\"submodulesChanged\", function () {\r\n\t\tself.sagremorParams = sagremorParams;\r\n\t});\r\n\t\r\n\t$scope.$on(\"carleonServicesChanged\", function () {\r\n\t\tself.loadMenu();\r\n\t});\r\n\r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"topLeftMenu\", {\r\n    templateUrl: \"components/topLeftMenu/topLeftMenu.template.html\",\r\n    controller: topLeftMenuCtrl,\r\n    controllerAs: \"topLeftMenuCtrl\"\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"ConfirmModalCtrl\",\r\n    function($uibModalInstance, title, message) {\r\n        var self = this;\r\n        \r\n        this.title = title;\r\n        this.message = message;\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.ok = function () {\r\n            $uibModalInstance.close(\"ok\");\r\n        };\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"EditModalCtrl\",\r\n    function($uibModalInstance, title, message, placeholder) {\r\n        var self = this;\r\n        \r\n        this.title = title;\r\n        this.message = message;\r\n        this.placeholder = placeholder;\r\n        this.value = \"\";\r\n        \r\n        this.cancel = function () {\r\n            $uibModalInstance.dismiss(\"cancel\");\r\n        };\r\n        \r\n        this.ok = function () {\r\n            $uibModalInstance.close({reason: \"close\", value: self.value});\r\n        };\r\n        \r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"ImageModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, title, src) {\r\n        var self = this;\r\n        \r\n        this.title = title;\r\n        this.src = src;\r\n        \r\n        function init() {\r\n        }\r\n        \r\n        this.close = function () {\r\n            $uibModalInstance.dismiss(\"close\");\r\n        };\r\n        \r\n        this.displayTitle = function () {\r\n\t\t\treturn $translate.instant(\"image_title\") + self.title;\r\n\t\t};\r\n\t\t\r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"MonitorModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, benoicFactory, sagremorConstant, element) {\r\n        var self = this;\r\n        \r\n        this.element = element;\r\n        this.data = [];\r\n        this.durationList = sagremorConstant.durationList;\r\n        this.duration = {value: 4};\r\n        \r\n\t\tthis.options = {\r\n\t\t\tchart: {\r\n\t\t\t\ttype: \"lineChart\",\r\n\t\t\t\tinterpolate:\"basis\",\r\n\t\t\t\tx: function(d) { return d.timestamp; },\r\n\t\t\t\ty: function(d) { return d.value; },\r\n\t\t\t\tshowValues: true,\r\n\t\t\t\tvalueFormat: function(d){\r\n\t\t\t\t\treturn d3.format(\",.2f\")(d);\r\n\t\t\t\t},\r\n\t\t\t\ttransitionDuration: 500,\r\n\t\t\t\txScale : d3.time.scale(),\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\taxisLabel: $translate.instant(\"monitor_date_axis\")\r\n\t\t\t\t},\r\n\t\t\t\tyAxis: {\r\n\t\t\t\t\taxisLabel: element.options.unit,\r\n\t\t\t\t\taxisLabelDistance: 30\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n        function init() {\r\n\t\t\tself.getMonitor();\r\n        }\r\n        \r\n        this.getMonitor = function () {\r\n\t\t\tvar from = new Date();\r\n\t\t\t\r\n\t\t\tswitch (self.duration.value) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 1*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 2*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 6*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 12*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 24*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 48*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 6:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 72*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 7:\r\n\t\t\t\t\tfrom.setTime(from.getTime() - 168*60*60*1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 8:\r\n\t\t\t\t\tfrom.setMonth(from.getMonth() - 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n            benoicFactory.getMonitor(element.device, element.type, element.name, Math.round(from.getTime() / 1000)).then(function (result) {\r\n                self.data = [];\r\n                var myData = {\r\n\t\t\t\t\tkey: element.display,\r\n\t\t\t\t\tvalues: []\r\n                };\r\n                if (!!result && result.length > 0) {\r\n\t\t\t\t\t_.forEach(result, function (monitor) {\r\n\t\t\t\t\t\tvar curDate = new Date(monitor.timestamp * 1000);\r\n\t\t\t\t\t\tvar value = {timestamp: curDate, value: parseFloat(monitor.value)};\r\n\t\t\t\t\t\tmyData.values.push(value);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tself.data.push(myData);\r\n\t\t\t\t}\r\n            });\r\n\t\t}\r\n        \r\n        this.tr = function (value) {\r\n\t\t\treturn $translate.instant(value);\r\n\t\t};\r\n        \r\n        this.close = function () {\r\n            $uibModalInstance.dismiss(\"close\");\r\n        };\r\n        \r\n        this.displayTitle = function () {\r\n\t\t\treturn $translate.instant(\"monitor_title\") + element.display;\r\n\t\t};\r\n\t\t\r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"ScriptBindElementModalCtrl\",\r\n    function($scope, $uibModalInstance, $translate, toaster, DTOptionsBuilder, sharedData, sagGenericInjectorManager, angharadFactory, script) {\r\n        var self = this;\r\n        \r\n        this.script = script;\r\n        \r\n        this.elementList = [];\r\n        this.options = {};\r\n        this.tmpCheck = [];\r\n        \r\n        function init() {\r\n\t\t\tif (!self.script.options.tags) {\r\n\t\t\t\tself.script.options.tags = [];\r\n\t\t\t}\r\n\t\t\tif ($translate.use()) {\r\n\t\t\t\tself.options = DTOptionsBuilder.newOptions()\r\n\t\t\t\t\t\t\t\t.withLanguageSource(\"components/core/i18n/datatables.\"+$translate.use()+\".json\")\r\n\t\t\t\t\t\t\t\t.withOption(\"order\", [])\r\n\t\t\t\t\t\t\t\t.withOption(\"scrollY\", \"200px\")\r\n\t\t\t\t\t\t\t\t.withOption(\"paging\", false);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_.forEach(sharedData.all(\"benoicDevices\"), function (device) {\r\n\t\t\t\tif (device.enabled && device.connected) {\r\n\t\t\t\t\t_.forEach(device.element.switches, function(element, name) {\r\n\t\t\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\t\t\treturn tag === \"SGMR$SCR$B$\" + device.name + \"$switch$\" + name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tsubmodule: \"benoic\", \r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"switch\",\r\n\t\t\t\t\t\t\ttypeTitle: $translate.instant(\"switch_title\"),\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tselected: selected\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.dimmers, function(element, name) {\r\n\t\t\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\t\t\treturn tag === \"SGMR$SCR$B$\" + device.name + \"$dimmer$\" + name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tsubmodule: \"benoic\", \r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"dimmer\",\r\n\t\t\t\t\t\t\ttypeTitle: $translate.instant(\"dimmer_title\"),\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tselected: selected\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.heaters, function(element, name) {\r\n\t\t\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\t\t\treturn tag === \"SGMR$SCR$B$\" + device.name + \"$heater$\" + name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tsubmodule: \"benoic\", \r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"heater\",\r\n\t\t\t\t\t\t\ttypeTitle: $translate.instant(\"heater_title\"),\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tselected: selected\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.forEach(device.element.sensors, function(element, name) {\r\n\t\t\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\t\t\treturn tag === \"SGMR$SCR$B$\" + device.name + \"$sensor$\" + name;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\t\tsubmodule: \"benoic\", \r\n\t\t\t\t\t\t\tdevice: device.name,\r\n\t\t\t\t\t\t\ttype: \"sensor\",\r\n\t\t\t\t\t\t\ttypeTitle: $translate.instant(\"sensor_title\"),\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\tdisplay: element.display,\r\n\t\t\t\t\t\t\tselected: selected\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t_.forEach(sharedData.all(\"angharadSchedulers\"), function (scheduler) {\r\n\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\treturn tag === \"SGMR$SCR$A$scheduler$\" + scheduler.name;\r\n\t\t\t\t});\r\n\t\t\t\tvar elt = {\r\n\t\t\t\t\tsubmodule: \"angharad\", \r\n\t\t\t\t\ttype: \"scheduler\",\r\n\t\t\t\t\ttypeTitle: $translate.instant(\"scheduler_title\"),\r\n\t\t\t\t\tname: scheduler.name,\r\n\t\t\t\t\tdisplay: scheduler.name,\r\n\t\t\t\t\tselected: selected\r\n\t\t\t\t}\r\n\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t});\r\n\r\n\t\t\t_.forEach(sharedData.all(\"carleonServices\"), function (service, serviceName) {\r\n\t\t\t\tvar inject = _.find(sagGenericInjectorManager.components, function (inject) {\r\n\t\t\t\t\treturn inject.type === serviceName && service.enabled;\r\n\t\t\t\t});\r\n\t\t\t\t_.forEach(service.element, function (element) {\r\n\t\t\t\t\tvar selected = !!_.find(self.script.options.tags, function (tag) {\r\n\t\t\t\t\t\treturn tag === \"SGMR$SCR$C$\" + serviceName + \"$\" + element.name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar elt = {\r\n\t\t\t\t\t\tsubmodule: \"carleon\", \r\n\t\t\t\t\t\ttype: serviceName,\r\n\t\t\t\t\t\ttypeTitle: $translate.instant(inject.groupTitle),\r\n\t\t\t\t\t\tname: element.name, \r\n\t\t\t\t\t\tdisplay: element.name, \r\n\t\t\t\t\t\tselected: selected\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.elementList.push(elt);\r\n\t\t\t\t\tself.tmpCheck.push(selected);\r\n\t\t\t\t});\r\n\t\t\t});\r\n        }\r\n        \r\n        this.selectRow = function (index) {\r\n\t\t\tself.elementList[index].selected = !self.elementList[index].selected;\r\n\t\t\tself.tmpCheck[index] = self.elementList[index].selected;\r\n\t\t};\r\n\t\t\r\n\t\tthis.cancel = function () {\r\n\t\t\t$uibModalInstance.dismiss(\"cancel\");\r\n\t\t};\r\n\t\t\r\n\t\tthis.ok = function () {\r\n\t\t\t// Script tag format: SGMR$SCR$<submodule>[$<device>]$<type>$name\r\n\t\t\t\r\n\t\t\t// First, remove all tags starting with SGMR$SCR$ for the current script\r\n\t\t\t_.remove(self.script.options.tags, function (tag) {\r\n\t\t\t\treturn tag.startsWith(\"SGMR$SCR$\");\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// Second, add a tag for all selected elements\r\n\t\t\tvar selectedElements = _.filter(self.elementList, function (element) {\r\n\t\t\t\treturn element.selected;\r\n\t\t\t});\r\n\t\t\t_.forEach(selectedElements, function (element) {\r\n\t\t\t\tvar tag = \"SGMR$SCR$\";\r\n\t\t\t\tif (element.submodule === \"benoic\") {\r\n\t\t\t\t\ttag += \"B$\" + element.device + \"$\" + element.type + \"$\" + element.name;\r\n\t\t\t\t} else if (element.submodule === \"carleon\") {\r\n\t\t\t\t\ttag += \"C$\" + element.type + \"$\" + element.name;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttag += \"A$\" + element.type + \"$\" + element.name;\r\n\t\t\t\t}\r\n\t\t\t\tself.script.options.tags.push(tag);\r\n\t\t\t});\r\n\t\t\tangharadFactory.setScript(self.script.name, self.script).then(function () {\r\n\t\t\t\tsharedData.add(\"angharadScripts\", self.script.name, self.script);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"script_save\"), $translate.instant(\"script_save_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"script_save\"), $translate.instant(\"script_save_error\"));\r\n\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t});\r\n\t\t};\r\n\t\t\r\n        init();\r\n    }\r\n);\r\n\nfunction carleonLiquidsoapController ($scope, $sce, $q, $window, $translatePartialLoader, $translate, $interval, angharadConfig, carleonFactory, carleonLiquidsoapFactory, sagremorService, sagremorParams, toaster) {\r\n    var ctrl = this;\r\n    \r\n    this.radio = {};\r\n\tthis.status = \"\";\r\n    this.onAir = {\r\n\t\ttitle: \"\",\r\n\t\tartist: \"\",\r\n\t\talbumartist: \"\",\r\n\t\tyear: \"\",\r\n\t\talbum: \"\"\r\n\t};\r\n\tthis.list = [];\r\n\tthis.listSelected = {\r\n\t\ttitle: \"\",\r\n\t\tartist: \"\",\r\n\t\talbumartist: \"\",\r\n\t\tyear: \"\",\r\n\t\talbum: \"\"\r\n\t};\r\n    \r\n    this.onAirAccordionOpen = false;\r\n    this.listAccordionOpen = false;\r\n    \r\n    function init() {\r\n\t\tcarleonLiquidsoapFactory.getLiquidsoapService(ctrl.element.name).then(function (result) {\r\n\t\t\tctrl.radio = result;\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_init\"), $translate.instant(\"carleon_liquidsoap_init_error\"));\r\n\t\t});\r\n    }\r\n    \r\n    this.commandRadio = function (command) {\r\n\t\tcarleonLiquidsoapFactory.command(ctrl.element.name, command).then(function (result) {\r\n\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_liquidsoap_command\"), $translate.instant(\"carleon_liquidsoap_command_success\"));\r\n\t\t\tctrl.refreshStatus();\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_command\"), $translate.instant(\"carleon_liquidsoap_command_error\"));\r\n\t\t});\r\n\t};\r\n    \r\n\t$scope.$watch(\"$ctrl.controlAccordionOpen\", function(isOpen){\r\n\t\tif (isOpen) {\r\n\t\t\tctrl.refreshStatus();\r\n\t\t}\r\n\t});\r\n\t\r\n\t$scope.$watch(\"$ctrl.onAirAccordionOpen\", function(isOpen){\r\n\t\tif (isOpen) {\r\n\t\t\tctrl.refreshOnAir();\r\n\t\t}\r\n\t});\r\n\t\r\n\t$scope.$watch(\"$ctrl.listAccordionOpen\", function(isOpen){\r\n\t\tif (isOpen) {\r\n\t\t\tctrl.refreshList();\r\n\t\t}\r\n\t});\r\n\t\r\n\tthis.refreshStatus = function () {\r\n\t\tcarleonLiquidsoapFactory.command(ctrl.element.name, \"status\").then(function (result) {\r\n\t\t\tctrl.status = result.value;\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_status\"), $translate.instant(\"carleon_liquidsoap_status_error\"));\r\n\t\t});\r\n\t};\r\n\t\r\n\tthis.refreshOnAir = function () {\r\n\t\tcarleonLiquidsoapFactory.onAir(ctrl.element.name).then(function (result) {\r\n\t\t\tctrl.onAir = result;\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_on_air\"), $translate.instant(\"carleon_liquidsoap_on_air_error\"));\r\n\t\t});\r\n\t};\r\n\t\r\n\tthis.refreshList = function () {\r\n\t\tcarleonLiquidsoapFactory.list(ctrl.element.name).then(function (result) {\r\n\t\t\tctrl.list = result;\r\n\t\t}, function () {\r\n\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_list\"), $translate.instant(\"carleon_liquidsoap_list_error\"));\r\n\t\t});\r\n\t};\r\n\t\r\n    init();\r\n}\r\n\r\nangular.module(\"sagremorApp\").component(\"serviceLiquidsoap\", {\r\n    templateUrl: \"components/carleonLiquidsoap/carleonLiquidsoap.template.html\",\r\n    controller: carleonLiquidsoapController,\r\n    bindings: {\r\n        element: \"=\"\r\n    }\r\n})\r\n.directive(\"radio\", function($sce) {\r\n\t// Using directive from Hols: http://stackoverflow.com/a/23663352\r\n\treturn {\r\n\t\trestrict: \"A\",\r\n\t\tscope: { src: \"=\" },\r\n\t\treplace: true,\r\n\t\ttemplate: \"<audio data-ng-src=\\\"{{url}}\\\" controls></audio>\",\r\n\t\tlink: function (scope) {\r\n\t\t\tscope.$watch(\"src\", function (newVal, oldVal) {\r\n\t\t\t\tif (newVal !== undefined) {\r\n\t\t\t\t\tscope.url = $sce.trustAsResourceUrl(newVal);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n})\r\n.factory(\"carleonLiquidsoapFactory\", function($http, $uibModal, $translate, toaster, angharadConfig, angharadBackendService, sagremorConfirm, sharedData) {\r\n    var urlBase = angharadConfig.baseUrl + angharadConfig.prefixCarleon;\r\n    var carleonLiquidsoapFactory = {};\r\n\r\n\t/* Liquidsoap service */\r\n    carleonLiquidsoapFactory.getLiquidsoapServiceList = function () {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-liquidsoap/\");\r\n    };\r\n\r\n    carleonLiquidsoapFactory.getLiquidsoapService = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-liquidsoap/\" + name);\r\n    };\r\n\r\n    carleonLiquidsoapFactory.addLiquidsoapService = function (liquidsoapService) {\r\n        return angharadBackendService.httpRequest(\"POST\", urlBase + \"service-liquidsoap/\", liquidsoapService);\r\n    };\r\n\r\n    carleonLiquidsoapFactory.setLiquidsoapService = function (name, liquidsoapService) {\r\n        return angharadBackendService.httpRequest(\"PUT\", urlBase + \"service-liquidsoap/\" + name, liquidsoapService);\r\n    };\r\n\r\n    carleonLiquidsoapFactory.removeLiquidsoapService = function (name) {\r\n        return angharadBackendService.httpRequest(\"DELETE\", urlBase + \"service-liquidsoap/\" + name);\r\n    };\r\n\r\n    carleonLiquidsoapFactory.list = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-liquidsoap/\" + name + \"/list\");\r\n    };\r\n\r\n    carleonLiquidsoapFactory.onAir = function (name) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-liquidsoap/\" + name + \"/on_air\");\r\n    };\r\n\r\n    carleonLiquidsoapFactory.command = function (name, command) {\r\n        return angharadBackendService.httpRequest(\"GET\", urlBase + \"service-liquidsoap/\" + name + \"/command/\" + command);\r\n    };\r\n\r\n\tcarleonLiquidsoapFactory.addService = function () {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonLiquidsoap/carleonLiquidsoap.modal.html\",\r\n\t\t\tcontroller: \"carleonLiquidsoapModalCtrl\",\r\n\t\t\tcontrollerAs: \"carleonLiquidsoapModalCtrl\",\r\n\t\t\tsize: \"md\",\r\n\t\t\tresolve: {\r\n\t\t\t\telement: function () {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tcarleonLiquidsoapFactory.editService = function (service) {\r\n\t\tvar modalInstance = $uibModal.open({\r\n\t\t\tanimation: true,\r\n\t\t\ttemplateUrl: \"components/carleonLiquidsoap/carleonLiquidsoap.modal.html\",\r\n\t\t\tcontroller: \"carleonLiquidsoapModalCtrl\",\r\n\t\t\tcontrollerAs: \"carleonLiquidsoapModalCtrl\",\r\n\t\t\tsize: \"md\",\r\n\t\t\tresolve: {\r\n\t\t\t\telement: function () {\r\n\t\t\t\t\treturn service;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tcarleonLiquidsoapFactory.removeService = function (service) {\r\n\t\treturn sagremorConfirm.open($translate.instant(\"carleon_liquidsoap_remove\"), $translate.instant(\"carleon_liquidsoap_remove_confirm\")).then(function () {\r\n\t\t\treturn carleonLiquidsoapFactory.removeLiquidsoapService(service.name).then(function () {\r\n\t\t\t\tvar injector = sharedData.get(\"carleonServices\", \"service-liquidsoap\");\r\n\t\t\t\t_.remove(injector.element, function (element) {\r\n\t\t\t\t\treturn element.name === service.name;\r\n\t\t\t\t});\r\n\t\t\t\tsharedData.add(\"carleonServices\", \"service-liquidsoap\", injector);\r\n\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_liquidsoap_remove\"), $translate.instant(\"carleon_liquidsoap_remove_success\"));\r\n\t\t\t}, function () {\r\n\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_remove\"), $translate.instant(\"carleon_liquidsoap_remove_error\"));\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n    return carleonLiquidsoapFactory;\r\n\r\n})\r\n.config(function run($translatePartialLoaderProvider) {\r\n\t$translatePartialLoaderProvider.addPart(\"carleonLiquidsoap\");\r\n})\r\n.run(function(sagGenericInjectorManager, carleonLiquidsoapFactory) {\r\n    sagGenericInjectorManager.add({\r\n        type: \"service-liquidsoap\",\r\n        directive: \"service-liquidsoap\",\r\n        groupTitle: \"carleon_liquidsoap_title\",\r\n        service: carleonLiquidsoapFactory,\r\n        carleonService: true,\r\n        size: 2,\r\n        leftMenu: {\r\n\t\t\ttitle: \"carleon_music_title\",\r\n\t\t\ttarget: \"music\"\r\n\t\t},\r\n\t\twidgetHeight: 4,\r\n\t\twidgetWidth: 3,\r\n\t\ticon: \"music\",\r\n\t\tcommands: {\r\n\t\t}\r\n    });\r\n});\r\n\nangular.module(\"sagremorApp\")\r\n    .controller(\"carleonLiquidsoapModalCtrl\", \r\n    function($rootScope, $uibModalInstance, $translate, sharedData, toaster, carleonLiquidsoapFactory, element) {\r\n        var self = this;\r\n\r\n        this.messages = {};\r\n        this.add = true;\r\n        this.element = {\r\n\t\t\tname: \"\",\r\n\t\t\tdescription: \"\",\r\n\t\t\tradio_url: \"\",\r\n\t\t\tradio_type: \"\",\r\n\t\t\tcontrol_enabled: false,\r\n\t\t\tcontrol_host: \"\",\r\n\t\t\tcontrol_port: 0,\r\n\t\t\tcontrol_request_name: \"\"\r\n\t\t}\r\n\r\n        function init() {\r\n\t\t\tif (!!element) {\r\n\t\t\t\tself.element = _.find(sharedData.get(\"carleonServices\", \"service-liquidsoap\").element, function (elt) {\r\n\t\t\t\t\treturn elt.name === element.name;\r\n\t\t\t\t});\r\n\t\t\t\tself.add = false;\r\n\t\t\t}\r\n        }\r\n        \r\n        this.isLiquidsoapValid = function () {\r\n\t\t\tvar found = _.find(sharedData.get(\"carleonServices\", \"service-liquidsoap\").element, function (element) {\r\n\t\t\t\treturn element.name === self.element.name;\r\n\t\t\t});\r\n\t\t\treturn (!found || !self.add) \r\n\t\t\t\t\t&& !!self.element.name\r\n\t\t\t\t\t&& !!self.element.radio_url \r\n\t\t\t\t\t&& (!self.element.control_enabled \r\n\t\t\t\t\t\t|| (!!self.element.control_host && !!self.element.control_port && !!self.element.control_request_name));\r\n\t\t};\r\n        \r\n        this.save = function () {\r\n\t\t\tif (self.add) {\r\n\t\t\t\tcarleonLiquidsoapFactory.addLiquidsoapService(self.element).then(function () {\r\n\t\t\t\t\tself.element.type = \"service-liquidsoap\";\r\n\t\t\t\t\tself.element.service = carleonLiquidsoapFactory;\r\n\t\t\t\t\tsharedData.get(\"carleonServices\", \"service-liquidsoap\").element.push(self.element);\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_liquidsoap_save\"), $translate.instant(\"carleon_liquidsoap_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_save\"), $translate.instant(\"carleon_liquidsoap_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcarleonLiquidsoapFactory.setLiquidsoapService(self.element.name, self.element).then(function () {\r\n\t\t\t\t\tself.element.type = \"service-liquidsoap\";\r\n\t\t\t\t\tself.element.service = carleonLiquidsoapFactory;\r\n\t\t\t\t\t$rootScope.$broadcast(\"carleonServicesChanged\");\r\n\t\t\t\t\ttoaster.pop(\"success\", $translate.instant(\"carleon_liquidsoap_save\"), $translate.instant(\"carleon_liquidsoap_save_success\"));\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\ttoaster.pop(\"error\", $translate.instant(\"carleon_liquidsoap_save\"), $translate.instant(\"carleon_liquidsoap_save_error\"));\r\n\t\t\t\t})[\"finally\"](function () {\r\n\t\t\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n        this.cancel = function () {\r\n\t\t\t$uibModalInstance.dismiss(\"close\");\r\n\t\t};\r\n\r\n        init();\r\n    }\r\n);\r\n\nangular.module(\"sagremorApp\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/error/error.html\",\"<div><div class=\\\"container\\\"><h1 data-translate=\\\"{{ErrorCtrl.errorMessage}}\\\"></h1></div></div>\");\n$templateCache.put(\"app/dashboard/dashboard.html\",\"<div><h1 data-translate=\\\"dashboard_title\\\"></h1><h2 data-ng-bind=\\\"DashboardCtrl.profileName\\\"></h2><div class=\\\"row\\\" data-ng-if=\\\"DashboardCtrl.sagremorParams.adminMode\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" name=\\\"addTitleLine\\\" id=\\\"addTitleLine\\\" data-ng-click=\\\"DashboardCtrl.addTitleLine()\\\" data-translate=\\\"dashboard_button_add_title_line\\\"></button><hr></div><div class=\\\"row\\\"><div class=\\\"col-md-12\\\"><div data-gridstack=\\\"\\\" class=\\\"grid-stack grid1\\\" data-options=\\\"DashboardCtrl.options\\\" data-on-change=\\\"DashboardCtrl.onChange(event, items)\\\"><div data-gridstack-item=\\\"\\\" data-ng-repeat=\\\"w in DashboardCtrl.dashboardWidgetsDisplay\\\" class=\\\"grid-stack-item\\\" data-gs-no-resize=\\\"true\\\" data-gs-item-x=\\\"w.x\\\" data-gs-item-y=\\\"w.y\\\" data-gs-item-width=\\\"w.width\\\" data-gs-item-height=\\\"w.height\\\" data-gs-min-width=\\\"3\\\" data-gs-item-autopos=\\\"0\\\" data-sag-type=\\\"{{w.type}}\\\" data-sag-device=\\\"{{w.device}}\\\" data-sag-name=\\\"{{w.name}}\\\" data-sag-profile=\\\"{{w.profile}}\\\"><div class=\\\"grid-stack-item-content\\\" data-ng-if=\\\"w.type !== \\'separator\\'\\\"><data-sag-container data-menu=\\\"DashboardCtrl.menu\\\" data-size=\\\"1\\\" data-title=\\\"w.element.display || w.element.name\\\" data-element=\\\"w\\\" data-dashboard=\\\"true\\\" data-type=\\\"w.type\\\" data-sag-params=\\\"DashboardCtrl.sagremorParams\\\" data-icon=\\\"w.icon\\\"><div data-sag-generic-injector=\\\"\\\" data-type=\\\"w.type\\\" data-elt=\\\"w.element\\\"></div></data-sag-container></div><div data-ng-if=\\\"w.type === \\'separator\\'\\\"><div class=\\\"sag-container-header-menu\\\" data-uib-dropdown=\\\"\\\"><button class=\\\"btn btn-primary text-left\\\" data-ng-if=\\\"DashboardCtrl.sagremorParams.adminMode\\\" type=\\\"button\\\" data-uib-dropdown-toggle=\\\"\\\" data-ng-click=\\\"\\\">#</button><ul data-uib-dropdown-menu=\\\"\\\"><li><a href=\\\"\\\" data-ng-click=\\\"DashboardCtrl.removeFromDashboard(w)\\\" data-translate=\\\"remove_from_dashboard\\\"></a></li></ul><fieldset class=\\\"grid-stack-item-content\\\" dir=\\\"ltr\\\"><legend data-ng-bind=\\\"w.name\\\" class=\\\"sag-separator\\\"></legend></fieldset></div></div></div></div></div></div><div class=\\\"row\\\" data-ng-if=\\\"!DashboardCtrl.connected\\\"><div class=\\\"col-md-12\\\"><h3 data-translate=\\\"connect_message\\\"></h3></div></div></div>\");\n$templateCache.put(\"app/heaters/heaters.html\",\"<div><h1 data-translate=\\\"heaters_title\\\"></h1><div class=\\\"row\\\"><div data-ng-repeat=\\\"heater in heatersCtrl.heaterList\\\" class=\\\"col-sm-3\\\" data-ng-if=\\\"heater.enabled || heatersCtrl.sagremorParams.adminMode\\\"><data-sag-container data-menu=\\\"heatersCtrl.menuSensor\\\" data-size=\\\"1\\\" data-title=\\\"heater.display\\\" data-type=\\\"\\'heater\\'\\\" data-element=\\\"heater\\\" data-icon=\\\"\\'fire\\'\\\"><data-sag-heater data-element=\\\"heater\\\"></data-sag-heater></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/events/events.html\",\"<div><h1 data-translate=\\\"events_title\\\"></h1><div class=\\\"row\\\" data-ng-if=\\\"eventsCtrl.sagremorParams.adminMode\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" name=\\\"addEvent\\\" id=\\\"addEvent\\\" data-ng-click=\\\"eventsCtrl.newEvent()\\\" data-translate=\\\"events_button_add\\\"></button></div><hr data-ng-if=\\\"eventsCtrl.schedulerList.length > 0\\\"><h2 data-translate=\\\"schedulers_title\\\" data-ng-if=\\\"eventsCtrl.schedulerList.length > 0\\\"></h2><div class=\\\"row\\\"><div data-ng-repeat=\\\"scheduler in eventsCtrl.schedulerList track by $index\\\" class=\\\"col-sm-3\\\"><data-sag-container data-menu=\\\"eventsCtrl.menuScheduler\\\" data-size=\\\"1\\\" data-title=\\\"scheduler.name\\\" data-type=\\\"\\'scheduler\\'\\\" data-element=\\\"scheduler\\\" data-icon=\\\"\\'calendar\\'\\\"><data-sag-scheduler data-element=\\\"scheduler\\\"></data-sag-scheduler></data-sag-container></div></div><hr data-ng-if=\\\"eventsCtrl.triggerList.length > 0\\\"><h2 data-translate=\\\"triggers_title\\\" data-ng-if=\\\"eventsCtrl.triggerList.length > 0\\\"></h2><div class=\\\"row\\\"><div data-ng-repeat=\\\"trigger in eventsCtrl.triggerList track by $index\\\" class=\\\"col-sm-3\\\"><data-sag-container data-menu=\\\"eventsCtrl.menuTrigger\\\" data-size=\\\"1\\\" data-title=\\\"trigger.name\\\" data-type=\\\"\\'trigger\\'\\\" data-element=\\\"trigger\\\" data-icon=\\\"\\'bell\\'\\\"><data-sag-trigger data-element=\\\"trigger\\\"></data-sag-trigger></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/logs/filters.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal_title\\\" data-translate=\\\"logs_filter_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-4 controls\\\" data-ng-if=\\\"!FiltersModalCtrl.displayAlert\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.newFilter()\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_filter_new_button\\\"></span></button></div><div class=\\\"col-xs-4 controls\\\" data-ng-if=\\\"!FiltersModalCtrl.displayAlert\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.showAlerts()\\\"><i class=\\\"fa fa-bolt\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_alerts_delete_button\\\"></span></button></div><div class=\\\"col-xs-4 controls\\\" data-ng-if=\\\"FiltersModalCtrl.displayAlert\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.showFilters()\\\"><i class=\\\"fa fa-bolt\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_filters_show_button\\\"></span></button></div></div><div data-ng-if=\\\"FiltersModalCtrl.editFilter && !FiltersModalCtrl.displayAlert\\\"><hr><h3 data-translate=\\\"filter_table_edit\\\" data-ng-if=\\\"!FiltersModalCtrl.addFilter\\\"></h3><h3 data-translate=\\\"filter_table_new\\\" data-ng-if=\\\"FiltersModalCtrl.addFilter\\\"></h3><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"filter_table_name\\\"></th><th data-translate=\\\"filter_table_description\\\"></th></tr></thead><tbody><tr><td><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"filterName\\\" id=\\\"filterName\\\" data-ng-model=\\\"FiltersModalCtrl.customFilter.name\\\" data-ng-disabled=\\\"!FiltersModalCtrl.addFilter\\\"></td><td><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"filterDescription\\\" id=\\\"filterDescription\\\" data-ng-model=\\\"FiltersModalCtrl.customFilter.description\\\"></td></tr></tbody></table><div class=\\\"row control-group\\\"><div class=\\\"col-xs-4 controls\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.addClause()\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_clause_new_button\\\"></span></button></div><div class=\\\"col-xs-4 controls\\\"><div data-uib-dropdown=\\\"\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.addAlert()\\\" data-uib-dropdown-toggle=\\\"\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_alert_new_button\\\"></span></button><ul data-uib-dropdown-menu=\\\"\\\"><li data-ng-repeat=\\\"menuItem in FiltersModalCtrl.menu\\\"><a href=\\\"\\\" data-ng-click=\\\"FiltersModalCtrl.menuSelect(menuItem, $ctrl.element)\\\" data-ng-bind=\\\"menuItem.display\\\"></a></li></ul></div></div></div><h3 data-translate=\\\"filter_table_clauses\\\"></h3><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"clause_table_element\\\"></th><th data-translate=\\\"clause_table_operator\\\"></th><th data-translate=\\\"clause_table_value\\\"></th><th></th><th></th></tr></thead><tbody><tr data-ng-if=\\\"FiltersModalCtrl.newClause\\\"><td><select class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.customClause.element\\\"><option value=\\\"priority\\\" data-translate=\\\"clause_option_priority\\\"></option><option value=\\\"source\\\" data-translate=\\\"clause_option_source\\\"></option><option value=\\\"message\\\" data-translate=\\\"clause_option_message\\\"></option><option value=\\\"tag\\\" data-translate=\\\"clause_option_tag\\\"></option></select></td><td><select class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.customClause.operator\\\"><option value=\\\"=\\\" data-translate=\\\"clause_operator_equal\\\"></option><option value=\\\"!=\\\" data-translate=\\\"clause_operator_different\\\"></option><option value=\\\"<\\\" data-translate=\\\"clause_operator_lower\\\"></option><option value=\\\"<=\\\" data-translate=\\\"clause_operator_lower_equal\\\"></option><option value=\\\">\\\" data-translate=\\\"clause_operator_higher\\\"></option><option value=\\\">=\\\" data-translate=\\\"clause_operator_higher_equal\\\"></option><option value=\\\"contains\\\" data-translate=\\\"clause_operator_contains\\\"></option><option value=\\\"notcontains\\\" data-translate=\\\"clause_operator_notcontains\\\"></option></select></td><td><select class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.customClause.value\\\" data-ng-if=\\\"FiltersModalCtrl.customClause.element === \\'priority\\'\\\"><option value=\\\"0\\\" data-translate=\\\"logs_priority_none\\\"></option><option value=\\\"1\\\" data-translate=\\\"logs_priority_low\\\"></option><option value=\\\"2\\\" data-translate=\\\"logs_priority_medium\\\"></option><option value=\\\"3\\\" data-translate=\\\"logs_priority_high\\\"></option><option value=\\\"4\\\" data-translate=\\\"logs_priority_critical\\\"></option></select><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customClause.value\\\" data-ng-if=\\\"FiltersModalCtrl.customClause.element !== \\'priority\\'\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.addNewClause()\\\" data-ng-disabled=\\\"!FiltersModalCtrl.isClauseValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.cancelAddClause()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-repeat=\\\"clause in FiltersModalCtrl.customFilter.filter_clauses track by $index\\\"><td data-ng-bind=\\\"FiltersModalCtrl.getClauseElement(clause.element)\\\"></td><td data-ng-bind=\\\"FiltersModalCtrl.getClauseOperator(clause.operator)\\\"></td><td data-ng-bind=\\\"FiltersModalCtrl.getClauseValue(clause)\\\"></td><td></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeClause($index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table><h3 data-translate=\\\"filter_table_alerts\\\"></h3><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"alert_table_name\\\"></th><th data-translate=\\\"alert_table_type\\\"></th><th></th></tr></thead><tbody><tr data-ng-repeat=\\\"alert in FiltersModalCtrl.customFilter.filter_alerts.smtp track by $index\\\"><td data-ng-bind=\\\"alert\\\"></td><td>SMTP</td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeAlert(\\'smtp\\', $index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-repeat=\\\"alert in FiltersModalCtrl.customFilter.filter_alerts.http track by $index\\\"><td data-ng-bind=\\\"alert\\\"></td><td>HTTP</td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeAlert(\\'http\\', $index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table><div data-ng-if=\\\"FiltersModalCtrl.newAlertSmtp\\\"><div class=\\\"row control-group\\\"><h3 data-translate=\\\"alert_smtp_title\\\"></h3><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_select\\\"></label></div><div class=\\\"controls col-xs-6\\\"><select id=\\\"logsSearchFilter\\\" class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.existingSmtpAlert\\\" data-ng-options=\\\"alert.name for alert in FiltersModalCtrl.AlertSmtpList\\\" data-ng-disabled=\\\"!FiltersModalCtrl.AlertSmtpList || FiltersModalCtrl.AlertSmtpList.length === 0\\\"><option value=\\\"\\\"></option></select></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-12 text-center\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_or\\\"></label></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_name\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input required=\\\"\\\" type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.name\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_host\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" required=\\\"\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.host\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_port\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"number\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.port\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_tls\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.tls\\\" data-ng-checked=\\\"false\\\" data-switch-active=\\\"{{!FiltersModalCtrl.existingSmtpAlert}}\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_check_ca\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.check_ca\\\" data-ng-checked=\\\"false\\\" data-switch-active=\\\"{{!FiltersModalCtrl.existingSmtpAlert}}\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_user\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.user\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_password\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.password\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_from\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-uib-tooltip=\\\"{{\\'alert_smtp_emails_tooltip\\' | translate}}\\\" required=\\\"\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.from\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_to\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" required=\\\"\\\" data-uib-tooltip=\\\"{{\\'alert_smtp_emails_tooltip\\' | translate}}\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.to\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_cc\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-uib-tooltip=\\\"{{\\'alert_smtp_emails_tooltip\\' | translate}}\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.cc\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_bcc\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-uib-tooltip=\\\"{{\\'alert_smtp_emails_tooltip\\' | translate}}\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.bcc\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_subject\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-uib-tooltip=\\\"{{\\'alert_subject_body_tooltip\\' | translate}}\\\" required=\\\"\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.subject\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_smtp_body\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-uib-tooltip=\\\"{{\\'alert_subject_body_tooltip\\' | translate}}\\\" required=\\\"\\\" data-ng-model=\\\"FiltersModalCtrl.customSmtpAlert.body\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingSmtpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"></div><div class=\\\"controls col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.postNewSmtpAlert()\\\" data-ng-disabled=\\\"!FiltersModalCtrl.isSmtpAlertValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.cancelAddSmtpAlert()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></div></div><hr></div><div data-ng-if=\\\"FiltersModalCtrl.newAlertHttp\\\"><h3 data-translate=\\\"alert_http_title\\\"></h3><div class=\\\"row control-group required\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_select\\\"></label></div><div class=\\\"controls col-xs-6\\\"><select id=\\\"logsSearchFilter\\\" class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.existingHttpAlert\\\" data-ng-options=\\\"alert.name for alert in FiltersModalCtrl.AlertHttpList\\\" data-ng-disabled=\\\"!FiltersModalCtrl.AlertHttpList || FiltersModalCtrl.AlertHttpList.length === 0\\\"><option value=\\\"\\\"></option></select></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-12 text-center\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_or\\\"></label></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_name\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input required=\\\"\\\" type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlert.name\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingHttpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_method\\\"></label></div><div class=\\\"controls col-xs-6\\\"><select required=\\\"\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlertMethodSelect\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingHttpAlert\\\"><option value=\\\"GET\\\">GET</option><option value=\\\"POST\\\">POST</option><option value=\\\"PUT\\\">PUT</option><option value=\\\"DELETE\\\">DELETE</option><option value=\\\"custom\\\" data-translate=\\\"alert_http_method_other\\\"></option></select></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"FiltersModalCtrl.customHttpAlertMethodSelect === \\'custom\\'\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_method_custom\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlert.method\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingHttpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_url\\\"></label></div><div class=\\\"controls col-xs-6\\\"><input required=\\\"\\\" type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlert.url\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"FiltersModalCtrl.existingHttpAlert\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_body\\\"></label></div><div class=\\\"controls col-xs-6\\\"><textarea data-uib-tooltip=\\\"{{\\'alert_subject_body_tooltip\\' | translate}}\\\" required=\\\"\\\" class=\\\"form-control\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlert.body\\\">\\r\\n\t\t\t\t\t\t</textarea></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_headers\\\"></label></div><div class=\\\"controls col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.addAlertHttpHeader()\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i></button></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-translate=\\\"alert_http_header_key\\\"></label></div><div class=\\\"controls col-xs-6\\\"><label data-translate=\\\"alert_http_header_value\\\"></label></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"FiltersModalCtrl.newAlertHttpHeader && !FiltersModalCtrl.existingHttpAlert\\\"><div class=\\\"controls col-xs-4\\\"><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlertHeader.key\\\" class=\\\"form-control\\\"></div><div class=\\\"controls col-xs-4\\\"><input type=\\\"text\\\" data-ng-model=\\\"FiltersModalCtrl.customHttpAlertHeader.value\\\" class=\\\"form-control\\\"></div><div class=\\\"controls col-xs-4\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.addNewAlertHttpHeader()\\\" data-ng-disabled=\\\"!FiltersModalCtrl.customHttpAlertHeader.key || !FiltersModalCtrl.customHttpAlertHeader.value\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.cancelAddAlertHttpHeader()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></div></div><div class=\\\"row control-group\\\" data-ng-repeat=\\\"header in FiltersModalCtrl.customHttpAlert.http_headers\\\"><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-ng-bind=\\\"header.key\\\"></label></div><div class=\\\"controls col-xs-6\\\"><label class=\\\"control-label\\\" data-ng-bind=\\\"header.value\\\"></label></div></div><div class=\\\"row control-group\\\"><div class=\\\"controls col-xs-6\\\"></div><div class=\\\"controls col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.postNewHttpAlert()\\\" data-ng-disabled=\\\"!FiltersModalCtrl.isHttpAlertValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.cancelAddHttpAlert()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></div></div><hr></div><div class=\\\"row control-group\\\"><div class=\\\"col-xs-6\\\"></div><div class=\\\"col-xs-3\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary pull-right\\\" data-ng-click=\\\"FiltersModalCtrl.postNewFilter()\\\" data-ng-disabled=\\\"!FiltersModalCtrl.isFilterValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"btn_ok\\\"></span></button></div><div class=\\\"col-xs-3\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary pull-right\\\" data-ng-click=\\\"FiltersModalCtrl.cancelNewFilter()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"btn_cancel\\\"></span></button></div></div></div><div data-ng-if=\\\"!FiltersModalCtrl.editFilter && !FiltersModalCtrl.displayAlert\\\"><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"filter_table_name\\\"></th><th data-translate=\\\"filter_table_description\\\"></th><th data-translate=\\\"filter_table_clauses\\\"></th><th data-translate=\\\"filter_table_alerts\\\"></th><th></th></tr></thead><tr data-ng-repeat=\\\"filter in FiltersModalCtrl.filterList track by $index\\\"><td data-ng-bind=\\\"filter.name\\\"></td><td data-ng-bind=\\\"filter.description\\\"></td><td><div class=\\\"row-fluid\\\" data-ng-repeat=\\\"clause in filter.filter_clauses\\\"><span data-ng-bind=\\\"FiltersModalCtrl.getClauseElement(clause.element)\\\"></span> <span data-ng-bind=\\\"FiltersModalCtrl.getClauseOperator(clause.operator)\\\"></span> <span data-ng-bind=\\\"FiltersModalCtrl.getClauseValue(clause)\\\"></span></div></td><td><div class=\\\"row\\\" data-ng-if=\\\"filter.filter_alerts.smtp.length\\\"><div class=\\\"col-xs-3\\\"><strong><span data-translate=\\\"logs_alert_list_smtp\\\"></span></strong></div><div class=\\\"col-xs-9\\\"><span class=\\\"pull-right\\\" data-ng-bind=\\\"filter.filter_alerts.smtp.join(\\', \\')\\\"></span></div></div><div class=\\\"row\\\" data-ng-if=\\\"filter.filter_alerts.http.length\\\"><div class=\\\"col-xs-3\\\"><strong><span data-translate=\\\"logs_alert_list_http\\\"></span></strong></div><div class=\\\"col-xs-9\\\"><span class=\\\"pull-right\\\" data-ng-bind=\\\"filter.filter_alerts.http.join(\\', \\')\\\"></span></div></div></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.editCustomFilter(filter)\\\"><i class=\\\"fa fa-pencil\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeCustomFilter(filter)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></table></div><div data-ng-if=\\\"FiltersModalCtrl.displayAlert\\\"><h4 data-translate=\\\"logs_menu_smtp\\\"></h4><div class=\\\"row\\\" data-ng-repeat=\\\"alertSmtp in FiltersModalCtrl.AlertSmtpList\\\"><div class=\\\"col-xs-2\\\"></div><div class=\\\"col-xs-4\\\" data-ng-bind=\\\"alertSmtp.name\\\"></div><div class=\\\"col-xs-4\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeSmtpAlert(alertSmtp)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></div></div><h4 data-translate=\\\"logs_menu_http\\\"></h4><div class=\\\"row\\\" data-ng-repeat=\\\"alertHttp in FiltersModalCtrl.AlertHttpList\\\"><div class=\\\"col-xs-2\\\"></div><div class=\\\"col-xs-4\\\" data-ng-bind=\\\"alertHttp.name\\\"></div><div class=\\\"col-xs-4\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"FiltersModalCtrl.removeHttpAlert(alertHttp)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></div></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"FiltersModalCtrl.close()\\\" data-translate=\\\"btn_close\\\"></button></div></div>\");\n$templateCache.put(\"app/logs/logs.html\",\"<div><h1 data-translate=\\\"logs_title\\\"></h1><div class=\\\"row control-group\\\"><div class=\\\"col-xs-1 controls\\\"><label for=\\\"logsSearchLimit\\\" data-translate=\\\"logs_search_limit\\\"></label></div><div class=\\\"col-xs-2 controls\\\"><input type=\\\"number\\\" min=\\\"1\\\" class=\\\"form-control\\\" name=\\\"logsSearchLimit\\\" id=\\\"logsSearchLimit\\\" data-ng-model=\\\"logsCtrl.searchOptions.limit\\\"></div><div class=\\\"col-xs-1 controls\\\"><label for=\\\"logsSearchOffset\\\" data-translate=\\\"logs_search_offset\\\"></label></div><div class=\\\"col-xs-2 controls\\\"><input type=\\\"number\\\" min=\\\"0\\\" class=\\\"form-control\\\" name=\\\"logsSearchOffset\\\" id=\\\"logsSearchOffset\\\" data-ng-model=\\\"logsCtrl.searchOptions.offset\\\"></div><div class=\\\"col-xs-1 controls\\\"><label for=\\\"logsSearchFilter\\\" data-translate=\\\"logs_search_filter\\\"></label></div><div class=\\\"col-xs-2 controls\\\"><select id=\\\"logsSearchFilter\\\" class=\\\"form-control\\\" data-ng-model=\\\"logsCtrl.searchOptions.filter\\\" data-ng-options=\\\"filter.name for filter in logsCtrl.filterList\\\" data-ng-disabled=\\\"logsCtrl.filterList.length === 0\\\"><option value=\\\"\\\"></option></select></div><div class=\\\"col-xs-3\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary pull-right\\\" data-ng-click=\\\"logsCtrl.search()\\\" style=\\\"margin-left: 5px; margin-bottom: 5px;\\\"><i class=\\\"fa fa-search\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_search_button\\\"></span></button> <button type=\\\"button\\\" class=\\\"btn btn-primary pull-right\\\" data-ng-click=\\\"logsCtrl.filterManagement()\\\" style=\\\"margin-left: 5px; margin-bottom: 5px;\\\"><i class=\\\"fa fa-filter\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"logs_filter_button\\\"></span></button></div></div><hr><table data-datatable=\\\"ng\\\" data-dt-options=\\\"logsCtrl.options\\\" class=\\\"table table-hover table-striped table-bordered dataTable\\\"><thead><tr><th data-translate=\\\"logs_table_date\\\"></th><th data-translate=\\\"logs_table_priority\\\"></th><th data-translate=\\\"logs_table_source\\\"></th><th data-translate=\\\"logs_table_text\\\"></th><th data-translate=\\\"logs_table_tags\\\"></th></tr></thead><tbody><tr data-ng-repeat=\\\"message in logsCtrl.messageList\\\"><td>{{message.date | date : \\'medium\\'}}</td><td>{{logsCtrl.getPriority(message)}}</td><td>{{message.source}}</td><td>{{message.text}}</td><td><span data-ng-repeat=\\\"tag in message.tags\\\">{{tag}}</span></td></tr></tbody></table></div>\");\n$templateCache.put(\"app/login/login.html\",\"<div class=\\\"col-xs-6 controls\\\"><label data-translate=\\\"top_right_menu_login\\\" data-ng-if=\\\"responseType !== \\'password\\' && show==\\'logged-out\\'\\\"></label> <label data-translate=\\\"top_right_menu_logout\\\" data-ng-if=\\\"show==\\'logged-in\\'\\\"></label> <label data-translate=\\\"top_right_menu_access_denied\\\" data-ng-if=\\\"responseType !== \\'password\\' && show==\\'denied\\'\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary btn-sm\\\" data-ng-if=\\\"responseType !== \\'password\\' && show==\\'logged-out\\' || show==\\'denied\\'\\\" data-ng-click=\\\"login()\\\"><i class=\\\"fa fa-sign-in\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn btn-primary btn-sm\\\" data-ng-if=\\\"show==\\'logged-in\\'\\\" data-ng-click=\\\"logout()\\\"><i class=\\\"fa fa-sign-out\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"col-xs-12\\\"><div data-ng-show=\\\"responseType === \\'password\\' && show !== \\'logged-in\\'\\\"><form><div><label>Login</label> <input type=\\\"text\\\" data-ng-model=\\\"typedLogin\\\" placeholder=\\\"login\\\"></div><div><label>Password</label> <input type=\\\"password\\\" data-ng-model=\\\"typedPassword\\\" placeholder=\\\"password\\\"></div><div><label>Keep connection</label> <input type=\\\"checkbox\\\" data-ng-model=\\\"typedKeepConnection\\\"></div><input type=\\\"submit\\\" class=\\\"btn btn-primary btn-sm\\\" value=\\\"Submit\\\" data-ng-click=\\\"checkPassword()\\\"></form></div></div>\");\n$templateCache.put(\"app/monitors/monitors.html\",\"<div><h1 data-translate=\\\"monitors_title\\\"></h1><div class=\\\"row\\\" data-ng-if=\\\"monitorsCtrl.sagremorParams.adminMode\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" name=\\\"addMonitor\\\" id=\\\"addMonitor\\\" data-ng-click=\\\"monitorsCtrl.newMonitor()\\\" data-translate=\\\"monitors_button_add\\\"></button></div><hr><div class=\\\"row\\\"><div data-ng-repeat=\\\"monitor in monitorsCtrl.monitorList track by monitor.name\\\" class=\\\"col-sm-6\\\"><data-sag-container data-menu=\\\"monitorsCtrl.menu\\\" data-title=\\\"monitor.name\\\" data-type=\\\"\\'monitor\\'\\\" data-element=\\\"monitor\\\" data-icon=\\\"\\'bar-chart\\'\\\"><data-sag-monitor data-element=\\\"monitor\\\"></data-sag-monitor></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/parameters/parameters.html\",\"<div><h1 data-translate=\\\"parameters_title\\\"></h1><h3 data-translate=\\\"param_submodule_title\\\"></h3><div class=\\\"row\\\"><div class=\\\"col-xs-2\\\"><label for=\\\"submodule-benoic\\\" data-translate=\\\"param_submodule_benoic\\\"></label></div><div class=\\\"col-xs-2\\\"><input data-ng-change=\\\"ParametersCtrl.submoduleEnable(\\'benoic\\')\\\" id=\\\"submodule-benoic\\\" name=\\\"submodule-benoic\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ParametersCtrl.submodules.benoic.enabled\\\"></div><div class=\\\"col-xs-2\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"ParametersCtrl.reloadBenoicDeviceTypes()\\\" data-ng-disabled=\\\"!ParametersCtrl.submodules.benoic.enabled\\\"><i aria-hidden=\\\"true\\\" class=\\\"fa fa-refresh\\\"></i> <span data-translate=\\\"param_submodule_benoic_reload_types\\\"></span></button></div></div><h4 data-translate=\\\"param_benoic_device_type_list\\\"></h4><div class=\\\"row\\\" data-ng-repeat=\\\"type in ParametersCtrl.deviceTypes track by $index\\\"><div class=\\\"col-xs-2\\\" data-ng-bind=\\\"type.name\\\"></div><div class=\\\"col-xs-2\\\"><input data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"type.enabled\\\" data-switch-active=\\\"false\\\"></div></div><hr><div class=\\\"row\\\"><div class=\\\"col-xs-2\\\"><label for=\\\"submodule-carleon\\\" data-translate=\\\"param_submodule_carleon\\\"></label></div><div class=\\\"col-xs-2\\\"><input data-ng-change=\\\"ParametersCtrl.submoduleEnable(\\'carleon\\')\\\" id=\\\"submodule-carleon\\\" name=\\\"submodule-carleon\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ParametersCtrl.submodules.carleon.enabled\\\"></div><div class=\\\"col-xs-2\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"ParametersCtrl.reloadCarleonServices()\\\" data-ng-disabled=\\\"!ParametersCtrl.submodules.carleon.enabled\\\"><i aria-hidden=\\\"true\\\" class=\\\"fa fa-refresh\\\"></i> <span data-translate=\\\"param_submodule_carleon_reload_services\\\"></span></button></div></div><h4 data-translate=\\\"param_carleon_service_list\\\"></h4><div class=\\\"row\\\" data-ng-repeat=\\\"service in ParametersCtrl.serviceList track by $index\\\"><div class=\\\"col-xs-2\\\" data-ng-bind=\\\"service.name\\\"></div><div class=\\\"col-xs-2\\\"><input data-ng-change=\\\"ParametersCtrl.enableCarleonService(service)\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"service.enabled\\\"></div></div><hr><div class=\\\"row\\\"><div class=\\\"col-xs-2\\\"><label for=\\\"submodule-gareth\\\" data-translate=\\\"param_submodule_gareth\\\"></label></div><div class=\\\"col-xs-2\\\"><input data-ng-change=\\\"ParametersCtrl.submoduleEnable(\\'gareth\\')\\\" id=\\\"submodule-gareth\\\" name=\\\"submodule-gareth\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ParametersCtrl.submodules.gareth.enabled\\\"></div></div><div data-ng-if=\\\"ParametersCtrl.sagremorParams.benoicEnabled\\\"><h3 data-translate=\\\"param_device_list\\\"></h3><form name=\\\"deviceList\\\" class=\\\"css-form\\\"><button type=\\\"button\\\" data-ng-click=\\\"ParametersCtrl.addDevice()\\\" class=\\\"btn\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i></button><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"device_name\\\"></th><th data-translate=\\\"device_description\\\"></th><th data-translate=\\\"device_type\\\"></th><th data-translate=\\\"device_connected\\\"></th><th data-translate=\\\"device_action\\\"></th></tr></thead><tbody><tr data-ng-repeat=\\\"(name, device) in ParametersCtrl.deviceList track by name\\\" data-ng-class=\\\"{\\'device-disabled\\': !device.enabled}\\\"><td>{{device.name}}</td><td data-ng-if=\\\"!device.update\\\">{{device.description}}</td><td data-ng-if=\\\"device.update\\\"><input type=\\\"text\\\" name=\\\"deviceDesc\\\" id=\\\"deviceDesc\\\" data-ng-model=\\\"device.newDescription\\\" value=\\\"{{device.newDescription}}\\\"></td><td>{{device.type_uid + \\'_device_type\\' | translate}}</td><td><input data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"device.connected\\\" data-ng-change=\\\"ParametersCtrl.connectDevice(device)\\\"></td><td data-ng-if=\\\"!device.update\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.editDevice(device)\\\"><i class=\\\"fa fa-pencil\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.removeDevice(device)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td><td data-ng-if=\\\"device.update\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.saveDevice(device)\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.cancelEditDevice(device)\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-if=\\\"ParametersCtrl.deviceAdded\\\"><td><input type=\\\"text\\\" data-ng-model=\\\"ParametersCtrl.newDeviceName\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"64\\\" maxlength=\\\"64\\\" placeholder=\\\"{{\\'device_name_placeholder\\' | translate}}\\\"></td><td><input type=\\\"text\\\" data-ng-model=\\\"ParametersCtrl.newDeviceDescription\\\" data-ng-maxlength=\\\"128\\\" maxlength=\\\"128\\\" placeholder=\\\"{{\\'device_description_placeholder\\' | translate}}\\\"></td><td><select data-ng-required=\\\"\\\" data-ng-model=\\\"ParametersCtrl.newDeviceType\\\" data-ng-options=\\\"device.uid as device.translate for device in ParametersCtrl.deviceTypesEnabled\\\" data-ng-change=\\\"ParametersCtrl.setDeviceOptions()\\\"></select></td><td><input data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ParametersCtrl.newDeviceConnect\\\"></td><td></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.postNewDevice()\\\" data-ng-disabled=\\\"!ParametersCtrl.isDeviceValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.cancelNewDevice()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table><h3 data-ng-if=\\\"(ParametersCtrl.deviceAdded || ParametersCtrl.deviceUpdated) && ParametersCtrl.deviceOptionListDisplay\\\" data-translate=\\\"device_options_title\\\"></h3><div data-ng-if=\\\"(ParametersCtrl.deviceAdded || ParametersCtrl.deviceUpdated) && ParametersCtrl.deviceOptionListDisplay\\\" data-ng-repeat=\\\"(optionName, option) in ParametersCtrl.deviceOptionList track by optionName\\\" class=\\\"container\\\"><div class=\\\"row\\\"><div class=\\\"col-xs-3\\\" data-ng-class=\\\"{\\'device-option-required\\': !option.optional}\\\">{{ParametersCtrl.newDeviceType + \\\"_\\\" + option.name | translate}}</div><div class=\\\"col-xs-3\\\" data-ng-if=\\\"option.type === \\'string\\'\\\"><input type=\\\"text\\\" data-ng-model=\\\"option.value\\\" data-ng-required=\\\"!option.optional\\\" placeholder=\\\"{{ParametersCtrl.newDeviceType + \\'_\\' + option.name + \\'_placeholder\\' | translate}}\\\"></div><div class=\\\"col-xs-3\\\" data-ng-if=\\\"option.type === \\'numeric\\'\\\"><input type=\\\"number\\\" data-ng-model=\\\"option.value\\\" data-ng-required=\\\"!option.optional\\\" placeholder=\\\"{{ParametersCtrl.newDeviceType + \\'_\\' + option.name + \\'_placeholder\\' | translate}}\\\"></div><div class=\\\"col-xs-3\\\" data-ng-if=\\\"option.type === \\'boolean\\'\\\"><input data-toggle=\\\"toggle\\\" type=\\\"checkbox\\\" data-ng-model=\\\"option.value\\\" data-ng-required=\\\"!option.optional\\\"></div></div></div></form></div><div data-ng-if=\\\"ParametersCtrl.sagremorParams.carleonEnabled\\\"><h3 data-translate=\\\"param_profiles_list\\\"></h3><button type=\\\"button\\\" data-ng-click=\\\"ParametersCtrl.addProfile()\\\" class=\\\"btn\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i></button><table class=\\\"table table-hover\\\"><thead><tr><th data-translate=\\\"profile_name\\\"></th><th data-translate=\\\"profile_description\\\"></th><th data-translate=\\\"profile_default\\\"></th><th data-translate=\\\"profile_use\\\"></th><th data-translate=\\\"profile_action\\\"></th></tr></thead><tbody><tr data-ng-repeat=\\\"profile in ParametersCtrl.profileList track by profile.name\\\"><td data-ng-if=\\\"!profile.update\\\">{{profile.name}}</td><td data-ng-if=\\\"!profile.update\\\">{{profile.description}}</td><td data-ng-if=\\\"profile.update\\\"><input type=\\\"text\\\" name=\\\"profileName\\\" id=\\\"profileName\\\" data-ng-model=\\\"profile.newName\\\" placeholder=\\\"{{\\'profile_name_placeholder\\' | translate}}\\\"></td><td data-ng-if=\\\"profile.update\\\"><input type=\\\"text\\\" name=\\\"profileDescription\\\" id=\\\"profileDescription\\\" data-ng-model=\\\"profile.newDescription\\\" placeholder=\\\"{{\\'profile_description_placeholder\\' | translate}}\\\"></td><td><input data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"profile.default\\\" data-ng-change=\\\"ParametersCtrl.setDefaultProfile(profile)\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" name=\\\"useProfile\\\" id=\\\"useProfile\\\" data-ng-click=\\\"ParametersCtrl.useProfile(profile)\\\" data-ng-if=\\\"profile.name !== ParametersCtrl.currentProfile.name\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <span data-ng-if=\\\"profile.name === ParametersCtrl.currentProfile.name\\\" data-translate=\\\"profile_used\\\"></span></td><td data-ng-if=\\\"!profile.update\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.editProfile(profile)\\\"><i class=\\\"fa fa-pencil\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.cleanProfile(profile)\\\"><i class=\\\"fa fa-eraser\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.removeProfile(profile)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td><td data-ng-if=\\\"profile.update\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.saveProfile(profile)\\\" data-ng-disabled=\\\"!ParametersCtrl.isUpdateProfileValid(profile)\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.cancelEditProfile(profile)\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-if=\\\"ParametersCtrl.profileAdded\\\"><td><input type=\\\"text\\\" data-ng-model=\\\"ParametersCtrl.newProfileName\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"64\\\" maxlength=\\\"64\\\" placeholder=\\\"{{\\'profile_name_placeholder\\' | translate}}\\\"></td><td><input type=\\\"text\\\" data-ng-model=\\\"ParametersCtrl.newProfileDescription\\\" data-ng-maxlength=\\\"128\\\" maxlength=\\\"128\\\" placeholder=\\\"{{\\'profile_description_placeholder\\' | translate}}\\\"></td><td><input data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ParametersCtrl.newProfileDefault\\\"></td><td></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.saveNewProfile()\\\" data-ng-disabled=\\\"!ParametersCtrl.isProfileValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ParametersCtrl.cancelNewProfile()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table></div></div>\");\n$templateCache.put(\"app/scripts/scripts.html\",\"<div><h1 data-translate=\\\"scripts_title\\\"></h1><div class=\\\"row\\\" data-ng-if=\\\"scriptsCtrl.sagremorParams.adminMode\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" name=\\\"addScript\\\" id=\\\"addScript\\\" data-ng-click=\\\"scriptsCtrl.newScript()\\\" data-translate=\\\"scripts_button_add\\\"></button></div><hr><div class=\\\"row\\\"><div data-ng-repeat=\\\"script in scriptsCtrl.scriptList track by script.name\\\" class=\\\"col-sm-3\\\"><data-sag-container data-menu=\\\"scriptsCtrl.menuScript\\\" data-size=\\\"1\\\" data-title=\\\"script.name\\\" data-type=\\\"\\'script\\'\\\" data-element=\\\"script\\\" data-icon=\\\"\\'tasks\\'\\\"><data-sag-script data-element=\\\"script\\\"></data-sag-script></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/sensors/sensors.html\",\"<div><h1 data-translate=\\\"sensors_title\\\"></h1><div class=\\\"row\\\"><div data-ng-repeat=\\\"sensor in sensorsCtrl.sensorList\\\" class=\\\"col-sm-3\\\" data-ng-if=\\\"sensor.enabled || sensorsCtrl.sagremorParams.adminMode\\\"><data-sag-container data-menu=\\\"sensorsCtrl.menuSensor\\\" data-size=\\\"1\\\" data-title=\\\"sensor.display\\\" data-type=\\\"\\'sensor\\'\\\" data-element=\\\"sensor\\\" data-icon=\\\"\\'line-chart\\'\\\"><data-sag-sensor data-element=\\\"sensor\\\"></data-sag-sensor></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/service/service.html\",\"<div><h1 data-translate=\\\"{{serviceCtrl.title}}\\\"></h1><div data-ng-repeat=\\\"service in serviceCtrl.serviceList\\\"><h3 data-translate=\\\"{{service.serviceGroup.title}}\\\"></h3><div class=\\\"row\\\" data-ng-if=\\\"serviceCtrl.sagremorParams.adminMode\\\"><div class=\\\"span6\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"serviceCtrl.addService(service.serviceGroup.service)\\\" data-translate=\\\"service_add\\\"></button></div></div><div class=\\\"row\\\"><data-sag-container data-ng-repeat=\\\"element in service.list\\\" data-menu=\\\"service.menu\\\" data-title=\\\"element.display || element.name\\\" data-type=\\\"element.type\\\" data-element=\\\"element\\\" data-icon=\\\"service.currentInjector.icon\\\" data-ng-class=\\\"{\\'col-md-2\\': !service.size || service.size === 1, \\'col-md-4\\': service.size === 2, \\'col-md-6\\': service.size === 3}\\\"><div data-sag-generic-injector=\\\"\\\" data-type=\\\"element.type\\\" data-elt=\\\"element\\\"></div></data-sag-container></div></div></div>\");\n$templateCache.put(\"app/users/users.html\",\"<div class=\\\"container\\\"><h1 data-translate=\\\"users_title\\\"></h1><h2 data-translate=\\\"users_user_list\\\"></h2><h4 data-ng-if=\\\"!usersCtrl.usersEnabled\\\" data-translate=\\\"users_user_disabled\\\"></h4><button type=\\\"button\\\" data-ng-click=\\\"usersCtrl.addUser()\\\" class=\\\"btn btn-primary\\\" data-translate=\\\"users_add_user\\\" data-ng-if=\\\"usersCtrl.usersEnabled\\\"></button><table class=\\\"table table-hover\\\" data-ng-if=\\\"usersCtrl.usersEnabled\\\"><thead><tr><th data-translate=\\\"users_table_login\\\"></th><th data-translate=\\\"users_table_password\\\"></th><th data-translate=\\\"users_table_enabled\\\"></th><th></th></tr></thead><tbody><tr data-ng-repeat=\\\"user in usersCtrl.userList\\\"><td data-ng-bind=\\\"user.login\\\"></td><td data-ng-if=\\\"!user.changePassword\\\">***</td><td data-ng-if=\\\"!!user.changePassword\\\"><input type=\\\"password\\\" data-ng-model=\\\"user.password\\\" maxlength=\\\"128\\\"></td><td><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-change=\\\"usersCtrl.enableUser(user)\\\" data-ng-model=\\\"user.enabled\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.displayChangePassword(user)\\\" data-ng-if=\\\"!user.changePassword\\\" title=\\\"{{ \\'users_user_change_password\\' | translate }}\\\"><i class=\\\"fa fa-key\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.removeUser(user)\\\" data-ng-if=\\\"!user.changePassword\\\" title=\\\"{{ \\'users_user_delete\\' | translate }}\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.changePassword(user)\\\" data-ng-disabled=\\\"user.password.length === 0\\\" data-ng-if=\\\"!!user.changePassword\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.cancelChangePassword(user)\\\" data-ng-if=\\\"!!user.changePassword\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-if=\\\"usersCtrl.newUser\\\"><td><input type=\\\"text\\\" data-ng-model=\\\"usersCtrl.user.login\\\" maxlength=\\\"128\\\"></td><td><input type=\\\"password\\\" data-ng-model=\\\"usersCtrl.user.password\\\" maxlength=\\\"128\\\"></td><td><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"usersCtrl.user.enabled\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.createNewUser()\\\" data-ng-disabled=\\\"!usersCtrl.isNewUserValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.cancelNewUser()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table><hr><h2 data-translate=\\\"users_token_list\\\"></h2><div class=\\\"row control-group\\\"><div class=\\\"col-xs-1 controls\\\"><label for=\\\"tokenSearchLogin\\\" data-translate=\\\"users_token_search_login\\\"></label></div><div class=\\\"col-xs-2 controls\\\"><input type=\\\"text\\\" min=\\\"1\\\" class=\\\"form-control\\\" name=\\\"tokenSearchLogin\\\" id=\\\"tokenSearchLogin\\\" data-ng-model=\\\"usersCtrl.searchOptions.login\\\" maxlength=\\\"128\\\"></div><div class=\\\"col-xs-1 controls\\\"><label for=\\\"tokenSearchEnabled\\\" data-translate=\\\"users_token_search_enabled\\\"></label></div><div class=\\\"col-xs-2 controls\\\"><select id=\\\"tokenSearchEnabled\\\" class=\\\"form-control\\\" data-ng-model=\\\"usersCtrl.searchOptions.enabled\\\"><option value=\\\"\\\" data-translate=\\\"users_token_search_enabled_all\\\"></option><option value=\\\"true\\\" data-translate=\\\"users_token_search_enabled_true\\\"></option><option value=\\\"false\\\" data-translate=\\\"users_token_search_enabled_false\\\"></option></select></div><div class=\\\"col-xs-3\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary pull-right\\\" data-ng-click=\\\"usersCtrl.getTokenList()\\\" style=\\\"margin-left: 5px; margin-bottom: 5px;\\\"><i class=\\\"fa fa-search\\\" aria-hidden=\\\"true\\\"></i> <span data-translate=\\\"users_search_button\\\"></span></button></div></div><table class=\\\"table table-hover dataTable table-striped\\\" data-dt-options=\\\"usersCtrl.options\\\" data-datatable=\\\"ng\\\"><thead><tr><th data-translate=\\\"users_table_token_login\\\"></th><th data-translate=\\\"users_table_token_value\\\"></th><th data-translate=\\\"users_table_token_validity\\\"></th><th data-translate=\\\"users_table_token_lastseen\\\"></th><th data-translate=\\\"users_table_token_revoke\\\"></th></tr></thead><tbody><tr data-ng-repeat=\\\"token in usersCtrl.tokenList\\\" data-ng-class=\\\"{ \\'text-muted\\' : !token.enabled}\\\"><td data-ng-bind=\\\"token.login\\\"></td><td data-ng-bind=\\\"usersCtrl.displayToken(token.token)\\\"></td><td data-ng-bind=\\\"token.validity | date : \\'medium\\'\\\" data-ng-if=\\\"token.enabled\\\"></td><td data-translate=\\\"users_token_revoked\\\" data-ng-if=\\\"!token.enabled\\\"></td><td data-ng-bind=\\\"token.last_seen | date : \\'medium\\'\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"usersCtrl.revokeToken(token)\\\" title=\\\"{{ \\'users_token_revoke\\' | translate }}\\\" data-ng-disabled=\\\"!token.enabled\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table></div>\");\n$templateCache.put(\"app/switches/switches.html\",\"<div><h1 data-translate=\\\"switches_title\\\"></h1><h2 data-translate=\\\"switch_title\\\"></h2><div class=\\\"row\\\"><div data-ng-repeat=\\\"switcher in switchesCtrl.switchList\\\" class=\\\"col-sm-3\\\" data-ng-if=\\\"switcher.enabled || switchesCtrl.sagremorParams.adminMode\\\"><data-sag-container data-menu=\\\"switchesCtrl.menuSwitcher\\\" data-size=\\\"1\\\" data-title=\\\"switcher.display\\\" data-type=\\\"\\'switch\\'\\\" data-element=\\\"switcher\\\" data-icon=\\\"\\'toggle-on\\'\\\"><data-sag-switch data-element=\\\"switcher\\\"></data-sag-switch></data-sag-container></div></div><h2 data-translate=\\\"dimmer_title\\\"></h2><div class=\\\"row\\\"><div data-ng-repeat=\\\"dimmer in switchesCtrl.dimmerList\\\" class=\\\"col-sm-3\\\" data-ng-if=\\\"dimmer.enabled || switchesCtrl.sagremorParams.adminMode\\\"><data-sag-container data-menu=\\\"switchesCtrl.menuDimmer\\\" data-size=\\\"1\\\" data-title=\\\"dimmer.display\\\" data-type=\\\"\\'dimmer\\'\\\" data-element=\\\"dimmer\\\" data-icon=\\\"\\'lightbulb-o\\'\\\"><data-sag-dimmer data-element=\\\"dimmer\\\"></data-sag-dimmer></data-sag-container></div></div></div>\");\n$templateCache.put(\"components/carleonLiquidsoap/carleonLiquidsoap.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-carleon-liquidsoap\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"carleon_liquidsoap_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_modal_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapName\\\" id=\\\"carleonLiquidsoapName\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.name\\\" data-ng-disabled=\\\"!carleonLiquidsoapModalCtrl.add\\\" size=\\\"10\\\" maxlength=\\\"64\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_modal_description\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapDescription\\\" id=\\\"carleonLiquidsoapDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.description\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_radio_url\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapRadioUrl\\\" id=\\\"carleonLiquidsoapRadioUrl\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.radio_url\\\" size=\\\"10\\\" maxlength=\\\"512\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_radio_type\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapRadioType\\\" id=\\\"carleonLiquidsoapRadioType\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.radio_type\\\" size=\\\"10\\\" maxlength=\\\"64\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_control_enabled\\\"></span><div class=\\\"col-xs-6 controls\\\"><input class=\\\"form-control\\\" id=\\\"carleonLiquidsoapControlEnabled\\\" name=\\\"carleonLiquidsoapControlEnabled\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.control_enabled\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_control_host\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapControlHost\\\" id=\\\"carleonLiquidsoapControlHost\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.control_host\\\" size=\\\"10\\\" maxlength=\\\"128\\\" data-ng-disabled=\\\"!carleonLiquidsoapModalCtrl.element.control_enabled\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_control_port\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"number\\\" name=\\\"carleonLiquidsoapControlPort\\\" id=\\\"carleonLiquidsoapControlPort\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.control_port\\\" size=\\\"10\\\" step=\\\"1\\\" data-ng-disabled=\\\"!carleonLiquidsoapModalCtrl.element.control_enabled\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_liquidsoap_control_request_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonLiquidsoapControlRequestName\\\" id=\\\"carleonLiquidsoapControlRequestName\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonLiquidsoapModalCtrl.element.control_request_name\\\" size=\\\"10\\\" maxlength=\\\"128\\\" data-ng-disabled=\\\"!carleonLiquidsoapModalCtrl.element.control_enabled\\\"></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"carleonLiquidsoapModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\" data-ng-disabled=\\\"!carleonLiquidsoapModalCtrl.isLiquidsoapValid()\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"carleonLiquidsoapModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/carleonLiquidsoap/carleonLiquidsoap.template.html\",\"<div class=\\\"container-fluid\\\"><div class=\\\"row control-group\\\"><div data-radio=\\\"\\\" data-src=\\\"$ctrl.radio.radio_url\\\"></div></div><div class=\\\"row control-group\\\"><data-uib-accordion><div data-uib-accordion-group=\\\"\\\" data-heading=\\\"{{\\'carleon_liquidsoap_control_header\\' | translate}}\\\" data-is-open=\\\"$ctrl.controlAccordionOpen\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"$ctrl.commandRadio(\\'stop\\')\\\" data-ng-if=\\\"$ctrl.status === \\'on\\'\\\"><i class=\\\"fa fa-stop\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"$ctrl.commandRadio(\\'start\\')\\\" data-ng-if=\\\"$ctrl.status === \\'off\\'\\\"><i class=\\\"fa fa-play\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"$ctrl.commandRadio(\\'skip\\')\\\" data-ng-if=\\\"$ctrl.status === \\'on\\'\\\"><i class=\\\"fa fa-step-forward\\\" aria-hidden=\\\"true\\\"></i></button></div></div></div><div data-uib-accordion-group=\\\"\\\" data-heading=\\\"{{\\'carleon_liquidsoap_on_air_header\\' | translate}}\\\" data-is-open=\\\"$ctrl.onAirAccordionOpen\\\"><div class=\\\"row control-group\\\"><dl><dt data-translate=\\\"carleon_liquidsoap_song_title\\\"></dt><dd data-ng-bind=\\\"$ctrl.onAir.title\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_artist\\\"></dt><dd data-ng-bind=\\\"$ctrl.onAir.artist\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_album\\\"></dt><dd data-ng-bind=\\\"$ctrl.onAir.album\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_album_artist\\\"></dt><dd data-ng-bind=\\\"$ctrl.onAir.albumartist\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_year\\\"></dt><dd data-ng-bind=\\\"$ctrl.onAir.year\\\"></dd></dl></div></div><div data-uib-accordion-group=\\\"\\\" data-heading=\\\"{{\\'carleon_liquidsoap_list_header\\' | translate}}\\\" data-is-open=\\\"$ctrl.listAccordionOpen\\\"><div class=\\\"row control-group\\\"><select class=\\\"form-control\\\" data-ng-model=\\\"$ctrl.listSelected\\\" data-ng-options=\\\"song as song.artist + \\' - \\' + song.title for song in $ctrl.list track by song.artist + \\' - \\' + song.title\\\"></select></div><div class=\\\"row control-group\\\"><dl><dt data-translate=\\\"carleon_liquidsoap_song_title\\\"></dt><dd data-ng-bind=\\\"$ctrl.listSelected.title\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_artist\\\"></dt><dd data-ng-bind=\\\"$ctrl.listSelected.artist\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_album\\\"></dt><dd data-ng-bind=\\\"$ctrl.listSelected.album\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_album_artist\\\"></dt><dd data-ng-bind=\\\"$ctrl.listSelected.albumartist\\\"></dd><dt data-translate=\\\"carleon_liquidsoap_song_year\\\"></dt><dd data-ng-bind=\\\"$ctrl.listSelected.year\\\"></dd></dl></div></div></data-uib-accordion></div></div>\");\n$templateCache.put(\"components/carleonMotion/carleonMotion.image.modal.html\",\"<div class=\\\"container-fluid\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal_title\\\" data-ng-bind=\\\"carleonMotionImageModalCtrl.displayTitle()\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-12\\\" data-ng-if=\\\"!!carleonMotionImageModalCtrl.currentImage.stream\\\"><img data-ng-src=\\\"{{carleonMotionImageModalCtrl.currentImage.stream}}\\\" alt=\\\"{{carleonMotionImageModalCtrl.currentImage.title}}\\\" class=\\\"img-responsive img-thumbnail\\\"></div><div class=\\\"col-xs-12\\\" data-ng-if=\\\"!!carleonMotionImageModalCtrl.currentImage.img\\\"><img data-http-src=\\\"{{carleonMotionImageModalCtrl.currentImage.img}}\\\" alt=\\\"{{carleonMotionImageModalCtrl.currentImage.title}}\\\" class=\\\"img-responsive img-thumbnail\\\"></div></div><div class=\\\"row control-group\\\"><div class=\\\"col-xs-5\\\"><button type=\\\"button\\\" class=\\\"btn pull-right\\\" data-ng-click=\\\"carleonMotionImageModalCtrl.changeImage(-1)\\\" data-ng-if=\\\"carleonMotionImageModalCtrl.canPrevious()\\\"><i class=\\\"fa fa-arrow-left\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"col-xs-2 text-center\\\"><span data-ng-bind=\\\"carleonMotionImageModalCtrl.showIndex()\\\"></span></div><div class=\\\"col-xs-5\\\"><button type=\\\"button\\\" class=\\\"btn pull-left\\\" data-ng-click=\\\"carleonMotionImageModalCtrl.changeImage(1)\\\" data-ng-if=\\\"carleonMotionImageModalCtrl.canNext()\\\"><i class=\\\"fa fa-arrow-right\\\" aria-hidden=\\\"true\\\"></i></button></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMotionImageModalCtrl.snapshot()\\\" data-ng-if=\\\"!!carleonMotionImageModalCtrl.currentImage.snapshotUri\\\"><span data-translate=\\\"carleon_motion_snapshot\\\"></span> <i class=\\\"fa fa-camera\\\" aria-hidden=\\\"true\\\"></i></button> <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMotionImageModalCtrl.close()\\\" data-translate=\\\"monitor_close\\\"></button></div></div></div>\");\n$templateCache.put(\"components/carleonMotion/carleonMotion.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-carleon-motion\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"carleon_motion_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_motion_modal_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMotionName\\\" id=\\\"carleonMotionName\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.motion.name\\\" data-ng-disabled=\\\"!carleonMotionModalCtrl.add\\\" size=\\\"10\\\" maxlength=\\\"64\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_motion_modal_description\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMotionDescription\\\" id=\\\"carleonMotionDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.motion.description\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_motion_modal_config_uri\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMotionDescription\\\" id=\\\"carleonMotionDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.motion.config_uri\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><hr><div class=\\\"row\\\"><h3 data-translate=\\\"carleon_motion_modal_file_list\\\"></h3><button type=\\\"button\\\" data-ng-click=\\\"carleonMotionModalCtrl.addNewFileList()\\\" class=\\\"btn\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"row control-group\\\"><table class=\\\"table table-hover controls\\\"><thead><tr><th data-translate=\\\"carleon_motion_file_list_name\\\"></th><th data-translate=\\\"carleon_motion_file_list_path\\\"></th><th data-translate=\\\"carleon_motion_file_list_thumbnail_path\\\"></th><th></th></tr></thead><tbody><tr data-ng-repeat=\\\"fileList in carleonMotionModalCtrl.motion.file_list track by $index\\\"><td data-ng-bind=\\\"fileList.name\\\"></td><td data-ng-bind=\\\"fileList.path\\\"></td><td data-ng-bind=\\\"fileList.thumbnail_path\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.removeFileList($index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-if=\\\"carleonMotionModalCtrl.addFileList\\\"><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newFileList.name\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"64\\\" maxlength=\\\"64\\\"></td><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newFileList.path\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"512\\\" maxlength=\\\"512\\\"></td><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newFileList.thumbnail_path\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"512\\\" maxlength=\\\"512\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.saveNewFileList()\\\" data-ng-disabled=\\\"!carleonMotionModalCtrl.isFileListValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.cancelNewFileList()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table></div><hr><div class=\\\"row\\\"><h3 data-translate=\\\"carleon_motion_modal_stream_list\\\"></h3><button type=\\\"button\\\" data-ng-click=\\\"carleonMotionModalCtrl.addNewStream()\\\" class=\\\"btn\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"row control-group\\\"><table class=\\\"table table-hover controls\\\"><thead><tr><th data-translate=\\\"carleon_motion_stream_list_name\\\"></th><th data-translate=\\\"carleon_motion_stream_list_uri\\\"></th><th data-translate=\\\"carleon_motion_stream_list_snapshot_uri\\\"></th><th></th></tr></thead><tbody><tr data-ng-repeat=\\\"streamList in carleonMotionModalCtrl.motion.stream_list track by $index\\\"><td data-ng-bind=\\\"streamList.name\\\"></td><td data-ng-bind=\\\"streamList.uri\\\"></td><td data-ng-bind=\\\"streamList.snapshot_uri\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.removeStream($index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></td></tr><tr data-ng-if=\\\"carleonMotionModalCtrl.addStream\\\"><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newStream.name\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"64\\\" maxlength=\\\"64\\\"></td><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newStream.uri\\\" data-ng-required=\\\"\\\" data-ng-maxlength=\\\"512\\\" maxlength=\\\"512\\\"></td><td><input type=\\\"text\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMotionModalCtrl.newStream.snapshot_uri\\\" data-ng-maxlength=\\\"512\\\" maxlength=\\\"512\\\"></td><td><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.saveNewStream()\\\" data-ng-disabled=\\\"!carleonMotionModalCtrl.isStreamValid()\\\"><i class=\\\"fa fa-check\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"carleonMotionModalCtrl.cancelNewStream()\\\"><i class=\\\"fa fa-times\\\" aria-hidden=\\\"true\\\"></i></button></td></tr></tbody></table></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMotionModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\" data-ng-disabled=\\\"!carleonMotionModalCtrl.isCameraValid()\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMotionModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/carleonMotion/carleonMotion.template.html\",\"<div class=\\\"container-fluid\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-4 controls\\\" data-ng-class=\\\"{\\'text-success\\': $ctrl.online, \\'text-danger\\': !$ctrl.online}\\\"><label data-translate=\\\"carleon_motion_online\\\" data-ng-if=\\\"$ctrl.online\\\"></label> <label data-translate=\\\"carleon_motion_offline\\\" data-ng-if=\\\"!$ctrl.online\\\"></label> <i class=\\\"fa fa-power-off\\\" aria-hidden=\\\"true\\\"></i></div><div class=\\\"col-xs-4 controls\\\" data-ng-if=\\\"$ctrl.fileListName.length > 1\\\"><div><label for=\\\"motionImagesList\\\" data-translate=\\\"carleon_motion_file_list\\\"></label></div></div><div class=\\\"col-xs-4 controls\\\" data-ng-if=\\\"$ctrl.fileListName.length > 1\\\"><select id=\\\"motionImagesList\\\" class=\\\"form-control\\\" data-ng-change=\\\"$ctrl.changeSelectedFileList()\\\" data-ng-model=\\\"$ctrl.selectedFileList\\\" data-ng-options=\\\"fileListName as fileListName for fileListName in $ctrl.fileListName track by fileListName\\\"></select></div><div class=\\\"col-xs-8 controls\\\" data-ng-if=\\\"$ctrl.fileListName.length <= 1\\\"><span data-ng-bind=\\\"$ctrl.selectedFileList\\\"></span></div></div><div class=\\\"row control-group\\\"><div class=\\\"col-xs-4\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"$ctrl.refresh()\\\"><span data-translate=\\\"carleon_motion_refresh\\\"></span> <i class=\\\"fa fa-refresh\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"col-xs-4 controls\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"$ctrl.openStream()\\\"><span data-translate=\\\"carleon_motion_stream_open\\\"></span> <i class=\\\"fa fa-video-camera\\\" aria-hidden=\\\"true\\\"></i></button></div></div><hr><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.selectedFileList\\\"><div class=\\\"col-xs-3\\\" data-ng-repeat=\\\"image in $ctrl.images track by $index\\\"><a href=\\\"\\\" data-ng-click=\\\"$ctrl.openPopupImage($ctrl.images, $index)\\\" alt=\\\"{{image.title}}\\\"><img data-http-src=\\\"{{image.thumb}}\\\" title=\\\"{{image.title}}\\\" class=\\\"img-responsive\\\"></a> <span class=\\\"small text-center\\\" data-ng-bind=\\\"image.title\\\"></span></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.selectedFileList\\\"><div class=\\\"col-xs-5\\\"><button type=\\\"button\\\" class=\\\"btn pull-right\\\" data-ng-click=\\\"$ctrl.previousList()\\\" data-ng-if=\\\"$ctrl.canPrevious()\\\"><i class=\\\"fa fa-arrow-left\\\" aria-hidden=\\\"true\\\"></i></button></div><div class=\\\"col-xs-2 text-center\\\"><span data-ng-bind=\\\"$ctrl.offset\\\"></span></div><div class=\\\"col-xs-5\\\"><button type=\\\"button\\\" class=\\\"btn pull-left\\\" data-ng-click=\\\"$ctrl.nextList()\\\" data-ng-if=\\\"$ctrl.canNext()\\\"><i class=\\\"fa fa-arrow-right\\\" aria-hidden=\\\"true\\\"></i></button></div></div></div>\");\n$templateCache.put(\"components/carleonMock/carleonMock.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-carleon-mock\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"carleon_mock_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row-fluid\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mock_modal_name\\\"></span><div class=\\\"col-xs-6\\\"><input type=\\\"text\\\" name=\\\"carleonMockName\\\" id=\\\"carleonMockName\\\" data-ng-model=\\\"CarleonMockModalCtrl.mock.name\\\" data-ng-disabled=\\\"!CarleonMockModalCtrl.add\\\" class=\\\"modal-input-text\\\" size=\\\"10\\\"></div></div><div class=\\\"row\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mock_modal_description\\\"></span><div class=\\\"col-xs-6\\\"><input type=\\\"text\\\" name=\\\"carleonMockDescription\\\" id=\\\"carleonMockDescription\\\" data-ng-model=\\\"CarleonMockModalCtrl.mock.description\\\" class=\\\"modal-input-text\\\" size=\\\"10\\\"></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"CarleonMockModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"CarleonMockModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div></div>\");\n$templateCache.put(\"components/carleonMock/carleonMock.template.html\",\"<div class=\\\"text-center\\\"><div class=\\\"row\\\"><div class=\\\"span6\\\">command</div><div class=\\\"span6\\\"><select id=\\\"mockCommand\\\" data-ng-model=\\\"$ctrl.param.command\\\" data-ng-options=\\\"command for command in $ctrl.commandList\\\"></select></div></div><div class=\\\"row\\\" data-ng-if=\\\"$ctrl.param.command === \\'exec1\\' || $ctrl.param.command === \\'exec2\\'\\\"><div class=\\\"span6\\\">param1</div><div class=\\\"span6\\\"><input type=\\\"text\\\" data-ng-model=\\\"$ctrl.param.param1\\\" size=\\\"4\\\"></div></div><div class=\\\"row\\\" data-ng-if=\\\"$ctrl.param.command === \\'exec1\\'\\\"><div class=\\\"span6\\\">param2</div><div class=\\\"span6\\\"><input type=\\\"number\\\" data-ng-model=\\\"$ctrl.param.param2\\\" style=\\\"width: 7em\\\"></div></div><div class=\\\"row\\\" data-ng-if=\\\"$ctrl.param.command === \\'exec1\\'\\\"><div class=\\\"span6\\\">param3</div><div class=\\\"span6\\\"><input type=\\\"number\\\" step=\\\"0.01\\\" data-ng-model=\\\"$ctrl.param.param3\\\" style=\\\"width: 7em\\\"></div></div><button type=\\\"button\\\" data-ng-click=\\\"$ctrl.command()\\\">Execute</button></div>\");\n$templateCache.put(\"components/container/container.template.html\",\"<div data-ng-class=\\\"{\\'sag-container\\': !$ctrl.dashboard, \\'sag-container-dashboard\\': ($ctrl.dashboard && $ctrl.element.type !== \\'script\\')}\\\"><div class=\\\"row\\\"><div class=\\\"sag-container-header-menu col-xs-2\\\" data-ng-if=\\\"(!!$ctrl.menu && !$ctrl.dashboard) || $ctrl.dashboard && $ctrl.sagParams.adminMode\\\" data-uib-dropdown=\\\"\\\"><button class=\\\"btn btn-primary text-left\\\" type=\\\"button\\\" data-uib-dropdown-toggle=\\\"\\\" data-ng-click=\\\"\\\"><i data-ng-class=\\\"{\\'fa fa-{{$ctrl.icon}} fa-fw\\': !!$ctrl.icon, \\'fa fa-bars\\': !$ctrl.icon}\\\" aria-hidden=\\\"true\\\"></i></button><ul data-uib-dropdown-menu=\\\"\\\"><li data-ng-repeat=\\\"menuItem in $ctrl.menu\\\" data-ng-if=\\\"menuItem.name !== \\'monitor\\' || $ctrl.element.monitored\\\"><a href=\\\"\\\" data-ng-click=\\\"$ctrl.menuSelect(menuItem, $ctrl.element)\\\" data-ng-bind=\\\"menuItem.display\\\"></a></li></ul></div><div data-ng-if=\\\"$ctrl.element.type !== \\'script\\'\\\" class=\\\"sag-container-header-title col-xs-10\\\" data-ng-class=\\\"{\\'sag-container-header-title-dashboard\\': $ctrl.dashboard}\\\"><i data-ng-class=\\\"{\\'fa fa-{{$ctrl.icon}}\\': !!$ctrl.icon}\\\" aria-hidden=\\\"true\\\" data-ng-if=\\\"$ctrl.dashboard\\\"></i> <span data-toggle=\\\"tooltip\\\" data-ng-attr-title=\\\"{{$ctrl.title + \\'\\\\n\\' + $ctrl.element.description}}\\\"><span data-ng-bind=\\\"$ctrl.title\\\" class=\\\"text-center\\\"></span></span></div></div><div data-ng-transclude=\\\"\\\" class=\\\"sag-container-element\\\"></div><div class=\\\"row\\\"><div class=\\\"col-md-12\\\"><span data-ng-repeat=\\\"script in $ctrl.scripts\\\" class=\\\"script-small\\\"><button type=\\\"button\\\" class=\\\"btn btn-xs btn-primary\\\" data-ng-bind=\\\"script.name\\\" data-ng-click=\\\"$ctrl.runScript(script)\\\"></button></span></div></div></div>\");\n$templateCache.put(\"components/carleonMpd/carleonMpd.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-carleon-mpd\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"carleon_mpd_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMpdName\\\" id=\\\"carleonMpdName\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.mpd.name\\\" data-ng-disabled=\\\"!carleonMpdModalCtrl.add\\\" size=\\\"10\\\" maxlength=\\\"64\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_description\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMpdDescription\\\" id=\\\"carleonMpdDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.mpd.description\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_host\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMpdDescription\\\" id=\\\"carleonMpdDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.mpd.host\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_port\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"number\\\" name=\\\"carleonMpdDescription\\\" id=\\\"carleonMpdDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.mpd.port\\\" size=\\\"10\\\" step=\\\"1\\\" maxlength=\\\"5\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_password\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"carleonMpdDescription\\\" id=\\\"carleonMpdDescription\\\" class=\\\"modal-input-text form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.mpd.password\\\" size=\\\"10\\\" maxlength=\\\"128\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"carleon_mpd_modal_switch\\\"></span><div class=\\\"col-xs-6 controls\\\"><select id=\\\"newActionSwitch\\\" name=\\\"newActionSwitch\\\" class=\\\"form-control\\\" data-ng-model=\\\"carleonMpdModalCtrl.switchAttached\\\" data-ng-options=\\\"switch as switch.display for switch in carleonMpdModalCtrl.switches\\\" data-ng-change=\\\"carleonMpdModalCtrl.changeSwitch()\\\"></select></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMpdModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\" data-ng-disabled=\\\"!carleonMpdModalCtrl.isMpdValid()\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"carleonMpdModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/carleonMpd/carleonMpd.template.html\",\"<div class=\\\"container-fluid\\\"><div class=\\\"row control-group\\\"><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.name && ($ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\')\\\"><div class=\\\"col-xs-12 controls text-center\\\"><strong><span data-ng-bind=\\\"$ctrl.mpd.name\\\"></span></strong></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.title && ($ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\')\\\"><div class=\\\"col-xs-2 controls\\\"><strong><span data-translate=\\\"carleon_mpd_playing_title\\\"></span></strong></div><div class=\\\"col-xs-10 controls\\\"><span data-ng-bind=\\\"$ctrl.mpd.title\\\"></span></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.artist && ($ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\')\\\"><div class=\\\"col-xs-2 controls\\\"><strong><span data-translate=\\\"carleon_mpd_playing_artist\\\"></span></strong></div><div class=\\\"col-xs-10 controls\\\"><span data-ng-bind=\\\"$ctrl.mpd.artist\\\"></span></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.album && ($ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\')\\\"><div class=\\\"col-xs-2 controls\\\"><strong><span data-translate=\\\"carleon_mpd_playing_album\\\"></span></strong></div><div class=\\\"col-xs-10 controls\\\"><span data-ng-bind=\\\"$ctrl.mpd.album\\\"></span></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.date && ($ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\')\\\"><div class=\\\"col-xs-2 controls\\\"><strong><span data-translate=\\\"carleon_mpd_playing_date\\\"></span></strong></div><div class=\\\"col-xs-10 controls\\\"><span data-ng-bind=\\\"$ctrl.mpd.date\\\"></span></div></div><hr class=\\\"heater-hr\\\"><div class=\\\"clearfix control-group\\\"><div class=\\\"col-xs-4 controls\\\"><label for=\\\"mpdPlaylists\\\" data-translate=\\\"carleon_mpd_playlists_title\\\"></label></div><div class=\\\"col-xs-4 controls\\\"><select class=\\\"form-control\\\" name=\\\"mpdPlaylists\\\" value=\\\"mpdPlaylists\\\" data-ng-model=\\\"$ctrl.selectedPlaylist\\\" data-ng-options=\\\"playlist as playlist for playlist in $ctrl.playlists\\\"></select></div><div class=\\\"col-xs-4 controls\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"$ctrl.loadPlaylist()\\\" data-translate=\\\"carleon_mpd_playlist_load\\\"></button></div></div><hr class=\\\"heater-hr\\\"><div class=\\\"row control-group\\\"><div class=\\\"clearfix input-group\\\"><span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.setAction(\\'previous\\')\\\"><i class=\\\"fa fa-backward\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\" data-ng-if=\\\"$ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'play\\'\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.setAction(\\'stop\\')\\\"><i class=\\\"fa fa-stop\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\" data-ng-if=\\\"$ctrl.mpd.state == \\'pause\\' || $ctrl.mpd.state == \\'stop\\'\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.setAction(\\'play\\')\\\"><i class=\\\"fa fa-play\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\" data-ng-if=\\\"$ctrl.mpd.state == \\'play\\'\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.setAction(\\'pause\\')\\\"><i class=\\\"fa fa-pause\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.setAction(\\'next\\')\\\"><i class=\\\"fa fa-forward\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" data-ng-class=\\\"{\\'btn btn-primary\\': $ctrl.mpd.repeat, \\'btn btn-default\\': !$ctrl.mpd.repeat}\\\" data-ng-click=\\\"$ctrl.setAction(\\'repeat\\')\\\"><i class=\\\"fa fa-refresh\\\" aria-hidden=\\\"true\\\"></i></button> <button type=\\\"button\\\" data-ng-class=\\\"{\\'btn btn-primary\\': $ctrl.mpd.random, \\'btn btn-default\\': !$ctrl.mpd.random}\\\" data-ng-click=\\\"$ctrl.setAction(\\'random\\')\\\"><i class=\\\"fa fa-random\\\" aria-hidden=\\\"true\\\"></i></button></span></div></div><hr class=\\\"heater-hr\\\"><div class=\\\"row control-group\\\" data-ng-if=\\\"!!$ctrl.mpd.name\\\"><div class=\\\"col-xs-12 controls text-center\\\"><strong><span data-translate=\\\"carleon_mpd_control_volume\\\"></span></strong></div></div><div class=\\\"row control-group\\\"><div class=\\\"ring control-group\\\"><div class=\\\"quarter quarter-plus-1\\\" data-ng-click=\\\"$ctrl.setVolume(1)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayVolumeCommand(1)\\\"></span></div><div class=\\\"quarter quarter-plus-5\\\" data-ng-click=\\\"$ctrl.setVolume(5)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayVolumeCommand(5)\\\"></span></div><div class=\\\"quarter quarter-minus-1\\\" data-ng-click=\\\"$ctrl.setVolume(-1)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayVolumeCommand(-1)\\\"></span></div><div class=\\\"quarter quarter-minus-5\\\" data-ng-click=\\\"$ctrl.setVolume(-5)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayVolumeCommand(-5)\\\"></span></div><div class=\\\"cutout-heater\\\"><div class=\\\"ring-value\\\" data-ng-bind=\\\"$ctrl.displayVolume()\\\"></div></div></div></div></div></div>\");\n$templateCache.put(\"components/dimmer/dimmer.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"dimmer_update_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"dimmer_update_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"dimmerDisplay\\\" id=\\\"dimmerDisplay\\\" data-ng-model=\\\"DimmersModalCtrl.dimmer.newDisplay\\\" class=\\\"modal-input-text form-control\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"dimmer_update_enabled\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"DimmersModalCtrl.dimmer.enabled\\\"></div></div><div class=\\\"row\\\"><hr></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"dimmer_update_monitor\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"DimmersModalCtrl.dimmer.monitored\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"DimmersModalCtrl.dimmer.monitored\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"dimmer_update_monitor_every\\\"></span><div class=\\\"col-xs-6 controls\\\"><select id=\\\"bddAddUserGrant\\\" class=\\\"form-control\\\" data-ng-model=\\\"DimmersModalCtrl.dimmer.monitored_every\\\" data-ng-options=\\\"monitorEvery.value as DimmersModalCtrl.tr(monitorEvery.label) for monitorEvery in DimmersModalCtrl.monitorEveryEnum\\\"></select></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"DimmersModalCtrl.saveDimmer()\\\" data-translate=\\\"dimmer_btn_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"DimmersModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"dimmer_btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/dimmer/dimmer.template.html\",\"<div data-ng-if=\\\"$ctrl.element.enabled || $ctrl.adminMode\\\"><div class=\\\"text-center\\\" data-ng-class=\\\"{\\'text-italic\\': $ctrl.adminMode}\\\"><div class=\\\"ring\\\"><div class=\\\"quarter quarter1\\\" data-ng-click=\\\"$ctrl.setDimmer(100)\\\" data-ng-class=\\\"{\\'quarter-off\\': $ctrl.element.value <= 75, \\'quarter-almost-on\\': $ctrl.element.value < 100 && $ctrl.element.value > 75, \\'quarter-on\\': $ctrl.element.value === 100}\\\"><span class=\\\"quarter-value\\\">100%</span></div><div class=\\\"quarter quarter2\\\" data-ng-click=\\\"$ctrl.setDimmer(25)\\\" data-ng-class=\\\"{\\'quarter-off\\': $ctrl.element.value === 0, \\'quarter-almost-on\\': $ctrl.element.value < 25 && $ctrl.element.value > 0, \\'quarter-on\\': $ctrl.element.value >= 25}\\\"><span class=\\\"quarter-value\\\">25%</span></div><div class=\\\"quarter quarter3\\\" data-ng-click=\\\"$ctrl.setDimmer(75)\\\" data-ng-class=\\\"{\\'quarter-off\\': $ctrl.element.value <= 50, \\'quarter-almost-on\\': $ctrl.element.value < 75 && $ctrl.element.value > 50, \\'quarter-on\\': $ctrl.element.value >= 75}\\\"><span class=\\\"quarter-value\\\"><br>75%</span></div><div class=\\\"quarter quarter4\\\" data-ng-click=\\\"$ctrl.setDimmer(50)\\\" data-ng-class=\\\"{\\'quarter-off\\': $ctrl.element.value <= 25, \\'quarter-almost-on\\': $ctrl.element.value < 50 && $ctrl.element.value > 25, \\'quarter-on\\': $ctrl.element.value >= 50}\\\"><span class=\\\"quarter-value\\\"><br>50%</span></div><div class=\\\"cutout\\\"><div class=\\\"ring-value\\\" data-ng-bind=\\\"$ctrl.Dimmervalue()\\\"></div></div></div><hr class=\\\"dimmer-hr\\\"><div class=\\\"clearfix input-group\\\"><span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.addDimmer(-1)\\\"><i class=\\\"fa fa-minus\\\"></i></button></span> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" data-ng-click=\\\"$ctrl.setDimmer(0)\\\" class=\\\"btn btn-default\\\"><i class=\\\"fa fa-power-off\\\" aria-hidden=\\\"true\\\"></i></button></span> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"$ctrl.addDimmer(1)\\\"><i class=\\\"fa fa-plus\\\"></i></button></span></div></div></div>\");\n$templateCache.put(\"components/heater/heater.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"heater_update_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"heater_update_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"heaterDisplay\\\" id=\\\"heaterDisplay\\\" data-ng-model=\\\"HeatersModalCtrl.heater.newDisplay\\\" class=\\\"modal-input-text form-control\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"heater_update_unit\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"heaterUnit\\\" id=\\\"heaterUnit\\\" data-ng-model=\\\"HeatersModalCtrl.heater.options.unit\\\" class=\\\"modal-input-text form-control\\\" placeholder=\\\"{{\\'heater_unit_placeholder\\' | translate}}\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"heater_update_enabled\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"HeatersModalCtrl.heater.enabled\\\"></div></div><div class=\\\"row\\\"><hr></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"heater_update_monitor\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"HeatersModalCtrl.heater.monitored\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"HeatersModalCtrl.heater.monitored\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"heater_update_monitor_every\\\"></span><div class=\\\"col-xs-6 controls\\\"><select id=\\\"bddAddUserGrant\\\" class=\\\"form-control\\\" data-ng-model=\\\"HeatersModalCtrl.heater.monitored_every\\\" data-ng-options=\\\"monitorEvery.value as HeatersModalCtrl.tr(monitorEvery.label) for monitorEvery in HeatersModalCtrl.monitorEveryEnum\\\"></select></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"HeatersModalCtrl.saveHeater()\\\" data-translate=\\\"heater_btn_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"HeatersModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"heater_btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/heater/heater.template.html\",\"<div class=\\\"container-fluid\\\" data-ng-class=\\\"{\\'text-italic\\': $ctrl.adminMode}\\\" data-ng-if=\\\"$ctrl.element.enabled || $ctrl.adminMode\\\"><div class=\\\"text-center row control-group\\\"><span class=\\\"heater-on\\\"><i class=\\\"fa fa-fire\\\" aria-hidden=\\\"true\\\" data-ng-if=\\\"$ctrl.element.value.on\\\"></i></span></div><div class=\\\"row control-group\\\"><div class=\\\"ring control-group\\\"><div class=\\\"quarter quarter-plus-1\\\" data-ng-click=\\\"$ctrl.setHeater(1)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayCommand(1)\\\"></span></div><div class=\\\"quarter quarter-plus-5\\\" data-ng-click=\\\"$ctrl.setHeater(5)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayCommand(5)\\\"></span></div><div class=\\\"quarter quarter-minus-1\\\" data-ng-click=\\\"$ctrl.setHeater(-1)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayCommand(-1)\\\"></span></div><div class=\\\"quarter quarter-minus-5\\\" data-ng-click=\\\"$ctrl.setHeater(-5)\\\"><span class=\\\"quarter-value\\\" data-ng-bind=\\\"$ctrl.displayCommand(-5)\\\"></span></div><div class=\\\"cutout-heater\\\"><div class=\\\"ring-value\\\" data-ng-bind=\\\"$ctrl.displayCommandValue()\\\"></div></div></div></div><hr class=\\\"heater-hr\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-4 controls\\\"><label for=\\\"heaterMode\\\" data-translate=\\\"heater_mode_title\\\"></label></div><div class=\\\"col-xs-8 controls\\\"><select class=\\\"form-control\\\" name=\\\"heaterMode\\\" value=\\\"heaterMode\\\" data-ng-model=\\\"$ctrl.element.value.mode\\\" data-ng-change=\\\"$ctrl.setHeater(null)\\\" data-ng-options=\\\"mode as $ctrl.modeDisplay(mode) for mode in $ctrl.availableModes\\\"></select></div></div></div>\");\n$templateCache.put(\"components/modals/confirm.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\">{{ConfirmModalCtrl.title}}</h3></div><div class=\\\"modal-body\\\"><div class=\\\"row\\\" style=\\\"margin: 5px;\\\"><span>{{ConfirmModalCtrl.message}}</span></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"ConfirmModalCtrl.ok()\\\">OK</button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"ConfirmModalCtrl.cancel()\\\">Cancel</button></div></div></div>\");\n$templateCache.put(\"components/modals/edit.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-ng-bind=\\\"EditModalCtrl.title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row\\\" style=\\\"margin: 5px;\\\"><span data-ng-bind=\\\"EditModalCtrl.message\\\"></span></div><div class=\\\"row control-group\\\" style=\\\"margin: 5px;\\\"><div class=\\\"controls\\\"><input type=\\\"text\\\" name=\\\"editInput\\\" id=\\\"editInput\\\" class=\\\"form-control\\\" data-ng-model=\\\"EditModalCtrl.value\\\" placeholder=\\\"{{EditModalCtrl.placeholder}}\\\"></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"EditModalCtrl.ok()\\\" data-translate=\\\"modal_button_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"EditModalCtrl.cancel()\\\" data-translate=\\\"modal_button_cancel\\\"></button></div></div></div>\");\n$templateCache.put(\"components/modals/image.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal_title\\\" data-ng-bind=\\\"ImageModalCtrl.displayTitle()\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-1\\\"></div><div class=\\\"col-xs-10\\\"><img data-ng-src=\\\"{{ImageModalCtrl.src}}\\\" alt=\\\"{{ImageModalCtrl.title}}\\\" class=\\\"img-responsive img-thumbnail\\\"></div><div class=\\\"col-xs-1\\\"></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"ImageModalCtrl.close()\\\" data-translate=\\\"monitor_close\\\"></button></div></div>\");\n$templateCache.put(\"components/modals/monitor.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal_title\\\" data-ng-bind=\\\"MonitorModalCtrl.displayTitle()\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"monitorSelectDuration\\\" data-translate=\\\"monitor_select_duration\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><select id=\\\"monitorSelectDuration\\\" class=\\\"form-control\\\" data-ng-model=\\\"MonitorModalCtrl.duration\\\" data-ng-change=\\\"MonitorModalCtrl.getMonitor()\\\" data-ng-options=\\\"duration as MonitorModalCtrl.tr(duration.label) for duration in MonitorModalCtrl.durationList track by duration.value\\\"></select></div></div><div class=\\\"row\\\"><data-nvd3 data-options=\\\"MonitorModalCtrl.options\\\" data=\\\"MonitorModalCtrl.data\\\"></data-nvd3></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"MonitorModalCtrl.close()\\\" data-translate=\\\"monitor_close\\\"></button></div></div>\");\n$templateCache.put(\"components/modals/scriptBindElement.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"script_bind_element_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row\\\"><span data-translat=\\\"script_bind_element_list\\\"></span></div><div class=\\\"row\\\" style=\\\"padding: 5px;\\\"><table data-datatable=\\\"ng\\\" data-dt-options=\\\"ScriptBindElementModalCtrl.options\\\" class=\\\"table table-hover table-striped table-bordered dataTable\\\"><thead><tr><th data-translate=\\\"script_bind_table_select\\\"></th><th data-translate=\\\"script_bind_table_type\\\"></th><th data-translate=\\\"script_bind_table_display\\\"></th></tr></thead><tbody><tr data-ng-repeat=\\\"element in ScriptBindElementModalCtrl.elementList track by $index\\\" data-ng-click=\\\"ScriptBindElementModalCtrl.selectRow($index)\\\" data-ng-class=\\\"{\\'selected\\': element.selected}\\\"><td><input class=\\\"text-center\\\" id=\\\"elementSelect\\\" type=\\\"checkbox\\\" data-ng-model=\\\"ScriptBindElementModalCtrl.tmpCheck[$index]\\\"></td><td data-ng-bind=\\\"element.typeTitle\\\"></td><td data-ng-bind=\\\"element.display\\\"></td></tr></tbody></table></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"ScriptBindElementModalCtrl.ok()\\\" data-translate=\\\"modal_button_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"ScriptBindElementModalCtrl.cancel()\\\" data-translate=\\\"modal_button_cancel\\\"></button></div></div></div>\");\n$templateCache.put(\"components/monitor/monitor.template.html\",\"<div class=\\\"container-fluid\\\"><div class=\\\"row control-group\\\"><div class=\\\"col-xs-5\\\"><label for=\\\"monitorSelectDuration\\\" data-translate=\\\"monitor_select_duration\\\"></label></div><div class=\\\"col-xs-5 controls\\\"><select id=\\\"monitorSelectDuration\\\" class=\\\"form-control\\\" data-ng-model=\\\"$ctrl.duration\\\" data-ng-change=\\\"$ctrl.displayMonitor()\\\" data-ng-options=\\\"duration as $ctrl.tr(duration.label) for duration in $ctrl.durationList track by duration.value\\\"></select></div></div><div class=\\\"row control-group\\\"><div class=\\\"col-xs-1\\\"></div><div class=\\\"col-xs-2\\\"><label for=\\\"monitorNewElement\\\" data-translate=\\\"monitor_new_element\\\"></label></div><div class=\\\"col-xs-3 controls\\\"><select id=\\\"monitorNewElement\\\" class=\\\"form-control\\\" data-ng-model=\\\"$ctrl.newElement\\\" data-ng-options=\\\"element.display for element in $ctrl.elementListDisplayed\\\"></select></div><div class=\\\"col-xs-3 controls\\\"><button type=\\\"button\\\" data-ng-click=\\\"$ctrl.addElement()\\\" class=\\\"btn btn-primary\\\" data-ng-disabled=\\\"!$ctrl.newElementValid()\\\" data-translate=\\\"monitor_new_element_button\\\"></button></div></div><div class=\\\"row text-center\\\"><div class=\\\"col-xs-12\\\"><data-nvd3 data-options=\\\"$ctrl.options\\\" data=\\\"$ctrl.data\\\"></data-nvd3></div></div><div class=\\\"row text-center\\\"><span data-ng-repeat=\\\"serie in $ctrl.element.elements\\\" style=\\\"margin: 5px; color: white;\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"$ctrl.removeSerie(serie)\\\" data-ng-disabled=\\\"$ctrl.element.elements.length <= 1\\\"><i class=\\\"fa fa-trash-o\\\" aria-hidden=\\\"true\\\"></i> <span data-ng-bind=\\\"serie.display\\\"></span></button></span></div></div>\");\n$templateCache.put(\"components/event/event.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"event_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !!EventModalCtrl.error.nameInvalid}\\\"><label for=\\\"eventName\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_name\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"text\\\" name=\\\"eventName\\\" id=\\\"eventName\\\" data-ng-model=\\\"EventModalCtrl.event.name\\\" class=\\\"modal-input-text form-control\\\" size=\\\"16\\\" maxlength=\\\"64\\\" data-ng-disabled=\\\"!EventModalCtrl.add\\\" placeholder=\\\"{{\\'event_name_placeholder\\' | translate}}\\\"></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventDecription\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_description\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"text\\\" name=\\\"eventDecription\\\" id=\\\"eventDecription\\\" data-ng-model=\\\"EventModalCtrl.event.description\\\" class=\\\"modal-input-text form-control\\\" size=\\\"16\\\" maxlength=\\\"128\\\" placeholder=\\\"{{\\'event_description_placeholder\\' | translate}}\\\"></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventEnabled\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_enabled\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"checkbox\\\" id=\\\"eventEnabled\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.event.enabled\\\"></div></div><hr><div class=\\\"row control-group\\\"><label for=\\\"eventType\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_type_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"eventType\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.eventType\\\"><option value=\\\"scheduler\\\" data-translate=\\\"event_type_scheduler\\\"></option><option value=\\\"trigger\\\" data-translate=\\\"event_type_trigger\\\"></option></select></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\'\\\"><label for=\\\"schedulerDate\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_date_select\\\"></label><div class=\\\"col-xs-7\\\"><div class=\\\"input-group\\\"><input type=\\\"text\\\" id=\\\"schedulerDate\\\" class=\\\"form-control\\\" data-datetime-picker=\\\"yyyy/MM/dd HH:mm\\\" data-ng-model=\\\"EventModalCtrl.myDate\\\" data-is-open=\\\"EventModalCtrl.isOpen\\\" data-button-bar=\\\"EventModalCtrl.datePickerOptions.buttonBar\\\"> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"EventModalCtrl.openCalendar($event, prop)\\\"><i class=\\\"fa fa-calendar\\\"></i></button></span></div></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\'\\\"><label for=\\\"schedulerRepeat\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_repeat\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeat\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatSwitch\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\' && EventModalCtrl.scheduler.repeatSwitch\\\"><label for=\\\"schedulerRepeatEvery\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_repeat_every\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"schedulerRepeatEvery\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeat\\\" data-ng-options=\\\"repeatEvery.value*1 as EventModalCtrl.tr(repeatEvery.label) for repeatEvery in EventModalCtrl.schedulerRepeatEveryEnum\\\"></select></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\' && EventModalCtrl.scheduler.repeatSwitch && EventModalCtrl.scheduler.repeat !== 3\\\"><label for=\\\"schedulerRepeatEveryValue\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_repeat_every_value\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"number\\\" id=\\\"schedulerRepeatEveryValue\\\" min=\\\"0\\\" step=\\\"1\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeat_value\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\' && EventModalCtrl.scheduler.repeatSwitch && EventModalCtrl.scheduler.repeat === 3\\\"><label for=\\\"schedulerRepeatEveryDayOfWeek\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_repeat_every_value\\\"></label><div class=\\\"col-xs-7 controls\\\"><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatMonday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_monday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatMonday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.monday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatTuesday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_tuesday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatTuesday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.tuesday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatWednesday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_wednesday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatWednesday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.wednesday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatThursday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_thursday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatThursday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.thursday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatFriday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_friday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatFriday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.friday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatSaturday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_saturday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatSaturday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.saturday\\\"></div></div><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><label for=\\\"schedulerRepeatSunday\\\" data-translate=\\\"event_scheduler_repeat_every_day_of_week_sunday\\\"></label></div><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRepeatSunday\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.repeatEveryDayOfWeek.sunday\\\"></div></div></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'scheduler\\' && !EventModalCtrl.scheduler.repeatSwitch\\\"><label for=\\\"schedulerRemoveAfter\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_scheduler_remove_after\\\"></label><div class=\\\"col-xs-7 controls\\\"><input type=\\\"checkbox\\\" id=\\\"schedulerRemoveAfter\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.scheduler.remove_after\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"EventModalCtrl.eventType === \\'trigger\\'\\\"><label for=\\\"triggerSource\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_trigger_source\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"triggerSource\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.trigger\\\" data-ng-options=\\\"element as element.display for element in EventModalCtrl.globalTriggerElementList track by EventModalCtrl.trackTriggerElement(element)\\\"></select></div><div class=\\\"control-group\\\"><label for=\\\"newTriggerMessage\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_trigger_message\\\"></label><div class=\\\"col-xs-5 controls\\\"></div><div class=\\\"col-xs-3\\\"><select id=\\\"newTriggerMessageOperator\\\" name=\\\"newTriggerMessageOperator\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.event.message_match\\\"><option value=\\\"0\\\"></option><option value=\\\"1\\\" data-translate=\\\"message_match_equal\\\"></option><option value=\\\"2\\\" data-translate=\\\"message_match_different\\\"></option><option value=\\\"3\\\" data-translate=\\\"message_match_contains\\\"></option><option value=\\\"4\\\" data-translate=\\\"message_match_not_contains\\\"></option><option value=\\\"5\\\" data-translate=\\\"message_match_empty\\\"></option><option value=\\\"6\\\" data-translate=\\\"message_match_not_empty\\\"></option></select></div><div class=\\\"col-xs-4\\\" data-ng-if=\\\"EventModalCtrl.event.message_match <= 4\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"newTriggerMessageValue\\\" id=\\\"newTriggerMessageValue\\\" data-ng-model=\\\"EventModalCtrl.event.message\\\" placeholder=\\\"{{\\'event_message_match_placeholder\\' | translate}}\\\"></div></div></div><hr><div class=\\\"row control-group\\\"><label class=\\\"col-xs-5\\\" data-translate=\\\"event_script_list\\\"></label><div class=\\\"col-xs-7\\\"><div class=\\\"row\\\" data-ng-repeat=\\\"script in EventModalCtrl.scriptList track by $index\\\"><strong data-ng-bind=\\\"script.name\\\"></strong> <input type=\\\"checkbox\\\" id=\\\"scriptEnabled\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"script.enabled\\\"> <button type=\\\"button\\\" class=\\\"btn btn-default pull-right\\\" data-ng-click=\\\"EventModalCtrl.removeScript($index)\\\"><i class=\\\"fa fa-trash\\\"></i></button></div></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventScriptSelect\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_script_select\\\"></label><div class=\\\"col-xs-7\\\"><select id=\\\"eventScriptSelect\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newScript\\\" data-ng-options=\\\"script.name for script in EventModalCtrl.globalScriptList\\\"></select></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventScriptAdd\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_add\\\"></label><div class=\\\"col-xs-7\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"EventModalCtrl.addScript(EventModalCtrl.newScript)\\\"><i class=\\\"fa fa-plus\\\"></i></button></div></div><hr><div class=\\\"row control-group\\\"><label class=\\\"col-xs-5\\\" data-translate=\\\"event_condition_list\\\"></label><div class=\\\"col-xs-7\\\"><div class=\\\"row\\\" data-ng-repeat=\\\"condition in EventModalCtrl.conditionList track by $index\\\"><strong data-ng-bind=\\\"EventModalCtrl.displayCondition(condition)\\\"></strong> <button type=\\\"button\\\" class=\\\"btn btn-default pull-right\\\" data-ng-click=\\\"EventModalCtrl.removeCondition($index)\\\"><i class=\\\"fa fa-trash\\\"></i></button></div></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventScriptAdd\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_condition_select\\\"></label><div class=\\\"col-xs-7\\\"><select id=\\\"eventconditionAdd\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newConditionType\\\" data-ng-options=\\\"condition as EventModalCtrl.tr(condition.label) for condition in EventModalCtrl.globalElementList\\\"></select></div></div><div class=\\\"row control-group\\\"><div data-ng-if=\\\"EventModalCtrl.newConditionType.name === \\'switch\\'\\\"><div data-ng-class=\\\"{\\'has-error\\': !EventModalCtrl.tmpElement}\\\"><label for=\\\"newConditionSwitch\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_switch_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionSwitch\\\" name=\\\"newConditionSwitch\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.tmpElement\\\" data-ng-change=\\\"EventModalCtrl.setConditionBenoicElement()\\\" data-ng-options=\\\"switch as switch.display for switch in EventModalCtrl.benoicElements.switches track by EventModalCtrl.trackBenoicElement(switch, \\'switch\\')\\\"></select></div></div><div><label for=\\\"newConditionSwitchValue\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_switch_value\\\"></label><div class=\\\"col-xs-7\\\"><input type=\\\"checkbox\\\" id=\\\"newConditionSwitchValue\\\" name=\\\"newConditionSwitchValue\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\" data-ng-checked=\\\"false\\\" data-ng-true-value=\\\"1\\\" data-ng-false-value=\\\"0\\\"></div></div></div><div data-ng-if=\\\"EventModalCtrl.newConditionType.name === \\'dimmer\\'\\\"><div class=\\\"control-group\\\" data-ng-class=\\\"{\\'has-error\\': !EventModalCtrl.tmpElement}\\\"><label for=\\\"newConditionDimmer\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_dimmer_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionDimmer\\\" name=\\\"newConditionDimmer\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.tmpElement\\\" data-ng-change=\\\"EventModalCtrl.setConditionBenoicElement()\\\" data-ng-options=\\\"dimmer as dimmer.display for dimmer in EventModalCtrl.benoicElements.dimmers track by EventModalCtrl.trackBenoicElement(dimmer, \\'dimmer\\')\\\"></select></div></div><div class=\\\"form-group\\\"><label for=\\\"newConditionDimmerValue\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_dimmer_value\\\"></label><div class=\\\"col-xs-3\\\"><select id=\\\"newConditionOperator\\\" name=\\\"newConditionOperator\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\"><option value=\\\"==\\\">==</option><option value=\\\"<\\\">&lt;</option><option value=\\\"<=\\\">&lt;=</option><option value=\\\">\\\">&gt;</option><option value=\\\">=\\\">&gt;=</option></select></div><div class=\\\"col-xs-4\\\"><input id=\\\"newConditionDimmerValue\\\" class=\\\"form-control\\\" name=\\\"newConditionDimmerValue\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"100\\\" size=\\\"3\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\"></div></div></div><div data-ng-if=\\\"EventModalCtrl.newConditionType.name === \\'heater\\'\\\"><div class=\\\"control-group\\\"><label for=\\\"newConditionHeater\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_heater_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionHeater\\\" name=\\\"newConditionHeater\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.tmpElement\\\" data-ng-change=\\\"EventModalCtrl.setConditionBenoicElement()\\\" data-ng-options=\\\"heater as heater.display for heater in EventModalCtrl.benoicElements.heaters track by EventModalCtrl.trackBenoicElement(heater, \\'heater\\')\\\"></select></div></div><div><label for=\\\"newConditionHeaterValue\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_heater_command\\\"></label><div class=\\\"col-xs-3\\\"><select id=\\\"newConditionOperator\\\" name=\\\"newConditionOperator\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"!!EventModalCtrl.newCondition.commandMode\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\"><option value=\\\"==\\\">==</option><option value=\\\"<\\\"><</option><option value=\\\"<=\\\"><=< option=\\\"\\\"><option value=\\\">\\\">&gt;</option><option value=\\\">=\\\">&gt;=</option></=<></option></select></div><div class=\\\"col-xs-4\\\"><input id=\\\"newConditionHeaterValue\\\" class=\\\"form-control\\\" name=\\\"newConditionHeaterValue\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"100\\\" data-ng-disabled=\\\"!!EventModalCtrl.newCondition.commandMode\\\" data-ng-model=\\\"EventModalCtrl.newCondition.commandHeat\\\"></div></div><div class=\\\"control-group\\\"><div class=\\\"col-xs-12 text-center\\\"><label data-translate=\\\"condition_or\\\"></label></div></div><div class=\\\"control-group\\\"><label for=\\\"newConditionHeaterMode\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_heater_mode_title\\\"></label><div class=\\\"col-xs-3\\\"><select id=\\\"newConditionOperator\\\" name=\\\"newConditionOperator\\\" class=\\\"form-control\\\" data-ng-disabled=\\\"!!EventModalCtrl.newCondition.commandHeat\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\"><option value=\\\"==\\\">=</option><option value=\\\"!=\\\">!=</option></select></div><div class=\\\"col-xs-4 controls\\\"><select class=\\\"form-control\\\" id=\\\"newConditionHeaterMode\\\" name=\\\"newConditionHeaterMode\\\" data-ng-disabled=\\\"!!EventModalCtrl.newCondition.commandHeat\\\" data-ng-model=\\\"EventModalCtrl.newCondition.commandMode\\\" data-ng-options=\\\"mode as EventModalCtrl.heaterModeDisplay(mode) for mode in EventModalCtrl.tmpElement.availableModes\\\"><option value=\\\"\\\"></option></select></div></div></div><div data-ng-if=\\\"EventModalCtrl.newConditionType.name === \\'sensor\\'\\\"><div class=\\\"control-group\\\" data-ng-class=\\\"{\\'has-error\\': !EventModalCtrl.tmpElement}\\\"><label for=\\\"newConditionSensor\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_sensor_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionSensor\\\" name=\\\"newConditionSensor\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.tmpElement\\\" data-ng-change=\\\"EventModalCtrl.setConditionBenoicElement()\\\" data-ng-options=\\\"sensor as sensor.display for sensor in EventModalCtrl.benoicElements.sensors track by EventModalCtrl.trackBenoicElement(sensor, \\'sensor\\')\\\"></select></div></div><div class=\\\"form-group\\\"><label for=\\\"newConditionSensorValue\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_sensor_value\\\"></label><div class=\\\"col-xs-3\\\"><select id=\\\"newConditionOperator\\\" name=\\\"newConditionOperator\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\"><option value=\\\"==\\\">==</option><option value=\\\"<\\\">&lt;</option><option value=\\\"<=\\\">&lt;=</option><option value=\\\">\\\">&gt;</option><option value=\\\">=\\\">&gt;=</option></select></div><div class=\\\"col-xs-4\\\"><input id=\\\"newConditionSensorValue\\\" class=\\\"form-control\\\" name=\\\"newConditionSensorValue\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"100\\\" size=\\\"3\\\" step=\\\".1\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\"></div></div></div><div data-ng-if=\\\"EventModalCtrl.newConditionType.submodule === \\'carleon\\'\\\"><div class=\\\"control-group\\\" data-ng-class=\\\"{\\'has-error\\': !EventModalCtrl.tmpElement}\\\"><label for=\\\"newConditionCarleonElement\\\" class=\\\"col-xs-5\\\" data-translate=\\\"script_element_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionCarleonElement\\\" name=\\\"newConditionCarleonElement\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.tmpElement\\\" data-ng-change=\\\"EventModalCtrl.setActionCarleonElement()\\\" data-ng-options=\\\"element as element.name for element in EventModalCtrl.carleonConditionElementsList[EventModalCtrl.newConditionType.name] track by EventModalCtrl.trackCarleonElement(element, EventModalCtrl.newConditionType.name)\\\"></select></div></div><div class=\\\"control-group\\\" data-ng-repeat=\\\"parameter in EventModalCtrl.carleonConditionCommandsParameters[EventModalCtrl.newConditionType.name]\\\"><label for=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" class=\\\"col-xs-5\\\" data-ng-bind=\\\"parameter.title\\\"></label><div class=\\\"col-xs-7 controls\\\" data-ng-class=\\\"{\\'has-error\\': (parameter.required && !EventModalCtrl.newCondition.parameters[parameter.name] && EventModalCtrl.newCondition.parameters[parameter.name] !== 0)}\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'string\\'\\\" data-ng-model=\\\"EventModalCtrl.newCondition.parameters[parameter.name]\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'integer\\'\\\" data-ng-model=\\\"EventModalCtrl.newCondition.parameters[parameter.name]\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'real\\'\\\" step=\\\".01\\\" data-ng-model=\\\"EventModalCtrl.newCondition.parameters[parameter.name]\\\"> <input type=\\\"checkbox\\\" id=\\\"newConditionSwitchValue\\\" name=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.newCondition.parameters[parameter.name]\\\" data-ng-checked=\\\"false\\\" data-ng-if=\\\"parameter.type === \\'boolean\\'\\\"></div></div><div class=\\\"control-group\\\"><label for=\\\"newConditionCarleonParameter\\\" class=\\\"col-xs-5\\\" data-translate=\\\"condition_result_select\\\"></label><div class=\\\"col-xs-7 controls\\\"><select id=\\\"newConditionCarleonParameter\\\" name=\\\"newConditionCarleonParameter\\\" class=\\\"form-control\\\" data-ng-init=\\\"EventModalCtrl.tmpResult = EventModalCtrl.carleonConditionResultParameters[EventModalCtrl.newConditionType.name][0]\\\" data-ng-model=\\\"EventModalCtrl.tmpResult\\\" data-ng-options=\\\"parameter as EventModalCtrl.tr(parameter.title) for parameter in EventModalCtrl.carleonConditionResultParameters[EventModalCtrl.newConditionType.name]\\\"></select></div></div><div class=\\\"control-group\\\" data-ng-if=\\\"EventModalCtrl.tmpResult\\\"><label for=\\\"{{EventModalCtrl.tmpResult.title}}\\\" class=\\\"col-xs-5\\\" data-translate=\\\"scheduler_condition_value\\\"></label><div class=\\\"col-xs-5 controls\\\"></div><div class=\\\"col-xs-3\\\"><select id=\\\"{{EventModalCtrl.tmpResult.title}}\\\" name=\\\"{{EventModalCtrl.tmpResult.title}}\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'real\\' || EventModalCtrl.tmpResult.type === \\'integer\\'\\\"><option value=\\\"==\\\">==</option><option value=\\\"<\\\">&lt;</option><option value=\\\"<=\\\">&lt;=</option><option value=\\\">\\\">&gt;</option><option value=\\\">=\\\">&gt;=</option></select><select id=\\\"newConditionOperator\\\" name=\\\"newConditionOperator\\\" class=\\\"form-control\\\" data-ng-model=\\\"EventModalCtrl.newCondition.condition\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'string\\'\\\"><option value=\\\"==\\\">==</option><option value=\\\"!=\\\">!=</option><option value=\\\"contains\\\" data-translate=\\\"condition_contains\\\"></option><option value=\\\"not contains\\\" data-translate=\\\"condition_not_contains\\\"></option></select><input type=\\\"checkbox\\\" id=\\\"{{EventModalCtrl.newConditionType.name}}\\\" name=\\\"{{EventModalCtrl.newConditionType.name}\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\" data-ng-checked=\\\"false\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'boolean\\'\\\"></div><div class=\\\"col-xs-4\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'string\\'\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'integer\\'\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{EventModalCtrl.newConditionType.name}}\\\" id=\\\"{{EventModalCtrl.newConditionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"EventModalCtrl.tmpResult.type === \\'real\\'\\\" step=\\\".01\\\" data-ng-model=\\\"EventModalCtrl.newCondition.value\\\"></div></div></div></div><div class=\\\"row control-group\\\"><label for=\\\"eventScriptAdd\\\" class=\\\"col-xs-5\\\" data-translate=\\\"event_add\\\"></label><div class=\\\"col-xs-7\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" data-ng-click=\\\"EventModalCtrl.addCondition()\\\" data-ng-disabled=\\\"!EventModalCtrl.isConditionValid()\\\"><i class=\\\"fa fa-plus\\\"></i></button></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"EventModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\" data-ng-disabled=\\\"!EventModalCtrl.isEventValid()\\\" data-uib-tooltip=\\\"{{EventModalCtrl.error.message}}\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"EventModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/event/scheduler.template.html\",\"<div class=\\\"text-center\\\"><div class=\\\"row\\\"><div class=\\\"span6\\\"><label for=\\\"schedulerEnabled\\\" data-translate=\\\"scheduler_enable_button\\\"></label> <input type=\\\"checkbox\\\" id=\\\"schedulerEnabled\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-change=\\\"$ctrl.enableScheduler()\\\" data-ng-model=\\\"$ctrl.element.enabled\\\"></div></div><div class=\\\"row\\\"><div class=\\\"span6\\\"><label data-translate=\\\"scheduler_next_time\\\"></label></div><div class=\\\"span6\\\"><span data-ng-bind=\\\"$ctrl.element.next_time * 1000 | date:\\'yyyy/MM/dd HH:mm\\'\\\" data-ng-if=\\\"$ctrl.element.enabled\\\"></span> <span data-translate=\\\"scheduler_disabled\\\" data-ng-if=\\\"!$ctrl.element.enabled\\\"></span></div></div></div>\");\n$templateCache.put(\"components/event/trigger.template.html\",\"<div class=\\\"text-center\\\"><div class=\\\"row\\\"><div class=\\\"span6\\\"><label for=\\\"schedulerEnabled\\\" data-translate=\\\"scheduler_enable_button\\\"></label> <input type=\\\"checkbox\\\" id=\\\"schedulerEnabled\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-change=\\\"$ctrl.enableTrigger()\\\" data-ng-model=\\\"$ctrl.element.enabled\\\"></div></div></div>\");\n$templateCache.put(\"components/script/script.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"script_modal_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !!ScriptModalCtrl.error.message}\\\"><label for=\\\"scriptName\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_name\\\"></label><div class=\\\"col-xs-8 controls\\\"><input type=\\\"text\\\" name=\\\"scriptName\\\" id=\\\"scriptName\\\" data-ng-model=\\\"ScriptModalCtrl.script.name\\\" class=\\\"modal-input-text form-control\\\" size=\\\"16\\\" maxlength=\\\"64\\\" data-ng-disabled=\\\"!ScriptModalCtrl.add\\\" placeholder=\\\"{{\\'script_name_placeholder\\' | translate}}\\\"></div></div><div class=\\\"row control-group\\\"><label for=\\\"scriptDecription\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_description\\\"></label><div class=\\\"col-xs-8 controls\\\"><input type=\\\"text\\\" name=\\\"scriptDecription\\\" id=\\\"scriptDecription\\\" data-ng-model=\\\"ScriptModalCtrl.script.description\\\" class=\\\"modal-input-text form-control\\\" size=\\\"16\\\" maxlength=\\\"128\\\" placeholder=\\\"{{\\'script_description_placeholder\\' | translate}}\\\"></div></div><hr><h4 data-translate=\\\"script_actions\\\"></h4><div data-ng-repeat=\\\"action in ScriptModalCtrl.script.actions\\\"><div class=\\\"row\\\" data-ng-if=\\\"action.submodule === \\'benoic\\'\\\"><div class=\\\"col-xs-4\\\"><strong data-ng-bind=\\\"ScriptModalCtrl.getBenoicElementDisplay(action)\\\"></strong></div><div class=\\\"col-xs-4\\\"><strong data-ng-bind=\\\"ScriptModalCtrl.getBenoicElementValue(action)\\\"></strong></div><div class=\\\"col-xs-2\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ScriptModalCtrl.removeAction($index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></div></div><div class=\\\"row\\\" data-ng-if=\\\"action.submodule === \\'carleon\\'\\\"><div class=\\\"col-xs-4\\\"><strong data-ng-bind=\\\"ScriptModalCtrl.carleonCommand(action.command, action.parameters.service)\\\"></strong></div><div class=\\\"col-xs-4\\\"><div class=\\\"row\\\" data-ng-repeat=\\\"(name, value) in action.parameters\\\" data-ng-if=\\\"name !== \\'service\\'\\\"><strong><span data-ng-bind=\\\"ScriptModalCtrl.carleonParameter(name, action.parameters.service, action.command)\\\"></span> <span>:</span> <span data-ng-bind=\\\"value\\\"></span></strong></div></div><div class=\\\"col-xs-2\\\"><button type=\\\"button\\\" class=\\\"btn\\\" data-ng-click=\\\"ScriptModalCtrl.removeAction($index)\\\"><i class=\\\"fa fa-trash\\\" aria-hidden=\\\"true\\\"></i></button></div></div></div><hr><div class=\\\"row\\\"><div class=\\\"col-xs-12\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"ScriptModalCtrl.addAction()\\\" data-translate=\\\"script_add_action\\\"></button></div></div><div data-ng-if=\\\"ScriptModalCtrl.newAction\\\"><hr><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !ScriptModalCtrl.newActionType}\\\"><label for=\\\"newActionElement\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_action\\\"></label><div class=\\\"col-xs-8 controls\\\"><select id=\\\"newActionElement\\\" name=\\\"newActionElement\\\" class=\\\"form-control\\\" data-ng-model=\\\"ScriptModalCtrl.newActionType\\\" data-ng-options=\\\"element as ScriptModalCtrl.tr(element.label) for element in ScriptModalCtrl.scriptActionElements track by element.name\\\" data-ng-change=\\\"ScriptModalCtrl.changeActionType()\\\"></select></div></div><div data-ng-if=\\\"ScriptModalCtrl.newActionType.name === \\'switch\\'\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !ScriptModalCtrl.newAction.switcher.name}\\\"><label for=\\\"newActionSwitch\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_switch_select\\\"></label><div class=\\\"col-xs-8 controls\\\"><select id=\\\"newActionSwitch\\\" name=\\\"newActionSwitch\\\" class=\\\"form-control\\\" data-ng-model=\\\"ScriptModalCtrl.tmpElement\\\" data-ng-change=\\\"ScriptModalCtrl.setActionBenoicElement()\\\" data-ng-options=\\\"switch as switch.display for switch in ScriptModalCtrl.benoicElements.switches track by ScriptModalCtrl.trackBenoicElement(switch, \\'switch\\')\\\"></select></div></div><div class=\\\"row\\\"><label for=\\\"newActionSwitchValue\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_switch_value\\\"></label><div class=\\\"col-xs-8\\\"><input type=\\\"checkbox\\\" id=\\\"newActionSwitchValue\\\" name=\\\"newActionSwitchValue\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.command\\\" data-ng-checked=\\\"false\\\" data-ng-true-value=\\\"1\\\" data-ng-false-value=\\\"0\\\"></div></div></div><div data-ng-if=\\\"ScriptModalCtrl.newActionType.name === \\'dimmer\\'\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !ScriptModalCtrl.newAction.dimmer.name}\\\"><label for=\\\"newActionDimmer\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_dimmer_select\\\"></label><div class=\\\"col-xs-8 controls\\\"><select id=\\\"newActionDimmer\\\" name=\\\"newActionDimmer\\\" class=\\\"form-control\\\" data-ng-model=\\\"ScriptModalCtrl.tmpElement\\\" data-ng-change=\\\"ScriptModalCtrl.setActionBenoicElement()\\\" data-ng-options=\\\"dimmer as dimmer.display for dimmer in ScriptModalCtrl.benoicElements.dimmers track by ScriptModalCtrl.trackBenoicElement(dimmer, \\'dimmer\\')\\\"></select></div></div><div class=\\\"row\\\"><label for=\\\"newActionDimmerValue\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_dimmer_value\\\"></label><div class=\\\"col-xs-8\\\"><input id=\\\"newActionDimmerValue\\\" class=\\\"form-control\\\" name=\\\"newActionDimmerValue\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"100\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.command\\\"></div></div></div><div data-ng-if=\\\"ScriptModalCtrl.newActionType.name === \\'heater\\'\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !ScriptModalCtrl.newAction.heater.name}\\\"><label for=\\\"newActionHeater\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_heater_select\\\"></label><div class=\\\"col-xs-8 controls\\\"><select id=\\\"newActionHeater\\\" name=\\\"newActionHeater\\\" class=\\\"form-control\\\" data-ng-model=\\\"ScriptModalCtrl.tmpElement\\\" data-ng-change=\\\"ScriptModalCtrl.setActionBenoicElement()\\\" data-ng-options=\\\"heater as heater.display for heater in ScriptModalCtrl.benoicElements.heaters track by ScriptModalCtrl.trackBenoicElement(heater, \\'heater\\')\\\"></select></div></div><div class=\\\"row\\\"><label for=\\\"newActionHeaterValue\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_heater_command\\\"></label><div class=\\\"col-xs-8\\\"><input id=\\\"newActionHeaterValue\\\" class=\\\"form-control\\\" name=\\\"newActionHeaterValue\\\" type=\\\"number\\\" min=\\\"0\\\" max=\\\"100\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.command\\\"> <span data-ng-bind=\\\"ScriptModalCtrl.tmpElement.options.unit\\\"></span></div></div><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': !ScriptModalCtrl.newAction.heater.mode}\\\"><label for=\\\"newActionHeaterMode\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_heater_mode_title\\\"></label><div class=\\\"col-xs-8 controls\\\"><select class=\\\"form-control\\\" id=\\\"newActionHeaterMode\\\" name=\\\"newActionHeaterMode\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.parameters.mode\\\" data-ng-options=\\\"mode as ScriptModalCtrl.heaterModeDisplay(mode) for mode in ScriptModalCtrl.tmpElement.availableModes\\\"><option value=\\\"\\\" data-translate=\\\"heater_mode_keep\\\"></option></select></div></div></div><div data-ng-if=\\\"ScriptModalCtrl.newActionType.submodule === \\'carleon\\'\\\"><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': false}\\\"><label for=\\\"newActionCarleonElement\\\" class=\\\"col-xs-4\\\" data-translate=\\\"script_element_select\\\"></label><div class=\\\"col-xs-8 controls\\\"><select id=\\\"newActionCarleonElement\\\" name=\\\"newActionCarleonElement\\\" class=\\\"form-control\\\" data-ng-model=\\\"ScriptModalCtrl.tmpElement\\\" data-ng-change=\\\"ScriptModalCtrl.setActionCarleonElement()\\\" data-ng-options=\\\"element as element.name for element in ScriptModalCtrl.carleonConditionElementsList[ScriptModalCtrl.newActionType.name] track by ScriptModalCtrl.trackCarleonElement(element, ScriptModalCtrl.newActionType.name)\\\"></select></div></div><div class=\\\"row control-group\\\" data-ng-class=\\\"{\\'has-error\\': false}\\\" data-ng-repeat=\\\"parameter in ScriptModalCtrl.carleonConditionCommandsParameters[ScriptModalCtrl.newActionType.name]\\\"><label for=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" class=\\\"col-xs-4\\\" data-ng-bind=\\\"parameter.title\\\"></label><div class=\\\"col-xs-8 controls\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'string\\'\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.parameters[parameter.name]\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'integer\\'\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.parameters[parameter.name]\\\"> <input type=\\\"number\\\" class=\\\"form-control\\\" name=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" id=\\\"{{ScriptModalCtrl.newActionType.name + \\'$\\' + parameter.name}}\\\" data-ng-if=\\\"parameter.type === \\'real\\'\\\" step=\\\".01\\\" data-ng-model=\\\"ScriptModalCtrl.newAction.parameters[parameter.name]\\\"></div></div></div><hr><div class=\\\"row\\\"><div class=\\\"col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"ScriptModalCtrl.saveNewAction()\\\" data-translate=\\\"btn_add\\\" data-ng-disabled=\\\"!ScriptModalCtrl.isActionValid()\\\" data-uib-tooltip=\\\"{{ScriptModalCtrl.error.messageAction}}\\\"></button></div><div class=\\\"col-xs-6\\\"><button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-ng-click=\\\"ScriptModalCtrl.cancelAddAction()\\\" data-translate=\\\"btn_cancel\\\"></button></div></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"ScriptModalCtrl.save()\\\" data-translate=\\\"btn_ok\\\" data-ng-disabled=\\\"!ScriptModalCtrl.isScriptValid()\\\" data-uib-tooltip=\\\"{{ScriptModalCtrl.error.message}}\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"ScriptModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/script/script.template.html\",\"<div class=\\\"text-center\\\"><button type=\\\"button\\\" data-ng-click=\\\"$ctrl.runScript()\\\" class=\\\"btn btn-primary script-button\\\" data-ng-bind=\\\"$ctrl.element.name\\\"></button></div>\");\n$templateCache.put(\"components/sensor/sensor.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"sensor_update_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"sensor_update_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"sensorDisplay\\\" id=\\\"sensorDisplay\\\" data-ng-model=\\\"SensorsModalCtrl.sensor.newDisplay\\\" class=\\\"modal-input-text form-control\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"sensor_update_unit\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"sensorUnit\\\" id=\\\"sensorUnit\\\" data-ng-model=\\\"SensorsModalCtrl.sensor.options.unit\\\" class=\\\"modal-input-text form-control\\\" placeholder=\\\"{{\\'sensor_unit_placeholder\\' | translate}}\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"sensor_update_enabled\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"SensorsModalCtrl.sensor.enabled\\\"></div></div><div class=\\\"row\\\"><hr></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"sensor_update_monitor\\\"></span><div class=\\\"col-xs-6\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" class=\\\"form-control\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"SensorsModalCtrl.sensor.monitored\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"SensorsModalCtrl.sensor.monitored\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"sensor_update_monitor_every\\\"></span><div class=\\\"col-xs-6\\\"><select id=\\\"bddAddUserGrant\\\" class=\\\"form-control\\\" data-ng-model=\\\"SensorsModalCtrl.sensor.monitored_every\\\" data-ng-options=\\\"monitorEvery.value as SensorsModalCtrl.tr(monitorEvery.label) for monitorEvery in SensorsModalCtrl.monitorEveryEnum\\\"></select></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"SensorsModalCtrl.saveSensor()\\\" data-translate=\\\"sensor_btn_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"SensorsModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"sensor_btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/sensor/sensor.template.html\",\"<div data-ng-if=\\\"$ctrl.element.enabled || $ctrl.adminMode\\\"><div class=\\\"text-center\\\" data-ng-class=\\\"{\\'text-italic\\': $ctrl.adminMode}\\\"><div data-ng-bind=\\\"$ctrl.elementDisplayValue()\\\"></div></div></div>\");\n$templateCache.put(\"components/switch/switch.modal.html\",\"<div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\" data-translate=\\\"switch_update_title\\\"></h3></div><div class=\\\"modal-body\\\"><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"switch_update_name\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"text\\\" name=\\\"switcherDisplay\\\" id=\\\"switcherDisplay\\\" data-ng-model=\\\"SwitchesModalCtrl.switcher.newDisplay\\\" class=\\\"modal-input-text form-control\\\"></div></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"switch_update_enabled\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"SwitchesModalCtrl.switcher.enabled\\\"></div></div><div class=\\\"row\\\"><hr></div><div class=\\\"row control-group\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"switch_update_monitor\\\"></span><div class=\\\"col-xs-6 controls\\\"><input type=\\\"checkbox\\\" class=\\\"form-control\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"SwitchesModalCtrl.switcher.monitored\\\"></div></div><div class=\\\"row control-group\\\" data-ng-if=\\\"SwitchesModalCtrl.switcher.monitored\\\"><span class=\\\"col-xs-6\\\" data-translate=\\\"switch_update_monitor_every\\\"></span><div class=\\\"col-xs-6 controls\\\"><select id=\\\"bddAddUserGrant\\\" class=\\\"form-control\\\" data-ng-model=\\\"SwitchesModalCtrl.switcher.monitored_every\\\" data-ng-options=\\\"monitorEvery.value as SwitchesModalCtrl.tr(monitorEvery.label) for monitorEvery in SwitchesModalCtrl.monitorEveryEnum\\\"></select></div></div></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" data-ng-click=\\\"SwitchesModalCtrl.saveSwitcher()\\\" data-translate=\\\"switch_btn_ok\\\"></button> <button class=\\\"btn btn-warning\\\" type=\\\"button\\\" data-ng-click=\\\"SwitchesModalCtrl.cancel()\\\" data-dismiss=\\\"modal\\\" data-translate=\\\"switch_btn_cancel\\\"></button></div></div>\");\n$templateCache.put(\"components/switch/switch.template.html\",\"<div data-ng-if=\\\"$ctrl.element.enabled || $ctrl.adminMode\\\"><div class=\\\"text-center\\\" data-ng-class=\\\"{\\'text-italic\\': $ctrl.adminMode}\\\"><input type=\\\"checkbox\\\" data-bs-switch=\\\"\\\" data-toggle=\\\"toggle\\\" data-switch-size=\\\"mini\\\" data-ng-model=\\\"$ctrl.element.valueChecked\\\" data-ng-change=\\\"$ctrl.toggleSwitcher()\\\"></div></div>\");\n$templateCache.put(\"components/topLeftMenu/topLeftMenu.template.html\",\"<div data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.loggedIn\\\"><ul class=\\\"nav nav-tabs nav-stacked nav-pills topnav\\\"><li id=\\\"tabDashboard\\\" class=\\\"sag-menu active text-center\\\"><a data-ui-sref=\\\"dashboard\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabDashboard\\')\\\" title=\\\"{{\\'menu_home\\'|translate}}\\\"><i class=\\\"fa fa-home fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabSwitches\\\" class=\\\"sag-menu text-center\\\" data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.benoicEnabled\\\"><a data-ui-sref=\\\"switches\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabSwitches\\')\\\" title=\\\"{{\\'menu_lights\\'|translate}}\\\"><i class=\\\"fa fa-lightbulb-o fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabHeaters\\\" class=\\\"sag-menu text-center\\\" data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.benoicEnabled\\\"><a data-ui-sref=\\\"heaters\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabHeaters\\')\\\" title=\\\"{{\\'menu_heaters\\'|translate}}\\\"><i class=\\\"fa fa-fire fa-3x\\\"></i></a></li><li id=\\\"tabSensors\\\" class=\\\"sag-menu text-center\\\" data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.benoicEnabled\\\"><a data-ui-sref=\\\"sensors\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabSensors\\')\\\" title=\\\"{{\\'menu_sensors\\'|translate}}\\\"><i class=\\\"fa fa-line-chart fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabService{{service.target}}\\\" class=\\\"sag-menu text-center\\\" data-ng-repeat=\\\"service in topLeftMenuCtrl.serviceList\\\" data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.carleonEnabled\\\"><a data-ui-sref=\\\"service({service: service.target})\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabService\\' + service.target)\\\" title=\\\"{{service.name|translate}}\\\"><i data-ng-class=\\\"{\\'fa fa-{{service.icon}} fa-fw fa-3x\\': true}\\\"></i></a></li><li id=\\\"tabScripts\\\" class=\\\"sag-menu text-center\\\"><a data-ui-sref=\\\"scripts\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabScripts\\')\\\" title=\\\"{{\\'menu_scripts\\'|translate}}\\\"><i class=\\\"fa fa-tasks fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabEvents\\\" class=\\\"sag-menu text-center\\\"><a data-ui-sref=\\\"events\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabEvents\\')\\\" title=\\\"{{\\'menu_events\\'|translate}}\\\"><i class=\\\"fa fa-calendar fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabMonitors\\\" class=\\\"sag-menu text-center\\\"><a data-ui-sref=\\\"monitors\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabMonitors\\')\\\" title=\\\"{{\\'menu_monitor\\'|translate}}\\\"><i class=\\\"fa fa-bar-chart fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabLogs\\\" class=\\\"sag-menu text-center\\\" data-ng-if=\\\"topLeftMenuCtrl.sagremorParams.garethEnabled\\\" title=\\\"{{\\'menu_logs\\'|translate}}\\\"><a data-ui-sref=\\\"logs\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabLogs\\')\\\"><i class=\\\"fa fa-history fa-fw fa-3x\\\"></i></a></li><li id=\\\"tabParameters\\\" class=\\\"sag-menu text-center\\\"><a data-ui-sref=\\\"parameters\\\" data-toggle=\\\"tab\\\" data-ng-click=\\\"topLeftMenuCtrl.selectTab(\\'#tabParameters\\')\\\" title=\\\"{{\\'menu_parameters\\'|translate}}\\\"><i class=\\\"fa fa-cogs fa-fw fa-3x\\\"></i></a></li></ul></div>\");\n$templateCache.put(\"components/topRightMenu/topRightMenu.template.html\",\"<div class=\\\"top-right-menu\\\" data-uib-dropdown=\\\"\\\"><button class=\\\"btn btn-primary text-left\\\" type=\\\"button\\\" data-uib-dropdown-toggle=\\\"\\\"><i class=\\\"fa fa-user fa-3x\\\" aria-hidden=\\\"true\\\"></i></button><ul class=\\\"container-fluid dropdown-menu dropdown-menu-right top-right-menu-list\\\" data-uib-dropdown-menu=\\\"\\\" data-uib-dropdown-menu-auto-close=\\\"outsideClick\\\" data-ng-click=\\\"$event.stopPropagation()\\\"><li class=\\\"row control-group\\\" data-ng-if=\\\"topRightMenuCtrl.sagremorParams.loggedIn\\\"><div class=\\\"col-xs-6 controls\\\"><label for=\\\"admin-mode\\\" data-translate=\\\"top_right_menu_admin_mode\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><input class=\\\"form-control\\\" id=\\\"admin-mode\\\" name=\\\"admin-mode\\\" data-toggle=\\\"toggle\\\" data-bs-switch=\\\"\\\" data-switch-size=\\\"mini\\\" type=\\\"checkbox\\\" data-ng-model=\\\"topRightMenuCtrl.sagremorParams.adminMode\\\"></div></li><li class=\\\"row control-group\\\"><div class=\\\"col-xs-6 controls\\\"><label for=\\\"sag-lang\\\" data-translate=\\\"top_right_menu_lang\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><select class=\\\"form-control\\\" id=\\\"sag-lang\\\" name=\\\"sag-lang\\\" data-ng-model=\\\"topRightMenuCtrl.selectedLang\\\" data-ng-options=\\\"lang.name as lang.display for lang in topRightMenuCtrl.langList\\\" data-ng-change=\\\"topRightMenuCtrl.changeLang()\\\"></select></div></li><li class=\\\"row control-group\\\" data-ng-if=\\\"topRightMenuCtrl.sagremorParams.loggedIn\\\"><div class=\\\"col-xs-6 controls\\\"><label for=\\\"sag-lang\\\" data-translate=\\\"top_right_menu_profile\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><select class=\\\"form-control\\\" id=\\\"sag-lang\\\" name=\\\"sag-lang\\\" data-ng-model=\\\"topRightMenuCtrl.currentProfileName\\\" data-ng-options=\\\"profile.name as profile.name for profile in topRightMenuCtrl.profiles\\\" data-ng-change=\\\"topRightMenuCtrl.changeProfile()\\\"></select></div></li><li class=\\\"row control-group\\\" data-ng-if=\\\"topRightMenuCtrl.sagremorParams.loggedIn\\\"><div class=\\\"col-xs-6 controls\\\"><label for=\\\"sag-refresh\\\" data-translate=\\\"top_right_menu_refresh\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><button id=\\\"sag-refresh\\\" name=\\\"sag-refresh\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-sm\\\" data-ng-click=\\\"topRightMenuCtrl.refresh()\\\"><i class=\\\"fa fa-refresh\\\" aria-hidden=\\\"true\\\"></i></button></div></li><li class=\\\"row control-group\\\" data-ng-if=\\\"!topRightMenuCtrl.sagremorParams.loggedIn\\\"><div class=\\\"col-xs-6 controls\\\"><label for=\\\"sag-refresh\\\" data-translate=\\\"top_right_menu_refresh\\\"></label></div><div class=\\\"col-xs-6 controls\\\"><button id=\\\"sag-refresh\\\" name=\\\"sag-refresh\\\" type=\\\"button\\\" class=\\\"btn btn-primary btn-sm\\\" data-ng-click=\\\"topRightMenuCtrl.reconnect()\\\"><i class=\\\"fa fa-refresh\\\" aria-hidden=\\\"true\\\"></i></button></div></li><li class=\\\"row control-group\\\"><data-oauth data-site=\\\"{{topRightMenuCtrl.oauth2.site}}\\\" data-client-id=\\\"{{topRightMenuCtrl.oauth2.clientId}}\\\" data-response-type=\\\"{{topRightMenuCtrl.oauth2.responseType}}\\\" data-redirect-uri=\\\"{{topRightMenuCtrl.oauth2.redirectUri}}\\\" data-profile-uri=\\\"{{topRightMenuCtrl.oauth2.profileUri}}\\\" data-scope=\\\"{{topRightMenuCtrl.oauth2.scope}}\\\" data-authorize-path=\\\"{{topRightMenuCtrl.oauth2.authorizePath}}\\\" data-token-path=\\\"{{topRightMenuCtrl.oauth2.tokenPath}}\\\" data-template=\\\"/app/login/login.html\\\" data-storage=\\\"localStorage\\\" data-disable-check-session=\\\"true\\\"></data-oauth></li></ul></div>\");}]);"],"sourceRoot":"/source/"}